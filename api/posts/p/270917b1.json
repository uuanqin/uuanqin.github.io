{"data":{"title":"æ‰‹å†™ LRU ç¼“å­˜ä»¥ç†è§£ Java ä¸­çš„ LinkedHashMap","slug":"ç®—æ³•ä¸æ•°æ®ç»“æ„/æ‰‹å†™ LRU ç¼“å­˜ä»¥ç†è§£ Java ä¸­çš„ LinkedHashMap","description":"ä¸€ä¸ªå›´ç»• LRU çš„ä¸“é¢˜ç»¼åˆã€‚","date":"2024-09-03T15:25:18.000Z","updated":"2025-06-09T17:32:18.221Z","language":"zh-CN","comments":true,"url":"p/270917b1/","cover":"https://cdn.gallery.uuanqin.top/img/202409050003261.webp","images":[],"content":"<p>æœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼ˆLeast Recently Usedï¼ŒLRUï¼‰ï¼Œæ˜¯ä¸€ç§å¸¸ç”¨çš„é¡µé¢ç½®æ¢ç®—æ³•ï¼Œé€‰æ‹©æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„é¡µé¢äºˆä»¥æ·˜æ±°ã€‚è¯¥ç®—æ³•èµ‹äºˆæ¯ä¸ªé¡µé¢ä¸€ä¸ªè®¿é—®å­—æ®µï¼Œç”¨æ¥è®°å½•ä¸€ä¸ªé¡µé¢è‡ªä¸Šæ¬¡è¢«è®¿é—®ä»¥æ¥æ‰€ç»å†çš„æ—¶é—´ tï¼Œå½“é¡»æ·˜æ±°ä¸€ä¸ªé¡µé¢æ—¶ï¼Œé€‰æ‹©ç°æœ‰é¡µé¢ä¸­å…¶ t å€¼æœ€å¤§çš„ï¼Œå³æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„é¡µé¢äºˆä»¥æ·˜æ±°ã€‚</p>\n<p>Java ä¸­å¯ä»¥ä½¿ç”¨ <code>LinkedHashMap</code> è½»æ¾å®ç°ä¸€ä¸ª LRU ç¼“å­˜ã€‚</p>\n\n<div class=\"callout\" data-callout=\"note\">\n<div class=\"callout-title\">\n<div class=\"callout-title-icon\">\n<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"lucide lucide-pencil\"><path d=\"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z\"/><path d=\"m15 5 4 4\"/></svg>\n</div>\n<div class=\"callout-title-inner\">é¡µé¢ç½®æ¢ç®—æ³•</div>\n</div>\n<div class=\"callout-content\"><p>åœ¨è¿›ç¨‹è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œè‹¥å…¶æ‰€è¦è®¿é—®çš„é¡µé¢ä¸åœ¨å†…å­˜è€Œéœ€æŠŠå®ƒä»¬è°ƒå…¥å†…å­˜ï¼Œä½†å†…å­˜å·²æ— ç©ºé—²ç©ºé—´æ—¶ï¼Œä¸ºäº†ä¿è¯è¯¥è¿›ç¨‹èƒ½æ­£å¸¸è¿è¡Œï¼Œç³»ç»Ÿå¿…é¡»ä»å†…å­˜ä¸­è°ƒå‡ºä¸€é¡µç¨‹åºæˆ–æ•°æ®é€ç£ç›˜çš„å¯¹æ¢åŒºä¸­ã€‚ä½†åº”å°†å“ªä¸ªé¡µé¢è°ƒå‡ºï¼Œé¡»æ ¹æ®ä¸€å®šçš„ç®—æ³•æ¥ç¡®å®šã€‚é€šå¸¸ï¼ŒæŠŠé€‰æ‹©æ¢å‡ºé¡µé¢çš„ç®—æ³•ç§°ä¸ºé¡µé¢ç½®æ¢ç®—æ³•ï¼ˆPage-Replacement Algorithmsï¼‰ã€‚</p>\n<ul>\n<li>æœ€ä½³ç½®æ¢ç®—æ³•ï¼ˆOPTï¼‰</li>\n<li>å…ˆè¿›å…ˆå‡ºç½®æ¢ç®—æ³•ï¼ˆFIFOï¼‰</li>\n<li>æœ€å°‘ä½¿ç”¨ç½®æ¢ç®—æ³•ï¼ˆLFUï¼‰</li>\n<li><strong>æœ€è¿‘æœ€å°‘ä½¿ç”¨ç½®æ¢ç®—æ³•ï¼ˆLRUï¼‰</strong></li>\n</ul>\n<p>é™„ï¼šé«˜é€Ÿç¼“å†²å™¨æ›¿æ¢ç®—æ³•æœ‰ï¼šéšæœºç®—æ³•ã€FIFOã€LFUã€<strong>LRU</strong></p>\n</div></div><p>æœ¬æ–‡é¢˜ç›®éš¾åº¦æ ‡è¯†ï¼šğŸŸ©ç®€å•ï¼ŒğŸŸ¨ä¸­ç­‰ï¼ŒğŸŸ¥å›°éš¾ã€‚</p>\n<h1 id=\"æ‰‹å†™-lru-ç¼“å­˜\"><a class=\"markdownIt-Anchor\" href=\"#æ‰‹å†™-lru-ç¼“å­˜\"></a> æ‰‹å†™ LRU ç¼“å­˜</h1>\n\n<div class=\"callout\" data-callout=\"example\">\n<div class=\"callout-title\">\n<div class=\"callout-title-icon\">\n<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"lucide lucide-list\"><line x1=\"8\" x2=\"21\" y1=\"6\" y2=\"6\"/><line x1=\"8\" x2=\"21\" y1=\"12\" y2=\"12\"/><line x1=\"8\" x2=\"21\" y1=\"18\" y2=\"18\"/><line x1=\"3\" x2=\"3.01\" y1=\"6\" y2=\"6\"/><line x1=\"3\" x2=\"3.01\" y1=\"12\" y2=\"12\"/><line x1=\"3\" x2=\"3.01\" y1=\"18\" y2=\"18\"/></svg>\n</div>\n<div class=\"callout-title-inner\">é¢˜ç›®ï¼šğŸŸ¨ <a href=\"https://leetcode.cn/problems/lru-cache/description/?envType=study-plan-v2&amp;envId=top-interview-150\">146. LRU ç¼“å­˜ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></div>\n</div>\n<div class=\"callout-content\"><p>è¯·ä½ è®¾è®¡å¹¶å®ç°ä¸€ä¸ªæ»¡è¶³ LRUï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰ç¼“å­˜ çº¦æŸçš„æ•°æ®ç»“æ„ã€‚<br />\nå®ç° <code>LRUCache</code> ç±»ï¼š</p>\n<ul>\n<li><code>LRUCache(int capacity)</code> ä»¥ æ­£æ•´æ•° ä½œä¸ºå®¹é‡ <code>capacity</code> åˆå§‹åŒ– LRU ç¼“å­˜</li>\n<li><code>int get(int key)</code> å¦‚æœå…³é”®å­— <code>key</code> å­˜åœ¨äºç¼“å­˜ä¸­ï¼Œåˆ™è¿”å›å…³é”®å­—çš„å€¼ï¼Œå¦åˆ™è¿”å› -1 ã€‚</li>\n<li><code>void put(int key, int value)</code>\n<ul>\n<li>å¦‚æœå…³é”®å­— <code>key</code> å·²ç»å­˜åœ¨ï¼Œåˆ™å˜æ›´å…¶æ•°æ®å€¼ <code>value</code></li>\n<li>å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™å‘ç¼“å­˜ä¸­æ’å…¥è¯¥ç»„ key-value ã€‚å¦‚æœæ’å…¥æ“ä½œå¯¼è‡´å…³é”®å­—æ•°é‡è¶…è¿‡ <code>capacity</code> ï¼Œåˆ™åº”è¯¥ é€å‡º æœ€ä¹…æœªä½¿ç”¨çš„å…³é”®å­—ã€‚</li>\n</ul>\n</li>\n</ul>\n<p>å‡½æ•° <code>get</code> å’Œ <code>put</code> å¿…é¡»ä»¥ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span> çš„å¹³å‡æ—¶é—´å¤æ‚åº¦è¿è¡Œã€‚</p>\n</div></div><p>Java å®ç°è¦ç‚¹ï¼š</p>\n<ul>\n<li><code>HashMap</code> + åŒå‘é“¾è¡¨ã€‚<code>HashMap</code> ç”¨äºå¿«é€Ÿå®šä½åŒå‘é“¾è¡¨ä¸­çš„ç»“ç‚¹ï¼›åŒå‘é“¾è¡¨ç”¨äºåŒºåˆ†ç¼“å­˜ <code>key</code> çš„è®¿é—®é¡ºåºã€‚</li>\n<li>åŒå‘é“¾è¡¨å¿…é¡»è‡ªå·±æ‰‹åŠ¨å»ºç«‹å¹¶ç»´æŠ¤å„ç§ç»“ç‚¹æ“ä½œ</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">LRUCache</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">class</span> <span class=\"title class_\">DLinkedNode</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> key;</span><br><span class=\"line\">        <span class=\"type\">int</span> value;</span><br><span class=\"line\">        DLinkedNode prev;</span><br><span class=\"line\">        DLinkedNode next;</span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"title function_\">DLinkedNode</span><span class=\"params\">()</span> &#123;&#125;</span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"title function_\">DLinkedNode</span><span class=\"params\">(<span class=\"type\">int</span> _key, <span class=\"type\">int</span> _value)</span> &#123;key = _key; value = _value;&#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Map&lt;Integer, DLinkedNode&gt; cache = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;Integer, DLinkedNode&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> size;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> capacity;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> DLinkedNode head, tail;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">LRUCache</span><span class=\"params\">(<span class=\"type\">int</span> capacity)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.size = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.capacity = capacity;</span><br><span class=\"line\">        <span class=\"comment\">// ä½¿ç”¨ä¼ªå¤´éƒ¨å’Œä¼ªå°¾éƒ¨èŠ‚ç‚¹</span></span><br><span class=\"line\">        head = <span class=\"keyword\">new</span> <span class=\"title class_\">DLinkedNode</span>();</span><br><span class=\"line\">        tail = <span class=\"keyword\">new</span> <span class=\"title class_\">DLinkedNode</span>();</span><br><span class=\"line\">        head.next = tail;</span><br><span class=\"line\">        tail.prev = head;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">get</span><span class=\"params\">(<span class=\"type\">int</span> key)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">DLinkedNode</span> <span class=\"variable\">node</span> <span class=\"operator\">=</span> cache.get(key);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (node == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> -<span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// å¦‚æœ key å­˜åœ¨ï¼Œå…ˆé€šè¿‡å“ˆå¸Œè¡¨å®šä½ï¼Œå†ç§»åˆ°å¤´éƒ¨</span></span><br><span class=\"line\">        moveToHead(node);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> node.value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">put</span><span class=\"params\">(<span class=\"type\">int</span> key, <span class=\"type\">int</span> value)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">DLinkedNode</span> <span class=\"variable\">node</span> <span class=\"operator\">=</span> cache.get(key);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (node == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// å¦‚æœ key ä¸å­˜åœ¨ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹</span></span><br><span class=\"line\">            <span class=\"type\">DLinkedNode</span> <span class=\"variable\">newNode</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">DLinkedNode</span>(key, value);</span><br><span class=\"line\">            <span class=\"comment\">// æ·»åŠ è¿›å“ˆå¸Œè¡¨</span></span><br><span class=\"line\">            cache.put(key, newNode);</span><br><span class=\"line\">            <span class=\"comment\">// æ·»åŠ è‡³åŒå‘é“¾è¡¨çš„å¤´éƒ¨</span></span><br><span class=\"line\">            addToHead(newNode);</span><br><span class=\"line\">            ++size;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (size &gt; capacity) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// å¦‚æœè¶…å‡ºå®¹é‡ï¼Œåˆ é™¤åŒå‘é“¾è¡¨çš„å°¾éƒ¨èŠ‚ç‚¹</span></span><br><span class=\"line\">                <span class=\"type\">DLinkedNode</span> <span class=\"variable\">tail</span> <span class=\"operator\">=</span> removeTail();</span><br><span class=\"line\">                <span class=\"comment\">// åˆ é™¤å“ˆå¸Œè¡¨ä¸­å¯¹åº”çš„é¡¹</span></span><br><span class=\"line\">                cache.remove(tail.key);</span><br><span class=\"line\">                --size;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// å¦‚æœ key å­˜åœ¨ï¼Œå…ˆé€šè¿‡å“ˆå¸Œè¡¨å®šä½ï¼Œå†ä¿®æ”¹ valueï¼Œå¹¶ç§»åˆ°å¤´éƒ¨</span></span><br><span class=\"line\">            node.value = value;</span><br><span class=\"line\">            moveToHead(node);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">addToHead</span><span class=\"params\">(DLinkedNode node)</span> &#123;</span><br><span class=\"line\">        node.prev = head;</span><br><span class=\"line\">        node.next = head.next;</span><br><span class=\"line\">        head.next.prev = node;</span><br><span class=\"line\">        head.next = node;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">removeNode</span><span class=\"params\">(DLinkedNode node)</span> &#123;</span><br><span class=\"line\">        node.prev.next = node.next;</span><br><span class=\"line\">        node.next.prev = node.prev;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">moveToHead</span><span class=\"params\">(DLinkedNode node)</span> &#123;</span><br><span class=\"line\">        removeNode(node);</span><br><span class=\"line\">        addToHead(node);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> DLinkedNode <span class=\"title function_\">removeTail</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">DLinkedNode</span> <span class=\"variable\">res</span> <span class=\"operator\">=</span> tail.prev;</span><br><span class=\"line\">        removeNode(res);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"java-ä¸­çš„-linkedhashmap\"><a class=\"markdownIt-Anchor\" href=\"#java-ä¸­çš„-linkedhashmap\"></a> Java ä¸­çš„ <code>LinkedHashMap</code></h1>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/202408310204657.webp\" alt=\"image.png\" width=\"350px\" /></p>\n<p><code>LinkedHashMap</code> æ˜¯ Java æä¾›çš„ä¸€ä¸ªé›†åˆç±»ï¼Œå®ƒç»§æ‰¿äº† <code>HashMap</code> çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼Œå¹¶ä¸”åœ¨ HashMap çš„åŸºç¡€é‡å†™äº† <code>afterNodeRemoval</code>ã€<code>afterNodeInsertion</code>ã€<code>afterNodeAccess</code> æ–¹æ³•ã€‚ä½¿ä¹‹æ‹¥æœ‰é¡ºåºæ’å…¥å’Œè®¿é—®æœ‰åºçš„ç‰¹æ€§ã€‚</p>\n<p><code>LinkedHashMap</code> ç‰¹æ€§ï¼š</p>\n<ul>\n<li>æ”¯æŒéå†æ—¶ä¼šæŒ‰ç…§æ’å…¥é¡ºåºæœ‰åºè¿›è¡Œè¿­ä»£ã€‚<strong>ï¼ˆä¸ <code>HashMap</code> çš„æœ€å¤§åŒºåˆ«ï¼‰</strong></li>\n<li>æ”¯æŒæŒ‰ç…§å…ƒç´ è®¿é—®é¡ºåºæ’åºï¼Œé€‚ç”¨äºå°è£… LRU ç¼“å­˜å·¥å…·ã€‚</li>\n<li>å› ä¸ºå†…éƒ¨ä½¿ç”¨åŒå‘é“¾è¡¨ç»´æŠ¤å„ä¸ªèŠ‚ç‚¹ï¼Œæ‰€ä»¥éå†æ—¶çš„æ•ˆç‡å’Œå…ƒç´ ä¸ªæ•°æˆæ­£æ¯”ï¼Œç›¸è¾ƒäºå’Œå®¹é‡æˆæ­£æ¯”çš„ <code>HashMap</code> æ¥è¯´ï¼Œè¿­ä»£æ•ˆç‡ä¼šé«˜å¾ˆå¤šã€‚<strong>ç”±äºåŒå‘é“¾è¡¨çš„å­˜åœ¨ï¼Œå…¶æ’å…¥æ€§èƒ½å¯èƒ½ä¼šæ¯”Â <code>HashMap</code>Â ç•¥ä½ã€‚</strong></li>\n</ul>\n<p><code>LinkedHashMap</code> é€»è¾‘ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå®ƒæ˜¯åœ¨ <code>HashMap</code> åŸºç¡€ä¸Šåœ¨å„ä¸ªèŠ‚ç‚¹ä¹‹é—´ç»´æŠ¤ä¸€æ¡åŒå‘é“¾è¡¨ï¼Œä½¿å¾—åŸæœ¬æ•£åˆ—åœ¨ä¸åŒ bucket ä¸Šçš„èŠ‚ç‚¹ã€é“¾è¡¨ã€çº¢é»‘æ ‘æœ‰åºå…³è”èµ·æ¥ã€‚</p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/202408310151331.webp\" alt=\"image.png\" width=\"375px\" /></p>\n<p><code>LinkedHashMap</code> æä¾›äº†å¤šä¸ªæ„é€ æ–¹æ³•ï¼ŒåŒ…æ‹¬é»˜è®¤æ„é€ æ–¹æ³•å’Œå¸¦æœ‰è®¿é—®é¡ºåºé€‰é¡¹çš„æ„é€ æ–¹æ³•ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"title function_\">LinkedHashMap</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">super</span>();</span><br><span class=\"line\">    accessOrder = <span class=\"literal\">false</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"title function_\">LinkedHashMap</span><span class=\"params\">(<span class=\"type\">int</span> initialCapacity)</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">super</span>(initialCapacity);</span><br><span class=\"line\">    accessOrder = <span class=\"literal\">false</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"title function_\">LinkedHashMap</span><span class=\"params\">(<span class=\"type\">int</span> initialCapacity, <span class=\"type\">float</span> loadFactor)</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">super</span>(initialCapacity, loadFactor);</span><br><span class=\"line\">    accessOrder = <span class=\"literal\">false</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"title function_\">LinkedHashMap</span><span class=\"params\">(</span></span><br><span class=\"line\"><span class=\"params\">\t<span class=\"type\">int</span> initialCapacity, // å®¹é‡å¤§å°</span></span><br><span class=\"line\"><span class=\"params\">    <span class=\"type\">float</span> loadFactor,    // è´Ÿè½½å› å­</span></span><br><span class=\"line\"><span class=\"params\">    <span class=\"type\">boolean</span> accessOrder  </span></span><br><span class=\"line\"><span class=\"params\">)</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">super</span>(initialCapacity, loadFactor); <span class=\"comment\">// è°ƒç”¨ç›´æ¥çˆ¶ç±» HashMap çš„æ„é€ æ–¹æ³•</span></span><br><span class=\"line\">    <span class=\"built_in\">this</span>.accessOrder = accessOrder;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>é€šè¿‡æŒ‡å®š <code>accessOrder</code> å‚æ•°ä¸º <code>true</code>ï¼Œå¯ä»¥è®© <code>LinkedHashMap</code> ä»¥è®¿é—®é¡ºåºæ’åºï¼ˆå³å°†æœ€è¿‘æœªè®¿é—®çš„å…ƒç´ æ’åœ¨é“¾è¡¨é¦–éƒ¨ã€æœ€è¿‘è®¿é—®çš„å…ƒç´ ç§»åŠ¨åˆ°é“¾è¡¨å°¾éƒ¨ï¼‰ï¼Œè€Œä¸æ˜¯æ’å…¥é¡ºåºã€‚åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ç¨å¾®å¯¹å…¶æ”¹é€ ï¼Œå°±èƒ½å¾—åˆ°ä¸€ä¸ª LRU ç¼“å­˜ã€‚</p>\n\n<div class=\"callout\" data-callout=\"hint\">\n<div class=\"callout-title\">\n<div class=\"callout-title-icon\">\n<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"lucide lucide-flame\"><path d=\"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z\"/></svg>\n</div>\n<div class=\"callout-title-inner\">é¢è¯•æç¤º</div>\n</div>\n<div class=\"callout-content\"><p>å¦‚æœé¢è¯•æ—¶è€ƒå¯Ÿå®ç° LRU çš„é¢˜ç›®ï¼Œç›´æ¥ä½¿ç”¨è¯­è¨€å†…ç½®ç‰¹æ€§çš„åšæ³•é€šå¸¸ä¸ä¼šç¬¦åˆé¢è¯•å®˜çš„è¦æ±‚ã€‚ä½†æˆ‘ä»¬è¿˜æ˜¯éœ€è¦äº†è§£å¦‚ä½•ä½¿ç”¨ <code>LinkedHashMap</code> å®ç° LRUã€‚</p>\n</div></div><p>å…·ä½“å®ç°æ€è·¯å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>ç»§æ‰¿ <code>LinkedHashMap</code>ï¼›</li>\n<li>æ„é€ æ–¹æ³•ä¸­æŒ‡å®š <code>accessOrder</code> ä¸º <code>true</code> ï¼Œè¿™æ ·åœ¨è®¿é—®å…ƒç´ æ—¶å°±ä¼šæŠŠè¯¥å…ƒç´ ç§»åŠ¨åˆ°é“¾è¡¨å°¾éƒ¨ï¼Œé“¾è¡¨é¦–å…ƒç´ å°±æ˜¯æœ€è¿‘æœ€å°‘è¢«è®¿é—®çš„å…ƒç´ ï¼›</li>\n<li>é‡å†™ <code>removeEldestEntry</code> æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ª <code>boolean</code> å€¼ï¼Œå‘ŠçŸ¥ <code>LinkedHashMap</code> æ˜¯å¦éœ€è¦ç§»é™¤é“¾è¡¨é¦–å…ƒç´ ï¼ˆç¼“å­˜å®¹é‡æœ‰é™ï¼‰ã€‚</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">LRUCache</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">LinkedHashMap</span>&lt;Integer, Integer&gt;&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> capacity;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">LRUCache</span><span class=\"params\">(<span class=\"type\">int</span> capacity)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">super</span>(capacity, <span class=\"number\">0.75F</span>, <span class=\"literal\">true</span>); <span class=\"comment\">// TIPSï¼šHashMap loadFactor çš„é»˜è®¤å€¼ä¸º 0.75f </span></span><br><span class=\"line\">        <span class=\"built_in\">this</span>.capacity = capacity;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">get</span><span class=\"params\">(<span class=\"type\">int</span> key)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">super</span>.getOrDefault(key, -<span class=\"number\">1</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">put</span><span class=\"params\">(<span class=\"type\">int</span> key, <span class=\"type\">int</span> value)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">super</span>.put(key, value);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">protected</span> <span class=\"type\">boolean</span> <span class=\"title function_\">removeEldestEntry</span><span class=\"params\">(Map.Entry&lt;Integer, Integer&gt; eldest)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> size() &gt; capacity; </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"æœ¬æ–‡å‚è€ƒ\"><a class=\"markdownIt-Anchor\" href=\"#æœ¬æ–‡å‚è€ƒ\"></a> æœ¬æ–‡å‚è€ƒ</h1>\n<ul>\n<li><a href=\"https://baike.baidu.com/item/LRU\">LRU_ç™¾åº¦ç™¾ç§‘ (baidu.com)</a></li>\n<li><a href=\"https://leetcode.cn/problems/lru-cache/solutions/259678/lruhuan-cun-ji-zhi-by-leetcode-solution/?envType=study-plan-v2&amp;envId=top-interview-150\">146. LRU ç¼“å­˜ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></li>\n<li><a href=\"https://javaguide.cn/java/collection/linkedhashmap-source-code.html#linkedhashmap-%E7%AE%80%E4%BB%8B\">LinkedHashMap æºç åˆ†æ | JavaGuide</a></li>\n<li><a href=\"https://www.mianshiya.com/bank/1788408712975282177/question/1780933294783754241\">ä»€ä¹ˆæ˜¯ Java çš„ LinkedHashMapï¼Ÿ - Java é›†åˆé¢è¯•é¢˜ - é¢è¯•é¸­ - ç¨‹åºå‘˜æ±‚èŒé¢è¯•åˆ·é¢˜ç¥å™¨ (mianshiya.com)</a></li>\n<li>ç‹é“ 2023ã€Š408 æ•°æ®ç»“æ„ã€‹</li>\n</ul>\n","raw":"---\ntitle: æ‰‹å†™ LRU ç¼“å­˜ä»¥ç†è§£ Java ä¸­çš„ LinkedHashMap\ntags:\n  - LRU\n  - Java\n  - LeetCode\n  - æ“ä½œç³»ç»Ÿ\ncover: 'https://cdn.gallery.uuanqin.top/img/202409050003261.webp'\ndescription: ä¸€ä¸ªå›´ç»• LRU çš„ä¸“é¢˜ç»¼åˆã€‚\ncategories:\n  - ç®—æ³•ä¸æ•°æ®ç»“æ„\nabbrlink: 270917b1\ndate: 2024-09-03 23:25:18\ntop_img:\n---\n\næœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼ˆLeast Recently Usedï¼ŒLRUï¼‰ï¼Œæ˜¯ä¸€ç§å¸¸ç”¨çš„é¡µé¢ç½®æ¢ç®—æ³•ï¼Œé€‰æ‹©æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„é¡µé¢äºˆä»¥æ·˜æ±°ã€‚è¯¥ç®—æ³•èµ‹äºˆæ¯ä¸ªé¡µé¢ä¸€ä¸ªè®¿é—®å­—æ®µï¼Œç”¨æ¥è®°å½•ä¸€ä¸ªé¡µé¢è‡ªä¸Šæ¬¡è¢«è®¿é—®ä»¥æ¥æ‰€ç»å†çš„æ—¶é—´ tï¼Œå½“é¡»æ·˜æ±°ä¸€ä¸ªé¡µé¢æ—¶ï¼Œé€‰æ‹©ç°æœ‰é¡µé¢ä¸­å…¶ t å€¼æœ€å¤§çš„ï¼Œå³æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„é¡µé¢äºˆä»¥æ·˜æ±°ã€‚\n\nJava ä¸­å¯ä»¥ä½¿ç”¨ `LinkedHashMap` è½»æ¾å®ç°ä¸€ä¸ª LRU ç¼“å­˜ã€‚\n\n> [!note] é¡µé¢ç½®æ¢ç®—æ³•\n> åœ¨è¿›ç¨‹è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œè‹¥å…¶æ‰€è¦è®¿é—®çš„é¡µé¢ä¸åœ¨å†…å­˜è€Œéœ€æŠŠå®ƒä»¬è°ƒå…¥å†…å­˜ï¼Œä½†å†…å­˜å·²æ— ç©ºé—²ç©ºé—´æ—¶ï¼Œä¸ºäº†ä¿è¯è¯¥è¿›ç¨‹èƒ½æ­£å¸¸è¿è¡Œï¼Œç³»ç»Ÿå¿…é¡»ä»å†…å­˜ä¸­è°ƒå‡ºä¸€é¡µç¨‹åºæˆ–æ•°æ®é€ç£ç›˜çš„å¯¹æ¢åŒºä¸­ã€‚ä½†åº”å°†å“ªä¸ªé¡µé¢è°ƒå‡ºï¼Œé¡»æ ¹æ®ä¸€å®šçš„ç®—æ³•æ¥ç¡®å®šã€‚é€šå¸¸ï¼ŒæŠŠé€‰æ‹©æ¢å‡ºé¡µé¢çš„ç®—æ³•ç§°ä¸ºé¡µé¢ç½®æ¢ç®—æ³•ï¼ˆPage-Replacement Algorithmsï¼‰ã€‚\n> - æœ€ä½³ç½®æ¢ç®—æ³•ï¼ˆOPTï¼‰\n> - å…ˆè¿›å…ˆå‡ºç½®æ¢ç®—æ³•ï¼ˆFIFOï¼‰\n> - æœ€å°‘ä½¿ç”¨ç½®æ¢ç®—æ³•ï¼ˆLFUï¼‰\n> - **æœ€è¿‘æœ€å°‘ä½¿ç”¨ç½®æ¢ç®—æ³•ï¼ˆLRUï¼‰**\n>\n> é™„ï¼šé«˜é€Ÿç¼“å†²å™¨æ›¿æ¢ç®—æ³•æœ‰ï¼šéšæœºç®—æ³•ã€FIFOã€LFUã€**LRU**\n\næœ¬æ–‡é¢˜ç›®éš¾åº¦æ ‡è¯†ï¼šğŸŸ©ç®€å•ï¼ŒğŸŸ¨ä¸­ç­‰ï¼ŒğŸŸ¥å›°éš¾ã€‚\n\n# æ‰‹å†™ LRU ç¼“å­˜\n\n> [!example] é¢˜ç›®ï¼šğŸŸ¨ [146. LRU ç¼“å­˜ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/problems/lru-cache/description/?envType=study-plan-v2&envId=top-interview-150)\n> è¯·ä½ è®¾è®¡å¹¶å®ç°ä¸€ä¸ªæ»¡è¶³ LRUï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰ç¼“å­˜ çº¦æŸçš„æ•°æ®ç»“æ„ã€‚\n> å®ç° `LRUCache` ç±»ï¼š\n> - `LRUCache(int capacity)` ä»¥ æ­£æ•´æ•° ä½œä¸ºå®¹é‡ `capacity` åˆå§‹åŒ– LRU ç¼“å­˜\n> - `int get(int key)` å¦‚æœå…³é”®å­— `key` å­˜åœ¨äºç¼“å­˜ä¸­ï¼Œåˆ™è¿”å›å…³é”®å­—çš„å€¼ï¼Œå¦åˆ™è¿”å› -1 ã€‚\n> - `void put(int key, int value)`\n> \t- å¦‚æœå…³é”®å­— `key` å·²ç»å­˜åœ¨ï¼Œåˆ™å˜æ›´å…¶æ•°æ®å€¼ `value`\n> \t- å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™å‘ç¼“å­˜ä¸­æ’å…¥è¯¥ç»„ key-value ã€‚å¦‚æœæ’å…¥æ“ä½œå¯¼è‡´å…³é”®å­—æ•°é‡è¶…è¿‡ `capacity` ï¼Œåˆ™åº”è¯¥ é€å‡º æœ€ä¹…æœªä½¿ç”¨çš„å…³é”®å­—ã€‚\n>\n> å‡½æ•° `get` å’Œ `put` å¿…é¡»ä»¥ $O(1)$ çš„å¹³å‡æ—¶é—´å¤æ‚åº¦è¿è¡Œã€‚\n\nJava å®ç°è¦ç‚¹ï¼š\n\n- `HashMap` + åŒå‘é“¾è¡¨ã€‚`HashMap` ç”¨äºå¿«é€Ÿå®šä½åŒå‘é“¾è¡¨ä¸­çš„ç»“ç‚¹ï¼›åŒå‘é“¾è¡¨ç”¨äºåŒºåˆ†ç¼“å­˜ `key` çš„è®¿é—®é¡ºåºã€‚\n- åŒå‘é“¾è¡¨å¿…é¡»è‡ªå·±æ‰‹åŠ¨å»ºç«‹å¹¶ç»´æŠ¤å„ç§ç»“ç‚¹æ“ä½œ\n\n```java\npublic class LRUCache {\n    class DLinkedNode {\n        int key;\n        int value;\n        DLinkedNode prev;\n        DLinkedNode next;\n        public DLinkedNode() {}\n        public DLinkedNode(int _key, int _value) {key = _key; value = _value;}\n    }\n\n    private Map<Integer, DLinkedNode> cache = new HashMap<Integer, DLinkedNode>();\n    private int size;\n    private int capacity;\n    private DLinkedNode head, tail;\n\n    public LRUCache(int capacity) {\n        this.size = 0;\n        this.capacity = capacity;\n        // ä½¿ç”¨ä¼ªå¤´éƒ¨å’Œä¼ªå°¾éƒ¨èŠ‚ç‚¹\n        head = new DLinkedNode();\n        tail = new DLinkedNode();\n        head.next = tail;\n        tail.prev = head;\n    }\n\n    public int get(int key) {\n        DLinkedNode node = cache.get(key);\n        if (node == null) {\n            return -1;\n        }\n        // å¦‚æœ key å­˜åœ¨ï¼Œå…ˆé€šè¿‡å“ˆå¸Œè¡¨å®šä½ï¼Œå†ç§»åˆ°å¤´éƒ¨\n        moveToHead(node);\n        return node.value;\n    }\n\n    public void put(int key, int value) {\n        DLinkedNode node = cache.get(key);\n        if (node == null) {\n            // å¦‚æœ key ä¸å­˜åœ¨ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹\n            DLinkedNode newNode = new DLinkedNode(key, value);\n            // æ·»åŠ è¿›å“ˆå¸Œè¡¨\n            cache.put(key, newNode);\n            // æ·»åŠ è‡³åŒå‘é“¾è¡¨çš„å¤´éƒ¨\n            addToHead(newNode);\n            ++size;\n            if (size > capacity) {\n                // å¦‚æœè¶…å‡ºå®¹é‡ï¼Œåˆ é™¤åŒå‘é“¾è¡¨çš„å°¾éƒ¨èŠ‚ç‚¹\n                DLinkedNode tail = removeTail();\n                // åˆ é™¤å“ˆå¸Œè¡¨ä¸­å¯¹åº”çš„é¡¹\n                cache.remove(tail.key);\n                --size;\n            }\n        }\n        else {\n            // å¦‚æœ key å­˜åœ¨ï¼Œå…ˆé€šè¿‡å“ˆå¸Œè¡¨å®šä½ï¼Œå†ä¿®æ”¹ valueï¼Œå¹¶ç§»åˆ°å¤´éƒ¨\n            node.value = value;\n            moveToHead(node);\n        }\n    }\n\n    private void addToHead(DLinkedNode node) {\n        node.prev = head;\n        node.next = head.next;\n        head.next.prev = node;\n        head.next = node;\n    }\n\n    private void removeNode(DLinkedNode node) {\n        node.prev.next = node.next;\n        node.next.prev = node.prev;\n    }\n\n    private void moveToHead(DLinkedNode node) {\n        removeNode(node);\n        addToHead(node);\n    }\n\n    private DLinkedNode removeTail() {\n        DLinkedNode res = tail.prev;\n        removeNode(res);\n        return res;\n    }\n}\n```\n\n# Java ä¸­çš„ `LinkedHashMap`\n\n![image.png|350](https://cdn.gallery.uuanqin.top/img/202408310204657.webp)\n\n`LinkedHashMap` æ˜¯ Java æä¾›çš„ä¸€ä¸ªé›†åˆç±»ï¼Œå®ƒç»§æ‰¿äº† `HashMap` çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼Œå¹¶ä¸”åœ¨ HashMap çš„åŸºç¡€é‡å†™äº† `afterNodeRemoval`ã€`afterNodeInsertion`ã€`afterNodeAccess` æ–¹æ³•ã€‚ä½¿ä¹‹æ‹¥æœ‰é¡ºåºæ’å…¥å’Œè®¿é—®æœ‰åºçš„ç‰¹æ€§ã€‚\n\n`LinkedHashMap` ç‰¹æ€§ï¼š\n\n- æ”¯æŒéå†æ—¶ä¼šæŒ‰ç…§æ’å…¥é¡ºåºæœ‰åºè¿›è¡Œè¿­ä»£ã€‚**ï¼ˆä¸ `HashMap` çš„æœ€å¤§åŒºåˆ«ï¼‰**\n- æ”¯æŒæŒ‰ç…§å…ƒç´ è®¿é—®é¡ºåºæ’åºï¼Œé€‚ç”¨äºå°è£… LRU ç¼“å­˜å·¥å…·ã€‚\n- å› ä¸ºå†…éƒ¨ä½¿ç”¨åŒå‘é“¾è¡¨ç»´æŠ¤å„ä¸ªèŠ‚ç‚¹ï¼Œæ‰€ä»¥éå†æ—¶çš„æ•ˆç‡å’Œå…ƒç´ ä¸ªæ•°æˆæ­£æ¯”ï¼Œç›¸è¾ƒäºå’Œå®¹é‡æˆæ­£æ¯”çš„ `HashMap` æ¥è¯´ï¼Œè¿­ä»£æ•ˆç‡ä¼šé«˜å¾ˆå¤šã€‚**ç”±äºåŒå‘é“¾è¡¨çš„å­˜åœ¨ï¼Œå…¶æ’å…¥æ€§èƒ½å¯èƒ½ä¼šæ¯”Â `HashMap`Â ç•¥ä½ã€‚**\n\n`LinkedHashMap` é€»è¾‘ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå®ƒæ˜¯åœ¨ `HashMap` åŸºç¡€ä¸Šåœ¨å„ä¸ªèŠ‚ç‚¹ä¹‹é—´ç»´æŠ¤ä¸€æ¡åŒå‘é“¾è¡¨ï¼Œä½¿å¾—åŸæœ¬æ•£åˆ—åœ¨ä¸åŒ bucket ä¸Šçš„èŠ‚ç‚¹ã€é“¾è¡¨ã€çº¢é»‘æ ‘æœ‰åºå…³è”èµ·æ¥ã€‚\n\n![image.png|375](https://cdn.gallery.uuanqin.top/img/202408310151331.webp)\n\n`LinkedHashMap` æä¾›äº†å¤šä¸ªæ„é€ æ–¹æ³•ï¼ŒåŒ…æ‹¬é»˜è®¤æ„é€ æ–¹æ³•å’Œå¸¦æœ‰è®¿é—®é¡ºåºé€‰é¡¹çš„æ„é€ æ–¹æ³•ã€‚\n\n```java\npublic LinkedHashMap() {\n    super();\n    accessOrder = false;\n}\n\npublic LinkedHashMap(int initialCapacity) {\n    super(initialCapacity);\n    accessOrder = false;\n}\n\npublic LinkedHashMap(int initialCapacity, float loadFactor) {\n    super(initialCapacity, loadFactor);\n    accessOrder = false;\n}\n\npublic LinkedHashMap(\n\tint initialCapacity, // å®¹é‡å¤§å°\n    float loadFactor,    // è´Ÿè½½å› å­\n    boolean accessOrder  \n) {\n    super(initialCapacity, loadFactor); // è°ƒç”¨ç›´æ¥çˆ¶ç±» HashMap çš„æ„é€ æ–¹æ³•\n    this.accessOrder = accessOrder;\n}\n```\n\né€šè¿‡æŒ‡å®š `accessOrder` å‚æ•°ä¸º `true`ï¼Œå¯ä»¥è®© `LinkedHashMap` ä»¥è®¿é—®é¡ºåºæ’åºï¼ˆå³å°†æœ€è¿‘æœªè®¿é—®çš„å…ƒç´ æ’åœ¨é“¾è¡¨é¦–éƒ¨ã€æœ€è¿‘è®¿é—®çš„å…ƒç´ ç§»åŠ¨åˆ°é“¾è¡¨å°¾éƒ¨ï¼‰ï¼Œè€Œä¸æ˜¯æ’å…¥é¡ºåºã€‚åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ç¨å¾®å¯¹å…¶æ”¹é€ ï¼Œå°±èƒ½å¾—åˆ°ä¸€ä¸ª LRU ç¼“å­˜ã€‚\n\n> [!hint] é¢è¯•æç¤º\n> å¦‚æœé¢è¯•æ—¶è€ƒå¯Ÿå®ç° LRU çš„é¢˜ç›®ï¼Œç›´æ¥ä½¿ç”¨è¯­è¨€å†…ç½®ç‰¹æ€§çš„åšæ³•é€šå¸¸ä¸ä¼šç¬¦åˆé¢è¯•å®˜çš„è¦æ±‚ã€‚ä½†æˆ‘ä»¬è¿˜æ˜¯éœ€è¦äº†è§£å¦‚ä½•ä½¿ç”¨ `LinkedHashMap` å®ç° LRUã€‚\n\nå…·ä½“å®ç°æ€è·¯å¦‚ä¸‹ï¼š\n\n- ç»§æ‰¿ `LinkedHashMap`ï¼›\n- æ„é€ æ–¹æ³•ä¸­æŒ‡å®š `accessOrder` ä¸º `true` ï¼Œè¿™æ ·åœ¨è®¿é—®å…ƒç´ æ—¶å°±ä¼šæŠŠè¯¥å…ƒç´ ç§»åŠ¨åˆ°é“¾è¡¨å°¾éƒ¨ï¼Œé“¾è¡¨é¦–å…ƒç´ å°±æ˜¯æœ€è¿‘æœ€å°‘è¢«è®¿é—®çš„å…ƒç´ ï¼›\n- é‡å†™ `removeEldestEntry` æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ª `boolean` å€¼ï¼Œå‘ŠçŸ¥ `LinkedHashMap` æ˜¯å¦éœ€è¦ç§»é™¤é“¾è¡¨é¦–å…ƒç´ ï¼ˆç¼“å­˜å®¹é‡æœ‰é™ï¼‰ã€‚\n\n\n```java\nclass LRUCache extends LinkedHashMap<Integer, Integer>{\n    private int capacity;\n    \n    public LRUCache(int capacity) {\n        super(capacity, 0.75F, true); // TIPSï¼šHashMap loadFactor çš„é»˜è®¤å€¼ä¸º 0.75f \n        this.capacity = capacity;\n    }\n\n    public int get(int key) {\n        return super.getOrDefault(key, -1);\n    }\n\n    public void put(int key, int value) {\n        super.put(key, value);\n    }\n\n    @Override\n    protected boolean removeEldestEntry(Map.Entry<Integer, Integer> eldest) {\n        return size() > capacity; \n    }\n}\n```\n\n\n\n# æœ¬æ–‡å‚è€ƒ\n- [LRU_ç™¾åº¦ç™¾ç§‘ (baidu.com)](https://baike.baidu.com/item/LRU)\n- [146. LRU ç¼“å­˜ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/problems/lru-cache/solutions/259678/lruhuan-cun-ji-zhi-by-leetcode-solution/?envType=study-plan-v2&envId=top-interview-150)\n- [LinkedHashMap æºç åˆ†æ | JavaGuide](https://javaguide.cn/java/collection/linkedhashmap-source-code.html#linkedhashmap-%E7%AE%80%E4%BB%8B)\n- [ä»€ä¹ˆæ˜¯ Java çš„ LinkedHashMapï¼Ÿ - Java é›†åˆé¢è¯•é¢˜ - é¢è¯•é¸­ - ç¨‹åºå‘˜æ±‚èŒé¢è¯•åˆ·é¢˜ç¥å™¨ (mianshiya.com)](https://www.mianshiya.com/bank/1788408712975282177/question/1780933294783754241)\n- ç‹é“ 2023ã€Š408 æ•°æ®ç»“æ„ã€‹\n","categories":[{"name":"ç®—æ³•ä¸æ•°æ®ç»“æ„","api":"api/categories/ç®—æ³•ä¸æ•°æ®ç»“æ„.json"}],"tags":[{"name":"Java","api":"api/tags/Java.json"},{"name":"LeetCode","api":"api/tags/LeetCode.json"},{"name":"LRU","api":"api/tags/LRU.json"},{"name":"æ“ä½œç³»ç»Ÿ","api":"api/tags/æ“ä½œç³»ç»Ÿ.json"}]},"api":"api/posts/p/270917b1.json"}