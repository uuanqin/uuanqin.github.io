{"data":{"title":"阿里云ECS主机可ping通但拒绝连接的解决办法","slug":"解决问题/阿里云ECS主机可ping通但拒绝连接的解决办法","description":"将目标IP加入阿里云白名单中","date":"2023-09-10T03:13:48.000Z","updated":"2024-08-08T09:14:53.913Z","language":"zh-CN","comments":true,"url":"p/434e04cb/","cover":"https://cdn.gallery.uuanqin.top/img/pexels-skylar-kang-6045366.webp","images":[],"content":"<h1 id=\"问题出现\"><a class=\"markdownIt-Anchor\" href=\"#问题出现\"></a> 问题出现</h1>\n<p>开学注册了，最近写了篇博客文章想像往常一样部署服务器，但是出现了连接问题。以前从来没遇到过：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Connection reset by 我的主机IP port 22</span><br><span class=\"line\">fatal: Could not read from remote repository.</span><br><span class=\"line\"></span><br><span class=\"line\">Please make sure you have the correct access rights</span><br><span class=\"line\">and the repository exists.</span><br><span class=\"line\">FATAL &#123;</span><br><span class=\"line\">  err: Error: Spawn failed</span><br><span class=\"line\">      at ChildProcess.&lt;anonymous&gt; (D:\\uuanqin\\Desktop\\uuanqin-blogs\\node_modules\\hexo-util\\lib\\spawn.js:51:21)</span><br><span class=\"line\">      at ChildProcess.emit (node:events:513:28)</span><br><span class=\"line\">      at cp.emit (D:\\uuanqin\\Desktop\\uuanqin-blogs\\node_modules\\cross-spawn\\lib\\enoent.js:34:29)</span><br><span class=\"line\">      at ChildProcess._handle.onexit (node:internal/child_process:291:12) &#123;</span><br><span class=\"line\">    code: 128</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125; Something&#x27;s wrong. Maybe you can find the solution here: %s https://hexo.io/docs/troubleshooting.html</span><br><span class=\"line\"></span><br><span class=\"line\">Process finished with exit code 2</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>想用 XShell 连上服务器看看，结果还是失败：</p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/QQ截图20230910111157.webp\" alt=\"QQ截图20230910111157.png\" /></p>\n<p>终端使用 SSH 连接也不行：</p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/QQ图片20230910111113.webp\" alt=\"QQ图片20230910111113.png\" /></p>\n<h1 id=\"问题排查\"><a class=\"markdownIt-Anchor\" href=\"#问题排查\"></a> 问题排查</h1>\n<p>经过排查发现：</p>\n<ul>\n<li>服务器公网 IP 可以 Ping 通</li>\n<li>安全组设置正确</li>\n<li>阿里云 Workbench 工具可以远程连接</li>\n<li>换学校热点、手机移动热点正常，唯独<strong>校园有线网</strong>连接出现异常</li>\n</ul>\n<p>综上判断，有理由怀疑是阿里云屏蔽了一些 IP。</p>\n<h1 id=\"问题解决\"><a class=\"markdownIt-Anchor\" href=\"#问题解决\"></a> 问题解决</h1>\n<p>打开阿里云控制台，点击右上角头像找到安全管控：</p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/20230910112630.webp\" alt=\"image.png\" /></p>\n<p>在 IP 白名单中添加当前 IP 即可。</p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/20230910112743.webp\" alt=\"image.png\" /></p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/20230910161416.webp\" alt=\"image.png\" width=\"500px\" /></p>\n<h1 id=\"后记\"><a class=\"markdownIt-Anchor\" href=\"#后记\"></a> 后记</h1>\n<p>取消白名单后，过一段时间就又被 ban 咯，所以就让它一直存在吧。</p>\n<h1 id=\"本文参考\"><a class=\"markdownIt-Anchor\" href=\"#本文参考\"></a> 本文参考</h1>\n<ul>\n<li><a href=\"https://blog.csdn.net/peng2hui1314/article/details/119756512\">采坑阿里云 kex<em>exchange_identification: read: Connection reset by peer</em>阿里云 ecs read econnreset_Roc.Chang 的博客-CSDN 博客</a></li>\n<li><a href=\"https://help.aliyun.com/zh/ecs/support/the-ssh-exchange-identification-read-connection-reset-by-peer-error-is-displayed-when-you-log-on-to-an-ecs-instance-through-ssh#823e130097gyd\">提示“ssh<em>exchange_identification:read:Connectionresetbypeer”错误怎么办</em>云服务器 ECS-阿里云帮助中心 (aliyun.com)</a></li>\n</ul>\n","raw":"---\ntitle: 阿里云ECS主机可ping通但拒绝连接的解决办法\ntags:\n  - ECS\n  - SSH\n  - IP\n  - 阿里云\n  - 问题解决\n  - 阿里巴巴\ndescription: 将目标IP加入阿里云白名单中\nabbrlink: 434e04cb\ncategories:\n  - 解决问题\ndate: 2023-09-10 11:13:48\ncover:\ntop_img:\n---\n\n# 问题出现\n\n开学注册了，最近写了篇博客文章想像往常一样部署服务器，但是出现了连接问题。以前从来没遇到过：\n\n```\nConnection reset by 我的主机IP port 22\nfatal: Could not read from remote repository.\n\nPlease make sure you have the correct access rights\nand the repository exists.\nFATAL {\n  err: Error: Spawn failed\n      at ChildProcess.<anonymous> (D:\\uuanqin\\Desktop\\uuanqin-blogs\\node_modules\\hexo-util\\lib\\spawn.js:51:21)\n      at ChildProcess.emit (node:events:513:28)\n      at cp.emit (D:\\uuanqin\\Desktop\\uuanqin-blogs\\node_modules\\cross-spawn\\lib\\enoent.js:34:29)\n      at ChildProcess._handle.onexit (node:internal/child_process:291:12) {\n    code: 128\n  }\n} Something's wrong. Maybe you can find the solution here: %s https://hexo.io/docs/troubleshooting.html\n\nProcess finished with exit code 2\n\n```\n\n想用 XShell 连上服务器看看，结果还是失败：\n\n![QQ截图20230910111157.png](https://cdn.gallery.uuanqin.top/img/QQ%E6%88%AA%E5%9B%BE20230910111157.webp)\n\n终端使用 SSH 连接也不行：\n\n![QQ图片20230910111113.png](https://cdn.gallery.uuanqin.top/img/QQ%E5%9B%BE%E7%89%8720230910111113.webp)\n\n# 问题排查\n\n经过排查发现：\n\n- 服务器公网 IP 可以 Ping 通\n- 安全组设置正确\n- 阿里云 Workbench 工具可以远程连接\n- 换学校热点、手机移动热点正常，唯独**校园有线网**连接出现异常\n\n综上判断，有理由怀疑是阿里云屏蔽了一些 IP。\n\n# 问题解决\n\n打开阿里云控制台，点击右上角头像找到安全管控：\n\n![image.png](https://cdn.gallery.uuanqin.top/img/20230910112630.webp)\n\n在 IP 白名单中添加当前 IP 即可。\n\n![image.png](https://cdn.gallery.uuanqin.top/img/20230910112743.webp)\n\n![image.png|500](https://cdn.gallery.uuanqin.top/img/20230910161416.webp)\n\n# 后记\n\n取消白名单后，过一段时间就又被 ban 咯，所以就让它一直存在吧。\n\n# 本文参考\n\n- [采坑阿里云 kex*exchange_identification: read: Connection reset by peer*阿里云 ecs read econnreset_Roc.Chang 的博客-CSDN 博客](https://blog.csdn.net/peng2hui1314/article/details/119756512)\n- [提示“ssh*exchange_identification:read:Connectionresetbypeer”错误怎么办*云服务器 ECS-阿里云帮助中心 (aliyun.com)](https://help.aliyun.com/zh/ecs/support/the-ssh-exchange-identification-read-connection-reset-by-peer-error-is-displayed-when-you-log-on-to-an-ecs-instance-through-ssh#823e130097gyd)\n","categories":[{"name":"解决问题","api":"api/categories/解决问题.json"}],"tags":[{"name":"阿里巴巴","api":"api/tags/阿里巴巴.json"},{"name":"阿里云","api":"api/tags/阿里云.json"},{"name":"ECS","api":"api/tags/ECS.json"},{"name":"IP","api":"api/tags/IP.json"},{"name":"问题解决","api":"api/tags/问题解决.json"},{"name":"SSH","api":"api/tags/SSH.json"}]},"api":"api/posts/p/434e04cb.json"}