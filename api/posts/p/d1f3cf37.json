{"data":{"title":"CSAPP LAB-2 äºŒè¿›åˆ¶ç‚¸å¼¹å®éªŒ","slug":"CSAPP LABS/CSAPP LAB-2 äºŒè¿›åˆ¶ç‚¸å¼¹å®éªŒ","description":"è¯¥è¡¥çš„åœ°æ–¹è¿˜æ˜¯å¾—è¡¥","date":"2024-05-22T12:00:46.000Z","updated":"2025-10-12T15:39:44.941Z","language":"zh-CN","comments":true,"url":"p/d1f3cf37/","cover":"https://cdn.gallery.uuanqin.top/img/20240522192911.webp","images":[],"content":"<blockquote>\n<p>æ­»å»çš„ç‚¸å¼¹åˆæ¥æ”»å‡»æˆ‘ï¼ï¼ğŸ˜…ğŸ˜…ğŸ˜…</p>\n</blockquote>\n<p>Computer Systems. A Programmerâ€™s Perspectiveï¼ŒCS: APPâ€”â€”ä¸­æ–‡è¯‘åã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹ï¼Œæ˜¯æœ¬ç§‘æ—¶å€™çš„å¿…é€‰è¯¾ï¼Œç ”ç©¶ç”Ÿé˜¶æ®µé€‰ä¿®äº†è¿™é—¨è¯¾ï¼Œç›¸å½“äºé‡æ–°å†å­¦ä¸€éã€‚æœ¬ç§‘å­¦è¿™é—¨è¯¾æ—¶æ­£å€¼ç–«æƒ…ï¼Œåœ¨åŠ é‡Œæ•¦~~ï¼ˆå®¶é‡Œè¹²ï¼‰~~å¤§å­¦ä¸Šäº†ä¸€ä¸ªå­¦æœŸï¼Œå½“æ—¶å¤ªè¿·èŒ«äº†ï¼Œå•¥ä¹Ÿä¸ä¼šï¼Œæ•´ä¸ªè¯¾ä¸Šå¾—æ‡µæ‡µæ‡‚æ‡‚ã€‚ä¼°è®¡é‚£æ—¶çš„ç‚¸å¼¹ä¹Ÿæ˜¯çœ‹ç€ç½‘ä¸Šçš„æ•™ç¨‹ä¸œæŠ„æŠ„è¥¿è¡¥è¡¥å‹‰å¼ºå¼„å‡ºæ¥çš„ã€‚</p>\n<p>ç°åœ¨ç ”ç©¶ç”Ÿäº†ï¼Œè¯¥è¡¥çš„åœ°æ–¹è¿˜æ˜¯å¾—è¡¥ã€‚ä¸ç®¡æœ‰å¤šå¿™ï¼Œæˆ‘å†³å®šæ²‰ä¸‹å¿ƒæ¥é‡çœ‹ã€ŠCSAPPã€‹ï¼Œç‚¸å¼¹å®¢å®éªŒä¹Ÿæ‰“ç®—äº²è‡ªåšåšã€‚æœ€ç»ˆè¿˜æ˜¯åšå‡ºæ¥äº†ğŸ˜ï¼Œè€—æ—¶ 2 å¤©ã€‚éš¾åº¦æ€ä¹ˆè¯´â€”â€”è¿˜ç®—é€‚ä¸­å§ï¼Œå¦‚æœä½ ä»”ç»†çœ‹è¿‡è¯¾æœ¬å°±ä¸éš¾ã€‚</p>\n<p>ç›®å‰åŸºæœ¬çš„ 6 å±‚ç‚¸å¼¹å·²ç»æ‹†é™¤ï¼Œè¿˜æœ‰ä¸€å±‚éšè—å±‚æœ‰æ—¶é—´å†ç ”ç©¶ã€‚ç”±äºæ¯ä¸ªäººæ”¶åˆ°çš„ç‚¸å¼¹æ˜¯ä¸åŒçš„ï¼ˆä½ çš„è€å¸ˆä¼šè¯´æ ¹æ®ä½ çš„å­¦å·é€‰æ‹©ç›¸åº”çš„ç‚¸å¼¹ï¼‰ï¼Œæ‰€ä»¥æ–‡ç« ä»…æä¾›åŸºæœ¬æ€è·¯ä¾›å‚è€ƒã€‚</p>\n\n<div class=\"callout\" data-callout=\"notice\">\n<div class=\"callout-title\">\n<div class=\"callout-title-icon\">\n<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"lucide lucide-pencil\"><path d=\"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z\"/><path d=\"m15 5 4 4\"/></svg>\n</div>\n<div class=\"callout-title-inner\">CSAPP LAB å®éªŒç³»åˆ—</div>\n</div>\n<div class=\"callout-content\"><p></p>\n<ul>\n<li><a class=\"uuanqin-bilink\" target=\"_blank\" href=\"/p/c5970284/\"><span class=\"bilink-pop-up\">ç«™å†…æ–‡ç« </span>CSAPP LAB-1 ä½æ“ä½œ</a></li>\n<li>CSAPP LAB-2 äºŒè¿›åˆ¶ç‚¸å¼¹å®éªŒï¼ˆæœ¬æ–‡ï¼‰</li>\n<li><a class=\"uuanqin-bilink\" target=\"_blank\" href=\"/p/67787353/\"><span class=\"bilink-pop-up\">ç«™å†…æ–‡ç« </span>CSAPP LAB-3 ç¼“å†²åŒºæº¢å‡ºç‚¸å¼¹</a></li>\n<li><a class=\"uuanqin-bilink\" target=\"_blank\" href=\"/p/9d6b717/\"><span class=\"bilink-pop-up\">ç«™å†…æ–‡ç« </span>CSAPP LAB-4 ä»£ç ä¼˜åŒ–</a></li>\n<li><a class=\"uuanqin-bilink\" target=\"_blank\" href=\"/p/3eb1abc7/\"><span class=\"bilink-pop-up\">ç«™å†…æ–‡ç« </span>CSAPP LAB-5 æ‰‹å†™åŠ¨æ€å­˜å‚¨åˆ†é…å™¨</a></li>\n</ul>\n</div></div><h1 id=\"å®éªŒä»‹ç»\"><a class=\"markdownIt-Anchor\" href=\"#å®éªŒä»‹ç»\"></a> å®éªŒä»‹ç»</h1>\n<p>äºŒè¿›åˆ¶ç‚¸å¼¹åŒ…å«è‹¥å¹²ä¸ªé˜¶æ®µï¼Œæ¯ä¸ªé˜¶æ®µéœ€è¦è¾“å…¥ç‰¹å®šçš„å­—ç¬¦ä¸²ï¼Œæ‰€æœ‰è¾“å…¥æ­£ç¡®åˆ™ç‚¸å¼¹è¢«æ’é™¤ï¼Œå¦åˆ™â€¦â€¦</p>\n<p>æˆ‘ä»¬çš„ä»»åŠ¡æ˜¯æ‰¾å‡ºè¿™äº›å­—ç¬¦ä¸²å­—ç¬¦ä¸²è®°å½•åˆ°æ–‡ä»¶ä¸­ï¼Œå¯è¾“å…¥å‘½ä»¤éªŒè¯ <code>./bomb  solution.txt</code> ç”¨æ¢è¡ŒåŒºåˆ«ä¸åŒé˜¶æ®µçš„å­—ç¬¦ä¸²ã€‚</p>\n<p>ä¸‹è½½å‹ç¼©åŒ… bombsï¼Œå‹ç¼©åŒ…åŒ…å«å¤šä¸ª <code>bomb</code> ä»£ç åŒ…ï¼Œæ ¹æ®å­¦å·é¢†å–è‡ªå·±çš„ä»£ç åŒ…ã€‚</p>\n<p>æŸ¥çœ‹ <code>bomb.c</code> å¯çŸ¥ç¨‹åºåˆ©ç”¨ <code>phase_*</code> å‡½æ•°ï¼ˆ<code>*</code> ä¸º 1~6ï¼‰ æ£€æŸ¥è¾“å…¥å­—ç¬¦ä¸²æ˜¯å¦åˆæ³•ï¼Œä¸åˆæ³•å°±å¼•çˆ†ç‚¸å¼¹ã€‚æˆ‘ä»¬çš„ä»»åŠ¡å°±æ˜¯é€†å‘å‡ºæ¯ä¸ª phase çš„æ£€æŸ¥è§„åˆ™ï¼Œæ„é€ å‡ºåˆæ³•å­—ç¬¦ä¸²ã€‚å½“ç„¶ï¼Œ<code>bomb.c</code> æ²¡æœ‰ç»™å‡º <code>phase_*</code> çš„æºç </p>\n<p>é€†å‘æ–¹æ³•ï¼š</p>\n<ul>\n<li>GDB</li>\n<li>ç›´æ¥åæ±‡ç¼–</li>\n</ul>\n<p>è¯¾æœ¬å‚è€ƒï¼š</p>\n<ul>\n<li>CSAPP ç¬¬ä¸‰ç« ï¼šGDB çš„ä½¿ç”¨</li>\n<li>CSAPP ç¬¬ä¸‰ç« ï¼šè¿‡ç¨‹</li>\n</ul>\n<p>é“¾æ¥å‚è€ƒï¼ˆå–œæŠ¥ï¼šå…¨æ˜¯ Englishï¼‰ï¼š</p>\n<ul>\n<li>GDBï¼š\n<ul>\n<li><a href=\"https://heather.cs.ucdavis.edu/matloff/public_html/UnixAndC/CLanguage/Debug.html\">Guide to Faster, Less Frustrating Debugging (ucdavis.edu)</a></li>\n<li><a href=\"https://www.gnu.org/software/gdb/\">GDB: The GNU Project Debugger</a></li>\n</ul>\n</li>\n<li>X86 æŒ‡ä»¤æ‰‹å†Œï¼š<a href=\"http://csapp.cs.cmu.edu/public/students.html\">CS:APP2e, Bryant and Oâ€™Hallaron (cmu.edu)</a></li>\n<li>GNU æ±‡ç¼–è¯­æ³•å‚è€ƒï¼š\n<ul>\n<li>Wiki ç®€æ˜ä»‹ç»ï¼š<a href=\"https://en.wikibooks.org/wiki/X86_Assembly/GNU_assembly_syntax\">x86 Assembly/GNU assembly syntax - Wikibooks</a></li>\n<li>æ‰‹å†Œï¼š<a href=\"https://sourceware.org/binutils/docs/as/\">Top (Using as) (sourceware.org)</a></li>\n</ul>\n</li>\n</ul>\n<blockquote>\n<p>æ±‡ç¼–è¯­æ³•çœ‹è¯¾æœ¬å°±è¡Œï¼ŒGDB å‘½ä»¤çœ‹æœ¬æ–‡åç»­ç« èŠ‚å°±è¡Œã€‚ä»¥ä¸Šé“¾æ¥ä½ å¯ä»¥ä¸€ä¸ªéƒ½ä¸ç”¨ç‚¹å¼€ã€‚</p>\n</blockquote>\n<h1 id=\"gdb-å·¥å…·çš„ä½¿ç”¨\"><a class=\"markdownIt-Anchor\" href=\"#gdb-å·¥å…·çš„ä½¿ç”¨\"></a> GDB å·¥å…·çš„ä½¿ç”¨</h1>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt install gdb <span class=\"comment\"># å®‰è£… GDB</span></span><br><span class=\"line\">gdb --version   <span class=\"comment\"># æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ</span></span><br></pre></td></tr></table></figure>\n<p>GDB ä¸éœ€è¦äº†è§£è¿‡å¤šï¼Œæƒ³å¹²ä»€ä¹ˆç›´æ¥æŸ¥å°±è¡Œã€‚ç°ç”¨ç°å­¦ã€‚</p>\n<p>ä½ å¯èƒ½ç”¨åˆ°çš„å‘½ä»¤åªæœ‰è¿™äº›ï¼š</p>\n<ul>\n<li><code>run</code>ï¼šè¿è¡Œ GDB</li>\n<li><code>continue</code>ï¼šç»§ç»­è¿è¡Œï¼Œå¯ç®€å†™ä¸º <code>c</code>ã€‚</li>\n<li><code>break &lt;addr&gt;</code>ï¼šåœ¨æŒ‡å®šåœ°å€å¤„è®¾ç½®æ–­ç‚¹ã€‚<code>break</code> å¯ç®€å†™ä¸º <code>b</code>ã€‚</li>\n<li><code>print $eax</code>ï¼šæ‰“å°æŸä¸ªå¯„å­˜å™¨çš„å€¼ã€‚<code>print</code> å¯ç®€å†™ä¸º <code>p</code>ã€‚</li>\n<li><code>p /x ($esp-0x8)</code>ï¼šæ‰“å°æŸä¸ªå¯„å­˜å™¨çš„å€¼çš„è¿ç®—ç»“æœ</li>\n<li><code>print (char *) &lt;addr&gt;</code> ï¼šå°†ç›´æ¥æ‰“å°è¯¥åœ°å€ <code>addr</code> ä¸‹çš„å­—ç¬¦ä¸²</li>\n<li><code>print /x * &lt;addr&gt;</code> ï¼šä»¥åå…­è¿›åˆ¶çš„å½¢å¼æ‰“å°æŒ‡å®šåœ°å€ <code>addr</code> çš„å€¼</li>\n<li><code>print ((int*) &lt;addr&gt;)[&lt;index&gt;]</code> ï¼šæ‰“å°æŒ‡å®šä½ç½® <code>addr</code> æ•°ç»„ä¸‹æ ‡ä¸º <code>index</code> çš„å…ƒç´ </li>\n<li><code>print ((int*) &lt;addr&gt;)[&lt;index&gt;]@&lt;num&gt;</code> ï¼šæ‰“å°æŒ‡å®šä½ç½®æ•°ç»„çš„å…ƒç´ ï¼Œèµ·å§‹åæ ‡ä¸º <code>index</code>ï¼Œè¾“å‡º <code>num</code> ä¸ªå…ƒç´ </li>\n</ul>\n<p>æˆªä¸€å¼ è¯¾æœ¬çš„å›¾ä¾›æ›´å¤šå‚è€ƒï¼š</p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/20240519124236.webp\" alt=\"image.png\" /></p>\n<h1 id=\"å¼€å§‹æ‹†å¼¹\"><a class=\"markdownIt-Anchor\" href=\"#å¼€å§‹æ‹†å¼¹\"></a> å¼€å§‹æ‹†å¼¹ï¼</h1>\n<h2 id=\"æ‹†å¼¹å‡†å¤‡\"><a class=\"markdownIt-Anchor\" href=\"#æ‹†å¼¹å‡†å¤‡\"></a> æ‹†å¼¹å‡†å¤‡</h2>\n<p>åœ¨ Linux ç¯å¢ƒä¸‹è§£å‹ bomb å‹ç¼©æ–‡ä»¶ã€‚</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar -xvf bomb7.tar</span><br></pre></td></tr></table></figure>\n<p>å¾—åˆ°å¦‚ä¸‹æ–‡ä»¶ï¼š</p>\n<ul>\n<li><code>bomb</code>ï¼šäºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»»åŠ¡ç›®æ ‡æ–‡ä»¶</li>\n<li><code>bomb.c</code>ï¼š<code>bomb</code> çš„æºæ–‡ä»¶ï¼Œè¾…åŠ©ç†è§£ <code>bomb</code> ä»£ç </li>\n</ul>\n<p>é¦–å…ˆä½¿ç”¨ <code>objdump</code> åæ±‡ç¼–å·¥å…·å¯¹ <code>bomb</code> è¿›è¡Œåæ±‡ç¼–ï¼Œè¾“å‡ºçš„æ±‡ç¼–æ–‡ä»¶åä¸º <code>dump.s</code>ï¼š</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">objdump -d bomb &gt; dump.s</span><br></pre></td></tr></table></figure>\n<p><code>bomb.c</code> æ˜¯ <code>bomb</code> çš„éƒ¨åˆ†æºæ–‡ä»¶ï¼ŒåŒ…å«ä¸»å‡½æ•° <code>main</code>ã€‚é€šè¯» <code>main</code> å‡½æ•°ä»¥åŠæ³¨é‡Šï¼Œæˆ‘ä»¬çŸ¥é“ï¼š</p>\n<ol>\n<li>è¿è¡Œ <code>bomb</code> æ—¶å¦‚æœä¸å¸¦å‚æ•°ï¼Œæˆ‘ä»¬å°†åœ¨æ ‡å‡†è¾“å…¥ä¸­è¾“å…¥æ‹†å¼¹çš„å­—ç¬¦ä¸²ã€‚</li>\n<li>è¿è¡Œ <code>bomb</code> æ—¶å¦‚æœæºå¸¦ä¸€ä¸ªå‚æ•°ï¼Œåˆ™å…ˆä»æŒ‡å®šçš„æ–‡ä»¶ä¸­è¯»å–å­—ç¬¦ä¸²</li>\n<li>è¿è¡Œ <code>bomb</code> æ—¶å¦‚æœæºå¸¦å¤šäºä¸€ä¸ªå‚æ•°ï¼Œåˆ™è¾“å‡ºæç¤ºï¼š<code>bomb [&lt;input_file&gt;]</code></li>\n<li>ä¸€å…±æœ‰ 6 å±‚ç‚¸å¼¹ï¼Œæ¯ä¸€å±‚é€šè¿‡è¾“å…¥ä¸€è¡Œå­—ç¬¦ä¸²ä»¥è¿›è¡Œæ‹†å¼¹</li>\n<li>ç‚¸å¼¹çˆ†ç‚¸åä¸ä¼šæœ‰ä»»ä½•äººå—åˆ°ä¼¤å®³</li>\n<li>å¯èƒ½å­˜åœ¨éšè—å…³å¡</li>\n</ol>\n<p>æ­¤å¤–ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç‚¸å¼¹è¿è¡Œæ—¶ <kbd>Ctrl</kbd>+<kbd>C</kbd> ä¸­æ­¢æ‹†å¼¹ï¼Œé‚ªæ¶åšå£«ğŸ˜ˆï¼ˆDr. Evilï¼‰æœ€ç»ˆè¿˜æ˜¯ä¼šæ”¾æˆ‘ä»¬èµ°çš„ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">^CSo you think you can stop the bomb with ctrl-c, do you?</span><br><span class=\"line\">Well...OK. :-)</span><br></pre></td></tr></table></figure>\n<p>æ–°å»ºæ–‡ä»¶ <code>solution.txt</code>ï¼Œä¹‹åæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨é‡Œé¢å†™å­—ç¬¦ä¸²ç­”æ¡ˆï¼ˆæ¯è¡ŒæŒ‰åºå†™ä¸Šå„å±‚ç­”æ¡ˆï¼‰ï¼Œä»è€Œä¸ç”¨æ‰‹åŠ¨è¾“å…¥å­—ç¬¦ä¸²ã€‚</p>\n<p><code>bomb.c</code> çœ‹å®Œåï¼Œå®ƒçš„ä½œç”¨åŸºæœ¬ç»“æŸäº†ã€‚åé¢æˆ‘ä»¬çš„æ—¶é—´å°†ä¼šèŠ±åœ¨äººå·¥è§£è¯» <code>dump.s</code> æ–‡ä»¶ä»¥åŠä½¿ç”¨ gdb è°ƒè¯•å·¥å…·çš„è¿‡ç¨‹ä¸­ã€‚</p>\n<p><code>dump.s</code> æ–‡ä»¶é˜…è¯»è¦ç‚¹ï¼š</p>\n<ol>\n<li>ä¸éœ€è¦çœ‹æ‡‚æ‰€æœ‰æ±‡ç¼–ä»£ç ï¼ˆå®é™…ä¸Šä¹Ÿä¸å¯èƒ½ï¼‰ï¼Œåªéœ€çœ‹æ‡‚å…³é”®å‡½æ•°éƒ¨åˆ†çš„ä»£ç ã€‚</li>\n<li>å…³é”®å‡½æ•°ï¼šå„å±‚ç‚¸å¼¹å‡½æ•° <code>&lt;phase_X&gt;</code>ï¼Œä¸­é—´ç©¿æ’çš„å‡½æ•° <code>&lt;funcX&gt;</code>ã€‚ä¸ºäº†ä¾¿äºè‡ªå·±çš„ç†è§£ï¼Œæœ‰æ—¶å€™ä½ ä¹Ÿå¯ä»¥çœ‹ä¸€äº›å·¥å…·ç±»çš„å‡½æ•°ï¼Œæ¯”å¦‚ <code>&lt;read_six_numbers&gt;</code> <code>&lt;strings_not_equal&gt;</code> ç­‰ï¼Œä½†è¿™äº›å‡½æ•°çœ‹åå­—å°±çŸ¥é“å…¶ä½œç”¨ã€‚</li>\n<li>å½“è¿è¡Œåˆ° <code>&lt;explode_bomb&gt;</code> æ—¶ç‚¸å¼¹çˆ†ç‚¸ï¼Œå½“è¯¥å±‚å‡½æ•°å®‰å…¨ç»“æŸè¿”å›åˆ° main è¿è¡Œ <code>&lt;phase_defused&gt;</code> æ—¶è¯¥å±‚ç‚¸å¼¹å®‰å…¨ç ´è§£ã€‚</li>\n<li>å¤šæ³¨é‡Šå’Œåˆ†è¡Œä¾¿äºé˜…è¯»</li>\n</ol>\n<p>åœ¨ç ´è§£æŸä¸€å±‚ç‚¸å¼¹æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆéšä¾¿è¾“å‡ ä¸ªæ•°ï¼Œé€šè¿‡ GDB å·¥å…·æ¨æµ‹æˆ‘ä»¬çš„è¾“å…¥å­˜æ”¾åœ¨æ ˆä¸­çš„å“ªä¸ªä½ç½®ï¼Œè¿™æ ·ä¹Ÿèƒ½æ–¹ä¾¿æ¨ç†ã€‚</p>\n<h2 id=\"phase-1-å¯»æ‰¾å­—ç¬¦ä¸²\"><a class=\"markdownIt-Anchor\" href=\"#phase-1-å¯»æ‰¾å­—ç¬¦ä¸²\"></a> Phase 1 - å¯»æ‰¾å­—ç¬¦ä¸²</h2>\n<blockquote>\n<p>asm ä»£ç é˜…è¯»æç¤ºï¼šå·¦ä¾§ä¸ºç¨‹åºåœ°å€ä¸æŒ‡ä»¤å­—èŠ‚ç ï¼Œå³ä¾§ä¸ºåæ±‡ç¼–åå¾—åˆ°çš„æ±‡ç¼–ä»£ç ã€‚æ³¨é‡Šä½¿ç”¨ <code>;</code> ä»¥åŠ <code>#</code>ã€‚</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">08048b80 &lt;phase_1&gt;:</span><br><span class=\"line\"> 8048b80:\t55                   \tpush   %ebp</span><br><span class=\"line\"> 8048b81:\t89 e5                \tmov    %esp,%ebp</span><br><span class=\"line\"> 8048b83:\t83 ec 08             \tsub    $0x8,%esp\t\t\t# æ ˆæŒ‡é’ˆ -8 </span><br><span class=\"line\"> 8048b86:\tc7 44 24 04 d8 99 04 \tmovl   $0x80499d8,0x4(%esp) # æ ˆ+4 å– 0x80499d8 å­˜å‚¨çš„å­—ç¬¦ä¸²</span><br><span class=\"line\"> 8048b8d:\t08 </span><br><span class=\"line\"> 8048b8e:\t8b 45 08             \tmov    0x8(%ebp),%eax       # åŸå…ˆçš„æ ˆæŒ‡é’ˆ + 8 ç»™ eax</span><br><span class=\"line\"> 8048b91:\t89 04 24             \tmov    %eax,(%esp)          # eax æ”¾åˆ° æ ˆå½“å‰æŒ‡å‘çš„ä½ç½®</span><br><span class=\"line\"> 8048b94:\te8 86 05 00 00       \tcall   804911f &lt;strings_not_equal&gt; # è¿”å› 0 è¡¨ç¤ºå­—ç¬¦ä¸²ç›¸ç­‰</span><br><span class=\"line\"> 8048b99:\t85 c0                \ttest   %eax,%eax            # test æ‰§è¡Œçš„æ˜¯ AND æ“ä½œã€‚ eaxä¸º0æ‰æˆåŠŸ</span><br><span class=\"line\"> 8048b9b:\t74 05                \tje     8048ba2 &lt;phase_1+0x22&gt; # ç ´è§£æˆåŠŸ je æ˜¯åˆ¤æ–­æ ‡å¿—ä½ZFæ˜¯å¦ä¸º1</span><br><span class=\"line\"> 8048b9d:\te8 44 0b 00 00       \tcall   80496e6 &lt;explode_bomb&gt; # ç ´è§£å¤±è´¥</span><br><span class=\"line\"> 8048ba2:\tc9                   \tleave  </span><br><span class=\"line\"> 8048ba3:\tc3                   \tret   </span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>ä½¿ç”¨ GDB è°ƒè¯•å‰è®°å¾—æ‰“æ–­ç‚¹ï¼Œæ¯”å¦‚ï¼š<code>b *0x8048b94</code></p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(gdb) p (char*)  0x80499d8</span><br><span class=\"line\">$2 = 0x80499d8 &quot;I am not part of the problem. I am a Republican.&quot;</span><br></pre></td></tr></table></figure>\n<p>è§£æåŠè¦ç‚¹ï¼š</p>\n<ul>\n<li>æœ¬å±‚é€šè¿‡åˆ¤æ–­è¾“å…¥çš„å­—ç¬¦ä¸²æ˜¯å¦ä¸æŒ‡å®šå­—ç¬¦ä¸²ç›¸ç­‰ã€‚</li>\n<li>æ­¤å±‚åªéœ€ä½¿ç”¨ GDB æŒ‡ä»¤æ‰¾å‡ºåœ°å€ <code>$0x80499d8</code> å­˜å‚¨çš„å­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²å°±æ˜¯æœ¬å±‚ç­”æ¡ˆã€‚</li>\n</ul>\n<p>ç‚¹è¯„ä¸æç¤ºï¼š</p>\n<ul>\n<li>æ‹†å¼¹å…¥é—¨ã€‚</li>\n<li>åƒé‡åˆ°è¿™ç§å­˜åœ¨ã€Œé­”æ•°ã€çš„æŒ‡ä»¤è¦å¤šç•™å¿ƒï¼Œå¸¸ä½¿ç”¨ GDB æ‰“å°è¯¥ä½ç½®çš„å†…å®¹ï¼Œæœ‰å¯èƒ½å­˜å‚¨å…³é”®å­—ç¬¦ä¸²æˆ–æ•°ç»„ã€‚</li>\n<li>%eax å¤šç”¨äºå­˜å‚¨å‡½æ•°è¿”å›ç»“æœ</li>\n<li><code>test   %eax,%eax</code> ï¼š<code>test</code> ç›¸å½“äº <code>and</code> æŒ‡ä»¤ï¼Œç”¨äºæµ‹è¯• <code>%eax</code> æ˜¯å¦ä¸º 0ã€‚<code>je</code> æŒ‡ä»¤ä¼šåˆ¤æ–­ <code>ZF</code> æ ‡å¿—ä½ï¼Œå½“ ZF ä¸º 1 æ—¶è¯´æ˜ <code>%eax</code> ä¸º 0ï¼Œç¨‹åºæ‰§è¡Œè·³è½¬ã€‚</li>\n</ul>\n<h2 id=\"phase-2-æœ‰åºæ•°ç»„\"><a class=\"markdownIt-Anchor\" href=\"#phase-2-æœ‰åºæ•°ç»„\"></a> Phase 2 - æœ‰åºæ•°ç»„</h2>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">08048ba4 &lt;phase_2&gt;:</span><br><span class=\"line\"> 8048ba4:\t55                   \tpush   %ebp</span><br><span class=\"line\"> 8048ba5:\t89 e5                \tmov    %esp,%ebp</span><br><span class=\"line\"> 8048ba7:\t83 ec 28             \tsub    $0x28,%esp              # æ ˆæŒ‡é’ˆ - 0x28 = 40 ï¼›æ ˆåˆ†é… 40 å­—èŠ‚</span><br><span class=\"line\"> 8048baa:\t8d 45 e4             \tlea    -0x1c(%ebp),%eax        # åŸå…ˆæ ˆ - 0x1c = 28</span><br><span class=\"line\"> 8048bad:\t89 44 24 04          \tmov    %eax,0x4(%esp)\t\t# æ ˆ+4 &lt;- åŸå…ˆæ ˆ-28</span><br><span class=\"line\"> 8048bb1:\t8b 45 08             \tmov    0x8(%ebp),%eax</span><br><span class=\"line\"> 8048bb4:\t89 04 24             \tmov    %eax,(%esp)\t\t\t# æ ˆ &lt;- åŸå…ˆæ ˆ+8</span><br><span class=\"line\"> 8048bb7:\te8 d0 04 00 00       \tcall   804908c &lt;read_six_numbers&gt;</span><br><span class=\"line\"> 8048bbc:\tc7 45 fc 01 00 00 00 \tmovl   $0x1,-0x4(%ebp)      # i = 1</span><br><span class=\"line\"> 8048bc3:\teb 1e                \tjmp    8048be3 &lt;phase_2+0x3f&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"> # å¾ªç¯å¼€å§‹ï¼ˆæ¯”è¾ƒå‰åä¸¤ä¸ªæ•°æ˜¯å¦ç›¸å·®5ï¼‰</span><br><span class=\"line\"> 8048bc5:\t8b 45 fc             \tmov    -0x4(%ebp),%eax          # å– i</span><br><span class=\"line\"> 8048bc8:\t8b 54 85 e4          \tmov    -0x1c(%ebp,%eax,4),%edx  # arr[i]</span><br><span class=\"line\"> 8048bcc:\t8b 45 fc             \tmov    -0x4(%ebp),%eax          </span><br><span class=\"line\"> 8048bcf:\t48                   \tdec    %eax                     # å– i-1 </span><br><span class=\"line\"> 8048bd0:\t8b 44 85 e4          \tmov    -0x1c(%ebp,%eax,4),%eax  # arr[i-1]</span><br><span class=\"line\"> 8048bd4:\t83 c0 05             \tadd    $0x5,%eax\t\t\t\t</span><br><span class=\"line\"> 8048bd7:\t39 c2                \tcmp    %eax,%edx</span><br><span class=\"line\"> 8048bd9:\t74 05                \tje     8048be0 &lt;phase_2+0x3c&gt;   # arr[i-1]+5 == arr[i] å¿…é¡»ç›¸ç­‰</span><br><span class=\"line\"> 8048bdb:\te8 06 0b 00 00       \tcall   80496e6 &lt;explode_bomb&gt;</span><br><span class=\"line\"> 8048be0:\tff 45 fc             \tincl   -0x4(%ebp)               # i+=1</span><br><span class=\"line\"></span><br><span class=\"line\"> 8048be3:\t83 7d fc 05          \tcmpl   $0x5,-0x4(%ebp)      </span><br><span class=\"line\"> 8048be7:\t7e dc                \tjle    8048bc5 &lt;phase_2+0x21&gt; # i &lt;= 5 ç»§ç»­å¾ªç¯(iä»1å¼€å§‹)</span><br><span class=\"line\"> 8048be9:\tc9                   \tleave  </span><br><span class=\"line\"> 8048bea:\tc3                   \tret    </span><br></pre></td></tr></table></figure>\n<p>æ–­ç‚¹æ‰“åˆ° <code>&lt;read_six_numbers&gt;</code> ä¹‹åï¼Œæ¯”å¦‚ <code>0x8048bbc</code>ã€‚æˆ‘ä»¬éšä¾¿è¾“å…¥ 5 ä¸ªæ•°å­—ï¼Œæ¯”å¦‚ <code>1 6 11 16 21 26</code>ï¼Œé€šè¿‡ GDB å¯ä»¥åˆ¤æ–­å…¶å­˜å‚¨ä½ç½®ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># ä¸‹é¢å±•ç¤ºäº†è¾“å…¥çš„ 6 ä¸ªæ•°å­—çš„å­˜å‚¨ä½ç½®ï¼ˆç¤ºä¾‹æ•°æ®ï¼‰</span><br><span class=\"line\">(gdb) p *(int*) 0xffffcc6c    $6 = 1</span><br><span class=\"line\">(gdb) p *(int*) 0xffffcc70    $8 = 6</span><br><span class=\"line\">(gdb) p *(int*) 0xffffcc74    $9 = 11</span><br><span class=\"line\">(gdb) p *(int*) 0xffffcc78    $10 = 16</span><br><span class=\"line\">(gdb) p *(int*) 0xffffcc7c    $11 = 21</span><br><span class=\"line\">(gdb) p *(int*) 0xffffcc80    $12 = 26</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>ä¸ºå•¥ä¼šçŸ¥é“æŸ¥ 6 ä¸ªåœ°å€ã€‚æˆ‘ä»¬æ ¹æ®è¿™ä¸ªåŸåˆ™å°±è¡Œï¼šæ±‡ç¼–ä¸­ç”¨åˆ°å“ªé‡Œï¼ŒGDB å°±æŸ¥å“ªé‡Œã€‚</p>\n</blockquote>\n<p>è¿™é‡Œçš„æ±‡ç¼–ä»£ç ä¸­å­˜åœ¨ä¸€ä¸ªå…¸å‹çš„ <code>for</code> å¾ªç¯ç»“æ„ï¼Œä½¿ç”¨äº†ã€Œè·³è½¬åˆ°ä¸­é—´ã€ç­–ç•¥ï¼ˆå…·ä½“è¯·çœ‹æ•™æï¼‰ã€‚for å¾ªç¯çš„é€šç”¨å½¢å¼ï¼š</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span>(init-expr;test-expr;update-expr)</span><br><span class=\"line\">\tbody-statement;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// è¡Œä¸ºä¸ä¸‹é¢çš„whileå¾ªç¯ä»£ç ä¸€æ ·</span></span><br><span class=\"line\">init-expr;</span><br><span class=\"line\"><span class=\"keyword\">while</span>(test-expr)&#123;</span><br><span class=\"line\">\tbody-statement</span><br><span class=\"line\">\tupdate-expr;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è¯¥éƒ¨åˆ†æ±‡ç¼–ä»£ç ç»“æ„ç¿»è¯‘ä¸º C è¯­è¨€çš„å¤§è‡´ç»“æ„å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\tinit-expr;</span><br><span class=\"line\">\t<span class=\"keyword\">goto</span> test;</span><br><span class=\"line\">loop:</span><br><span class=\"line\">\tbody-statement;</span><br><span class=\"line\">\tupdate-expr;</span><br><span class=\"line\">test:</span><br><span class=\"line\">\tt=test-expr;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(t)</span><br><span class=\"line\">\t\t<span class=\"keyword\">goto</span> loop;</span><br></pre></td></tr></table></figure>\n<p>è§£æåŠè¦ç‚¹ï¼š</p>\n<ul>\n<li>æœ¬å±‚éœ€è¾“å…¥ 6 ä¸ªæ•°å­—ï¼Œæ¯ä¸ªæ•°å­—éœ€æ„æˆå‡åºçš„ç­‰å·®æ•°åˆ—ï¼ˆå…¬å·®ä¸º 5ï¼‰</li>\n</ul>\n<p>ç‚¹è¯„ä¸æç¤ºï¼š</p>\n<ul>\n<li>è¯†åˆ« <code>for</code> å¾ªç¯</li>\n<li>çŸ¥é“è¾“å…¥çš„ 6 ä¸ªæ•°å­—çš„å­˜å‚¨ä½ç½®</li>\n</ul>\n<h2 id=\"phase-3-è·³è½¬è¡¨\"><a class=\"markdownIt-Anchor\" href=\"#phase-3-è·³è½¬è¡¨\"></a> Phase 3 - è·³è½¬è¡¨</h2>\n<blockquote>\n<p>ç›¸ä¿¡ä½ é€šè¿‡äº†å‰é¢æ±‡ç¼–çš„æ´—ç¤¼åï¼Œæ±‡ç¼–ä»£ç çš„é˜…è¯»èƒ½åŠ›æé«˜äº†ä¸å°‘ã€‚æœ¬å±‚å¼€å§‹å°±ä¸ä¼šå•°å—¦å¤ªå¤šå“¦ï¼Œçœ‹æ³¨é‡Šå³å¯ã€‚</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">08048beb &lt;phase_3&gt;:</span><br><span class=\"line\"> 8048beb:\t55                   \tpush   %ebp</span><br><span class=\"line\"> 8048bec:\t89 e5                \tmov    %esp,%ebp</span><br><span class=\"line\"> 8048bee:\t83 ec 38             \tsub    $0x38,%esp</span><br><span class=\"line\"> 8048bf1:\tc7 45 f8 00 00 00 00 \tmovl   $0x0,-0x8(%ebp)</span><br><span class=\"line\"> 8048bf8:\t8d 45 f0             \tlea    -0x10(%ebp),%eax</span><br><span class=\"line\"> 8048bfb:\t89 44 24 10          \tmov    %eax,0x10(%esp)</span><br><span class=\"line\"> 8048bff:\t8d 45 ef             \tlea    -0x11(%ebp),%eax</span><br><span class=\"line\"> 8048c02:\t89 44 24 0c          \tmov    %eax,0xc(%esp)</span><br><span class=\"line\"> 8048c06:\t8d 45 f4             \tlea    -0xc(%ebp),%eax</span><br><span class=\"line\"> 8048c09:\t89 44 24 08          \tmov    %eax,0x8(%esp)</span><br><span class=\"line\"> 8048c0d:\tc7 44 24 04 09 9a 04 \tmovl   $0x8049a09,0x4(%esp)</span><br></pre></td></tr></table></figure>\n<p>æŸ¥çœ‹é­”æ•°ä¿¡æ¯ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(gdb) p (char*) 0x8049a09</span><br><span class=\"line\">$13 = 0x8049a09 &quot;%d %c %d&quot;</span><br></pre></td></tr></table></figure>\n<p>è¿™ä¸ªå­—ç¬¦ä¸²æ˜¯ä¸æ˜¯å¾ˆçœ¼ç†Ÿï¼Œè¿™å¯èƒ½æç¤ºæˆ‘ä»¬è¾“å…¥ 3 ä¸ªæ•°æ®ï¼š1 ä¸ªæ•°å­—ã€1 ä¸ªå­—ç¬¦ä»¥åŠ 1 ä¸ªæ•°å­—ã€‚æˆ‘ä»¬å¯ä»¥åƒä¸Šä¸€å±‚é‚£æ ·éšä¾¿è¾“å…¥ 3 ä¸ªæ•°æ®ã€‚</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">8048c14:\t08 </span><br><span class=\"line\">8048c15:\t8b 45 08             \tmov    0x8(%ebp),%eax</span><br><span class=\"line\">8048c18:\t89 04 24             \tmov    %eax,(%esp)</span><br><span class=\"line\">8048c1b:\te8 48 fc ff ff       \tcall   8048868 &lt;sscanf@plt&gt;</span><br><span class=\"line\">8048c20:\t89 45 f8             \tmov    %eax,-0x8(%ebp)          # è¿”å›è¾“å…¥çš„ä¸ªæ•°</span><br><span class=\"line\">8048c23:\t83 7d f8 02          \tcmpl   $0x2,-0x8(%ebp)</span><br><span class=\"line\">8048c27:\t7f 05                \tjg     8048c2e &lt;phase_3+0x43&gt; \t# è¾“å…¥ï¼ˆé•¿åº¦ï¼‰å¿…é¡»å¤§äº2</span><br><span class=\"line\">8048c29:\te8 b8 0a 00 00       \tcall   80496e6 &lt;explode_bomb&gt;</span><br><span class=\"line\">8048c2e:\t8b 45 f4             \tmov    -0xc(%ebp),%eax          # -0xc(%ebp)æºå¸¦è¾“å…¥çš„é¦–åœ°å€</span><br><span class=\"line\">8048c31:\t89 45 dc             \tmov    %eax,-0x24(%ebp)         # ç»è¿‡GDBè°ƒè¯•ï¼Œ-0x24(%ebp) è¡¨ç¤ºç¬¬ä¸€ä¸ªè¾“å…¥çš„æ•°å­—</span><br><span class=\"line\">8048c34:\t83 7d dc 07          \tcmpl   $0x7,-0x24(%ebp)         # è¾“å…¥çš„æ•°å­—å¿…é¡»å°äºç­‰äº7</span><br><span class=\"line\">8048c38:\t0f 87 c0 00 00 00    \tja     8048cfe &lt;phase_3+0x113&gt; \t# æ— ç¬¦å·å¤§äº7 - åˆ™çˆ†ç‚¸</span><br><span class=\"line\">8048c3e:\t8b 55 dc             \tmov    -0x24(%ebp),%edx\t\t\t# %edx = ç¬¬ä¸€ä¸ªè¾“å…¥çš„æ•°å­—</span><br><span class=\"line\">8048c41:\t8b 04 95 14 9a 04 08 \tmov    0x8049a14(,%edx,4),%eax \t</span><br><span class=\"line\">8048c48:\tff e0                \tjmp    *%eax \t\t\t\t\t# ä¾‹å¦‚ç¬¬ä¸€ä¸ªè¾“å…¥çš„æ•°å­—æ˜¯6 åˆ™ eax=0x8048cd4</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>æ±‡ç¼–ä¸­ç”¨åˆ°å“ªé‡Œï¼ŒGDB å°±æŸ¥å“ªé‡Œã€‚<code>-0x24(%ebp)</code> æŒ‡å‘æˆ‘ä»¬ç¬¬ä¸€ä¸ªè¾“å…¥çš„æ•°å­—ã€‚</p>\n</blockquote>\n<p>åƒ <code>jmp    *%eax</code> è¿™ç§è¯­æ³•å¾ˆçœ¼ç†Ÿï¼Œåƒæ˜¯è¯¾æœ¬ä¸­æåˆ°çš„ <code>switch</code> è¯­å¥çš„æ±‡ç¼–ã€‚æˆ‘ä»¬å¯ä»¥å°è¯•æ‰¾å‡ºå…¶è·³è½¬è¡¨ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(gdb) print /x ((int*) 0x8049a14)[0]@8</span><br><span class=\"line\">$25 = &#123;0x8048c4a, 0x8048c66, 0x8048c82, 0x8048c97, 0x8048cac, 0x8048cbf, 0x8048cd4, 0x8048ce9&#125;</span><br></pre></td></tr></table></figure>\n<p>æˆ‘ä»¬å°±éšä¾¿é€‰ä¸€ä¸ªï¼Œæ¯”å¦‚ 6ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ 6 çš„ä»£ç å°±è¡Œã€‚</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> # 0</span><br><span class=\"line\"> 8048c4a:\tc6 45 ff 67          \tmovb   $0x67,-0x1(%ebp)</span><br><span class=\"line\"> 8048c4e:\t8b 45 f0             \tmov    -0x10(%ebp),%eax</span><br><span class=\"line\"> 8048c51:\t3d c8 00 00 00       \tcmp    $0xc8,%eax</span><br><span class=\"line\"> 8048c56:\t0f 84 ab 00 00 00    \tje     8048d07 &lt;phase_3+0x11c&gt;</span><br><span class=\"line\"> 8048c5c:\te8 85 0a 00 00       \tcall   80496e6 &lt;explode_bomb&gt;</span><br><span class=\"line\"> 8048c61:\te9 a1 00 00 00       \tjmp    8048d07 &lt;phase_3+0x11c&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"> # 1</span><br><span class=\"line\"> 8048c66:\tc6 45 ff 6c          \tmovb   $0x6c,-0x1(%ebp)</span><br><span class=\"line\"> 8048c6a:\t8b 45 f0             \tmov    -0x10(%ebp),%eax</span><br><span class=\"line\"> 8048c6d:\t3d c7 03 00 00       \tcmp    $0x3c7,%eax</span><br><span class=\"line\"> 8048c72:\t0f 84 8f 00 00 00    \tje     8048d07 &lt;phase_3+0x11c&gt;</span><br><span class=\"line\"> 8048c78:\te8 69 0a 00 00       \tcall   80496e6 &lt;explode_bomb&gt;</span><br><span class=\"line\"> 8048c7d:\te9 85 00 00 00       \tjmp    8048d07 &lt;phase_3+0x11c&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"> # 2</span><br><span class=\"line\"> 8048c82:\tc6 45 ff 69          \tmovb   $0x69,-0x1(%ebp)</span><br><span class=\"line\"> 8048c86:\t8b 45 f0             \tmov    -0x10(%ebp),%eax</span><br><span class=\"line\"> 8048c89:\t3d 1e 02 00 00       \tcmp    $0x21e,%eax</span><br><span class=\"line\"> 8048c8e:\t74 77                \tje     8048d07 &lt;phase_3+0x11c&gt;</span><br><span class=\"line\"> 8048c90:\te8 51 0a 00 00       \tcall   80496e6 &lt;explode_bomb&gt;</span><br><span class=\"line\"> 8048c95:\teb 70                \tjmp    8048d07 &lt;phase_3+0x11c&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"># 3</span><br><span class=\"line\"> 8048c97:\tc6 45 ff 6e          \tmovb   $0x6e,-0x1(%ebp)</span><br><span class=\"line\"> 8048c9b:\t8b 45 f0             \tmov    -0x10(%ebp),%eax</span><br><span class=\"line\"> 8048c9e:\t3d 6a 03 00 00       \tcmp    $0x36a,%eax</span><br><span class=\"line\"> 8048ca3:\t74 62                \tje     8048d07 &lt;phase_3+0x11c&gt;</span><br><span class=\"line\"> 8048ca5:\te8 3c 0a 00 00       \tcall   80496e6 &lt;explode_bomb&gt;</span><br><span class=\"line\"> 8048caa:\teb 5b                \tjmp    8048d07 &lt;phase_3+0x11c&gt;</span><br><span class=\"line\"> 8048cac:\tc6 45 ff 6f          \tmovb   $0x6f,-0x1(%ebp)</span><br><span class=\"line\"></span><br><span class=\"line\"> # 4</span><br><span class=\"line\"> 8048cb0:\t8b 45 f0             \tmov    -0x10(%ebp),%eax</span><br><span class=\"line\"> 8048cb3:\t83 f8 3f             \tcmp    $0x3f,%eax</span><br><span class=\"line\"> 8048cb6:\t74 4f                \tje     8048d07 &lt;phase_3+0x11c&gt;</span><br><span class=\"line\"> 8048cb8:\te8 29 0a 00 00       \tcall   80496e6 &lt;explode_bomb&gt;</span><br><span class=\"line\"> 8048cbd:\teb 48                \tjmp    8048d07 &lt;phase_3+0x11c&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"> # 5</span><br><span class=\"line\"> 8048cbf:\tc6 45 ff 69          \tmovb   $0x69,-0x1(%ebp)</span><br><span class=\"line\"> 8048cc3:\t8b 45 f0             \tmov    -0x10(%ebp),%eax</span><br><span class=\"line\"> 8048cc6:\t3d 8f 00 00 00       \tcmp    $0x8f,%eax</span><br><span class=\"line\"> 8048ccb:\t74 3a                \tje     8048d07 &lt;phase_3+0x11c&gt;</span><br><span class=\"line\"> 8048ccd:\te8 14 0a 00 00       \tcall   80496e6 &lt;explode_bomb&gt;</span><br><span class=\"line\"> 8048cd2:\teb 33                \tjmp    8048d07 &lt;phase_3+0x11c&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"># 6</span><br><span class=\"line\"> 8048cd4:\tc6 45 ff 77          \tmovb   $0x77,-0x1(%ebp)\t\t\t# 77 å¯¹åº”å­—ç¬¦ w ä¸ºåæ–‡åŸ‹ä¸‹ä¼ç¬”</span><br><span class=\"line\"> 8048cd8:\t8b 45 f0             \tmov    -0x10(%ebp),%eax         # ebp - 0x10 æ˜¯ç¬¬ä¸‰ä¸ªè¾“å…¥çš„æ•°å­—</span><br><span class=\"line\">;  (gdb) p /x *0xffffcc78</span><br><span class=\"line\">; $31 = 0x1b1</span><br><span class=\"line\"> 8048cdb:\t3d b1 01 00 00       \tcmp    $0x1b1,%eax              # $0x1b1 = 433 ç¬¬ä¸‰ä¸ªæ•°å­—å’Œ 0x1b1 æ¯”è¾ƒ</span><br><span class=\"line\"> 8048ce0:\t74 25                \tje     8048d07 &lt;phase_3+0x11c&gt;</span><br><span class=\"line\"> 8048ce2:\te8 ff 09 00 00       \tcall   80496e6 &lt;explode_bomb&gt;</span><br><span class=\"line\"> 8048ce7:\teb 1e                \tjmp    8048d07 &lt;phase_3+0x11c&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"> # 7</span><br><span class=\"line\"> 8048ce9:\tc6 45 ff 76          \tmovb   $0x76,-0x1(%ebp)</span><br><span class=\"line\"> 8048ced:\t8b 45 f0             \tmov    -0x10(%ebp),%eax         </span><br><span class=\"line\"> 8048cf0:\t3d 9f 03 00 00       \tcmp    $0x39f,%eax</span><br><span class=\"line\"> 8048cf5:\t74 10                \tje     8048d07 &lt;phase_3+0x11c&gt;</span><br><span class=\"line\"> 8048cf7:\te8 ea 09 00 00       \tcall   80496e6 &lt;explode_bomb&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"> 8048cfc:\teb 09                \tjmp    8048d07 &lt;phase_3+0x11c&gt;</span><br><span class=\"line\"> 8048cfe:\tc6 45 ff 65          \tmovb   $0x65,-0x1(%ebp)        # çˆ†ç‚¸</span><br><span class=\"line\"> 8048d02:\te8 df 09 00 00       \tcall   80496e6 &lt;explode_bomb&gt;</span><br><span class=\"line\">  </span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>æ±‡ç¼–ä¸­ç”¨åˆ°å“ªé‡Œï¼ŒGDB å°±æŸ¥å“ªé‡Œã€‚<code>-0x10(%ebp)</code> æŒ‡å‘æˆ‘ä»¬ç¬¬ä¸‰ä¸ªè¾“å…¥çš„æ•°å­—ã€‚</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># è¿”å›</span><br><span class=\"line\"> 8048d07:\t0f b6 45 ef          \tmovzbl -0x11(%ebp),%eax        # é›¶æ‰©å±•ä¼ é€åˆ°eax</span><br><span class=\"line\">;  (gdb) p *(char*) 0xffffcc77</span><br><span class=\"line\">; $37 = 119 &#x27;w&#x27;</span><br><span class=\"line\"> 8048d0b:\t38 45 ff             \tcmp    %al,-0x1(%ebp)          # alæ˜¯raxçš„ä½å­—èŠ‚ ä¸Šæ–‡çš„ä¼ç¬”</span><br><span class=\"line\"> 8048d0e:\t74 05                \tje     8048d15 &lt;phase_3+0x12a&gt; # ç­‰äºæ‰æˆåŠŸï¼Œå¦åˆ™çˆ†ç‚¸</span><br><span class=\"line\"> 8048d10:\te8 d1 09 00 00       \tcall   80496e6 &lt;explode_bomb&gt;</span><br><span class=\"line\"> 8048d15:\tc9                   \tleave  </span><br><span class=\"line\"> 8048d16:\tc3                   \tret  </span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>æ±‡ç¼–ä¸­ç”¨åˆ°å“ªé‡Œï¼ŒGDB å°±æŸ¥å“ªé‡Œã€‚<code>-0x11(%ebp)</code> æŒ‡å‘æˆ‘ä»¬ç¬¬äºŒä¸ªè¾“å…¥çš„å­—ç¬¦ã€‚</p>\n</blockquote>\n<p>è§£æåŠè¦ç‚¹ï¼š</p>\n<ul>\n<li>æœ¬å±‚éœ€è¾“å…¥ 3 ä¸ªæ•°æ®ã€‚æ ¹æ®è·³è½¬è¡¨å†…å®¹è¾“å…¥ç¬¦åˆè¦æ±‚çš„æ•°å­—ã€‚æ¯”å¦‚ï¼š<code>6 w 433</code>ã€‚</li>\n</ul>\n<p>ç‚¹è¯„ä¸æç¤ºï¼š</p>\n<ul>\n<li>è¯†åˆ« <code>switch</code></li>\n<li>å–„ç”¨ <code>GDB</code></li>\n</ul>\n<h2 id=\"phase-4-é€’å½’å‡½æ•°\"><a class=\"markdownIt-Anchor\" href=\"#phase-4-é€’å½’å‡½æ•°\"></a> Phase 4 - é€’å½’å‡½æ•°</h2>\n<p>ç¬¬å››å±‚ä½¿ç”¨åˆ°äº†ä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å…ˆè§£è¯»è¿™ä¸ªå‡½æ•°ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">08048d17 &lt;func4&gt;:</span><br><span class=\"line\"> 8048d17:\t55                   \tpush   %ebp</span><br><span class=\"line\"> 8048d18:\t89 e5                \tmov    %esp,%ebp</span><br><span class=\"line\"> 8048d1a:\t53                   \tpush   %ebx</span><br><span class=\"line\"> 8048d1b:\t83 ec 08             \tsub    $0x8,%esp</span><br><span class=\"line\"> 8048d1e:\t83 7d 08 01          \tcmpl   $0x1,0x8(%ebp)            </span><br><span class=\"line\"> 8048d22:\t7f 09                \tjg     8048d2d &lt;func4+0x16&gt;  # if x&gt;1</span><br><span class=\"line\"> 8048d24:\tc7 45 f8 01 00 00 00 \tmovl   $0x1,-0x8(%ebp)       # else</span><br><span class=\"line\"> 8048d2b:\teb 21                \tjmp    8048d4e &lt;func4+0x37&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"> 8048d2d:\t8b 45 08             \tmov    0x8(%ebp),%eax        # if x&gt;1</span><br><span class=\"line\"> 8048d30:\t48                   \tdec    %eax              </span><br><span class=\"line\"> 8048d31:\t89 04 24             \tmov    %eax,(%esp)           # x-1 ä½œä¸ºå‚æ•°é€’å½’</span><br><span class=\"line\"> 8048d34:\te8 de ff ff ff       \tcall   8048d17 &lt;func4&gt;</span><br><span class=\"line\"> 8048d39:\t89 c3                \tmov    %eax,%ebx             # f(x-1) çš„ç»“æœæš‚å­˜</span><br><span class=\"line\"> 8048d3b:\t8b 45 08             \tmov    0x8(%ebp),%eax</span><br><span class=\"line\"> 8048d3e:\t83 e8 02             \tsub    $0x2,%eax      </span><br><span class=\"line\"> 8048d41:\t89 04 24             \tmov    %eax,(%esp)           # x-2 ä½œä¸ºå‚æ•°é€’å½’</span><br><span class=\"line\"> 8048d44:\te8 ce ff ff ff       \tcall   8048d17 &lt;func4&gt;</span><br><span class=\"line\"> 8048d49:\t01 c3                \tadd    %eax,%ebx             # f(x-1) çš„ç»“æœ+f(x-1)</span><br><span class=\"line\"> 8048d4b:\t89 5d f8             \tmov    %ebx,-0x8(%ebp)       # ä½œä¸ºè¿”å›ç»“æœ</span><br><span class=\"line\"></span><br><span class=\"line\"> 8048d4e:\t8b 45 f8             \tmov    -0x8(%ebp),%eax # 1 è¿”å›1</span><br><span class=\"line\"> 8048d51:\t83 c4 08             \tadd    $0x8,%esp</span><br><span class=\"line\"> 8048d54:\t5b                   \tpop    %ebx</span><br><span class=\"line\"> 8048d55:\t5d                   \tpop    %ebp</span><br><span class=\"line\"> 8048d56:\tc3                   \tret   </span><br></pre></td></tr></table></figure>\n<p>ä¸éš¾çœ‹å‡ºæ˜¯ä¸ªé€’å½’æ±‚æ–æ³¢é‚£å¥‘æ•°åˆ—çš„å‡½æ•°ï¼š</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">func4(x)&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> x&gt;<span class=\"number\">1</span>:</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> func4(x<span class=\"number\">-1</span>)+func4(x<span class=\"number\">-2</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">else</span>:</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// è¾“å…¥ï¼š0 1 2 3 4 5 ... 13</span></span><br><span class=\"line\"><span class=\"comment\">// è¾“å‡ºï¼š1 1 2 3 5 8 ... 377</span></span><br></pre></td></tr></table></figure>\n<p>ç¬¬å››å±‚çš„é€»è¾‘æ›´åŠ ç®€å•ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">08048d57 &lt;phase_4&gt;:</span><br><span class=\"line\"> 8048d57:\t55                   \tpush   %ebp</span><br><span class=\"line\"> 8048d58:\t89 e5                \tmov    %esp,%ebp</span><br><span class=\"line\"> 8048d5a:\t83 ec 28             \tsub    $0x28,%esp</span><br><span class=\"line\"> 8048d5d:\t8d 45 f4             \tlea    -0xc(%ebp),%eax</span><br><span class=\"line\"> 8048d60:\t89 44 24 08          \tmov    %eax,0x8(%esp)</span><br><span class=\"line\"> 8048d64:\tc7 44 24 04 34 9a 04 \tmovl   $0x8049a34,0x4(%esp) #  0x8049a34 -&gt; &quot;%d&quot;</span><br><span class=\"line\"> 8048d6b:\t08 </span><br><span class=\"line\"> 8048d6c:\t8b 45 08             \tmov    0x8(%ebp),%eax</span><br><span class=\"line\"> 8048d6f:\t89 04 24             \tmov    %eax,(%esp)</span><br><span class=\"line\"> 8048d72:\te8 f1 fa ff ff       \tcall   8048868 &lt;sscanf@plt&gt;</span><br><span class=\"line\"> 8048d77:\t89 45 fc             \tmov    %eax,-0x4(%ebp)      </span><br><span class=\"line\"> 8048d7a:\t83 7d fc 01          \tcmpl   $0x1,-0x4(%ebp)      # åªèƒ½è¾“å…¥ä¸€ä¸ªæ•°iï¼Œå¦åˆ™çˆ†ç‚¸</span><br><span class=\"line\"> 8048d7e:\t75 07                \tjne    8048d87 &lt;phase_4+0x30&gt; # è·³è½¬åˆ°çˆ†ç‚¸</span><br><span class=\"line\"> 8048d80:\t8b 45 f4             \tmov    -0xc(%ebp),%eax  #   -0xc(%ebp)å­˜æ”¾æˆ‘ä»¬ç¬¬ä¸€ä¸ªè¾“å…¥çš„æ•°i   </span><br><span class=\"line\">;  (gdb) p  *0xffffcc7c</span><br><span class=\"line\">; $42 = 13</span><br><span class=\"line\"> 8048d83:\t85 c0                \ttest   %eax,%eax            # -0xc(%ebp) ä¸èƒ½ä¸ºé›¶</span><br><span class=\"line\"> 8048d85:\t7f 05                \tjg     8048d8c &lt;phase_4+0x35&gt; # å¤§äºæ‰æˆåŠŸï¼Œå¦åˆ™çˆ†ç‚¸</span><br><span class=\"line\"> 8048d87:\te8 5a 09 00 00       \tcall   80496e6 &lt;explode_bomb&gt;</span><br><span class=\"line\"> 8048d8c:\t8b 45 f4             \tmov    -0xc(%ebp),%eax</span><br><span class=\"line\"> 8048d8f:\t89 04 24             \tmov    %eax,(%esp)          # å°†æ•°å­—ä¼ å‚</span><br><span class=\"line\"> 8048d92:\te8 80 ff ff ff       \tcall   8048d17 &lt;func4&gt;      # i è¿›å…¥å‡½æ•°func4</span><br><span class=\"line\"></span><br><span class=\"line\"> 8048d97:\t89 45 f8             \tmov    %eax,-0x8(%ebp)</span><br><span class=\"line\"> 8048d9a:\t81 7d f8 79 01 00 00 \tcmpl   $0x179,-0x8(%ebp)    # ç»“æœå¿…é¡»ä¸º 0x179 = 377 (æ–æ³¢é‚£å¥‘æ•°åˆ—ç¬¬13é¡¹)</span><br><span class=\"line\"> 8048da1:\t74 05                \tje     8048da8 &lt;phase_4+0x51&gt; # ç­‰äºæ‰æˆåŠŸï¼Œå¦åˆ™çˆ†ç‚¸</span><br><span class=\"line\"> 8048da3:\te8 3e 09 00 00       \tcall   80496e6 &lt;explode_bomb&gt;</span><br><span class=\"line\"> 8048da8:\tc9                   \tleave  </span><br><span class=\"line\"> 8048da9:\tc3                   \tret  </span><br></pre></td></tr></table></figure>\n<p>è§£æåŠè¦ç‚¹ï¼š</p>\n<ul>\n<li>æœ¬å±‚éœ€è¾“å…¥ 1 ä¸ªæ•°æ®ã€‚ä½¿å¾—å‡½æ•°çš„è¾“å‡ºç»“æœä¸ç»™å®šæ•°å­—ç›¸ç­‰ã€‚åœ¨è¿™é‡Œä¸º <code>13</code></li>\n</ul>\n<p>ç‚¹è¯„ä¸æç¤ºï¼š</p>\n<ul>\n<li>ä¼šè¯»é€’å½’å‡½æ•°</li>\n</ul>\n<h2 id=\"phase-5-ç®—æ•°\"><a class=\"markdownIt-Anchor\" href=\"#phase-5-ç®—æ•°\"></a> Phase 5 - ç®—æ•°</h2>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">08048daa &lt;phase_5&gt;:</span><br><span class=\"line\"> 8048daa:\t55                   \tpush   %ebp</span><br><span class=\"line\"> 8048dab:\t89 e5                \tmov    %esp,%ebp</span><br><span class=\"line\"> 8048dad:\t83 ec 18             \tsub    $0x18,%esp</span><br><span class=\"line\"> 8048db0:\t8b 45 08             \tmov    0x8(%ebp),%eax</span><br><span class=\"line\"> 8048db3:\t89 04 24             \tmov    %eax,(%esp)</span><br><span class=\"line\"> 8048db6:\te8 3a 03 00 00       \tcall   80490f5 &lt;string_length&gt;</span><br><span class=\"line\"> 8048dbb:\t89 45 fc             \tmov    %eax,-0x4(%ebp)</span><br><span class=\"line\"> 8048dbe:\t83 7d fc 06          \tcmpl   $0x6,-0x4(%ebp)</span><br><span class=\"line\"> 8048dc2:\t74 05                \tje     8048dc9 &lt;phase_5+0x1f&gt; # è¾“å…¥çš„å­—ç¬¦ä¸²é•¿åº¦å¿…é¡»ä¸º 6 </span><br><span class=\"line\"> 8048dc4:\te8 1d 09 00 00       \tcall   80496e6 &lt;explode_bomb&gt;</span><br><span class=\"line\"> 8048dc9:\tc7 45 f8 00 00 00 00 \tmovl   $0x0,-0x8(%ebp)        # result = 0</span><br><span class=\"line\"> 8048dd0:\tc7 45 f4 00 00 00 00 \tmovl   $0x0,-0xc(%ebp)\t\t  # i = 0</span><br><span class=\"line\"> 8048dd7:\teb 1c                \tjmp    8048df5 &lt;phase_5+0x4b&gt;</span><br></pre></td></tr></table></figure>\n<p>æˆ‘ä»¬çœ‹åˆ°åæ–‡è€æ˜¯å‡ºç° <code>-0x8(%ebp)</code>ï¼Œ<code>-0xc(%ebp)</code>ã€‚åˆçœ‹åˆ°ç†Ÿæ‚‰çš„å¾ªç¯ç»“æ„ï¼Œå¹²è„†åˆ†åˆ«å®šä¹‰å˜é‡ <code>result</code>ï¼Œ<code>i</code> è¾…åŠ©æˆ‘ä»¬è¿›è¡Œåˆ†æã€‚</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># å¾ªç¯å¼€å§‹</span><br><span class=\"line\"> 8048dd9:\t8b 45 f4             \tmov    -0xc(%ebp),%eax</span><br><span class=\"line\"> 8048ddc:\t03 45 08             \tadd    0x8(%ebp),%eax  # 0x804a9a0 + i å°±æ˜¯éå†è¾“å…¥çš„å­—ç¬¦ä¸²</span><br><span class=\"line\"></span><br><span class=\"line\"> 8048ddf:\t0f b6 00             \tmovzbl (%eax),%eax</span><br><span class=\"line\"> 8048de2:\t0f be c0             \tmovsbl %al,%eax</span><br><span class=\"line\"> 8048de5:\t83 e0 0f             \tand    $0xf,%eax       # å¯¹æ¯ä¸€ä¸ªå­—ç¬¦ä¸²å–ä½ä½å­—èŠ‚ å¾—åˆ° k</span><br><span class=\"line\"> 8048de8:\t8b 04 85 c0 a5 04 08 \tmov    0x804a5c0(,%eax,4),%eax # å– arr[k]</span><br><span class=\"line\"></span><br><span class=\"line\"> 8048def:\t01 45 f8             \tadd    %eax,-0x8(%ebp)          # result += arr[k]</span><br><span class=\"line\"> 8048df2:\tff 45 f4             \tincl   -0xc(%ebp)\t\t\t\t# i++</span><br><span class=\"line\"></span><br><span class=\"line\"> 8048df5:\t83 7d f4 05          \tcmpl   $0x5,-0xc(%ebp)</span><br><span class=\"line\"> 8048df9:\t7e de                \tjle    8048dd9 &lt;phase_5+0x2f&gt;  # i &lt;= 5 ç»§ç»­å¾ªç¯</span><br><span class=\"line\"> 8048dfb:\t83 7d f8 24          \tcmpl   $0x24,-0x8(%ebp)\t\t\t# result == 36</span><br><span class=\"line\"> 8048dff:\t74 05                \tje     8048e06 &lt;phase_5+0x5c&gt;   # å¿…é¡»ç›¸ç­‰</span><br><span class=\"line\"> 8048e01:\te8 e0 08 00 00       \tcall   80496e6 &lt;explode_bomb&gt;</span><br><span class=\"line\"> 8048e06:\tc9                   \tleave  </span><br><span class=\"line\"> 8048e07:\tc3                   \tret    </span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(gdb) p  (char*) 0x804a9a0</span><br><span class=\"line\">$56 = 0x804a9a0 &lt;input_strings+320&gt; &quot;@@BBAA&quot;  # å‡è®¾è¾“å…¥çš„å­—ç¬¦ä¸²ä¸º `@@BBAA`</span><br><span class=\"line\"># 0x804a5c0: &#123;2, 10, 6, 1, 12, 16, 9, 3, 4, 7, 14, 5, 11, 8, 15, 13,     ...&#125;</span><br></pre></td></tr></table></figure>\n<p><code>0x804a9a0</code> æ˜¯ä¸€ä¸ªæ•°ç»„ arr çš„åœ°å€ï¼Œæˆ‘ä»¬éœ€è¦è¾“å…¥åŒ…å« 6 ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²ï¼š</p>\n<ul>\n<li>æ¯ä¸ªå­—ç¬¦çš„ä½ 4 ä½ä½œä¸ºæ•°ç»„ arr çš„ç´¢å¼• iã€‚</li>\n<li>æœ¬ä¾‹ä¸­ï¼Œéœ€è¦ä½¿å¾— <code>arr[0]</code>+<code>arr[1]</code>+â€¦+<code>arr[5]</code> çš„æ€»å’Œä¸º 36 å³å¯é€šå…³ã€‚</li>\n</ul>\n<p>ä¾‹å¦‚ï¼š</p>\n<ul>\n<li>36 = 2+2+6+6+10+10</li>\n<li>å„åŠ æ•°å¯¹åº”æ•°ç»„çš„åºå·ä¸º 0 0 2 2 1 1</li>\n<li>ASCII ä¸­ï¼Œ<code>@</code>ï¼š0x40   <code>B</code>ï¼š0x42  <code>A</code>ï¼š0x41ï¼Œä¹Ÿå°±æ˜¯å¯¹åº”åºå· 0, 2, 1</li>\n<li>ç­”æ¡ˆå³ä¸º <code>@@BBAA</code></li>\n</ul>\n<p>è§£æåŠè¦ç‚¹ï¼š</p>\n<ul>\n<li>æœ¬å±‚éœ€è¾“å…¥åˆé€‚å­—ç¬¦ä¸²æŒ‡ç¤ºæ•°ç»„çš„ä¸‹æ ‡ï¼Œä½¿å¾—ä¸‹æ ‡å¯¹åº”æ•°ç»„æ•°å­—ä¹‹å’Œç­‰äºæŒ‡å®šå€¼å³å¯ã€‚</li>\n<li>çŸ¥é“è¾“å…¥å­—ç¬¦ä¸²çš„å­˜å‚¨ä½ç½®</li>\n</ul>\n<p>ç‚¹è¯„ä¸æç¤ºï¼š</p>\n<ul>\n<li>æ±‡ç¼–çš„èä¼šè´¯é€š</li>\n</ul>\n<h2 id=\"phase-6-é“¾è¡¨æ’åº\"><a class=\"markdownIt-Anchor\" href=\"#phase-6-é“¾è¡¨æ’åº\"></a> Phase 6 - é“¾è¡¨æ’åº</h2>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">08048e08 &lt;phase_6&gt;:</span><br><span class=\"line\"> 8048e08:\t55                   \tpush   %ebp</span><br><span class=\"line\"> 8048e09:\t89 e5                \tmov    %esp,%ebp</span><br><span class=\"line\"> 8048e0b:\t83 ec 48             \tsub    $0x48,%esp</span><br><span class=\"line\"> 8048e0e:\tc7 45 f0 3c a6 04 08 \tmovl   $0x804a63c,-0x10(%ebp) # $0x804a63c-&gt; 0x329</span><br><span class=\"line\"> 8048e15:\t8d 45 d8             \tlea    -0x28(%ebp),%eax</span><br><span class=\"line\"> 8048e18:\t89 44 24 04          \tmov    %eax,0x4(%esp)</span><br><span class=\"line\"> 8048e1c:\t8b 45 08             \tmov    0x8(%ebp),%eax</span><br><span class=\"line\"> 8048e1f:\t89 04 24             \tmov    %eax,(%esp)</span><br><span class=\"line\"> 8048e22:\te8 65 02 00 00       \tcall   804908c &lt;read_six_numbers&gt;</span><br><span class=\"line\"> 8048e27:\tc7 45 f8 00 00 00 00 \tmovl   $0x0,-0x8(%ebp)        # i=0</span><br><span class=\"line\"> 8048e2e:\teb 48                \tjmp    8048e78 &lt;phase_6+0x70&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"># å¾ªç¯A ------- å¼€å§‹ ç”¨äºåˆ¤æ–­ï¼šæ¯ä¸ªå…ƒç´ ä¸ç›¸ç­‰ï¼Œä¸”æ¯ä¸ªå…ƒç´ ä¸ä¸º0</span><br><span class=\"line\"> 8048e30:\t8b 45 f8             \tmov    -0x8(%ebp),%eax</span><br><span class=\"line\"> 8048e33:\t8b 44 85 d8          \tmov    -0x28(%ebp,%eax,4),%eax  # -0x28(%ebp) çš„ä½ç½®æ˜¯è¾“å…¥æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ </span><br><span class=\"line\"> 8048e37:\t85 c0                \ttest   %eax,%eax   </span><br><span class=\"line\"> 8048e39:\t7e 0c                \tjle    8048e47 &lt;phase_6+0x3f&gt;  # arr[i] == 0 è·³è½¬çˆ†ç‚¸</span><br><span class=\"line\"> 8048e3b:\t8b 45 f8             \tmov    -0x8(%ebp),%eax         # arr[i] != 0</span><br><span class=\"line\"> 8048e3e:\t8b 44 85 d8          \tmov    -0x28(%ebp,%eax,4),%eax</span><br><span class=\"line\"> 8048e42:\t83 f8 06             \tcmp    $0x6,%eax               </span><br><span class=\"line\"> 8048e45:\t7e 05                \tjle    8048e4c &lt;phase_6+0x44&gt;  # arr[i]&lt;= 6 å¦åˆ™çˆ†ç‚¸</span><br><span class=\"line\"> 8048e47:\te8 9a 08 00 00       \tcall   80496e6 &lt;explode_bomb&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"> 8048e4c:\t8b 45 f8             \tmov    -0x8(%ebp),%eax</span><br><span class=\"line\"> 8048e4f:\t40                   \tinc    %eax\t\t\t\t\t# i++</span><br><span class=\"line\"> 8048e50:\t89 45 fc             \tmov    %eax,-0x4(%ebp)      # å­˜å‚¨ti = i+1</span><br><span class=\"line\"> 8048e53:\teb 1a                \tjmp    8048e6f &lt;phase_6+0x67&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"> 8048e55:\t8b 45 f8             \tmov    -0x8(%ebp),%eax</span><br><span class=\"line\"> 8048e58:\t8b 54 85 d8          \tmov    -0x28(%ebp,%eax,4),%edx  # edx = arr[i]</span><br><span class=\"line\"> 8048e5c:\t8b 45 fc             \tmov    -0x4(%ebp),%eax</span><br><span class=\"line\"> 8048e5f:\t8b 44 85 d8          \tmov    -0x28(%ebp,%eax,4),%eax  # eax = arr[i+1]</span><br><span class=\"line\"> 8048e63:\t39 c2                \tcmp    %eax,%edx</span><br><span class=\"line\"> 8048e65:\t75 05                \tjne    8048e6c &lt;phase_6+0x64&gt;   # å¿…é¡» arr[i] != arr[i+1] å¦åˆ™çˆ†ç‚¸</span><br><span class=\"line\"> 8048e67:\te8 7a 08 00 00       \tcall   80496e6 &lt;explode_bomb&gt;</span><br><span class=\"line\"> 8048e6c:\tff 45 fc             \tincl   -0x4(%ebp)               # ti++</span><br><span class=\"line\"></span><br><span class=\"line\"> 8048e6f:\t83 7d fc 05          \tcmpl   $0x5,-0x4(%ebp)\t\t</span><br><span class=\"line\"> 8048e73:\t7e e0                \tjle    8048e55 &lt;phase_6+0x4d&gt; # ti&lt;=5 åˆ™è·³è½¬</span><br><span class=\"line\"> 8048e75:\tff 45 f8             \tincl   -0x8(%ebp)             # i+1==5 ,i++ , i=6  å³å°†é€€å‡ºå¾ªç¯</span><br><span class=\"line\"></span><br><span class=\"line\"> 8048e78:\t83 7d f8 05          \tcmpl   $0x5,-0x8(%ebp)</span><br><span class=\"line\"> 8048e7c:\t7e b2                \tjle    8048e30 &lt;phase_6+0x28&gt;  # i&lt;=5 å¾ªç¯ï¼ˆéå†6ä¸ªå…ƒç´ ï¼‰</span><br><span class=\"line\"> # å¾ªç¯A ---- ------ ç»“æŸ</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"> 8048e7e:\tc7 45 f8 00 00 00 00 \tmovl   $0x0,-0x8(%ebp)\t\t# j=0</span><br><span class=\"line\"> 8048e85:\teb 34                \tjmp    8048ebb &lt;phase_6+0xb3&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"> # å¾ªç¯B å¼€å§‹ ---- å°†æ•°ç»„å¹³ç§»åˆ°å†…å­˜ä¸­çš„ç‰¹å®šçš„ä½ç½®$0x804a63c å¼€å§‹çš„ä½ç½®ï¼Œ8ä½éš”å¼€</span><br><span class=\"line\"> # è¿™æ˜¯ä¸ªé“¾è¡¨</span><br><span class=\"line\"> 8048e87:\t8b 45 f0             \tmov    -0x10(%ebp),%eax     # æ˜¯ä¸ªåœ°å€$0x804a63cï¼Œæå‰å­˜æœ‰ 0x329 = 809</span><br><span class=\"line\"> 8048e8a:\t89 45 f4             \tmov    %eax,-0xc(%ebp)      # t[1] è¡¨ç¤ºä¸Šä¸€æ¬¡çš„è®¡ç®—ç»“æœ = $0x804a63c</span><br><span class=\"line\"> 8048e8d:\tc7 45 fc 01 00 00 00 \tmovl   $0x1,-0x4(%ebp)      # tj = 1</span><br><span class=\"line\"> 8048e94:\teb 0c                \tjmp    8048ea2 &lt;phase_6+0x9a&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"> 8048e96:\t8b 45 f4             \tmov    -0xc(%ebp),%eax      # t[0]åœ°å€$0x804a63c</span><br><span class=\"line\"> 8048e99:\t8b 40 08             \tmov    0x8(%eax),%eax\t\t# 0x8(%eax) =$0x804a644 -&gt; $0x804a630</span><br><span class=\"line\"> 8048e9c:\t89 45 f4             \tmov    %eax,-0xc(%ebp)      # é“¾è¡¨ç»“ç‚¹ä¸‹ç§»</span><br><span class=\"line\"> 8048e9f:\tff 45 fc             \tincl   -0x4(%ebp)           # tj++</span><br><span class=\"line\"></span><br><span class=\"line\"> 8048ea2:\t8b 45 f8             \tmov    -0x8(%ebp),%eax</span><br><span class=\"line\"> 8048ea5:\t8b 44 85 d8          \tmov    -0x28(%ebp,%eax,4),%eax # arr[j]</span><br><span class=\"line\"> 8048ea9:\t3b 45 fc             \tcmp    -0x4(%ebp),%eax         # tj</span><br><span class=\"line\"> 8048eac:\t7f e8                \tjg     8048e96 &lt;phase_6+0x8e&gt;  # arr[j]&gt;tj å¤§äº</span><br><span class=\"line\"></span><br><span class=\"line\"> 8048eae:\t8b 55 f8             \tmov    -0x8(%ebp),%edx         # edx = j</span><br><span class=\"line\"> 8048eb1:\t8b 45 f4             \tmov    -0xc(%ebp),%eax\t\t   # eax = t[0]</span><br><span class=\"line\"> 8048eb4:\t89 44 95 c0          \tmov    %eax,-0x40(%ebp,%edx,4) # å­˜å‚¨ç»Ÿè®¡ç»“æœ</span><br><span class=\"line\"> 8048eb8:\tff 45 f8             \tincl   -0x8(%ebp)              # j++</span><br><span class=\"line\"></span><br><span class=\"line\"> 8048ebb:\t83 7d f8 05          \tcmpl   $0x5,-0x8(%ebp)</span><br><span class=\"line\"> 8048ebf:\t7e c6                \tjle    8048e87 &lt;phase_6+0x7f&gt; # j&lt;=5 å¾ªç¯ï¼ˆéå†6ä¸ªå…ƒç´ ï¼‰</span><br><span class=\"line\"># å¾ªç¯B ------------------------ ç»“æŸ</span><br><span class=\"line\"></span><br><span class=\"line\"> 8048ec1:\t8b 45 c0             \tmov    -0x40(%ebp),%eax   # arr8[0]</span><br><span class=\"line\"> 8048ec4:\t89 45 f0             \tmov    %eax,-0x10(%ebp)   #  </span><br><span class=\"line\"> 8048ec7:\t8b 45 f0             \tmov    -0x10(%ebp),%eax</span><br><span class=\"line\"> 8048eca:\t89 45 f4             \tmov    %eax,-0xc(%ebp)    # t[1] å­˜å‚¨ä¸Šä¸€æ¬¡è¿ç®—ç»“æœ = arr8[0]</span><br><span class=\"line\"> 8048ecd:\tc7 45 f8 01 00 00 00 \tmovl   $0x1,-0x8(%ebp)    # k = 1</span><br><span class=\"line\"> 8048ed4:\teb 19                \tjmp    8048eef &lt;phase_6+0xe7&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"># å¾ªç¯C ------------------------- å¼€å§‹ è°ƒæ•´é“¾è¡¨å†…çš„é¡ºåº</span><br><span class=\"line\"> 8048ed6:\t8b 45 f8             \tmov    -0x8(%ebp),%eax    # k</span><br><span class=\"line\"> 8048ed9:\t8b 54 85 c0          \tmov    -0x40(%ebp,%eax,4),%edx # edx = arr8[k]</span><br><span class=\"line\"> 8048edd:\t8b 45 f4             \tmov    -0xc(%ebp),%eax         # eax = $0x804a63c</span><br><span class=\"line\"> 8048ee0:\t89 50 08             \tmov    %edx,0x8(%eax)          # $0x804a63c+8 = arr8[k]</span><br><span class=\"line\"> 8048ee3:\t8b 45 f4             \tmov    -0xc(%ebp),%eax</span><br><span class=\"line\"> 8048ee6:\t8b 40 08             \tmov    0x8(%eax),%eax          # $0x804a63c+8</span><br><span class=\"line\"> 8048ee9:\t89 45 f4             \tmov    %eax,-0xc(%ebp)         # åŸºåœ°å€ä¸Šç§»8</span><br><span class=\"line\"> 8048eec:\tff 45 f8             \tincl   -0x8(%ebp)          # k++</span><br><span class=\"line\"></span><br><span class=\"line\"> 8048eef:\t83 7d f8 05          \tcmpl   $0x5,-0x8(%ebp)  </span><br><span class=\"line\"> 8048ef3:\t7e e1                \tjle    8048ed6 &lt;phase_6+0xce&gt;  # k&lt;=5 å¾ªç¯ï¼ˆéå†5ä¸ªå…ƒç´ ï¼Œå› ä¸ºkä»1å¼€å§‹çš„ï¼‰</span><br><span class=\"line\"># å¾ªç¯C -------------------------- ç»“æŸ</span><br><span class=\"line\"></span><br><span class=\"line\"> 8048ef5:\t8b 45 f4             \tmov    -0xc(%ebp),%eax</span><br><span class=\"line\"> 8048ef8:\tc7 40 08 00 00 00 00 \tmovl   $0x0,0x8(%eax)   # åŸºå€è®¾ç½®ä¸º0</span><br><span class=\"line\"> 8048eff:\t8b 45 f0             \tmov    -0x10(%ebp),%eax # é‡æ–°è·å–$0x804a63c</span><br><span class=\"line\"> 8048f02:\t89 45 f4             \tmov    %eax,-0xc(%ebp)</span><br><span class=\"line\"> 8048f05:\tc7 45 f8 00 00 00 00 \tmovl   $0x0,-0x8(%ebp) # l = 0</span><br><span class=\"line\"> 8048f0c:\teb 22                \tjmp    8048f30 &lt;phase_6+0x128&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"># å¾ªç¯ D -------- å¼€å§‹ï¼šå·¦è¾¹çš„æ•°å¤§äºå³è¾¹çš„æ•°</span><br><span class=\"line\"> 8048f0e:\t8b 45 f4             \tmov    -0xc(%ebp),%eax # $0x804a63c</span><br><span class=\"line\"> 8048f11:\t8b 10                \tmov    (%eax),%edx</span><br><span class=\"line\"> 8048f13:\t8b 45 f4             \tmov    -0xc(%ebp),%eax</span><br><span class=\"line\"> 8048f16:\t8b 40 08             \tmov    0x8(%eax),%eax</span><br><span class=\"line\"> 8048f19:\t8b 00                \tmov    (%eax),%eax</span><br><span class=\"line\"> 8048f1b:\t39 c2                \tcmp    %eax,%edx       # ç›¸éš” 8  çš„ä¸¤ä¸ªåŸºå€</span><br><span class=\"line\"> 8048f1d:\t7d 05                \tjge    8048f24 &lt;phase_6+0x11c&gt; #å¿…é¡»ï¼š å·¦åŸºå€ &gt;= å³åŸºå€ </span><br><span class=\"line\"> 8048f1f:\te8 c2 07 00 00       \tcall   80496e6 &lt;explode_bomb&gt;</span><br><span class=\"line\"> 8048f24:\t8b 45 f4             \tmov    -0xc(%ebp),%eax</span><br><span class=\"line\"> 8048f27:\t8b 40 08             \tmov    0x8(%eax),%eax # åŸºå€+8</span><br><span class=\"line\"> 8048f2a:\t89 45 f4             \tmov    %eax,-0xc(%ebp) # åŸºå€æ›´æ–°</span><br><span class=\"line\"> 8048f2d:\tff 45 f8             \tincl   -0x8(%ebp)     # l++</span><br><span class=\"line\"></span><br><span class=\"line\"> 8048f30:\t83 7d f8 04          \tcmpl   $0x4,-0x8(%ebp) # l&lt;=4 5 æ¬¡</span><br><span class=\"line\"> 8048f34:\t7e d8                \tjle    8048f0e &lt;phase_6+0x106&gt;</span><br><span class=\"line\"># å¾ªç¯Dç»“æŸ</span><br><span class=\"line\"></span><br><span class=\"line\"> 8048f36:\tc9                   \tleave  </span><br><span class=\"line\"> 8048f37:\tc3                   \tret   </span><br></pre></td></tr></table></figure>\n<p>æœ¬ä¾‹ä¸­å‡ºç°çš„é­”æ•° <code>0x804a63c</code> ä¸ºé“¾è¡¨å¤´ç»“ç‚¹åœ°å€ï¼Œé€šè¿‡ GDB æˆ‘ä»¬å¯ä»¥å¾—çŸ¥é“¾è¡¨ç»“ç‚¹åœ°å€ä»¥åŠå­˜å‚¨çš„å€¼ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">; 0x804a63c 0x329</span><br><span class=\"line\">; 0x804a630 0x124</span><br><span class=\"line\">; 0x804a638 0x325</span><br><span class=\"line\">; 0x804a62c 0x178</span><br><span class=\"line\">; 0x804a620 0x207</span><br><span class=\"line\">; 0x804a614 0x92</span><br><span class=\"line\">; 0x804a608 0x00 NULL</span><br></pre></td></tr></table></figure>\n<p>è¾“å…¥çš„æ•°ç»„è¦æ±‚ï¼š</p>\n<ol>\n<li>6 ä¸ªæ•°å­—äº’ä¸ç›¸åŒï¼ŒèŒƒå›´ 1~6</li>\n<li>ç¬¬ n ä¸ªæ•°å­—å€¼ vï¼Œä»£è¡¨ç¬¬ n ä¸ªç»“ç‚¹æ’åºåçš„ä½ç½®ä¸º v</li>\n<li>ç»“ç‚¹æ’åºåçš„ç»“æœä¸ºï¼šç»“ç‚¹ä»£è¡¨çš„å€¼é™åºæ’åº</li>\n</ol>\n<p>è§£æåŠè¦ç‚¹ï¼š</p>\n<ul>\n<li>æœ¬å±‚éœ€è¾“å…¥ 6 ä¸ªæ•°å­—å¯¹é“¾è¡¨è¿›è¡Œæ’åºï¼Œä½¿å¾—æ’åºç»“æœæ»¡è¶³ç›®æ ‡è¦æ±‚</li>\n<li>å¿…é¡»è¯†åˆ«å‡ºè¿™æ˜¯ä¸ªé“¾è¡¨</li>\n<li>é€ä¸ªå¾ªç¯é˜…è¯»</li>\n</ul>\n<p>ç‚¹è¯„ä¸æç¤ºï¼š</p>\n<ul>\n<li>è€å¿ƒè€å¿ƒè€å¿ƒ</li>\n</ul>\n<h2 id=\"secret-phase\"><a class=\"markdownIt-Anchor\" href=\"#secret-phase\"></a> Secret Phase</h2>\n<p>æ‹†é™¤ç‚¸å¼¹å„å±‚çš„æç¤ºè¯­å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Welcome to my fiendish little bomb. You have 6 phases with</span><br><span class=\"line\">which to blow yourself up. Have a nice day!</span><br><span class=\"line\">Phase 1 defused. How about the next one?</span><br><span class=\"line\">That&#x27;s number 2.  Keep going!</span><br><span class=\"line\">Halfway there!</span><br><span class=\"line\">So you got that one.  Try this one.</span><br><span class=\"line\">Good work!  On to the next...</span><br><span class=\"line\">Congratulations! You&#x27;ve defused the bomb!</span><br></pre></td></tr></table></figure>\n<p>ä½†è¿™å¹¶ä¸æ„å‘³ç€ç‚¸å¼¹å·²ç»æ‹†é™¤å®Œæˆï¼Œæ³¨æ„åˆ° <code>bomb.c</code> æ–‡ä»¶ä¸­æœ‰é‚ªæ¶åšå£«ğŸ˜ˆåœ¨æœ€åä¸€å±‚ç‚¸å¼¹æ‹†é™¤æ—¶ç•™ä¸‹çš„æ³¨é‡Šï¼š</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/* Wow, they got it!  But isn&#x27;t something... missing?  Perhaps</span></span><br><span class=\"line\"><span class=\"comment\">* something they overlooked?  Mua ha ha ha ha! */</span></span><br></pre></td></tr></table></figure>\n<p>åæ±‡ç¼–å¾—åˆ°çš„æ±‡ç¼–ä»£ç ä¸­è¿˜å­˜åœ¨ä¸€äº›éšè—å†…å®¹ï¼š<code>&lt;func7&gt;</code> ä»¥åŠ <code>&lt;secret_phase&gt;</code> å‡½æ•°ã€‚</p>\n<p>è¿™éƒ¨åˆ†å°±ç•™ç»™è¯»è€…è‡ªå·±è§£å†³å•¦~~ åæ­£åŠ©æ•™é€šè¿‡æˆ‘çš„å®éªŒäº†ï¼Œä¸ºäº†ã€Œå®Œç¾ä¸»ä¹‰ã€ï¼Œæˆ‘æœ‰æ—¶é—´åœ¨å¼„å§ã€‚</p>\n<blockquote>\n<p>çœ‹èµ·æ¥ä¸å¤šå‘¢ã€‚</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">08048f38 &lt;fun7&gt;:</span><br><span class=\"line\"> 8048f38:\t55                   \tpush   %ebp</span><br><span class=\"line\"> 8048f39:\t89 e5                \tmov    %esp,%ebp</span><br><span class=\"line\"> 8048f3b:\t83 ec 0c             \tsub    $0xc,%esp</span><br><span class=\"line\"> 8048f3e:\t83 7d 08 00          \tcmpl   $0x0,0x8(%ebp)</span><br><span class=\"line\"> 8048f42:\t75 09                \tjne    8048f4d &lt;fun7+0x15&gt;</span><br><span class=\"line\"> 8048f44:\tc7 45 fc ff ff ff ff \tmovl   $0xffffffff,-0x4(%ebp)</span><br><span class=\"line\"> 8048f4b:\teb 54                \tjmp    8048fa1 &lt;fun7+0x69&gt;</span><br><span class=\"line\"> 8048f4d:\t8b 45 08             \tmov    0x8(%ebp),%eax</span><br><span class=\"line\"> 8048f50:\t8b 00                \tmov    (%eax),%eax</span><br><span class=\"line\"> 8048f52:\t3b 45 0c             \tcmp    0xc(%ebp),%eax</span><br><span class=\"line\"> 8048f55:\t7e 1c                \tjle    8048f73 &lt;fun7+0x3b&gt;</span><br><span class=\"line\"> 8048f57:\t8b 45 08             \tmov    0x8(%ebp),%eax</span><br><span class=\"line\"> 8048f5a:\t8b 50 04             \tmov    0x4(%eax),%edx</span><br><span class=\"line\"> 8048f5d:\t8b 45 0c             \tmov    0xc(%ebp),%eax</span><br><span class=\"line\"> 8048f60:\t89 44 24 04          \tmov    %eax,0x4(%esp)</span><br><span class=\"line\"> 8048f64:\t89 14 24             \tmov    %edx,(%esp)</span><br><span class=\"line\"> 8048f67:\te8 cc ff ff ff       \tcall   8048f38 &lt;fun7&gt;</span><br><span class=\"line\"> 8048f6c:\t01 c0                \tadd    %eax,%eax</span><br><span class=\"line\"> 8048f6e:\t89 45 fc             \tmov    %eax,-0x4(%ebp)</span><br><span class=\"line\"> 8048f71:\teb 2e                \tjmp    8048fa1 &lt;fun7+0x69&gt;</span><br><span class=\"line\"> 8048f73:\t8b 45 08             \tmov    0x8(%ebp),%eax</span><br><span class=\"line\"> 8048f76:\t8b 00                \tmov    (%eax),%eax</span><br><span class=\"line\"> 8048f78:\t3b 45 0c             \tcmp    0xc(%ebp),%eax</span><br><span class=\"line\"> 8048f7b:\t75 09                \tjne    8048f86 &lt;fun7+0x4e&gt;</span><br><span class=\"line\"> 8048f7d:\tc7 45 fc 00 00 00 00 \tmovl   $0x0,-0x4(%ebp)</span><br><span class=\"line\"> 8048f84:\teb 1b                \tjmp    8048fa1 &lt;fun7+0x69&gt;</span><br><span class=\"line\"> 8048f86:\t8b 45 08             \tmov    0x8(%ebp),%eax</span><br><span class=\"line\"> 8048f89:\t8b 50 08             \tmov    0x8(%eax),%edx</span><br><span class=\"line\"> 8048f8c:\t8b 45 0c             \tmov    0xc(%ebp),%eax</span><br><span class=\"line\"> 8048f8f:\t89 44 24 04          \tmov    %eax,0x4(%esp)</span><br><span class=\"line\"> 8048f93:\t89 14 24             \tmov    %edx,(%esp)</span><br><span class=\"line\"> 8048f96:\te8 9d ff ff ff       \tcall   8048f38 &lt;fun7&gt;</span><br><span class=\"line\"> 8048f9b:\t01 c0                \tadd    %eax,%eax</span><br><span class=\"line\"> 8048f9d:\t40                   \tinc    %eax</span><br><span class=\"line\"> 8048f9e:\t89 45 fc             \tmov    %eax,-0x4(%ebp)</span><br><span class=\"line\"> 8048fa1:\t8b 45 fc             \tmov    -0x4(%ebp),%eax</span><br><span class=\"line\"> 8048fa4:\tc9                   \tleave  </span><br><span class=\"line\"> 8048fa5:\tc3                   \tret    </span><br><span class=\"line\"></span><br><span class=\"line\">08048fa6 &lt;secret_phase&gt;:</span><br><span class=\"line\"> 8048fa6:\t55                   \tpush   %ebp</span><br><span class=\"line\"> 8048fa7:\t89 e5                \tmov    %esp,%ebp</span><br><span class=\"line\"> 8048fa9:\t83 ec 18             \tsub    $0x18,%esp</span><br><span class=\"line\"> 8048fac:\te8 a9 03 00 00       \tcall   804935a &lt;read_line&gt;</span><br><span class=\"line\"> 8048fb1:\t89 45 f4             \tmov    %eax,-0xc(%ebp)</span><br><span class=\"line\"> 8048fb4:\t8b 45 f4             \tmov    -0xc(%ebp),%eax</span><br><span class=\"line\"> 8048fb7:\t89 04 24             \tmov    %eax,(%esp)</span><br><span class=\"line\"> 8048fba:\te8 99 f8 ff ff       \tcall   8048858 &lt;atoi@plt&gt;</span><br><span class=\"line\"> 8048fbf:\t89 45 f8             \tmov    %eax,-0x8(%ebp)</span><br><span class=\"line\"> 8048fc2:\t83 7d f8 00          \tcmpl   $0x0,-0x8(%ebp)</span><br><span class=\"line\"> 8048fc6:\t7e 09                \tjle    8048fd1 &lt;secret_phase+0x2b&gt;</span><br><span class=\"line\"> 8048fc8:\t81 7d f8 e9 03 00 00 \tcmpl   $0x3e9,-0x8(%ebp)</span><br><span class=\"line\"> 8048fcf:\t7e 05                \tjle    8048fd6 &lt;secret_phase+0x30&gt;</span><br><span class=\"line\"> 8048fd1:\te8 10 07 00 00       \tcall   80496e6 &lt;explode_bomb&gt;</span><br><span class=\"line\"> 8048fd6:\t8b 45 f8             \tmov    -0x8(%ebp),%eax</span><br><span class=\"line\"> 8048fd9:\t89 44 24 04          \tmov    %eax,0x4(%esp)</span><br><span class=\"line\"> 8048fdd:\tc7 04 24 f0 a6 04 08 \tmovl   $0x804a6f0,(%esp)</span><br><span class=\"line\"> 8048fe4:\te8 4f ff ff ff       \tcall   8048f38 &lt;fun7&gt;</span><br><span class=\"line\"> 8048fe9:\t89 45 fc             \tmov    %eax,-0x4(%ebp)</span><br><span class=\"line\"> 8048fec:\t83 7d fc 06          \tcmpl   $0x6,-0x4(%ebp)</span><br><span class=\"line\"> 8048ff0:\t74 05                \tje     8048ff7 &lt;secret_phase+0x51&gt;</span><br><span class=\"line\"> 8048ff2:\te8 ef 06 00 00       \tcall   80496e6 &lt;explode_bomb&gt;</span><br><span class=\"line\"> 8048ff7:\tc7 04 24 38 9a 04 08 \tmovl   $0x8049a38,(%esp)</span><br><span class=\"line\"> 8048ffe:\te8 c5 f7 ff ff       \tcall   80487c8 &lt;puts@plt&gt;</span><br><span class=\"line\"> 8049003:\te8 08 07 00 00       \tcall   8049710 &lt;phase_defused&gt;</span><br><span class=\"line\"> 8049008:\tc9                   \tleave  </span><br><span class=\"line\"> 8049009:\tc3                   \tret    </span><br><span class=\"line\"> 804900a:\t90                   \tnop</span><br><span class=\"line\"> 804900b:\t90                   \tnop</span><br></pre></td></tr></table></figure>\n<h1 id=\"åç»­ä»»åŠ¡\"><a class=\"markdownIt-Anchor\" href=\"#åç»­ä»»åŠ¡\"></a> åç»­ä»»åŠ¡</h1>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input class=\"task-list-item-checkbox\" disabled=\"\" type=\"checkbox\"> æœ‰æ—¶é—´å†å®Œå–„éšè—å±‚éƒ¨åˆ†çš„å†…å®¹</li>\n</ul>\n<h1 id=\"æœ¬æ–‡å‚è€ƒ\"><a class=\"markdownIt-Anchor\" href=\"#æœ¬æ–‡å‚è€ƒ\"></a> æœ¬æ–‡å‚è€ƒ</h1>\n<ul>\n<li><a href=\"https://zhuanlan.zhihu.com/p/472178808\">CSAPP | Lab2-Bomb Lab æ·±å…¥è§£æ - çŸ¥ä¹ (zhihu.com)</a> æ–‡ç« æç¤ºäº†æˆ‘ç¬¬å…­å±‚é‚£ä¸ªæ•°æ®ç»“æ„æ˜¯ä¸ªé“¾è¡¨ğŸ˜…</li>\n</ul>\n","raw":"---\ntitle: CSAPP LAB-2 äºŒè¿›åˆ¶ç‚¸å¼¹å®éªŒ\ntags:\n  - CSAPP\n  - ASM\n  - C\n  - å®éªŒ\n  - GDB\n  - objdump\ncover: 'https://cdn.gallery.uuanqin.top/img/20240522192911.webp'\ndescription: è¯¥è¡¥çš„åœ°æ–¹è¿˜æ˜¯å¾—è¡¥\ncategories:\n  - CSAPP LABS\nabbrlink: d1f3cf37\ndate: 2024-05-22 20:00:46\ntop_img:\n---\n\n> æ­»å»çš„ç‚¸å¼¹åˆæ¥æ”»å‡»æˆ‘ï¼ï¼ğŸ˜…ğŸ˜…ğŸ˜…\n\nComputer Systems. A Programmerâ€™s Perspectiveï¼ŒCS: APPâ€”â€”ä¸­æ–‡è¯‘åã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹ï¼Œæ˜¯æœ¬ç§‘æ—¶å€™çš„å¿…é€‰è¯¾ï¼Œç ”ç©¶ç”Ÿé˜¶æ®µé€‰ä¿®äº†è¿™é—¨è¯¾ï¼Œç›¸å½“äºé‡æ–°å†å­¦ä¸€éã€‚æœ¬ç§‘å­¦è¿™é—¨è¯¾æ—¶æ­£å€¼ç–«æƒ…ï¼Œåœ¨åŠ é‡Œæ•¦~~ï¼ˆå®¶é‡Œè¹²ï¼‰~~å¤§å­¦ä¸Šäº†ä¸€ä¸ªå­¦æœŸï¼Œå½“æ—¶å¤ªè¿·èŒ«äº†ï¼Œå•¥ä¹Ÿä¸ä¼šï¼Œæ•´ä¸ªè¯¾ä¸Šå¾—æ‡µæ‡µæ‡‚æ‡‚ã€‚ä¼°è®¡é‚£æ—¶çš„ç‚¸å¼¹ä¹Ÿæ˜¯çœ‹ç€ç½‘ä¸Šçš„æ•™ç¨‹ä¸œæŠ„æŠ„è¥¿è¡¥è¡¥å‹‰å¼ºå¼„å‡ºæ¥çš„ã€‚\n\nç°åœ¨ç ”ç©¶ç”Ÿäº†ï¼Œè¯¥è¡¥çš„åœ°æ–¹è¿˜æ˜¯å¾—è¡¥ã€‚ä¸ç®¡æœ‰å¤šå¿™ï¼Œæˆ‘å†³å®šæ²‰ä¸‹å¿ƒæ¥é‡çœ‹ã€ŠCSAPPã€‹ï¼Œç‚¸å¼¹å®¢å®éªŒä¹Ÿæ‰“ç®—äº²è‡ªåšåšã€‚æœ€ç»ˆè¿˜æ˜¯åšå‡ºæ¥äº†ğŸ˜ï¼Œè€—æ—¶ 2 å¤©ã€‚éš¾åº¦æ€ä¹ˆè¯´â€”â€”è¿˜ç®—é€‚ä¸­å§ï¼Œå¦‚æœä½ ä»”ç»†çœ‹è¿‡è¯¾æœ¬å°±ä¸éš¾ã€‚\n\nç›®å‰åŸºæœ¬çš„ 6 å±‚ç‚¸å¼¹å·²ç»æ‹†é™¤ï¼Œè¿˜æœ‰ä¸€å±‚éšè—å±‚æœ‰æ—¶é—´å†ç ”ç©¶ã€‚ç”±äºæ¯ä¸ªäººæ”¶åˆ°çš„ç‚¸å¼¹æ˜¯ä¸åŒçš„ï¼ˆä½ çš„è€å¸ˆä¼šè¯´æ ¹æ®ä½ çš„å­¦å·é€‰æ‹©ç›¸åº”çš„ç‚¸å¼¹ï¼‰ï¼Œæ‰€ä»¥æ–‡ç« ä»…æä¾›åŸºæœ¬æ€è·¯ä¾›å‚è€ƒã€‚\n\n> [!notice] CSAPP LAB å®éªŒç³»åˆ—\n>\n> - [[CSAPP LAB-1 ä½æ“ä½œ]]\n> - CSAPP LAB-2 äºŒè¿›åˆ¶ç‚¸å¼¹å®éªŒï¼ˆæœ¬æ–‡ï¼‰\n> - [[CSAPP LAB-3 ç¼“å†²åŒºæº¢å‡ºç‚¸å¼¹]]\n> - [[CSAPP LAB-4 ä»£ç ä¼˜åŒ–]]\n> - [[CSAPP LAB-5 æ‰‹å†™åŠ¨æ€å­˜å‚¨åˆ†é…å™¨]]\n\n# å®éªŒä»‹ç»\n\näºŒè¿›åˆ¶ç‚¸å¼¹åŒ…å«è‹¥å¹²ä¸ªé˜¶æ®µï¼Œæ¯ä¸ªé˜¶æ®µéœ€è¦è¾“å…¥ç‰¹å®šçš„å­—ç¬¦ä¸²ï¼Œæ‰€æœ‰è¾“å…¥æ­£ç¡®åˆ™ç‚¸å¼¹è¢«æ’é™¤ï¼Œå¦åˆ™â€¦..\n\næˆ‘ä»¬çš„ä»»åŠ¡æ˜¯æ‰¾å‡ºè¿™äº›å­—ç¬¦ä¸²å­—ç¬¦ä¸²è®°å½•åˆ°æ–‡ä»¶ä¸­ï¼Œå¯è¾“å…¥å‘½ä»¤éªŒè¯ `./bomb  solution.txt` ç”¨æ¢è¡ŒåŒºåˆ«ä¸åŒé˜¶æ®µçš„å­—ç¬¦ä¸²ã€‚\n\nä¸‹è½½å‹ç¼©åŒ… bombsï¼Œå‹ç¼©åŒ…åŒ…å«å¤šä¸ª `bomb` ä»£ç åŒ…ï¼Œæ ¹æ®å­¦å·é¢†å–è‡ªå·±çš„ä»£ç åŒ…ã€‚\n\næŸ¥çœ‹ `bomb.c` å¯çŸ¥ç¨‹åºåˆ©ç”¨ `phase_*` å‡½æ•°ï¼ˆ`*` ä¸º 1~6ï¼‰ æ£€æŸ¥è¾“å…¥å­—ç¬¦ä¸²æ˜¯å¦åˆæ³•ï¼Œä¸åˆæ³•å°±å¼•çˆ†ç‚¸å¼¹ã€‚æˆ‘ä»¬çš„ä»»åŠ¡å°±æ˜¯é€†å‘å‡ºæ¯ä¸ª phase çš„æ£€æŸ¥è§„åˆ™ï¼Œæ„é€ å‡ºåˆæ³•å­—ç¬¦ä¸²ã€‚å½“ç„¶ï¼Œ`bomb.c` æ²¡æœ‰ç»™å‡º `phase_*` çš„æºç \n\né€†å‘æ–¹æ³•ï¼š\n\n- GDB\n- ç›´æ¥åæ±‡ç¼–\n\nè¯¾æœ¬å‚è€ƒï¼š\n\n- CSAPP ç¬¬ä¸‰ç« ï¼šGDB çš„ä½¿ç”¨\n- CSAPP ç¬¬ä¸‰ç« ï¼šè¿‡ç¨‹\n\né“¾æ¥å‚è€ƒï¼ˆå–œæŠ¥ï¼šå…¨æ˜¯ Englishï¼‰ï¼š\n\n- GDBï¼š\n\t- [Guide to Faster, Less Frustrating Debugging (ucdavis.edu)](https://heather.cs.ucdavis.edu/matloff/public_html/UnixAndC/CLanguage/Debug.html)\n\t- [GDB: The GNU Project Debugger](https://www.gnu.org/software/gdb/)\n- X86 æŒ‡ä»¤æ‰‹å†Œï¼š[CS:APP2e, Bryant and O'Hallaron (cmu.edu)](http://csapp.cs.cmu.edu/public/students.html)\n- GNU æ±‡ç¼–è¯­æ³•å‚è€ƒï¼š\n\t- Wiki ç®€æ˜ä»‹ç»ï¼š[x86 Assembly/GNU assembly syntax - Wikibooks](https://en.wikibooks.org/wiki/X86_Assembly/GNU_assembly_syntax)\n\t- æ‰‹å†Œï¼š[Top (Using as) (sourceware.org)](https://sourceware.org/binutils/docs/as/)\n\n> æ±‡ç¼–è¯­æ³•çœ‹è¯¾æœ¬å°±è¡Œï¼ŒGDB å‘½ä»¤çœ‹æœ¬æ–‡åç»­ç« èŠ‚å°±è¡Œã€‚ä»¥ä¸Šé“¾æ¥ä½ å¯ä»¥ä¸€ä¸ªéƒ½ä¸ç”¨ç‚¹å¼€ã€‚\n\n# GDB å·¥å…·çš„ä½¿ç”¨\n\n```sh\napt install gdb # å®‰è£… GDB\ngdb --version   # æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ\n```\n\nGDB ä¸éœ€è¦äº†è§£è¿‡å¤šï¼Œæƒ³å¹²ä»€ä¹ˆç›´æ¥æŸ¥å°±è¡Œã€‚ç°ç”¨ç°å­¦ã€‚\n\nä½ å¯èƒ½ç”¨åˆ°çš„å‘½ä»¤åªæœ‰è¿™äº›ï¼š\n\n- `run`ï¼šè¿è¡Œ GDB\n- `continue`ï¼šç»§ç»­è¿è¡Œï¼Œå¯ç®€å†™ä¸º `c`ã€‚\n- `break <addr>`ï¼šåœ¨æŒ‡å®šåœ°å€å¤„è®¾ç½®æ–­ç‚¹ã€‚`break` å¯ç®€å†™ä¸º `b`ã€‚\n- `print $eax`ï¼šæ‰“å°æŸä¸ªå¯„å­˜å™¨çš„å€¼ã€‚`print` å¯ç®€å†™ä¸º `p`ã€‚\n- `p /x ($esp-0x8)`ï¼šæ‰“å°æŸä¸ªå¯„å­˜å™¨çš„å€¼çš„è¿ç®—ç»“æœ\n- `print (char *) <addr>` ï¼šå°†ç›´æ¥æ‰“å°è¯¥åœ°å€ `addr` ä¸‹çš„å­—ç¬¦ä¸²\n- `print /x * <addr>` ï¼šä»¥åå…­è¿›åˆ¶çš„å½¢å¼æ‰“å°æŒ‡å®šåœ°å€ `addr` çš„å€¼\n- `print ((int*) <addr>)[<index>]` ï¼šæ‰“å°æŒ‡å®šä½ç½® `addr` æ•°ç»„ä¸‹æ ‡ä¸º `index` çš„å…ƒç´ \n- `print ((int*) <addr>)[<index>]@<num>` ï¼šæ‰“å°æŒ‡å®šä½ç½®æ•°ç»„çš„å…ƒç´ ï¼Œèµ·å§‹åæ ‡ä¸º `index`ï¼Œè¾“å‡º `num` ä¸ªå…ƒç´ \n\næˆªä¸€å¼ è¯¾æœ¬çš„å›¾ä¾›æ›´å¤šå‚è€ƒï¼š\n\n![image.png](https://cdn.gallery.uuanqin.top/img/20240519124236.webp)\n\n# å¼€å§‹æ‹†å¼¹ï¼\n\n## æ‹†å¼¹å‡†å¤‡\n\nåœ¨ Linux ç¯å¢ƒä¸‹è§£å‹ bomb å‹ç¼©æ–‡ä»¶ã€‚\n\n```sh\ntar -xvf bomb7.tar\n```\n\nå¾—åˆ°å¦‚ä¸‹æ–‡ä»¶ï¼š\n\n- `bomb`ï¼šäºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»»åŠ¡ç›®æ ‡æ–‡ä»¶\n- `bomb.c`ï¼š`bomb` çš„æºæ–‡ä»¶ï¼Œè¾…åŠ©ç†è§£ `bomb` ä»£ç \n\né¦–å…ˆä½¿ç”¨ `objdump` åæ±‡ç¼–å·¥å…·å¯¹ `bomb` è¿›è¡Œåæ±‡ç¼–ï¼Œè¾“å‡ºçš„æ±‡ç¼–æ–‡ä»¶åä¸º `dump.s`ï¼š\n\n```sh\nobjdump -d bomb > dump.s\n```\n\n`bomb.c` æ˜¯ `bomb` çš„éƒ¨åˆ†æºæ–‡ä»¶ï¼ŒåŒ…å«ä¸»å‡½æ•° `main`ã€‚é€šè¯» `main` å‡½æ•°ä»¥åŠæ³¨é‡Šï¼Œæˆ‘ä»¬çŸ¥é“ï¼š\n\n1. è¿è¡Œ `bomb` æ—¶å¦‚æœä¸å¸¦å‚æ•°ï¼Œæˆ‘ä»¬å°†åœ¨æ ‡å‡†è¾“å…¥ä¸­è¾“å…¥æ‹†å¼¹çš„å­—ç¬¦ä¸²ã€‚\n2. è¿è¡Œ `bomb` æ—¶å¦‚æœæºå¸¦ä¸€ä¸ªå‚æ•°ï¼Œåˆ™å…ˆä»æŒ‡å®šçš„æ–‡ä»¶ä¸­è¯»å–å­—ç¬¦ä¸²\n3. è¿è¡Œ `bomb` æ—¶å¦‚æœæºå¸¦å¤šäºä¸€ä¸ªå‚æ•°ï¼Œåˆ™è¾“å‡ºæç¤ºï¼š`bomb [<input_file>]`\n4. ä¸€å…±æœ‰ 6 å±‚ç‚¸å¼¹ï¼Œæ¯ä¸€å±‚é€šè¿‡è¾“å…¥ä¸€è¡Œå­—ç¬¦ä¸²ä»¥è¿›è¡Œæ‹†å¼¹\n5. ç‚¸å¼¹çˆ†ç‚¸åä¸ä¼šæœ‰ä»»ä½•äººå—åˆ°ä¼¤å®³\n6. å¯èƒ½å­˜åœ¨éšè—å…³å¡\n\næ­¤å¤–ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç‚¸å¼¹è¿è¡Œæ—¶ <kbd>Ctrl</kbd>+<kbd>C</kbd> ä¸­æ­¢æ‹†å¼¹ï¼Œé‚ªæ¶åšå£«ğŸ˜ˆï¼ˆDr. Evilï¼‰æœ€ç»ˆè¿˜æ˜¯ä¼šæ”¾æˆ‘ä»¬èµ°çš„ï¼š\n\n```stdout\n^CSo you think you can stop the bomb with ctrl-c, do you?\nWell...OK. :-)\n```\n\næ–°å»ºæ–‡ä»¶ `solution.txt`ï¼Œä¹‹åæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨é‡Œé¢å†™å­—ç¬¦ä¸²ç­”æ¡ˆï¼ˆæ¯è¡ŒæŒ‰åºå†™ä¸Šå„å±‚ç­”æ¡ˆï¼‰ï¼Œä»è€Œä¸ç”¨æ‰‹åŠ¨è¾“å…¥å­—ç¬¦ä¸²ã€‚\n\n`bomb.c` çœ‹å®Œåï¼Œå®ƒçš„ä½œç”¨åŸºæœ¬ç»“æŸäº†ã€‚åé¢æˆ‘ä»¬çš„æ—¶é—´å°†ä¼šèŠ±åœ¨äººå·¥è§£è¯» `dump.s` æ–‡ä»¶ä»¥åŠä½¿ç”¨ gdb è°ƒè¯•å·¥å…·çš„è¿‡ç¨‹ä¸­ã€‚\n\n`dump.s` æ–‡ä»¶é˜…è¯»è¦ç‚¹ï¼š\n\n1. ä¸éœ€è¦çœ‹æ‡‚æ‰€æœ‰æ±‡ç¼–ä»£ç ï¼ˆå®é™…ä¸Šä¹Ÿä¸å¯èƒ½ï¼‰ï¼Œåªéœ€çœ‹æ‡‚å…³é”®å‡½æ•°éƒ¨åˆ†çš„ä»£ç ã€‚\n2. å…³é”®å‡½æ•°ï¼šå„å±‚ç‚¸å¼¹å‡½æ•° `<phase_X>`ï¼Œä¸­é—´ç©¿æ’çš„å‡½æ•° `<funcX>`ã€‚ä¸ºäº†ä¾¿äºè‡ªå·±çš„ç†è§£ï¼Œæœ‰æ—¶å€™ä½ ä¹Ÿå¯ä»¥çœ‹ä¸€äº›å·¥å…·ç±»çš„å‡½æ•°ï¼Œæ¯”å¦‚ `<read_six_numbers>` `<strings_not_equal>` ç­‰ï¼Œä½†è¿™äº›å‡½æ•°çœ‹åå­—å°±çŸ¥é“å…¶ä½œç”¨ã€‚\n3. å½“è¿è¡Œåˆ° `<explode_bomb>` æ—¶ç‚¸å¼¹çˆ†ç‚¸ï¼Œå½“è¯¥å±‚å‡½æ•°å®‰å…¨ç»“æŸè¿”å›åˆ° main è¿è¡Œ `<phase_defused>` æ—¶è¯¥å±‚ç‚¸å¼¹å®‰å…¨ç ´è§£ã€‚\n4. å¤šæ³¨é‡Šå’Œåˆ†è¡Œä¾¿äºé˜…è¯»\n\nåœ¨ç ´è§£æŸä¸€å±‚ç‚¸å¼¹æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆéšä¾¿è¾“å‡ ä¸ªæ•°ï¼Œé€šè¿‡ GDB å·¥å…·æ¨æµ‹æˆ‘ä»¬çš„è¾“å…¥å­˜æ”¾åœ¨æ ˆä¸­çš„å“ªä¸ªä½ç½®ï¼Œè¿™æ ·ä¹Ÿèƒ½æ–¹ä¾¿æ¨ç†ã€‚\n\n## Phase 1 - å¯»æ‰¾å­—ç¬¦ä¸²\n\n> asm ä»£ç é˜…è¯»æç¤ºï¼šå·¦ä¾§ä¸ºç¨‹åºåœ°å€ä¸æŒ‡ä»¤å­—èŠ‚ç ï¼Œå³ä¾§ä¸ºåæ±‡ç¼–åå¾—åˆ°çš„æ±‡ç¼–ä»£ç ã€‚æ³¨é‡Šä½¿ç”¨ `;` ä»¥åŠ `#`ã€‚\n\n```asm\n08048b80 <phase_1>:\n 8048b80:\t55                   \tpush   %ebp\n 8048b81:\t89 e5                \tmov    %esp,%ebp\n 8048b83:\t83 ec 08             \tsub    $0x8,%esp\t\t\t# æ ˆæŒ‡é’ˆ -8 \n 8048b86:\tc7 44 24 04 d8 99 04 \tmovl   $0x80499d8,0x4(%esp) # æ ˆ+4 å– 0x80499d8 å­˜å‚¨çš„å­—ç¬¦ä¸²\n 8048b8d:\t08 \n 8048b8e:\t8b 45 08             \tmov    0x8(%ebp),%eax       # åŸå…ˆçš„æ ˆæŒ‡é’ˆ + 8 ç»™ eax\n 8048b91:\t89 04 24             \tmov    %eax,(%esp)          # eax æ”¾åˆ° æ ˆå½“å‰æŒ‡å‘çš„ä½ç½®\n 8048b94:\te8 86 05 00 00       \tcall   804911f <strings_not_equal> # è¿”å› 0 è¡¨ç¤ºå­—ç¬¦ä¸²ç›¸ç­‰\n 8048b99:\t85 c0                \ttest   %eax,%eax            # test æ‰§è¡Œçš„æ˜¯ AND æ“ä½œã€‚ eaxä¸º0æ‰æˆåŠŸ\n 8048b9b:\t74 05                \tje     8048ba2 <phase_1+0x22> # ç ´è§£æˆåŠŸ je æ˜¯åˆ¤æ–­æ ‡å¿—ä½ZFæ˜¯å¦ä¸º1\n 8048b9d:\te8 44 0b 00 00       \tcall   80496e6 <explode_bomb> # ç ´è§£å¤±è´¥\n 8048ba2:\tc9                   \tleave  \n 8048ba3:\tc3                   \tret   \n```\n\n> ä½¿ç”¨ GDB è°ƒè¯•å‰è®°å¾—æ‰“æ–­ç‚¹ï¼Œæ¯”å¦‚ï¼š`b *0x8048b94`\n\n```gdb\n(gdb) p (char*)  0x80499d8\n$2 = 0x80499d8 \"I am not part of the problem. I am a Republican.\"\n```\n\nè§£æåŠè¦ç‚¹ï¼š\n\n- æœ¬å±‚é€šè¿‡åˆ¤æ–­è¾“å…¥çš„å­—ç¬¦ä¸²æ˜¯å¦ä¸æŒ‡å®šå­—ç¬¦ä¸²ç›¸ç­‰ã€‚\n- æ­¤å±‚åªéœ€ä½¿ç”¨ GDB æŒ‡ä»¤æ‰¾å‡ºåœ°å€ `$0x80499d8` å­˜å‚¨çš„å­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²å°±æ˜¯æœ¬å±‚ç­”æ¡ˆã€‚\n\nç‚¹è¯„ä¸æç¤ºï¼š\n\n- æ‹†å¼¹å…¥é—¨ã€‚\n- åƒé‡åˆ°è¿™ç§å­˜åœ¨ã€Œé­”æ•°ã€çš„æŒ‡ä»¤è¦å¤šç•™å¿ƒï¼Œå¸¸ä½¿ç”¨ GDB æ‰“å°è¯¥ä½ç½®çš„å†…å®¹ï¼Œæœ‰å¯èƒ½å­˜å‚¨å…³é”®å­—ç¬¦ä¸²æˆ–æ•°ç»„ã€‚\n- %eax å¤šç”¨äºå­˜å‚¨å‡½æ•°è¿”å›ç»“æœ\n- `test   %eax,%eax` ï¼š`test` ç›¸å½“äº `and` æŒ‡ä»¤ï¼Œç”¨äºæµ‹è¯• `%eax` æ˜¯å¦ä¸º 0ã€‚`je` æŒ‡ä»¤ä¼šåˆ¤æ–­ `ZF` æ ‡å¿—ä½ï¼Œå½“ ZF ä¸º 1 æ—¶è¯´æ˜ `%eax` ä¸º 0ï¼Œç¨‹åºæ‰§è¡Œè·³è½¬ã€‚\n\n## Phase 2 - æœ‰åºæ•°ç»„\n\n```asm\n08048ba4 <phase_2>:\n 8048ba4:\t55                   \tpush   %ebp\n 8048ba5:\t89 e5                \tmov    %esp,%ebp\n 8048ba7:\t83 ec 28             \tsub    $0x28,%esp              # æ ˆæŒ‡é’ˆ - 0x28 = 40 ï¼›æ ˆåˆ†é… 40 å­—èŠ‚\n 8048baa:\t8d 45 e4             \tlea    -0x1c(%ebp),%eax        # åŸå…ˆæ ˆ - 0x1c = 28\n 8048bad:\t89 44 24 04          \tmov    %eax,0x4(%esp)\t\t# æ ˆ+4 <- åŸå…ˆæ ˆ-28\n 8048bb1:\t8b 45 08             \tmov    0x8(%ebp),%eax\n 8048bb4:\t89 04 24             \tmov    %eax,(%esp)\t\t\t# æ ˆ <- åŸå…ˆæ ˆ+8\n 8048bb7:\te8 d0 04 00 00       \tcall   804908c <read_six_numbers>\n 8048bbc:\tc7 45 fc 01 00 00 00 \tmovl   $0x1,-0x4(%ebp)      # i = 1\n 8048bc3:\teb 1e                \tjmp    8048be3 <phase_2+0x3f>\n\n # å¾ªç¯å¼€å§‹ï¼ˆæ¯”è¾ƒå‰åä¸¤ä¸ªæ•°æ˜¯å¦ç›¸å·®5ï¼‰\n 8048bc5:\t8b 45 fc             \tmov    -0x4(%ebp),%eax          # å– i\n 8048bc8:\t8b 54 85 e4          \tmov    -0x1c(%ebp,%eax,4),%edx  # arr[i]\n 8048bcc:\t8b 45 fc             \tmov    -0x4(%ebp),%eax          \n 8048bcf:\t48                   \tdec    %eax                     # å– i-1 \n 8048bd0:\t8b 44 85 e4          \tmov    -0x1c(%ebp,%eax,4),%eax  # arr[i-1]\n 8048bd4:\t83 c0 05             \tadd    $0x5,%eax\t\t\t\t\n 8048bd7:\t39 c2                \tcmp    %eax,%edx\n 8048bd9:\t74 05                \tje     8048be0 <phase_2+0x3c>   # arr[i-1]+5 == arr[i] å¿…é¡»ç›¸ç­‰\n 8048bdb:\te8 06 0b 00 00       \tcall   80496e6 <explode_bomb>\n 8048be0:\tff 45 fc             \tincl   -0x4(%ebp)               # i+=1\n\n 8048be3:\t83 7d fc 05          \tcmpl   $0x5,-0x4(%ebp)      \n 8048be7:\t7e dc                \tjle    8048bc5 <phase_2+0x21> # i <= 5 ç»§ç»­å¾ªç¯(iä»1å¼€å§‹)\n 8048be9:\tc9                   \tleave  \n 8048bea:\tc3                   \tret    \n```\n\næ–­ç‚¹æ‰“åˆ° `<read_six_numbers>` ä¹‹åï¼Œæ¯”å¦‚ `0x8048bbc`ã€‚æˆ‘ä»¬éšä¾¿è¾“å…¥ 5 ä¸ªæ•°å­—ï¼Œæ¯”å¦‚ `1 6 11 16 21 26`ï¼Œé€šè¿‡ GDB å¯ä»¥åˆ¤æ–­å…¶å­˜å‚¨ä½ç½®ï¼š\n\n```gdb\n# ä¸‹é¢å±•ç¤ºäº†è¾“å…¥çš„ 6 ä¸ªæ•°å­—çš„å­˜å‚¨ä½ç½®ï¼ˆç¤ºä¾‹æ•°æ®ï¼‰\n(gdb) p *(int*) 0xffffcc6c    $6 = 1\n(gdb) p *(int*) 0xffffcc70    $8 = 6\n(gdb) p *(int*) 0xffffcc74    $9 = 11\n(gdb) p *(int*) 0xffffcc78    $10 = 16\n(gdb) p *(int*) 0xffffcc7c    $11 = 21\n(gdb) p *(int*) 0xffffcc80    $12 = 26\n```\n\n> ä¸ºå•¥ä¼šçŸ¥é“æŸ¥ 6 ä¸ªåœ°å€ã€‚æˆ‘ä»¬æ ¹æ®è¿™ä¸ªåŸåˆ™å°±è¡Œï¼šæ±‡ç¼–ä¸­ç”¨åˆ°å“ªé‡Œï¼ŒGDB å°±æŸ¥å“ªé‡Œã€‚\n\nè¿™é‡Œçš„æ±‡ç¼–ä»£ç ä¸­å­˜åœ¨ä¸€ä¸ªå…¸å‹çš„ `for` å¾ªç¯ç»“æ„ï¼Œä½¿ç”¨äº†ã€Œè·³è½¬åˆ°ä¸­é—´ã€ç­–ç•¥ï¼ˆå…·ä½“è¯·çœ‹æ•™æï¼‰ã€‚for å¾ªç¯çš„é€šç”¨å½¢å¼ï¼š\n\n```c\nfor(init-expr;test-expr;update-expr)\n\tbody-statement;\n\n// è¡Œä¸ºä¸ä¸‹é¢çš„whileå¾ªç¯ä»£ç ä¸€æ ·\ninit-expr;\nwhile(test-expr){\n\tbody-statement\n\tupdate-expr;\n}\n```\n\nè¯¥éƒ¨åˆ†æ±‡ç¼–ä»£ç ç»“æ„ç¿»è¯‘ä¸º C è¯­è¨€çš„å¤§è‡´ç»“æ„å¦‚ä¸‹ï¼š\n\n```c\n\tinit-expr;\n\tgoto test;\nloop:\n\tbody-statement;\n\tupdate-expr;\ntest:\n\tt=test-expr;\n\tif(t)\n\t\tgoto loop;\n```\n\nè§£æåŠè¦ç‚¹ï¼š\n\n- æœ¬å±‚éœ€è¾“å…¥ 6 ä¸ªæ•°å­—ï¼Œæ¯ä¸ªæ•°å­—éœ€æ„æˆå‡åºçš„ç­‰å·®æ•°åˆ—ï¼ˆå…¬å·®ä¸º 5ï¼‰\n\nç‚¹è¯„ä¸æç¤ºï¼š\n\n- è¯†åˆ« `for` å¾ªç¯\n- çŸ¥é“è¾“å…¥çš„ 6 ä¸ªæ•°å­—çš„å­˜å‚¨ä½ç½®\n\n## Phase 3 - è·³è½¬è¡¨\n\n> ç›¸ä¿¡ä½ é€šè¿‡äº†å‰é¢æ±‡ç¼–çš„æ´—ç¤¼åï¼Œæ±‡ç¼–ä»£ç çš„é˜…è¯»èƒ½åŠ›æé«˜äº†ä¸å°‘ã€‚æœ¬å±‚å¼€å§‹å°±ä¸ä¼šå•°å—¦å¤ªå¤šå“¦ï¼Œçœ‹æ³¨é‡Šå³å¯ã€‚\n\n```asm\n08048beb <phase_3>:\n 8048beb:\t55                   \tpush   %ebp\n 8048bec:\t89 e5                \tmov    %esp,%ebp\n 8048bee:\t83 ec 38             \tsub    $0x38,%esp\n 8048bf1:\tc7 45 f8 00 00 00 00 \tmovl   $0x0,-0x8(%ebp)\n 8048bf8:\t8d 45 f0             \tlea    -0x10(%ebp),%eax\n 8048bfb:\t89 44 24 10          \tmov    %eax,0x10(%esp)\n 8048bff:\t8d 45 ef             \tlea    -0x11(%ebp),%eax\n 8048c02:\t89 44 24 0c          \tmov    %eax,0xc(%esp)\n 8048c06:\t8d 45 f4             \tlea    -0xc(%ebp),%eax\n 8048c09:\t89 44 24 08          \tmov    %eax,0x8(%esp)\n 8048c0d:\tc7 44 24 04 09 9a 04 \tmovl   $0x8049a09,0x4(%esp)\n```\n\næŸ¥çœ‹é­”æ•°ä¿¡æ¯ï¼š\n\n```gdb\n(gdb) p (char*) 0x8049a09\n$13 = 0x8049a09 \"%d %c %d\"\n```\n\nè¿™ä¸ªå­—ç¬¦ä¸²æ˜¯ä¸æ˜¯å¾ˆçœ¼ç†Ÿï¼Œè¿™å¯èƒ½æç¤ºæˆ‘ä»¬è¾“å…¥ 3 ä¸ªæ•°æ®ï¼š1 ä¸ªæ•°å­—ã€1 ä¸ªå­—ç¬¦ä»¥åŠ 1 ä¸ªæ•°å­—ã€‚æˆ‘ä»¬å¯ä»¥åƒä¸Šä¸€å±‚é‚£æ ·éšä¾¿è¾“å…¥ 3 ä¸ªæ•°æ®ã€‚\n\n```asm\n 8048c14:\t08 \n 8048c15:\t8b 45 08             \tmov    0x8(%ebp),%eax\n 8048c18:\t89 04 24             \tmov    %eax,(%esp)\n 8048c1b:\te8 48 fc ff ff       \tcall   8048868 <sscanf@plt>\n 8048c20:\t89 45 f8             \tmov    %eax,-0x8(%ebp)          # è¿”å›è¾“å…¥çš„ä¸ªæ•°\n 8048c23:\t83 7d f8 02          \tcmpl   $0x2,-0x8(%ebp)\n 8048c27:\t7f 05                \tjg     8048c2e <phase_3+0x43> \t# è¾“å…¥ï¼ˆé•¿åº¦ï¼‰å¿…é¡»å¤§äº2\n 8048c29:\te8 b8 0a 00 00       \tcall   80496e6 <explode_bomb>\n 8048c2e:\t8b 45 f4             \tmov    -0xc(%ebp),%eax          # -0xc(%ebp)æºå¸¦è¾“å…¥çš„é¦–åœ°å€\n 8048c31:\t89 45 dc             \tmov    %eax,-0x24(%ebp)         # ç»è¿‡GDBè°ƒè¯•ï¼Œ-0x24(%ebp) è¡¨ç¤ºç¬¬ä¸€ä¸ªè¾“å…¥çš„æ•°å­—\n 8048c34:\t83 7d dc 07          \tcmpl   $0x7,-0x24(%ebp)         # è¾“å…¥çš„æ•°å­—å¿…é¡»å°äºç­‰äº7\n 8048c38:\t0f 87 c0 00 00 00    \tja     8048cfe <phase_3+0x113> \t# æ— ç¬¦å·å¤§äº7 - åˆ™çˆ†ç‚¸\n 8048c3e:\t8b 55 dc             \tmov    -0x24(%ebp),%edx\t\t\t# %edx = ç¬¬ä¸€ä¸ªè¾“å…¥çš„æ•°å­—\n 8048c41:\t8b 04 95 14 9a 04 08 \tmov    0x8049a14(,%edx,4),%eax \t\n 8048c48:\tff e0                \tjmp    *%eax \t\t\t\t\t# ä¾‹å¦‚ç¬¬ä¸€ä¸ªè¾“å…¥çš„æ•°å­—æ˜¯6 åˆ™ eax=0x8048cd4\n```\n\n> æ±‡ç¼–ä¸­ç”¨åˆ°å“ªé‡Œï¼ŒGDB å°±æŸ¥å“ªé‡Œã€‚`-0x24(%ebp)` æŒ‡å‘æˆ‘ä»¬ç¬¬ä¸€ä¸ªè¾“å…¥çš„æ•°å­—ã€‚\n\nåƒ `jmp    *%eax` è¿™ç§è¯­æ³•å¾ˆçœ¼ç†Ÿï¼Œåƒæ˜¯è¯¾æœ¬ä¸­æåˆ°çš„ `switch` è¯­å¥çš„æ±‡ç¼–ã€‚æˆ‘ä»¬å¯ä»¥å°è¯•æ‰¾å‡ºå…¶è·³è½¬è¡¨ï¼š\n\n```gdb\n(gdb) print /x ((int*) 0x8049a14)[0]@8\n$25 = {0x8048c4a, 0x8048c66, 0x8048c82, 0x8048c97, 0x8048cac, 0x8048cbf, 0x8048cd4, 0x8048ce9}\n```\n\næˆ‘ä»¬å°±éšä¾¿é€‰ä¸€ä¸ªï¼Œæ¯”å¦‚ 6ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ 6 çš„ä»£ç å°±è¡Œã€‚\n\n```asm\n # 0\n 8048c4a:\tc6 45 ff 67          \tmovb   $0x67,-0x1(%ebp)\n 8048c4e:\t8b 45 f0             \tmov    -0x10(%ebp),%eax\n 8048c51:\t3d c8 00 00 00       \tcmp    $0xc8,%eax\n 8048c56:\t0f 84 ab 00 00 00    \tje     8048d07 <phase_3+0x11c>\n 8048c5c:\te8 85 0a 00 00       \tcall   80496e6 <explode_bomb>\n 8048c61:\te9 a1 00 00 00       \tjmp    8048d07 <phase_3+0x11c>\n\n # 1\n 8048c66:\tc6 45 ff 6c          \tmovb   $0x6c,-0x1(%ebp)\n 8048c6a:\t8b 45 f0             \tmov    -0x10(%ebp),%eax\n 8048c6d:\t3d c7 03 00 00       \tcmp    $0x3c7,%eax\n 8048c72:\t0f 84 8f 00 00 00    \tje     8048d07 <phase_3+0x11c>\n 8048c78:\te8 69 0a 00 00       \tcall   80496e6 <explode_bomb>\n 8048c7d:\te9 85 00 00 00       \tjmp    8048d07 <phase_3+0x11c>\n\n # 2\n 8048c82:\tc6 45 ff 69          \tmovb   $0x69,-0x1(%ebp)\n 8048c86:\t8b 45 f0             \tmov    -0x10(%ebp),%eax\n 8048c89:\t3d 1e 02 00 00       \tcmp    $0x21e,%eax\n 8048c8e:\t74 77                \tje     8048d07 <phase_3+0x11c>\n 8048c90:\te8 51 0a 00 00       \tcall   80496e6 <explode_bomb>\n 8048c95:\teb 70                \tjmp    8048d07 <phase_3+0x11c>\n\n# 3\n 8048c97:\tc6 45 ff 6e          \tmovb   $0x6e,-0x1(%ebp)\n 8048c9b:\t8b 45 f0             \tmov    -0x10(%ebp),%eax\n 8048c9e:\t3d 6a 03 00 00       \tcmp    $0x36a,%eax\n 8048ca3:\t74 62                \tje     8048d07 <phase_3+0x11c>\n 8048ca5:\te8 3c 0a 00 00       \tcall   80496e6 <explode_bomb>\n 8048caa:\teb 5b                \tjmp    8048d07 <phase_3+0x11c>\n 8048cac:\tc6 45 ff 6f          \tmovb   $0x6f,-0x1(%ebp)\n\n # 4\n 8048cb0:\t8b 45 f0             \tmov    -0x10(%ebp),%eax\n 8048cb3:\t83 f8 3f             \tcmp    $0x3f,%eax\n 8048cb6:\t74 4f                \tje     8048d07 <phase_3+0x11c>\n 8048cb8:\te8 29 0a 00 00       \tcall   80496e6 <explode_bomb>\n 8048cbd:\teb 48                \tjmp    8048d07 <phase_3+0x11c>\n\n # 5\n 8048cbf:\tc6 45 ff 69          \tmovb   $0x69,-0x1(%ebp)\n 8048cc3:\t8b 45 f0             \tmov    -0x10(%ebp),%eax\n 8048cc6:\t3d 8f 00 00 00       \tcmp    $0x8f,%eax\n 8048ccb:\t74 3a                \tje     8048d07 <phase_3+0x11c>\n 8048ccd:\te8 14 0a 00 00       \tcall   80496e6 <explode_bomb>\n 8048cd2:\teb 33                \tjmp    8048d07 <phase_3+0x11c>\n\n# 6\n 8048cd4:\tc6 45 ff 77          \tmovb   $0x77,-0x1(%ebp)\t\t\t# 77 å¯¹åº”å­—ç¬¦ w ä¸ºåæ–‡åŸ‹ä¸‹ä¼ç¬”\n 8048cd8:\t8b 45 f0             \tmov    -0x10(%ebp),%eax         # ebp - 0x10 æ˜¯ç¬¬ä¸‰ä¸ªè¾“å…¥çš„æ•°å­—\n;  (gdb) p /x *0xffffcc78\n; $31 = 0x1b1\n 8048cdb:\t3d b1 01 00 00       \tcmp    $0x1b1,%eax              # $0x1b1 = 433 ç¬¬ä¸‰ä¸ªæ•°å­—å’Œ 0x1b1 æ¯”è¾ƒ\n 8048ce0:\t74 25                \tje     8048d07 <phase_3+0x11c>\n 8048ce2:\te8 ff 09 00 00       \tcall   80496e6 <explode_bomb>\n 8048ce7:\teb 1e                \tjmp    8048d07 <phase_3+0x11c>\n\n # 7\n 8048ce9:\tc6 45 ff 76          \tmovb   $0x76,-0x1(%ebp)\n 8048ced:\t8b 45 f0             \tmov    -0x10(%ebp),%eax         \n 8048cf0:\t3d 9f 03 00 00       \tcmp    $0x39f,%eax\n 8048cf5:\t74 10                \tje     8048d07 <phase_3+0x11c>\n 8048cf7:\te8 ea 09 00 00       \tcall   80496e6 <explode_bomb>\n\n 8048cfc:\teb 09                \tjmp    8048d07 <phase_3+0x11c>\n 8048cfe:\tc6 45 ff 65          \tmovb   $0x65,-0x1(%ebp)        # çˆ†ç‚¸\n 8048d02:\te8 df 09 00 00       \tcall   80496e6 <explode_bomb>\n  \n```\n\n> æ±‡ç¼–ä¸­ç”¨åˆ°å“ªé‡Œï¼ŒGDB å°±æŸ¥å“ªé‡Œã€‚`-0x10(%ebp)` æŒ‡å‘æˆ‘ä»¬ç¬¬ä¸‰ä¸ªè¾“å…¥çš„æ•°å­—ã€‚\n\n```asm\n# è¿”å›\n 8048d07:\t0f b6 45 ef          \tmovzbl -0x11(%ebp),%eax        # é›¶æ‰©å±•ä¼ é€åˆ°eax\n;  (gdb) p *(char*) 0xffffcc77\n; $37 = 119 'w'\n 8048d0b:\t38 45 ff             \tcmp    %al,-0x1(%ebp)          # alæ˜¯raxçš„ä½å­—èŠ‚ ä¸Šæ–‡çš„ä¼ç¬”\n 8048d0e:\t74 05                \tje     8048d15 <phase_3+0x12a> # ç­‰äºæ‰æˆåŠŸï¼Œå¦åˆ™çˆ†ç‚¸\n 8048d10:\te8 d1 09 00 00       \tcall   80496e6 <explode_bomb>\n 8048d15:\tc9                   \tleave  \n 8048d16:\tc3                   \tret  \n```\n\n> æ±‡ç¼–ä¸­ç”¨åˆ°å“ªé‡Œï¼ŒGDB å°±æŸ¥å“ªé‡Œã€‚`-0x11(%ebp)` æŒ‡å‘æˆ‘ä»¬ç¬¬äºŒä¸ªè¾“å…¥çš„å­—ç¬¦ã€‚\n\nè§£æåŠè¦ç‚¹ï¼š\n\n- æœ¬å±‚éœ€è¾“å…¥ 3 ä¸ªæ•°æ®ã€‚æ ¹æ®è·³è½¬è¡¨å†…å®¹è¾“å…¥ç¬¦åˆè¦æ±‚çš„æ•°å­—ã€‚æ¯”å¦‚ï¼š`6 w 433`ã€‚\n\nç‚¹è¯„ä¸æç¤ºï¼š\n\n- è¯†åˆ« `switch`\n- å–„ç”¨ `GDB`\n\n## Phase 4 - é€’å½’å‡½æ•°\n\nç¬¬å››å±‚ä½¿ç”¨åˆ°äº†ä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å…ˆè§£è¯»è¿™ä¸ªå‡½æ•°ï¼š\n\n```asm\n08048d17 <func4>:\n 8048d17:\t55                   \tpush   %ebp\n 8048d18:\t89 e5                \tmov    %esp,%ebp\n 8048d1a:\t53                   \tpush   %ebx\n 8048d1b:\t83 ec 08             \tsub    $0x8,%esp\n 8048d1e:\t83 7d 08 01          \tcmpl   $0x1,0x8(%ebp)            \n 8048d22:\t7f 09                \tjg     8048d2d <func4+0x16>  # if x>1\n 8048d24:\tc7 45 f8 01 00 00 00 \tmovl   $0x1,-0x8(%ebp)       # else\n 8048d2b:\teb 21                \tjmp    8048d4e <func4+0x37>\n\n 8048d2d:\t8b 45 08             \tmov    0x8(%ebp),%eax        # if x>1\n 8048d30:\t48                   \tdec    %eax              \n 8048d31:\t89 04 24             \tmov    %eax,(%esp)           # x-1 ä½œä¸ºå‚æ•°é€’å½’\n 8048d34:\te8 de ff ff ff       \tcall   8048d17 <func4>\n 8048d39:\t89 c3                \tmov    %eax,%ebx             # f(x-1) çš„ç»“æœæš‚å­˜\n 8048d3b:\t8b 45 08             \tmov    0x8(%ebp),%eax\n 8048d3e:\t83 e8 02             \tsub    $0x2,%eax      \n 8048d41:\t89 04 24             \tmov    %eax,(%esp)           # x-2 ä½œä¸ºå‚æ•°é€’å½’\n 8048d44:\te8 ce ff ff ff       \tcall   8048d17 <func4>\n 8048d49:\t01 c3                \tadd    %eax,%ebx             # f(x-1) çš„ç»“æœ+f(x-1)\n 8048d4b:\t89 5d f8             \tmov    %ebx,-0x8(%ebp)       # ä½œä¸ºè¿”å›ç»“æœ\n\n 8048d4e:\t8b 45 f8             \tmov    -0x8(%ebp),%eax # 1 è¿”å›1\n 8048d51:\t83 c4 08             \tadd    $0x8,%esp\n 8048d54:\t5b                   \tpop    %ebx\n 8048d55:\t5d                   \tpop    %ebp\n 8048d56:\tc3                   \tret   \n```\n\nä¸éš¾çœ‹å‡ºæ˜¯ä¸ªé€’å½’æ±‚æ–æ³¢é‚£å¥‘æ•°åˆ—çš„å‡½æ•°ï¼š\n\n```c\nfunc4(x){\n\tif x>1:\n\t\treturn func4(x-1)+func4(x-2)\n\telse:\n\t\treturn 1;\n}\n// è¾“å…¥ï¼š0 1 2 3 4 5 ... 13\n// è¾“å‡ºï¼š1 1 2 3 5 8 ... 377\n```\n\nç¬¬å››å±‚çš„é€»è¾‘æ›´åŠ ç®€å•ï¼š\n\n```asm\n08048d57 <phase_4>:\n 8048d57:\t55                   \tpush   %ebp\n 8048d58:\t89 e5                \tmov    %esp,%ebp\n 8048d5a:\t83 ec 28             \tsub    $0x28,%esp\n 8048d5d:\t8d 45 f4             \tlea    -0xc(%ebp),%eax\n 8048d60:\t89 44 24 08          \tmov    %eax,0x8(%esp)\n 8048d64:\tc7 44 24 04 34 9a 04 \tmovl   $0x8049a34,0x4(%esp) #  0x8049a34 -> \"%d\"\n 8048d6b:\t08 \n 8048d6c:\t8b 45 08             \tmov    0x8(%ebp),%eax\n 8048d6f:\t89 04 24             \tmov    %eax,(%esp)\n 8048d72:\te8 f1 fa ff ff       \tcall   8048868 <sscanf@plt>\n 8048d77:\t89 45 fc             \tmov    %eax,-0x4(%ebp)      \n 8048d7a:\t83 7d fc 01          \tcmpl   $0x1,-0x4(%ebp)      # åªèƒ½è¾“å…¥ä¸€ä¸ªæ•°iï¼Œå¦åˆ™çˆ†ç‚¸\n 8048d7e:\t75 07                \tjne    8048d87 <phase_4+0x30> # è·³è½¬åˆ°çˆ†ç‚¸\n 8048d80:\t8b 45 f4             \tmov    -0xc(%ebp),%eax  #   -0xc(%ebp)å­˜æ”¾æˆ‘ä»¬ç¬¬ä¸€ä¸ªè¾“å…¥çš„æ•°i   \n;  (gdb) p  *0xffffcc7c\n; $42 = 13\n 8048d83:\t85 c0                \ttest   %eax,%eax            # -0xc(%ebp) ä¸èƒ½ä¸ºé›¶\n 8048d85:\t7f 05                \tjg     8048d8c <phase_4+0x35> # å¤§äºæ‰æˆåŠŸï¼Œå¦åˆ™çˆ†ç‚¸\n 8048d87:\te8 5a 09 00 00       \tcall   80496e6 <explode_bomb>\n 8048d8c:\t8b 45 f4             \tmov    -0xc(%ebp),%eax\n 8048d8f:\t89 04 24             \tmov    %eax,(%esp)          # å°†æ•°å­—ä¼ å‚\n 8048d92:\te8 80 ff ff ff       \tcall   8048d17 <func4>      # i è¿›å…¥å‡½æ•°func4\n\n 8048d97:\t89 45 f8             \tmov    %eax,-0x8(%ebp)\n 8048d9a:\t81 7d f8 79 01 00 00 \tcmpl   $0x179,-0x8(%ebp)    # ç»“æœå¿…é¡»ä¸º 0x179 = 377 (æ–æ³¢é‚£å¥‘æ•°åˆ—ç¬¬13é¡¹)\n 8048da1:\t74 05                \tje     8048da8 <phase_4+0x51> # ç­‰äºæ‰æˆåŠŸï¼Œå¦åˆ™çˆ†ç‚¸\n 8048da3:\te8 3e 09 00 00       \tcall   80496e6 <explode_bomb>\n 8048da8:\tc9                   \tleave  \n 8048da9:\tc3                   \tret  \n```\n\nè§£æåŠè¦ç‚¹ï¼š\n\n- æœ¬å±‚éœ€è¾“å…¥ 1 ä¸ªæ•°æ®ã€‚ä½¿å¾—å‡½æ•°çš„è¾“å‡ºç»“æœä¸ç»™å®šæ•°å­—ç›¸ç­‰ã€‚åœ¨è¿™é‡Œä¸º `13`\n\nç‚¹è¯„ä¸æç¤ºï¼š\n\n- ä¼šè¯»é€’å½’å‡½æ•°\n\n## Phase 5 - ç®—æ•°\n\n```asm\n08048daa <phase_5>:\n 8048daa:\t55                   \tpush   %ebp\n 8048dab:\t89 e5                \tmov    %esp,%ebp\n 8048dad:\t83 ec 18             \tsub    $0x18,%esp\n 8048db0:\t8b 45 08             \tmov    0x8(%ebp),%eax\n 8048db3:\t89 04 24             \tmov    %eax,(%esp)\n 8048db6:\te8 3a 03 00 00       \tcall   80490f5 <string_length>\n 8048dbb:\t89 45 fc             \tmov    %eax,-0x4(%ebp)\n 8048dbe:\t83 7d fc 06          \tcmpl   $0x6,-0x4(%ebp)\n 8048dc2:\t74 05                \tje     8048dc9 <phase_5+0x1f> # è¾“å…¥çš„å­—ç¬¦ä¸²é•¿åº¦å¿…é¡»ä¸º 6 \n 8048dc4:\te8 1d 09 00 00       \tcall   80496e6 <explode_bomb>\n 8048dc9:\tc7 45 f8 00 00 00 00 \tmovl   $0x0,-0x8(%ebp)        # result = 0\n 8048dd0:\tc7 45 f4 00 00 00 00 \tmovl   $0x0,-0xc(%ebp)\t\t  # i = 0\n 8048dd7:\teb 1c                \tjmp    8048df5 <phase_5+0x4b>\n```\n\næˆ‘ä»¬çœ‹åˆ°åæ–‡è€æ˜¯å‡ºç° `-0x8(%ebp)`ï¼Œ`-0xc(%ebp)`ã€‚åˆçœ‹åˆ°ç†Ÿæ‚‰çš„å¾ªç¯ç»“æ„ï¼Œå¹²è„†åˆ†åˆ«å®šä¹‰å˜é‡ `result`ï¼Œ`i` è¾…åŠ©æˆ‘ä»¬è¿›è¡Œåˆ†æã€‚\n\n```asm\n# å¾ªç¯å¼€å§‹\n 8048dd9:\t8b 45 f4             \tmov    -0xc(%ebp),%eax\n 8048ddc:\t03 45 08             \tadd    0x8(%ebp),%eax  # 0x804a9a0 + i å°±æ˜¯éå†è¾“å…¥çš„å­—ç¬¦ä¸²\n\n 8048ddf:\t0f b6 00             \tmovzbl (%eax),%eax\n 8048de2:\t0f be c0             \tmovsbl %al,%eax\n 8048de5:\t83 e0 0f             \tand    $0xf,%eax       # å¯¹æ¯ä¸€ä¸ªå­—ç¬¦ä¸²å–ä½ä½å­—èŠ‚ å¾—åˆ° k\n 8048de8:\t8b 04 85 c0 a5 04 08 \tmov    0x804a5c0(,%eax,4),%eax # å– arr[k]\n\n 8048def:\t01 45 f8             \tadd    %eax,-0x8(%ebp)          # result += arr[k]\n 8048df2:\tff 45 f4             \tincl   -0xc(%ebp)\t\t\t\t# i++\n\n 8048df5:\t83 7d f4 05          \tcmpl   $0x5,-0xc(%ebp)\n 8048df9:\t7e de                \tjle    8048dd9 <phase_5+0x2f>  # i <= 5 ç»§ç»­å¾ªç¯\n 8048dfb:\t83 7d f8 24          \tcmpl   $0x24,-0x8(%ebp)\t\t\t# result == 36\n 8048dff:\t74 05                \tje     8048e06 <phase_5+0x5c>   # å¿…é¡»ç›¸ç­‰\n 8048e01:\te8 e0 08 00 00       \tcall   80496e6 <explode_bomb>\n 8048e06:\tc9                   \tleave  \n 8048e07:\tc3                   \tret    \n```\n\n\n```gdb\n(gdb) p  (char*) 0x804a9a0\n$56 = 0x804a9a0 <input_strings+320> \"@@BBAA\"  # å‡è®¾è¾“å…¥çš„å­—ç¬¦ä¸²ä¸º `@@BBAA`\n# 0x804a5c0: {2, 10, 6, 1, 12, 16, 9, 3, 4, 7, 14, 5, 11, 8, 15, 13,     ...}\n```\n\n`0x804a9a0` æ˜¯ä¸€ä¸ªæ•°ç»„ arr çš„åœ°å€ï¼Œæˆ‘ä»¬éœ€è¦è¾“å…¥åŒ…å« 6 ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²ï¼š\n\n- æ¯ä¸ªå­—ç¬¦çš„ä½ 4 ä½ä½œä¸ºæ•°ç»„ arr çš„ç´¢å¼• iã€‚\n- æœ¬ä¾‹ä¸­ï¼Œéœ€è¦ä½¿å¾— `arr[0]`+`arr[1]`+...+`arr[5]` çš„æ€»å’Œä¸º 36 å³å¯é€šå…³ã€‚\n\nä¾‹å¦‚ï¼š\n\n- 36 = 2+2+6+6+10+10\n- å„åŠ æ•°å¯¹åº”æ•°ç»„çš„åºå·ä¸º 0 0 2 2 1 1\n- ASCII ä¸­ï¼Œ`@`ï¼š0x40   `B`ï¼š0x42  `A`ï¼š0x41ï¼Œä¹Ÿå°±æ˜¯å¯¹åº”åºå· 0, 2, 1\n- ç­”æ¡ˆå³ä¸º `@@BBAA`\n\nè§£æåŠè¦ç‚¹ï¼š\n\n- æœ¬å±‚éœ€è¾“å…¥åˆé€‚å­—ç¬¦ä¸²æŒ‡ç¤ºæ•°ç»„çš„ä¸‹æ ‡ï¼Œä½¿å¾—ä¸‹æ ‡å¯¹åº”æ•°ç»„æ•°å­—ä¹‹å’Œç­‰äºæŒ‡å®šå€¼å³å¯ã€‚\n- çŸ¥é“è¾“å…¥å­—ç¬¦ä¸²çš„å­˜å‚¨ä½ç½®\n\nç‚¹è¯„ä¸æç¤ºï¼š\n\n- æ±‡ç¼–çš„èä¼šè´¯é€š\n\n## Phase 6 - é“¾è¡¨æ’åº\n\n```asm\n08048e08 <phase_6>:\n 8048e08:\t55                   \tpush   %ebp\n 8048e09:\t89 e5                \tmov    %esp,%ebp\n 8048e0b:\t83 ec 48             \tsub    $0x48,%esp\n 8048e0e:\tc7 45 f0 3c a6 04 08 \tmovl   $0x804a63c,-0x10(%ebp) # $0x804a63c-> 0x329\n 8048e15:\t8d 45 d8             \tlea    -0x28(%ebp),%eax\n 8048e18:\t89 44 24 04          \tmov    %eax,0x4(%esp)\n 8048e1c:\t8b 45 08             \tmov    0x8(%ebp),%eax\n 8048e1f:\t89 04 24             \tmov    %eax,(%esp)\n 8048e22:\te8 65 02 00 00       \tcall   804908c <read_six_numbers>\n 8048e27:\tc7 45 f8 00 00 00 00 \tmovl   $0x0,-0x8(%ebp)        # i=0\n 8048e2e:\teb 48                \tjmp    8048e78 <phase_6+0x70>\n\n# å¾ªç¯A ------- å¼€å§‹ ç”¨äºåˆ¤æ–­ï¼šæ¯ä¸ªå…ƒç´ ä¸ç›¸ç­‰ï¼Œä¸”æ¯ä¸ªå…ƒç´ ä¸ä¸º0\n 8048e30:\t8b 45 f8             \tmov    -0x8(%ebp),%eax\n 8048e33:\t8b 44 85 d8          \tmov    -0x28(%ebp,%eax,4),%eax  # -0x28(%ebp) çš„ä½ç½®æ˜¯è¾“å…¥æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ \n 8048e37:\t85 c0                \ttest   %eax,%eax   \n 8048e39:\t7e 0c                \tjle    8048e47 <phase_6+0x3f>  # arr[i] == 0 è·³è½¬çˆ†ç‚¸\n 8048e3b:\t8b 45 f8             \tmov    -0x8(%ebp),%eax         # arr[i] != 0\n 8048e3e:\t8b 44 85 d8          \tmov    -0x28(%ebp,%eax,4),%eax\n 8048e42:\t83 f8 06             \tcmp    $0x6,%eax               \n 8048e45:\t7e 05                \tjle    8048e4c <phase_6+0x44>  # arr[i]<= 6 å¦åˆ™çˆ†ç‚¸\n 8048e47:\te8 9a 08 00 00       \tcall   80496e6 <explode_bomb>\n\n 8048e4c:\t8b 45 f8             \tmov    -0x8(%ebp),%eax\n 8048e4f:\t40                   \tinc    %eax\t\t\t\t\t# i++\n 8048e50:\t89 45 fc             \tmov    %eax,-0x4(%ebp)      # å­˜å‚¨ti = i+1\n 8048e53:\teb 1a                \tjmp    8048e6f <phase_6+0x67>\n\n 8048e55:\t8b 45 f8             \tmov    -0x8(%ebp),%eax\n 8048e58:\t8b 54 85 d8          \tmov    -0x28(%ebp,%eax,4),%edx  # edx = arr[i]\n 8048e5c:\t8b 45 fc             \tmov    -0x4(%ebp),%eax\n 8048e5f:\t8b 44 85 d8          \tmov    -0x28(%ebp,%eax,4),%eax  # eax = arr[i+1]\n 8048e63:\t39 c2                \tcmp    %eax,%edx\n 8048e65:\t75 05                \tjne    8048e6c <phase_6+0x64>   # å¿…é¡» arr[i] != arr[i+1] å¦åˆ™çˆ†ç‚¸\n 8048e67:\te8 7a 08 00 00       \tcall   80496e6 <explode_bomb>\n 8048e6c:\tff 45 fc             \tincl   -0x4(%ebp)               # ti++\n\n 8048e6f:\t83 7d fc 05          \tcmpl   $0x5,-0x4(%ebp)\t\t\n 8048e73:\t7e e0                \tjle    8048e55 <phase_6+0x4d> # ti<=5 åˆ™è·³è½¬\n 8048e75:\tff 45 f8             \tincl   -0x8(%ebp)             # i+1==5 ,i++ , i=6  å³å°†é€€å‡ºå¾ªç¯\n\n 8048e78:\t83 7d f8 05          \tcmpl   $0x5,-0x8(%ebp)\n 8048e7c:\t7e b2                \tjle    8048e30 <phase_6+0x28>  # i<=5 å¾ªç¯ï¼ˆéå†6ä¸ªå…ƒç´ ï¼‰\n # å¾ªç¯A ---- ------ ç»“æŸ\n\n\n 8048e7e:\tc7 45 f8 00 00 00 00 \tmovl   $0x0,-0x8(%ebp)\t\t# j=0\n 8048e85:\teb 34                \tjmp    8048ebb <phase_6+0xb3>\n\n\n # å¾ªç¯B å¼€å§‹ ---- å°†æ•°ç»„å¹³ç§»åˆ°å†…å­˜ä¸­çš„ç‰¹å®šçš„ä½ç½®$0x804a63c å¼€å§‹çš„ä½ç½®ï¼Œ8ä½éš”å¼€\n # è¿™æ˜¯ä¸ªé“¾è¡¨\n 8048e87:\t8b 45 f0             \tmov    -0x10(%ebp),%eax     # æ˜¯ä¸ªåœ°å€$0x804a63cï¼Œæå‰å­˜æœ‰ 0x329 = 809\n 8048e8a:\t89 45 f4             \tmov    %eax,-0xc(%ebp)      # t[1] è¡¨ç¤ºä¸Šä¸€æ¬¡çš„è®¡ç®—ç»“æœ = $0x804a63c\n 8048e8d:\tc7 45 fc 01 00 00 00 \tmovl   $0x1,-0x4(%ebp)      # tj = 1\n 8048e94:\teb 0c                \tjmp    8048ea2 <phase_6+0x9a>\n\n 8048e96:\t8b 45 f4             \tmov    -0xc(%ebp),%eax      # t[0]åœ°å€$0x804a63c\n 8048e99:\t8b 40 08             \tmov    0x8(%eax),%eax\t\t# 0x8(%eax) =$0x804a644 -> $0x804a630\n 8048e9c:\t89 45 f4             \tmov    %eax,-0xc(%ebp)      # é“¾è¡¨ç»“ç‚¹ä¸‹ç§»\n 8048e9f:\tff 45 fc             \tincl   -0x4(%ebp)           # tj++\n\n 8048ea2:\t8b 45 f8             \tmov    -0x8(%ebp),%eax\n 8048ea5:\t8b 44 85 d8          \tmov    -0x28(%ebp,%eax,4),%eax # arr[j]\n 8048ea9:\t3b 45 fc             \tcmp    -0x4(%ebp),%eax         # tj\n 8048eac:\t7f e8                \tjg     8048e96 <phase_6+0x8e>  # arr[j]>tj å¤§äº\n\n 8048eae:\t8b 55 f8             \tmov    -0x8(%ebp),%edx         # edx = j\n 8048eb1:\t8b 45 f4             \tmov    -0xc(%ebp),%eax\t\t   # eax = t[0]\n 8048eb4:\t89 44 95 c0          \tmov    %eax,-0x40(%ebp,%edx,4) # å­˜å‚¨ç»Ÿè®¡ç»“æœ\n 8048eb8:\tff 45 f8             \tincl   -0x8(%ebp)              # j++\n\n 8048ebb:\t83 7d f8 05          \tcmpl   $0x5,-0x8(%ebp)\n 8048ebf:\t7e c6                \tjle    8048e87 <phase_6+0x7f> # j<=5 å¾ªç¯ï¼ˆéå†6ä¸ªå…ƒç´ ï¼‰\n# å¾ªç¯B ------------------------ ç»“æŸ\n\n 8048ec1:\t8b 45 c0             \tmov    -0x40(%ebp),%eax   # arr8[0]\n 8048ec4:\t89 45 f0             \tmov    %eax,-0x10(%ebp)   #  \n 8048ec7:\t8b 45 f0             \tmov    -0x10(%ebp),%eax\n 8048eca:\t89 45 f4             \tmov    %eax,-0xc(%ebp)    # t[1] å­˜å‚¨ä¸Šä¸€æ¬¡è¿ç®—ç»“æœ = arr8[0]\n 8048ecd:\tc7 45 f8 01 00 00 00 \tmovl   $0x1,-0x8(%ebp)    # k = 1\n 8048ed4:\teb 19                \tjmp    8048eef <phase_6+0xe7>\n\n# å¾ªç¯C ------------------------- å¼€å§‹ è°ƒæ•´é“¾è¡¨å†…çš„é¡ºåº\n 8048ed6:\t8b 45 f8             \tmov    -0x8(%ebp),%eax    # k\n 8048ed9:\t8b 54 85 c0          \tmov    -0x40(%ebp,%eax,4),%edx # edx = arr8[k]\n 8048edd:\t8b 45 f4             \tmov    -0xc(%ebp),%eax         # eax = $0x804a63c\n 8048ee0:\t89 50 08             \tmov    %edx,0x8(%eax)          # $0x804a63c+8 = arr8[k]\n 8048ee3:\t8b 45 f4             \tmov    -0xc(%ebp),%eax\n 8048ee6:\t8b 40 08             \tmov    0x8(%eax),%eax          # $0x804a63c+8\n 8048ee9:\t89 45 f4             \tmov    %eax,-0xc(%ebp)         # åŸºåœ°å€ä¸Šç§»8\n 8048eec:\tff 45 f8             \tincl   -0x8(%ebp)          # k++\n\n 8048eef:\t83 7d f8 05          \tcmpl   $0x5,-0x8(%ebp)  \n 8048ef3:\t7e e1                \tjle    8048ed6 <phase_6+0xce>  # k<=5 å¾ªç¯ï¼ˆéå†5ä¸ªå…ƒç´ ï¼Œå› ä¸ºkä»1å¼€å§‹çš„ï¼‰\n# å¾ªç¯C -------------------------- ç»“æŸ\n\n 8048ef5:\t8b 45 f4             \tmov    -0xc(%ebp),%eax\n 8048ef8:\tc7 40 08 00 00 00 00 \tmovl   $0x0,0x8(%eax)   # åŸºå€è®¾ç½®ä¸º0\n 8048eff:\t8b 45 f0             \tmov    -0x10(%ebp),%eax # é‡æ–°è·å–$0x804a63c\n 8048f02:\t89 45 f4             \tmov    %eax,-0xc(%ebp)\n 8048f05:\tc7 45 f8 00 00 00 00 \tmovl   $0x0,-0x8(%ebp) # l = 0\n 8048f0c:\teb 22                \tjmp    8048f30 <phase_6+0x128>\n\n# å¾ªç¯ D -------- å¼€å§‹ï¼šå·¦è¾¹çš„æ•°å¤§äºå³è¾¹çš„æ•°\n 8048f0e:\t8b 45 f4             \tmov    -0xc(%ebp),%eax # $0x804a63c\n 8048f11:\t8b 10                \tmov    (%eax),%edx\n 8048f13:\t8b 45 f4             \tmov    -0xc(%ebp),%eax\n 8048f16:\t8b 40 08             \tmov    0x8(%eax),%eax\n 8048f19:\t8b 00                \tmov    (%eax),%eax\n 8048f1b:\t39 c2                \tcmp    %eax,%edx       # ç›¸éš” 8  çš„ä¸¤ä¸ªåŸºå€\n 8048f1d:\t7d 05                \tjge    8048f24 <phase_6+0x11c> #å¿…é¡»ï¼š å·¦åŸºå€ >= å³åŸºå€ \n 8048f1f:\te8 c2 07 00 00       \tcall   80496e6 <explode_bomb>\n 8048f24:\t8b 45 f4             \tmov    -0xc(%ebp),%eax\n 8048f27:\t8b 40 08             \tmov    0x8(%eax),%eax # åŸºå€+8\n 8048f2a:\t89 45 f4             \tmov    %eax,-0xc(%ebp) # åŸºå€æ›´æ–°\n 8048f2d:\tff 45 f8             \tincl   -0x8(%ebp)     # l++\n\n 8048f30:\t83 7d f8 04          \tcmpl   $0x4,-0x8(%ebp) # l<=4 5 æ¬¡\n 8048f34:\t7e d8                \tjle    8048f0e <phase_6+0x106>\n# å¾ªç¯Dç»“æŸ\n\n 8048f36:\tc9                   \tleave  \n 8048f37:\tc3                   \tret   \n```\n\næœ¬ä¾‹ä¸­å‡ºç°çš„é­”æ•° `0x804a63c` ä¸ºé“¾è¡¨å¤´ç»“ç‚¹åœ°å€ï¼Œé€šè¿‡ GDB æˆ‘ä»¬å¯ä»¥å¾—çŸ¥é“¾è¡¨ç»“ç‚¹åœ°å€ä»¥åŠå­˜å‚¨çš„å€¼ï¼š\n\n```gdb\n; 0x804a63c 0x329\n; 0x804a630 0x124\n; 0x804a638 0x325\n; 0x804a62c 0x178\n; 0x804a620 0x207\n; 0x804a614 0x92\n; 0x804a608 0x00 NULL\n```\n\nè¾“å…¥çš„æ•°ç»„è¦æ±‚ï¼š\n\n1. 6 ä¸ªæ•°å­—äº’ä¸ç›¸åŒï¼ŒèŒƒå›´ 1~6\n2. ç¬¬ n ä¸ªæ•°å­—å€¼ vï¼Œä»£è¡¨ç¬¬ n ä¸ªç»“ç‚¹æ’åºåçš„ä½ç½®ä¸º v\n3. ç»“ç‚¹æ’åºåçš„ç»“æœä¸ºï¼šç»“ç‚¹ä»£è¡¨çš„å€¼é™åºæ’åº\n\nè§£æåŠè¦ç‚¹ï¼š\n\n- æœ¬å±‚éœ€è¾“å…¥ 6 ä¸ªæ•°å­—å¯¹é“¾è¡¨è¿›è¡Œæ’åºï¼Œä½¿å¾—æ’åºç»“æœæ»¡è¶³ç›®æ ‡è¦æ±‚\n- å¿…é¡»è¯†åˆ«å‡ºè¿™æ˜¯ä¸ªé“¾è¡¨\n- é€ä¸ªå¾ªç¯é˜…è¯»\n\nç‚¹è¯„ä¸æç¤ºï¼š\n\n- è€å¿ƒè€å¿ƒè€å¿ƒ\n\n## Secret Phase\n\næ‹†é™¤ç‚¸å¼¹å„å±‚çš„æç¤ºè¯­å¦‚ä¸‹ï¼š\n\n```text\nWelcome to my fiendish little bomb. You have 6 phases with\nwhich to blow yourself up. Have a nice day!\nPhase 1 defused. How about the next one?\nThat's number 2.  Keep going!\nHalfway there!\nSo you got that one.  Try this one.\nGood work!  On to the next...\nCongratulations! You've defused the bomb!\n```\n\nä½†è¿™å¹¶ä¸æ„å‘³ç€ç‚¸å¼¹å·²ç»æ‹†é™¤å®Œæˆï¼Œæ³¨æ„åˆ° `bomb.c` æ–‡ä»¶ä¸­æœ‰é‚ªæ¶åšå£«ğŸ˜ˆåœ¨æœ€åä¸€å±‚ç‚¸å¼¹æ‹†é™¤æ—¶ç•™ä¸‹çš„æ³¨é‡Šï¼š\n\n```c\n/* Wow, they got it!  But isn't something... missing?  Perhaps\n* something they overlooked?  Mua ha ha ha ha! */\n```\n\nåæ±‡ç¼–å¾—åˆ°çš„æ±‡ç¼–ä»£ç ä¸­è¿˜å­˜åœ¨ä¸€äº›éšè—å†…å®¹ï¼š`<func7>` ä»¥åŠ `<secret_phase>` å‡½æ•°ã€‚\n\nè¿™éƒ¨åˆ†å°±ç•™ç»™è¯»è€…è‡ªå·±è§£å†³å•¦~~ åæ­£åŠ©æ•™é€šè¿‡æˆ‘çš„å®éªŒäº†ï¼Œä¸ºäº†ã€Œå®Œç¾ä¸»ä¹‰ã€ï¼Œæˆ‘æœ‰æ—¶é—´åœ¨å¼„å§ã€‚\n\n> çœ‹èµ·æ¥ä¸å¤šå‘¢ã€‚\n\n```asm\n08048f38 <fun7>:\n 8048f38:\t55                   \tpush   %ebp\n 8048f39:\t89 e5                \tmov    %esp,%ebp\n 8048f3b:\t83 ec 0c             \tsub    $0xc,%esp\n 8048f3e:\t83 7d 08 00          \tcmpl   $0x0,0x8(%ebp)\n 8048f42:\t75 09                \tjne    8048f4d <fun7+0x15>\n 8048f44:\tc7 45 fc ff ff ff ff \tmovl   $0xffffffff,-0x4(%ebp)\n 8048f4b:\teb 54                \tjmp    8048fa1 <fun7+0x69>\n 8048f4d:\t8b 45 08             \tmov    0x8(%ebp),%eax\n 8048f50:\t8b 00                \tmov    (%eax),%eax\n 8048f52:\t3b 45 0c             \tcmp    0xc(%ebp),%eax\n 8048f55:\t7e 1c                \tjle    8048f73 <fun7+0x3b>\n 8048f57:\t8b 45 08             \tmov    0x8(%ebp),%eax\n 8048f5a:\t8b 50 04             \tmov    0x4(%eax),%edx\n 8048f5d:\t8b 45 0c             \tmov    0xc(%ebp),%eax\n 8048f60:\t89 44 24 04          \tmov    %eax,0x4(%esp)\n 8048f64:\t89 14 24             \tmov    %edx,(%esp)\n 8048f67:\te8 cc ff ff ff       \tcall   8048f38 <fun7>\n 8048f6c:\t01 c0                \tadd    %eax,%eax\n 8048f6e:\t89 45 fc             \tmov    %eax,-0x4(%ebp)\n 8048f71:\teb 2e                \tjmp    8048fa1 <fun7+0x69>\n 8048f73:\t8b 45 08             \tmov    0x8(%ebp),%eax\n 8048f76:\t8b 00                \tmov    (%eax),%eax\n 8048f78:\t3b 45 0c             \tcmp    0xc(%ebp),%eax\n 8048f7b:\t75 09                \tjne    8048f86 <fun7+0x4e>\n 8048f7d:\tc7 45 fc 00 00 00 00 \tmovl   $0x0,-0x4(%ebp)\n 8048f84:\teb 1b                \tjmp    8048fa1 <fun7+0x69>\n 8048f86:\t8b 45 08             \tmov    0x8(%ebp),%eax\n 8048f89:\t8b 50 08             \tmov    0x8(%eax),%edx\n 8048f8c:\t8b 45 0c             \tmov    0xc(%ebp),%eax\n 8048f8f:\t89 44 24 04          \tmov    %eax,0x4(%esp)\n 8048f93:\t89 14 24             \tmov    %edx,(%esp)\n 8048f96:\te8 9d ff ff ff       \tcall   8048f38 <fun7>\n 8048f9b:\t01 c0                \tadd    %eax,%eax\n 8048f9d:\t40                   \tinc    %eax\n 8048f9e:\t89 45 fc             \tmov    %eax,-0x4(%ebp)\n 8048fa1:\t8b 45 fc             \tmov    -0x4(%ebp),%eax\n 8048fa4:\tc9                   \tleave  \n 8048fa5:\tc3                   \tret    \n\n08048fa6 <secret_phase>:\n 8048fa6:\t55                   \tpush   %ebp\n 8048fa7:\t89 e5                \tmov    %esp,%ebp\n 8048fa9:\t83 ec 18             \tsub    $0x18,%esp\n 8048fac:\te8 a9 03 00 00       \tcall   804935a <read_line>\n 8048fb1:\t89 45 f4             \tmov    %eax,-0xc(%ebp)\n 8048fb4:\t8b 45 f4             \tmov    -0xc(%ebp),%eax\n 8048fb7:\t89 04 24             \tmov    %eax,(%esp)\n 8048fba:\te8 99 f8 ff ff       \tcall   8048858 <atoi@plt>\n 8048fbf:\t89 45 f8             \tmov    %eax,-0x8(%ebp)\n 8048fc2:\t83 7d f8 00          \tcmpl   $0x0,-0x8(%ebp)\n 8048fc6:\t7e 09                \tjle    8048fd1 <secret_phase+0x2b>\n 8048fc8:\t81 7d f8 e9 03 00 00 \tcmpl   $0x3e9,-0x8(%ebp)\n 8048fcf:\t7e 05                \tjle    8048fd6 <secret_phase+0x30>\n 8048fd1:\te8 10 07 00 00       \tcall   80496e6 <explode_bomb>\n 8048fd6:\t8b 45 f8             \tmov    -0x8(%ebp),%eax\n 8048fd9:\t89 44 24 04          \tmov    %eax,0x4(%esp)\n 8048fdd:\tc7 04 24 f0 a6 04 08 \tmovl   $0x804a6f0,(%esp)\n 8048fe4:\te8 4f ff ff ff       \tcall   8048f38 <fun7>\n 8048fe9:\t89 45 fc             \tmov    %eax,-0x4(%ebp)\n 8048fec:\t83 7d fc 06          \tcmpl   $0x6,-0x4(%ebp)\n 8048ff0:\t74 05                \tje     8048ff7 <secret_phase+0x51>\n 8048ff2:\te8 ef 06 00 00       \tcall   80496e6 <explode_bomb>\n 8048ff7:\tc7 04 24 38 9a 04 08 \tmovl   $0x8049a38,(%esp)\n 8048ffe:\te8 c5 f7 ff ff       \tcall   80487c8 <puts@plt>\n 8049003:\te8 08 07 00 00       \tcall   8049710 <phase_defused>\n 8049008:\tc9                   \tleave  \n 8049009:\tc3                   \tret    \n 804900a:\t90                   \tnop\n 804900b:\t90                   \tnop\n```\n\n# åç»­ä»»åŠ¡\n\n- [ ] æœ‰æ—¶é—´å†å®Œå–„éšè—å±‚éƒ¨åˆ†çš„å†…å®¹\n\n# æœ¬æ–‡å‚è€ƒ\n\n- [CSAPP | Lab2-Bomb Lab æ·±å…¥è§£æ - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/472178808) æ–‡ç« æç¤ºäº†æˆ‘ç¬¬å…­å±‚é‚£ä¸ªæ•°æ®ç»“æ„æ˜¯ä¸ªé“¾è¡¨ğŸ˜…\n","categories":[{"name":"CSAPP LABS","api":"api/categories/CSAPP-LABS.json"}],"tags":[{"name":"CSAPP","api":"api/tags/CSAPP.json"},{"name":"ASM","api":"api/tags/ASM.json"},{"name":"C","api":"api/tags/C.json"},{"name":"å®éªŒ","api":"api/tags/å®éªŒ.json"},{"name":"GDB","api":"api/tags/GDB.json"},{"name":"objdump","api":"api/tags/objdump.json"}]},"api":"api/posts/p/d1f3cf37.json"}