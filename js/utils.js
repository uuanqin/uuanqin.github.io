(()=>{var btfFn={debounce:(func,wait=0,immediate=!1)=>{let timeout;return(...args)=>{var callNow=immediate&&!timeout;clearTimeout(timeout),timeout=setTimeout(()=>{timeout=null,immediate||func(...args)},wait),callNow&&func(...args)}},throttle:function(func,wait,options={}){let timeout,context,args,previous=0,later=()=>{previous=!1===options.leading?0:(new Date).getTime(),timeout=null,func.apply(context,args),timeout||(context=args=null)};return(...params)=>{var now=(new Date).getTime(),remaining=(previous||!1!==options.leading||(previous=now),wait-(now-previous));context=this,args=params,remaining<=0||wait<remaining?(timeout&&(clearTimeout(timeout),timeout=null),previous=now,func.apply(context,args),timeout||(context=args=null)):timeout||!1===options.trailing||(timeout=setTimeout(later,remaining))}},overflowPaddingR:{add:()=>{var menuElement,paddingRight=window.innerWidth-document.body.clientWidth;0<paddingRight&&(document.body.style.paddingRight=paddingRight+'px',document.body.style.overflow='hidden',menuElement=document.querySelector('#page-header.nav-fixed #menus'))&&(menuElement.style.paddingRight=paddingRight+'px')},remove:()=>{document.body.style.paddingRight='',document.body.style.overflow='';var menuElement=document.querySelector('#page-header.nav-fixed #menus');menuElement&&(menuElement.style.paddingRight='')}},snackbarShow:(text,showAction=!1,duration=2e3)=>{var{position,bgLight,bgDark}=GLOBAL_CONFIG.Snackbar,bgLight='light'===document.documentElement.getAttribute('data-theme')?bgLight:bgDark;Snackbar.show({text:text,backgroundColor:bgLight,showAction:showAction,duration:duration,pos:position,customClass:'snackbar-css'})},diffDate:(inputDate,more=!1)=>{var dateNow=new Date,inputDate=new Date(inputDate),dateNow=(dateNow-inputDate)/1e3/60,diffHour=dateNow/60,diffDay=diffHour/24,diffMonth=diffDay/30,dateSuffix=GLOBAL_CONFIG.dateSuffix;return more?12<diffMonth?inputDate.toISOString().slice(0,10):1<=diffMonth?Math.floor(diffMonth)+' '+dateSuffix.month:1<=diffDay?Math.floor(diffDay)+' '+dateSuffix.day:1<=diffHour?Math.floor(diffHour)+' '+dateSuffix.hour:1<=dateNow?Math.floor(dateNow)+' '+dateSuffix.min:dateSuffix.just:Math.floor(diffDay)},loadComment:(dom,callback)=>{if('IntersectionObserver'in window){let observerItem=new IntersectionObserver(entries=>{entries[0].isIntersecting&&(callback(),observerItem.disconnect())},{threshold:[0]});observerItem.observe(dom)}else callback()},scrollToDest:(pos,time=500)=>{let currentPos=window.scrollY;var isNavFixed=document.getElementById('page-header').classList.contains('fixed');if((currentPos>pos||isNavFixed)&&(pos-=70),'scrollBehavior'in document.documentElement.style)window.scrollTo({top:pos,behavior:'smooth'});else{let startTime=performance.now(),animate=currentTime=>{currentTime-=startTime,currentTime=Math.min(currentTime/time,1);window.scrollTo(0,currentPos+(pos-currentPos)*currentTime),currentTime<1&&requestAnimationFrame(animate)};requestAnimationFrame(animate)}},animateIn:(ele,animation)=>{ele.style.display='block',ele.style.animation=animation},animateOut:(ele,animation)=>{let handleAnimationEnd=()=>{ele.style.display='',ele.style.animation='',ele.removeEventListener('animationend',handleAnimationEnd)};ele.addEventListener('animationend',handleAnimationEnd),ele.style.animation=animation},wrap:(selector,eleType,options)=>{var key,value,createEle=document.createElement(eleType);for([key,value]of Object.entries(options))createEle.setAttribute(key,value);selector.parentNode.insertBefore(createEle,selector),createEle.appendChild(selector)},isHidden:ele=>0===ele.offsetHeight&&0===ele.offsetWidth,getEleTop:ele=>{let actualTop=ele.offsetTop,current=ele.offsetParent;for(;null!==current;)actualTop+=current.offsetTop,current=current.offsetParent;return actualTop},loadLightbox:ele=>{var service=GLOBAL_CONFIG.lightbox;if('medium_zoom'===service)mediumZoom(ele,{background:'var(--zoom-bg)'});else if('fancybox'===service&&(Array.from(ele).forEach(i=>{var dataSrc,dataCaption;'A'!==i.parentNode.tagName&&(dataSrc=i.dataset.lazySrc||i.src,dataCaption=i.title||i.alt||'',btf.wrap(i,'a',{href:dataSrc,'data-fancybox':'gallery','data-caption':dataCaption,'data-thumb':dataSrc}))}),!window.fancyboxRun)){let options='';options=Fancybox.version<'6'?{Hash:!1,Thumbs:{showOnStart:!1},Images:{Panzoom:{maxScale:4}},Carousel:{transition:'slide'},Toolbar:{display:{left:['infobar'],middle:['zoomIn','zoomOut','toggle1to1','rotateCCW','rotateCW','flipX','flipY'],right:['slideshow','thumbs','close']}}}:{Hash:!1,Carousel:{transition:'slide',Thumbs:{showOnStart:!1},Toolbar:{display:{left:['counter'],middle:['zoomIn','zoomOut','toggle1to1','rotateCCW','rotateCW','flipX','flipY','reset'],right:['autoplay','thumbs','close']}},Zoomable:{Panzoom:{maxScale:4}}}},Fancybox.bind('[data-fancybox]',options),window.fancyboxRun=!0}},setLoading:{add:ele=>{ele.insertAdjacentHTML('afterend',`
        <div class="loading-container">
          <div class="loading-item">
            <div></div><div></div><div></div><div></div><div></div>
          </div>
        </div>
      `)},remove:ele=>{ele.nextElementSibling.remove()}},updateAnchor:anchor=>{var title;anchor!==window.location.hash&&(anchor=anchor||location.pathname,title=GLOBAL_CONFIG_SITE.title,window.history.replaceState({url:location.href,title:title},title,anchor))},getScrollPercent:(()=>{let docHeight,winHeight,headerHeight,contentMath;return(currentTop,ele)=>{docHeight&&ele.clientHeight===docHeight||(docHeight=ele.clientHeight,winHeight=window.innerHeight,headerHeight=ele.offsetTop,contentMath=Math.max(docHeight-winHeight,document.documentElement.scrollHeight-winHeight));ele=(currentTop-headerHeight)/contentMath;return Math.max(0,Math.min(100,Math.round(100*ele)))}})(),addEventListenerPjax:(ele,event,fn,option=!1)=>{ele.addEventListener(event,fn,option),btf.addGlobalFn('pjaxSendOnce',()=>{ele.removeEventListener(event,fn,option)})},removeGlobalFnEvent:(key,parent=window)=>{parent=parent.globalFn||{};let keyObj=parent[key];keyObj&&(Object.keys(keyObj).forEach(i=>keyObj[i]()),delete parent[key])},switchComments:(el=document,path)=>{var switchBtn=el.querySelector('#switch-btn');if(switchBtn){let switchDone=!1,postComment=el.querySelector('#post-comment');btf.addEventListenerPjax(switchBtn,'click',()=>{postComment.classList.toggle('move'),switchDone||'function'!=typeof loadOtherComment||(switchDone=!0,loadOtherComment(el,path))})}}};window.btf={...window.btf,...btfFn}})();