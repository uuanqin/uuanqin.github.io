{"title":"将 CDN 缓存自动刷新加入到博客发布的工作流（Hexo、WordPress）","tags":["CDN","API","Node.js","JavaScript","Hexo","WordPress","php","SDK","腾讯云","对象存储","COS"],"cover":"https://cdn.gallery.uuanqin.top/img/tencentcdn545.jpg","abbrlink":"b05ac1ee","description":"本文提供两类博客刷新CDN方法，另附有腾讯云SDK的使用介绍以及API KEY安全使用方法","categories":["核心协同","自动化"],"date":"2023-05-01T00:15:18.000Z","summary":"> [!success] 本文已收录至 Butterfly 主题美化教程 使用了 CDN 加速源站的小伙伴可能会遇到一个问题，那就是每次发布博客到服务器后，都需要手动在腾讯云控制台进行节点的缓存刷新，很是麻烦。这里我介绍几种刷新 CDN 缓存的方法，对于 Hexo 博客，将着重介绍通过脚本的思路实现一键发布的具体流程。 方案一：腾讯云对象存储的 CDN 刷新 首先介绍官方方案。点击存储桶后可以找到 CDN 缓存刷新函数，这是一项收费服务。有兴趣的小伙伴可以试一试。 方案二：自写 JS 脚本并利用钩子实现（Hexo 方案） 思路（`package.json` 编写） 在接触 Hexo 博客建站的时候，你一定会知道 Hexo 三连： > 命令含义参考：指令 | Hexo 上面的命令可以写进 `[blog_root]/package.json` 的 `scripts` 中，如： 这样每次部署我们只需要运行 `npm run publish` 即可完成连击。 在完成博客部署连击后，我们可以再执行一个脚本刷新腾讯云 CDN 缓存。我打算写一个 js 脚本 `auto_flush_cdn.js` 用 node 运行（毕竟玩 Hexo 总会装有 Node.js 的吧）。 这样我们的部署脚本就会是这样： 或者利用钩子： 现在的问题就是 `auto_flush_cdn.js` 该如何写。 使用腾讯云 SDK 进行开发 登录腾讯云后，打开云产品>云 API： 我们要使用腾讯云 SDK，需要先安装依赖： 这里我就安装在博客目录了：博客下新建终端运行命令 `npm install tencentcloud-sdk-nodejs-cdn --save` > [!hint] 「找不到模块」的解决方案 > 实践中遇到找不到模块的问题，安装好依赖后记得重启终端、VSCode 甚至电脑。如果不行请另外搜索解决方案。 然后找到对应的 API，按照平台指示的说明填写好参数，充分利用其诊断工具进行在线调试。（一般不会出什么问题） 没有问题的话我们就可以把平台代码复制下来了，在代码中改改 API ID 和 API KEY 参数即可。 > [!warning] 密钥安全性提示 > 此处 API ID 和 API KEY 参数填写仅供演示。为了安全起见，建议不要在代码中写入任何的密匙。详情看下一小节。..."}