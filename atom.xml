<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>半方池水半方田</title>
  
  <subtitle>Qinq的个人博客</subtitle>
  <link href="https://www.uuanqin.top/atom.xml" rel="self"/>
  
  <link href="https://www.uuanqin.top/"/>
  <updated>2023-05-30T14:54:11.706Z</updated>
  <id>https://www.uuanqin.top/</id>
  
  <author>
    <name>Wuanqin</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Butterfly主题自定义侧边栏尝试</title>
    <link href="https://www.uuanqin.top/p/4776e2ad.html"/>
    <id>https://www.uuanqin.top/p/4776e2ad.html</id>
    <published>2023-05-30T14:12:22.000Z</published>
    <updated>2023-05-30T14:54:11.706Z</updated>
    
    <content type="html"><![CDATA[<p>自定义侧边栏是Hexo主题Butterfly的新功能，在进行侧边栏增加时首先阅读官方文档：<a href="https://butterfly.js.org/posts/ea33ab97/">自定義側邊欄 | Butterfly</a>。</p><p>这里记录一下我的探索过程。重申，本人前端小透明，一切实现全靠摸索。</p><p>首先，在<a href="https://codepen.io/trending">Trending - CodePen</a>找到自己想要的小组件，以小风车为例<a href="https://codepen.io/FilipVitas/pen/zWWmbo">Windmill (codepen.io)</a>，进入代码编辑界面，里面有HTML代码和CSS代码。</p><h1 id="CSS准备"><a href="#CSS准备" class="headerlink" title="CSS准备"></a>CSS准备</h1><p>点击代码框右上小箭头，编译css文件：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230530222130344.png" alt="image-20230530222130344"></p><p>复制里面的的代码到新文件windmill.css。将新文件放在合适的位置并在主题配置中inject（优雅改的基础步骤，详见这篇文章《》）。</p><p>删除不必要代码（否则导致博客异常）并稍微修改一下类选择器（以防万一）：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">- *,</span></span><br><span class="line"><span class="deletion">- *:before,</span></span><br><span class="line"><span class="deletion">- *:after &#123;</span></span><br><span class="line"><span class="deletion">-   ...</span></span><br><span class="line"><span class="deletion">- &#125;</span></span><br><span class="line"><span class="deletion">- body &#123;</span></span><br><span class="line"><span class="deletion">-   ...</span></span><br><span class="line"><span class="deletion">- &#125;</span></span><br><span class="line"><span class="deletion">- .inspiration &#123;</span></span><br><span class="line"><span class="deletion">- ...</span></span><br><span class="line"><span class="deletion">- &#125;</span></span><br><span class="line"><span class="deletion">- .center &#123;</span></span><br><span class="line"><span class="deletion">- ...</span></span><br><span class="line"><span class="deletion">- &#125;</span></span><br><span class="line"><span class="deletion">- @media screen and (max-height: 500px) &#123;</span></span><br><span class="line"><span class="deletion">- ...</span></span><br><span class="line"><span class="deletion">- &#125;</span></span><br><span class="line"><span class="addition">+ /* 这是为了让svg居中 */</span></span><br><span class="line"><span class="addition">+ .windmill &#123;</span></span><br><span class="line"><span class="addition">+     display: flex;</span></span><br><span class="line"><span class="addition">+     align-items: center;</span></span><br><span class="line"><span class="addition">+     justify-content: center;</span></span><br><span class="line"><span class="addition">+ &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="addition">+ /* 以下关于svg类选择器加上.windmill */</span></span><br><span class="line"><span class="deletion">- svg &#123;</span></span><br><span class="line"><span class="addition">+ svg.windmill &#123;</span></span><br><span class="line">  overflow: visible;</span><br><span class="line">&#125;</span><br><span class="line"><span class="deletion">- svg .blades &#123;</span></span><br><span class="line"><span class="addition">+ svg .blades.windmill &#123;</span></span><br><span class="line">...</span><br><span class="line">&#125;</span><br><span class="line"><span class="deletion">- svg .clouds path:nth-child(1) &#123;</span></span><br><span class="line"><span class="addition">+ svg .clouds.windmill path:nth-child(1) &#123;</span></span><br><span class="line">...</span><br><span class="line">&#125;</span><br><span class="line"><span class="deletion">- svg .clouds path:nth-child(2) &#123;</span></span><br><span class="line"><span class="addition">+ svg .clouds.windmill path:nth-child(2) &#123;</span></span><br><span class="line">...</span><br><span class="line">&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure><h1 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h1><p>只提取代码中第一个div元素，并对相关元素增加windmill类：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">-&lt;div class=&quot;center&quot;&gt;</span></span><br><span class="line"><span class="addition">+&lt;div class=&quot;windmill&quot;&gt;</span></span><br><span class="line"><span class="deletion">-  &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;615.66 311.71 271.03 207.66&quot; width=&quot;271.03&quot; height=&quot;207.66&quot;&gt;</span></span><br><span class="line"><span class="deletion">-   &lt;g class=&quot;clouds&quot; fill=&quot;none&quot; stroke-width=&quot;3&quot; stroke=&quot;#BED3CF&quot; stroke-linejoin=&quot;round&quot; stroke-linecap=&quot;round&quot; stroke-miterlimit=&quot;3&quot;&gt;</span></span><br><span class="line"><span class="addition">+ &lt;svg class=&quot;windmill&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;615.66 311.71 271.03 207.66&quot; width=&quot;271.03&quot; height=&quot;207.66&quot;&gt;</span></span><br><span class="line"><span class="addition">+ &lt;g class=&quot;clouds windmill&quot; fill=&quot;none&quot; stroke-width=&quot;3&quot; stroke=&quot;#BED3CF&quot; stroke-linejoin=&quot;round&quot; stroke-linecap=&quot;round&quot; stroke-miterlimit=&quot;3&quot;&gt;</span></span><br><span class="line">        ...</span><br><span class="line">    &lt;/g&gt;</span><br><span class="line">...</span><br><span class="line"><span class="deletion">- &lt;g class=&quot;blades&quot; fill=&quot;#FFF&quot; stroke-width=&quot;3&quot; stroke=&quot;#4A5370&quot; stroke-linejoin=&quot;round&quot; stroke-miterlimit=&quot;3&quot;&gt;</span></span><br><span class="line"><span class="addition">+ &lt;g class=&quot;blades windmill&quot; fill=&quot;#FFF&quot; stroke-width=&quot;3&quot; stroke=&quot;#4A5370&quot; stroke-linejoin=&quot;round&quot; stroke-miterlimit=&quot;3&quot;&gt;</span></span><br><span class="line">...</span><br><span class="line">  &lt;/g&gt;</span><br><span class="line">&lt;/svg&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><p>在widget.yml中是这样的：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230530223905933.png" alt="image-20230530223905933"></p><p>注意YAML文件中的缩进！否则会报这样的错误：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">can not read a block mapping entry; a multiline key may not be an implicit key</span><br></pre></td></tr></table></figure><h1 id="效果预览"><a href="#效果预览" class="headerlink" title="效果预览"></a>效果预览</h1><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230530224311630.png" alt="image-20230530224311630"></p>]]></content>
    
    
    <summary type="html">一次自定义侧边栏的尝试</summary>
    
    
    
    <category term="计算机" scheme="https://www.uuanqin.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/"/>
    
    <category term="Hexo" scheme="https://www.uuanqin.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/Hexo/"/>
    
    
    <category term="CSS" scheme="https://www.uuanqin.top/tags/CSS/"/>
    
    <category term="HTML" scheme="https://www.uuanqin.top/tags/HTML/"/>
    
    <category term="Butterfly" scheme="https://www.uuanqin.top/tags/Butterfly/"/>
    
  </entry>
  
  <entry>
    <title>Git-flow：git的分支管理策略</title>
    <link href="https://www.uuanqin.top/p/6eb2089c.html"/>
    <id>https://www.uuanqin.top/p/6eb2089c.html</id>
    <published>2023-05-27T13:51:53.000Z</published>
    <updated>2023-05-29T16:17:43.192Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://nvie.com/posts/a-successful-git-branching-model/">A successful Git branching model</a>是一篇有名的分支管理策略（Git-Flow）的学习，下面文章以这篇文章为基础，介绍Git-Flow工作流，顺便练一下英语。这篇不是简单的英文翻译，里面杂合了我的理解与外部参考。</p><blockquote><p>参考：</p><ul><li><a href="https://nvie.com/posts/a-successful-git-branching-model/">A successful Git branching model » nvie.com</a></li><li><a href="http://www.ruanyifeng.com/blog/2012/07/git.html">Git分支管理策略 - 阮一峰的网络日志 (ruanyifeng.com)</a></li></ul></blockquote><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>这篇文章诞生于10年前，那时Git刚诞生不久。在这10年里，许多团队都把它当成了“准则”和“灵丹妙药”。现在，越来越多的软件类型转向了web应用，而这些应用一般是持续交付的，而不是回滚式的，因此不需要支持多版本管理。如果软件开发团队正在做持续交付的软件，那么可以参考更简单的工作流（如<a href="https://docs.github.com/zh/get-started/quickstart/github-flow">GitHub 流</a>）而不是非得使用git-flow。</p><p>当然了，学习前需要记住，世界上没有灵丹妙药。要考虑自己的情况选择自己的工作流。</p><h1 id="为什么选择Git"><a href="#为什么选择Git" class="headerlink" title="为什么选择Git"></a>为什么选择Git</h1><p>Git改变了程序员对“合并/分支”的看法。以前（CVS/Subversion时代），“合并/分支”有点可怕：小心合并冲突，不然它会咬你！但有了Git，这些操作将变得成本低廉和简单。由于其简单和可重复性的特性，“合并/分支”不再可怕。</p><h1 id="“去中心化”了但是还要“中心化”"><a href="#“去中心化”了但是还要“中心化”" class="headerlink" title="“去中心化”了但是还要“中心化”"></a>“去中心化”了但是还要“中心化”</h1><p>因为Git是DVCS（分布式管理系统），在技术层面上就没有诸如”中心化“仓库的东西。但是要让我们的模型工作得好，首先就得有一个“中心”的“真实”的仓库。这个中心化的仓库我们称为<code>origin</code>（这个名字对Git用户来说比较熟悉）</p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/centr-decentr@2x.png" style="zoom:50%;" /><p>每一个开发人员都从<code>origin</code>中拉取和推送，与此同时成员之间也互相拉取形成子团队。这适用于2到3个开发人员在对一个软件的重要特性的进行开发的场景。</p><p>上图中，alice和bob、alice和david、david和clair组成了子团队，这意味着Alice定义了一个远程Git仓库名为bob，反之亦然。</p><h1 id="主分支"><a href="#主分支" class="headerlink" title="主分支"></a>主分支</h1><p>中心仓库掌握两个主要的分支，它们有着无限的生命周期：</p><ul><li>master分支：主要分支，<code>HEAD</code>总是指向一个“可以作为产品发布”的状态。</li><li>develop分支：主要分支，<code>HEAD</code>总是指向为下一个版本做准备的最新交付开发版本，它包含了一些针对下一个版本的更改。</li></ul><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/main-branches@2x.png" alt="img" style="zoom:50%;" /><p>当develop中的源代码趋向稳定且做好发布准备时，所有的改变都应以某种方法“合并”回master，并打上版本标签。因此，每一次把所有改变合并回master，根据定义，这将是一个全新的发行版本。对于这一点，我们应严格遵守。所以从理论上来讲，每一次master分支存在提交，我们编写的Git Hook脚本会自动构建并导出我们的软件产品到产品服务器。</p><h1 id="辅助分支"><a href="#辅助分支" class="headerlink" title="辅助分支"></a>辅助分支</h1><p>次于master和develop两个主分支，我们的开发模型使用许多辅助分支以帮助团队成员之间的平行开发、简化特性的追踪、为版本发行做好准备以及对产品临时出现的问题进行修复。与主分支不同，这些分支总是有着有限的生存周期，它们最终将会被永久地移除。</p><p>我们可能会用到的不同辅助分支：</p><ul><li>特性分支（Feature branches）</li><li>预发行分支（Release branches）</li><li>热修复分支（Hotfix branches）</li></ul><p>这些分支有不同的目的，且各自有严格规则约束，这些规则规定了它们原分支和目的分支。从技术上来讲，这些分支并不十分“特殊”，它们都是一般的Git分支，只不过我们以“使用它的方式”进行分类罢了。</p><h3 id="特性分支"><a href="#特性分支" class="headerlink" title="特性分支"></a>特性分支</h3><table><thead><tr><th>可能从哪个分支分出来</th><th>必须合并回哪个分支去</th><th>习惯命名</th></tr></thead><tbody><tr><td>develop</td><td>develop</td><td>除了叫master、develop、release-*或hotfix-*，其他都可以</td></tr></tbody></table><p>特性分支（有时也称主题分支）是用来开发即将到来或远期发行版本新特性的分支。当我们开始开发一个特性时，包含这个特性的发行版本是未知的。特性分支的本质是，只要这个特性还在开发中，它就一直存在，但最终会合并回develop（这就决定了新特性将加入即将发行的版本之中）或丢弃（以防最终的结果令人失望）。</p><p>特性分支一般只存在于开发中的仓库，而不在<code>origin</code>。</p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/fb@2x.png" alt="img" style="zoom:50%;" /><h4 id="创建特性分支"><a href="#创建特性分支" class="headerlink" title="创建特性分支"></a>创建特性分支</h4><p>当我们开始在新特性上进行开发时，我们从develop中分出新分支</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git checkout -b myfeature develop</span><br><span class="line"><span class="comment"># git checkout [-b &lt;new-branch&gt;] [&lt;start-point&gt;]</span></span><br><span class="line"><span class="comment"># Create a new branch named &lt;new-branch&gt;, start it at &lt;start-point&gt;, and check the resulting branch out</span></span><br></pre></td></tr></table></figure><h4 id="在develop分支中合并完成的特性"><a href="#在develop分支中合并完成的特性" class="headerlink" title="在develop分支中合并完成的特性"></a>在develop分支中合并完成的特性</h4><p>开发完成的特性将合并到develop分支中，这就决定了即将发行的版本将包含这个特性。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 合并新特性</span></span><br><span class="line">git checkout develop<span class="comment"># Switched to branch &#x27;develop&#x27;</span></span><br><span class="line">git merge --no-ff myfeature</span><br><span class="line"><span class="comment"># 删除特性分支</span></span><br><span class="line">git branch -d myfeature</span><br><span class="line"><span class="comment"># git branch -d &lt;branchname&gt;</span></span><br><span class="line"><span class="comment"># Delete a branch. </span></span><br><span class="line">git push origin develop</span><br></pre></td></tr></table></figure><p>–no-ff参数解释：</p><p>默认情况下，Git执行”快进式合并”（fast-farward merge，参考<a href="https://sandofsky.com/static/images/fast_forward.pdf">fast_forward</a>），会直接将Master分支指向Develop分支。使用–no-ff参数后，会执行正常合并，在Master分支上生成一个新节点。为了保证版本演进的清晰，我们希望采用这种做法（即使这样做会产生空的commit结点，但利大于弊）。</p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/--no-ff-awdwdwedwad.png" alt="img" style="zoom: 50%;" /><h3 id="预发行分支"><a href="#预发行分支" class="headerlink" title="预发行分支"></a>预发行分支</h3><table><thead><tr><th>可能从哪个分支分出来</th><th>必须合并回哪个分支去</th><th>习惯命名</th></tr></thead><tbody><tr><td>develop</td><td>develop，master</td><td>release-*</td></tr></tbody></table><p>预发布分支，它是指发布正式版本之前（即合并到Master分支之前），我们可能需要有一个预发布的版本进行测试。</p><p>预发行分支辅助新产品发行的准备工作，They allow for last-minute dotting of i’s and crossing t’s. 此外，它允许小错误的修复且为一个发行版本准备元数据（版本号、构建日期等）。通过所有在预发行分支所做的工作，develop分支将被清除以接收下一个大版本的发行。</p><p>从develop分支分叉处新的预发行分支的时刻，就是develop（几乎）反应新发行版本的理想状态的时刻，至少此时所有指向正在构建的发行版本的特性已经合并到develop中（但是指向未来发行版本的特性也许还没有合并进去，它们必须等到那个版本被分出来后，才考虑进行合并）。</p><p>正是在预发行分支存在开始，预发布的版本将被指定一个版本号（不会更早），一直到develop分支反映下一个发行版本变动的那一刻。但是，预发行版本的版本号最终是0.3还是1.0我们是不清楚的。版本号的决定是从预发行分支开始，并由项目的版本号制定规则决定。</p><h4 id="创建一个预发行分支"><a href="#创建一个预发行分支" class="headerlink" title="创建一个预发行分支"></a>创建一个预发行分支</h4><p>预发行分支从develop分支分流出来的。例如，现在的产品版本为1.1.5，我们将有一个大的发行版本出现，develop分支也已经为下一个发行版本准备好了，而且我们决定这个版本将为1.2（而不是1.1.6或2.0）。所以我们分出一条预发行版本分支，其名字反映了新的版本号：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git checkout -b release-1.2 develop <span class="comment"># 切换到新分支 &quot;release-1.2&quot;</span></span><br><span class="line">./bump-version.sh 1.2 <span class="comment"># 文件修改成功，版本升级至1.2</span></span><br><span class="line">git commit -a -m <span class="string">&quot;Bumped version number to 1.2&quot;</span></span><br><span class="line"><span class="comment"># --all: Tell the command to automatically stage files that have been modified and deleted, but new files you have not told Git about are not affected.</span></span><br><span class="line"><span class="comment"># -m &lt;msg&gt;: Use the given &lt;msg&gt; as the commit message.</span></span><br></pre></td></tr></table></figure><p>在创建新分支并切换到它之后，我们提升了版本号。<code>./bump-version.sh</code>在这里是一个虚构的shell脚本，他将改变当前工作中的文件（副本）以反映新的版本（当然，你可以自己手动更改，就是一些文件的更改）。最后，提升的版本号将被提交。</p><p>新的分支也许会存在一段时间，直到这个发行版被推出。在这段时间中，release分支会有很多bug修复（而不是在develop分支中），但严格禁止在这里增加大的特性。大的特性应该合并到develop分支中，并等待下一个发行版本。</p><h4 id="完成一个预发行分支"><a href="#完成一个预发行分支" class="headerlink" title="完成一个预发行分支"></a>完成一个预发行分支</h4><p>当预发行分支准备好发行时，我们必须进行一些操作。首先，预发行分支合并到master分支中（别忘了，master中的每次提交代表的是一个新的发行版本）。其次，master中的提交必须被贴上标签以便未来对这个历史版本的参考。最后，预发行分支中的改变需要合并回develop，这样未来的发行版本中将会包含这些bug修复。</p><p>在Git中提交的步骤：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">git checkout master</span><br><span class="line">git merge --no-ff release-1.2</span><br><span class="line">git tag -a 1.2</span><br><span class="line"><span class="comment"># -a: Make an unsigned, annotated tag object</span></span><br><span class="line"><span class="comment"># 你还可以使用以下标签</span></span><br><span class="line"><span class="comment"># -s: Make a GPG-signed tag, using the default e-mail address’s key. </span></span><br><span class="line"><span class="comment"># -u &lt;key-id&gt;: Make a GPG-signed tag, using the given key.</span></span><br></pre></td></tr></table></figure><p>预发行已经完成，且进行了标签标注以便未来的参考。</p><p>为了保证预发行分支中的改变得到保留，我们需要将其合并到develop分支。在Git中这样做：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git checkout develop <span class="comment"># Switched to branch &#x27;develop&#x27;</span></span><br><span class="line">git merge --no-ff release-1.2</span><br></pre></td></tr></table></figure><p>这个步骤可能会导致合并冲突（或者说是必定冲突，因为我们改变了版本号），如果真的这样那就修复它然后提交。</p><p>现在我们真的要完事了，这个分支我们已经不需要了，把它删掉：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -d release-1.2</span><br></pre></td></tr></table></figure><h3 id="热修复分支"><a href="#热修复分支" class="headerlink" title="热修复分支"></a>热修复分支</h3><table><thead><tr><th>可能从哪个分支分出来</th><th>必须合并回哪个分支去</th><th>习惯命名</th></tr></thead><tbody><tr><td>master</td><td>develop，master</td><td>hotfix-*</td></tr></tbody></table><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/hotfix-branches@2x.png" alt="img" style="zoom:50%;" /><p>热修复分支非常像预发行分支，因为它也是为新产品发行做准备。它的出现是为了应对当前版本中出现的错误情况。当现行发行的产品出现一个紧急的Bug，它必须立即修复，这时热修复分支会从master分支中对应版本的tag分流出来。</p><p>它的本质就是要在develop进行开发的工作团队继续它们的工作，要另一个人去准备好修复这个Bug。</p><h4 id="创建热修复分支"><a href="#创建热修复分支" class="headerlink" title="创建热修复分支"></a>创建热修复分支</h4><p>热修复分支可以从master分支中创建。例如，版本1.2是当前产品发行版本，然而出现了严重Bug。但是develop分支中的改变还是不稳定的，我们需要分支出热修复分支并着手开始解决问题。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git checkout -b hotfix-1.2.1 master <span class="comment"># Switched to a new branch &quot;hotfix-1.2.1&quot;</span></span><br><span class="line">./bump-version.sh 1.2.1 <span class="comment"># 文件修改成功，版本升级至1.2.1</span></span><br><span class="line">git commit -a -m <span class="string">&quot;Bumped version number to 1.2.1&quot;</span></span><br></pre></td></tr></table></figure><p>别忘了分支出热修复分支后提升版本号。</p><p>大约提交几次commit后，修复好Bug。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit -m <span class="string">&quot;Fixed severe production problem&quot;</span></span><br></pre></td></tr></table></figure><h4 id="完成热修复分支"><a href="#完成热修复分支" class="headerlink" title="完成热修复分支"></a>完成热修复分支</h4><p>完成Bug修复后，需要把热修复分支合并到master中以及develop中，这是为了保证修复后的内容也被下一个版本包含。这就很像预发布分支完成后的操作。</p><p>首先，更新master并标注发行版本：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git checkout master</span><br><span class="line">git merge --no-ff hotfix-1.2.1</span><br><span class="line">git tag -a 1.2.1</span><br><span class="line"><span class="comment"># 你还可以使用以下标签</span></span><br><span class="line"><span class="comment"># -s: Make a GPG-signed tag, using the default e-mail address’s key. </span></span><br><span class="line"><span class="comment"># -u &lt;key-id&gt;: Make a GPG-signed tag, using the given key.</span></span><br></pre></td></tr></table></figure><p>然后，把Bug的修复也合并到develop中：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git checkout develop <span class="comment"># Switched to branch &#x27;develop&#x27;</span></span><br><span class="line">git merge --no-ff hotfix-1.2.1</span><br></pre></td></tr></table></figure><p>有一个例外规则是：<strong>当预发布分支存在时，热修复中的改变需要合并到这个预发布分支，而不是develop</strong>。合并的预发布分支的修复，会在预发布分支完成后最终合并到develop中。当然，如果develop分支急需这个修复，你也可以安全的合并到develop中。</p><p>最后，移除热修复分支这个临时分支。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -d hotfix-1.2.1</span><br></pre></td></tr></table></figure><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>如果这个分支模型没有什么重大改变，下面这张图将对你的项目非常有用。<img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/git-model@2x.png" alt="img" style="zoom: 67%;" /></p><blockquote><p>Author: Vincent Driessen </p><p>Original blog post: <a href="http://nvie.com/posts/a-succesful-git-branching-model">http://nvie.com/posts/a-succesful-git-branching-model</a> </p><p>License: Creative Commons BY-SA</p></blockquote><h1 id="English-corner"><a href="#English-corner" class="headerlink" title="English corner"></a>English corner</h1><ul><li><p>the pros and cons of…  …的优缺点</p></li><li><p>flame wars 激烈争论</p></li><li><p>no more than 只是、仅仅</p></li><li><p>vice versa 反之亦然</p></li></ul>]]></content>
    
    
    <summary type="html">这是一篇对分支管理策略学习和探讨。</summary>
    
    
    
    <category term="计算机" scheme="https://www.uuanqin.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/"/>
    
    
    <category term="git" scheme="https://www.uuanqin.top/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>Git基本操作学习</title>
    <link href="https://www.uuanqin.top/p/707592dd.html"/>
    <id>https://www.uuanqin.top/p/707592dd.html</id>
    <published>2023-05-27T07:52:37.000Z</published>
    <updated>2023-05-27T16:49:38.830Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>本文为可视化Git学习项目的学习笔记。初级操作可视化学习：<a href="https://learngitbranching.js.org/?locale=zh_CN">Learn Git Branching</a></p><p>项目地址：<a href="https://github.com/pcottle/learnGitBranching">pcottle/learnGitBranching: An interactive git visualization and tutorial. Aspiring students of git can use this app to educate and challenge themselves towards mastery of git! (github.com)</a></p></blockquote><blockquote><p>Git文档：<a href="https://git-scm.com/doc">Git - Documentation (git-scm.com)</a></p></blockquote><h1 id="Git基本操作"><a href="#Git基本操作" class="headerlink" title="Git基本操作"></a>Git基本操作</h1><h2 id="基本"><a href="#基本" class="headerlink" title="基本"></a>基本</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">git commit <span class="comment"># 新建提交记录</span></span><br><span class="line">git <span class="built_in">log</span>    <span class="comment"># 查看提交记录的hash值</span></span><br><span class="line"></span><br><span class="line">git branch &lt;branch_name&gt; <span class="comment"># 新建分支</span></span><br><span class="line">git checkout &lt;branch/node&gt; <span class="comment"># 切换分支或node</span></span><br><span class="line">git checkout -b &lt;your-branch-name&gt; <span class="comment"># 新建并切换分支</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 分支合并</span></span><br><span class="line">git merge &lt;branch_name&gt; <span class="comment"># 合并branch_name分支到当前分支</span></span><br><span class="line">git rebase &lt;branch_name&gt; <span class="comment"># 把当前分支里的工作直接移到branch_name上</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 自由在提交树移动（支持链式操作）</span></span><br><span class="line"><span class="comment"># 相对引用</span></span><br><span class="line">^ <span class="comment"># 向上移动一个提交记录</span></span><br><span class="line">^^ <span class="comment"># 向上移动两个提交记录</span></span><br><span class="line">~&lt;num&gt; <span class="comment"># 向上移动多个提交记录</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 选择父提交记录</span></span><br><span class="line">^&lt;num&gt;<span class="comment"># 指定合并提交记录的某个父提交。(一个合并提交有两个父提交)</span></span><br><span class="line"></span><br><span class="line">git branch -f &lt;branch&gt; &lt;node&gt; <span class="comment"># 强制修改branch分支位置</span></span><br><span class="line"><span class="comment"># e.g. git branch -f main HEAD~3</span></span><br></pre></td></tr></table></figure><h2 id="Rebase"><a href="#Rebase" class="headerlink" title="Rebase"></a>Rebase</h2><p>Rebase 实际上就是取出一系列的提交记录，“复制”它们，然后在另外一个地方逐个的放下去。</p><p>Rebase 的优势就是可以创造更线性的提交历史，这听上去有些难以理解。如果只允许使用 Rebase 的话，代码库的提交历史将会变得异常清晰。</p><h2 id="HEAD"><a href="#HEAD" class="headerlink" title="HEAD"></a>HEAD</h2><p>HEAD 是一个对当前所在分支的符号引用 —— 也就是指向你正在其基础上进行工作的提交记录。</p><p>HEAD 总是指向当前分支上最近一次提交记录。大多数修改提交树的 Git 命令都是从改变 HEAD 的指向开始的。</p><p>HEAD 通常情况下是指向分支名的（用*表示）。分离的 HEAD 就是让其指向了某个具体的提交记录而不是分支名。</p><h2 id="撤销变更"><a href="#撤销变更" class="headerlink" title="撤销变更"></a>撤销变更</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset &lt;node&gt;  </span><br></pre></td></tr></table></figure><p>通过把分支记录回退几个提交记录来实现撤销改动（对远程分支无效）。</p><p>例如：在C2处执行<code>git reset HEAD~1</code></p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230527163230995.png" alt="image-20230527163230995"></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git revert &lt;node&gt; </span><br></pre></td></tr></table></figure><p>例如：在C2处执行<code>git revert HEAD </code></p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230527163039945.png" alt="image-20230527163039945"></p><p>要撤销的提交记录后面多了一个新提交。新提交记录 C2’ 引入了更改 —— 这些更改刚好是用来撤销 C2 这个提交的。也就是说 C2’ 的状态与 C1 是相同的。revert 之后就可以把你的更改推送到远程仓库。</p><h2 id="修改分支树"><a href="#修改分支树" class="headerlink" title="修改分支树"></a>修改分支树</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git cherry-pick &lt;node&gt;...</span><br></pre></td></tr></table></figure><p>将一些提交复制到当前所在位置。cherry-pick 可以将提交树上任何地方的提交记录取过来追加到 HEAD 上（只要不是 HEAD 上游的提交就没问题）。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rebase --interactive &lt;node&gt;</span><br></pre></td></tr></table></figure><p>如果你在命令后增加了这个选项, Git 会打开一个 UI 界面并列出将要被复制到目标分支的备选提交记录，它还会显示每个提交记录的哈希值和提交说明，提交说明有助于你理解这个提交进行了哪些更改。</p><p>可以进行以下操作：</p><ul><li><p>调整记录顺序</p></li><li><p>删除不想要的提交</p></li><li><p>合并提交</p></li></ul><blockquote><p>本地栈式提交</p><ul><li><p>一个在开发中经常会遇到的情况：我正在解决某个特别棘手的 Bug，为了便于调试而在代码中添加了一些调试命令并向控制台打印了一些信息。这些调试和打印语句都在它们各自的提交记录里。最后我终于找到了造成这个 Bug 的根本原因。最后就差把 <code>bugFix</code> 分支里的工作合并回 <code>main</code> 分支了。你可以选择通过 fast-forward 快速合并到 <code>main</code> 分支上，但这样的话 <code>main</code> 分支就会包含我这些调试语句了。你肯定不想这样，应该还有更好的方式……<br>答案：使用上述命令修改分支树</p></li><li><p>接下来这种情况也是很常见的：你之前在 <code>newImage</code> 分支上进行了一次提交，然后又基于它创建了 <code>caption</code> 分支，然后又提交了一次。此时你想对某个以前的提交记录进行一些小小的调整。比如设计师想修改一下 <code>newImage</code> 中图片的分辨率，尽管那个提交记录并不是最新的了。</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230527165217947.png" alt="image-20230527165217947"><br>答案：我们可以通过下面的方法来克服困难：</p><ul><li>先用 <code>git rebase -i</code> 将提交重新排序，然后把我们想要修改的提交记录挪到最前</li><li>然后用 <code>git commit --amend</code> 来进行一些小修改</li><li>接着再用 <code>git rebase -i</code> 来将他们调回原来的顺序</li><li>最后我们把 main 移到修改的最前端（用你自己喜欢的方法）</li></ul><p>但这样做就唯一的问题就是要进行两次排序，而这有可能造成由 rebase 而导致的冲突。尝试使用cherry-pick。</p></li></ul></blockquote><h2 id="Tag与Describe"><a href="#Tag与Describe" class="headerlink" title="Tag与Describe"></a>Tag与Describe</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git tag &lt;your_tag&gt; [node]</span><br></pre></td></tr></table></figure><p>分支很容易被人为移动，并且当有新的提交时，它也会移动。分支很容易被改变，大部分分支还只是临时的，并且还一直在变。</p><p>有没有什么可以<em>永远</em>指向某个提交记录的标识呢，比如软件发布新的大版本，或者是修正一些重要的 Bug 或是增加了某些新特性，有没有比分支更好的可以永远指向这些提交的方法呢？</p><p>Git 的 tag 可以（在某种程度上 —— 因为标签可以被删除后重新在另外一个位置创建同名的标签）永久地将某个特定的提交命名为里程碑，然后就可以像分支一样引用了。</p><p>更难得的是，它们并不会随着新的提交而移动。你也不能切换到某个标签上面进行修改提交，它就像是提交树上的一个锚点，标识了某个特定的位置。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git describe &lt;ref&gt;</span><br><span class="line"><span class="comment"># &lt;ref&gt; 可以是任何能被 Git 识别成提交记录的引用，如果你没有指定的话，Git 会使用你目前所在的位置（HEAD）。</span></span><br><span class="line"><span class="comment"># 输出结果：&lt;tag&gt;_&lt;numCommits&gt;_g&lt;hash&gt;</span></span><br></pre></td></tr></table></figure><p>由于标签在代码库中起着“锚点”的作用，Git 还为此专门设计了一个命令用来<strong>描述</strong>离你最近的锚点（也就是标签），它就是 <code>git describe</code>！</p><p>Git Describe 能帮你在提交历史中移动了多次以后找到方向；当你用 <code>git bisect</code>（一个查找产生 Bug 的提交记录的指令）找到某个提交记录时，或者是当你坐在你那刚刚度假回来的同事的电脑前时， 可能会用到这个命令。</p><h1 id="远程仓库操作"><a href="#远程仓库操作" class="headerlink" title="远程仓库操作"></a>远程仓库操作</h1><h2 id="基本操作"><a href="#基本操作" class="headerlink" title="基本操作"></a>基本操作</h2><p>远程仓库实际上它们只是你的仓库在另个一台计算机上的拷贝。</p><p>远程分支反映了远程仓库（在你上次和它通信时）的<strong>状态</strong>。这会有助于你理解本地的工作与公共工作的差别。</p><p>远程分支有一个特别的属性，在你切换到远程分支时，自动进入分离 HEAD 状态。Git 这么做是出于不能直接在这些分支上进行操作的原因, 你必须在别的地方完成你的工作, （更新了远程分支之后）再用远程分享你的工作成果。</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230527173159602.png" alt="image-20230527173159602"></p><p>远程分支有一个命名规范 —— 它们的格式是<code>&lt;remote name&gt;/&lt;branch name&gt;</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git fetch</span><br></pre></td></tr></table></figure><p><code>git fetch</code> 完成了仅有的但是很重要的两步:</p><ul><li>从远程仓库下载本地仓库中缺失的提交记录</li><li>更新远程分支指针(如 <code>origin/main</code>)</li></ul><p><code>git fetch</code> 实际上将本地仓库中的远程分支更新成了远程仓库相应分支最新的状态。<code>git fetch</code> 并不会改变你本地仓库的状态。它不会更新你的 <code>main</code> 分支，也不会修改你磁盘上的文件。理解这一点很重要，因为许多开发人员误以为执行了 <code>git fetch</code> 以后，他们本地仓库就与远程仓库同步了。它可能已经将进行这一操作所需的所有数据都下载了下来，但是<strong>并没有</strong>修改你本地的文件。所以, 你可以将 <code>git fetch</code> 的理解为单纯的下载操作。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git pull</span><br><span class="line"><span class="comment"># 相当于以下两条命令，pull 就是 fetch + merge</span></span><br><span class="line">git fetch</span><br><span class="line">git merge origin/main</span><br></pre></td></tr></table></figure><p>实际上，由于先抓取更新再合并到本地分支这个流程很常用，因此 Git 提供了一个专门的命令来完成这两个操作。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push</span><br></pre></td></tr></table></figure><p><code>git push</code> 负责将<strong>你的</strong>变更上传到指定的远程仓库，并在远程仓库上合并你的新提交记录。*<code>git push</code> 不带任何参数时的行为与 Git 的一个名为 <code>push.default</code> 的配置有关。它的默认值取决于你正使用的 Git 的版本，但是在教程中我们使用的是 <code>upstream</code>。* </p><h2 id="冲突处理"><a href="#冲突处理" class="headerlink" title="冲突处理"></a>冲突处理</h2><p>假设你周一克隆了一个仓库，然后开始研发某个新功能。到周五时，你新功能开发测试完毕，可以发布了。但是 —— 天啊！你的同事这周写了一堆代码，还改了许多你的功能中使用的 API，这些变动会导致你新开发的功能变得不可用。但是他们已经将那些提交推送到远程仓库了，因此你的工作就变成了基于项目<strong>旧版</strong>的代码，与远程仓库最新的代码不匹配了。</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230527175900652.png" alt="image-20230527175900652"></p><p>这种情况下, <code>git push</code> 就不知道该如何操作了。如果你执行 <code>git push</code>，Git 应该让远程仓库回到星期一那天的状态吗？还是直接在新代码的基础上添加你的代码，亦或由于你的提交已经过时而直接忽略你的提交？</p><p>因为这情况（历史偏离）有许多的不确定性，Git 是不会允许你 <code>push</code> 变更的。实际上它会强制你先合并远程最新的代码，然后才能分享你的工作。</p><p>那该如何解决这个问题呢？很简单，你需要做的就是使你的工作基于最新的远程分支。有许多方法做到这一点呢，不过最直接的方法就是通过 rebase 调整你的工作：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git fetch</span><br><span class="line">git rebase o/main</span><br><span class="line">git push</span><br><span class="line"><span class="comment"># 相当于 git pull --rebase; git push</span></span><br></pre></td></tr></table></figure><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/origin_rebase.gif" alt="origin_rebase"></p><p>我们还可以使用 <code>merge</code></p><p>尽管 <code>git merge</code> 不会移动你的工作（它会创建新的合并提交），但是它会告诉 Git 你已经合并了远程仓库的所有变更。这是因为远程分支现在是你本地分支的祖先，也就是说你的提交已经包含了远程分支的所有变化：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git fetch</span><br><span class="line">git merge o/main</span><br><span class="line">git push</span><br><span class="line"><span class="comment"># 相当于 git pull; git push;</span></span><br></pre></td></tr></table></figure><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/origin_merge.gif" alt="origin_merge"></p><p>在开发社区里，有许多关于 merge 与 rebase 的讨论。以下是关于 rebase 的优缺点：</p><p>优点：Rebase 使你的提交树变得很干净, 所有的提交都在一条线上</p><p>缺点：Rebase 修改了提交树的历史</p><p>选择哪个，仁者见仁智者见智。</p><h2 id="远程跟踪分支"><a href="#远程跟踪分支" class="headerlink" title="远程跟踪分支"></a>远程跟踪分支</h2><p>跟踪：</p><ul><li>pull 操作时，提交记录会被先下载到 origin/main 上，之后再合并到本地的 main 分支。隐含的合并目标由这个关联确定的。</li><li>push 操作时，我们把工作从 <code>main</code> 推到远程仓库中的 <code>main</code> 分支(同时会更新远程分支 <code>origin/main</code>) 。这个推送的目的地也是由这种关联确定的！</li></ul><p>当你克隆时, Git 会为远程仓库中的每个分支在本地仓库中创建一个远程分支（比如 <code>origin/main</code>）。然后再创建一个跟踪远程仓库中活动分支的本地分支，默认情况下这个本地分支会被命名为 <code>main</code>。</p><p>我们可以自己指定这种属性：</p><p>有两种方法：</p><p>第一种就是通过远程分支切换到一个新的分支，执行:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout -b totallyNotMain origin/main</span><br></pre></td></tr></table></figure><p>就可以创建一个名为 <code>totallyNotMain</code> 的分支，它跟踪远程分支 <code>origin/main</code>。</p><p>第二种工作方法：</p><p>另一种设置远程追踪分支的方法就是使用：<code>git branch -u</code> 命令，执行：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -u origin/main foo <span class="comment"># 如果当前就在 foo 分支上, 还可以省略 foo</span></span><br></pre></td></tr></table></figure><h3 id="Git-Push的参数"><a href="#Git-Push的参数" class="headerlink" title="Git Push的参数"></a>Git Push的参数</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push &lt;remote&gt; &lt;place&gt;</span><br></pre></td></tr></table></figure><p>例子：<code>git push origin main</code></p><p>含义：<em>切到本地仓库中的“main”分支，获取所有的提交，再到远程仓库“origin”中找到“main”分支，将远程仓库中没有的提交记录都添加上去，搞定之后告诉我。</em>我们通过“place”参数来告诉 Git 提交记录来自于 main, 要推送到远程仓库中的 main。它实际就是要同步的两个仓库的位置。需要注意的是，因为我们通过指定参数告诉了 Git 所有它需要的信息，所以它就忽略了我们所切换分支的属性（就是说不管你的HEAD在哪）！</p><p>当为 git push 指定 place 参数为 <code>main</code> 时，我们同时指定了提交记录的<strong>来源</strong>和<strong>去向</strong>。要同时为源和目的地指定 <code>&lt;place&gt;</code> 的话，只需要用冒号 <code>:</code> 将二者连起来就可以了：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push origin &lt;<span class="built_in">source</span>&gt;:&lt;destination&gt;</span><br></pre></td></tr></table></figure><p>这个参数实际的值是个 refspec，“refspec” 是一个自造的词，意思是 Git 能识别的位置（比如分支 <code>foo</code> 或者 <code>HEAD~1</code>）。如果你要推送到的目的分支不存在，Git 会在远程仓库中根据你提供的名称帮你创建这个分支。</p><h3 id="Git-Fetch的参数"><a href="#Git-Fetch的参数" class="headerlink" title="Git Fetch的参数"></a>Git Fetch的参数</h3><p><code>git fetch</code> 的参数和 <code>git push</code> 极其相似。他们的概念是相同的，只是方向相反罢了（因为现在你是下载，而非上传）如果你像如下命令这样为 git fetch 设置 的话：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git fetch origin foo</span><br></pre></td></tr></table></figure><p>Git 会到远程仓库的 <code>foo</code> 分支上，然后获取所有本地不存在的提交，放到本地的 <code>origin/foo</code> 上。</p><p>“如果我们指定 <code>&lt;source&gt;:&lt;destination&gt;</code> 会发生什么呢？”</p><p>如果你觉得直接更新本地分支很爽，那你就用冒号分隔的 refspec 吧。不过，你不能在当前切换的分支上干这个事，但是其它分支是可以的。</p><p>这里有一点是需要注意的 —— <code>source</code> 现在指的是远程仓库中的位置，而 <code>&lt;destination&gt;</code> 才是要放置提交的本地仓库的位置。它与 git push 刚好相反，这是可以讲的通的，因为我们在往相反的方向传送数据。</p><p>理论上虽然行的通，但开发人员很少这么做。我在这里介绍它主要是为了从概念上说明 <code>fetch</code> 和 <code>push</code> 的相似性，只是方向相反罢了。</p><p>如果执行命令前目标分支不存在，Git 会在 fetch 前自己创建立本地分支，就像是 Git 在 push 时，如果远程仓库中不存在目标分支，会自己在建立一样。</p><p>如果 <code>git fetch</code> 没有参数，它会下载所有的提交记录到各个远程分支。</p><h3 id="不指定-lt-source-gt"><a href="#不指定-lt-source-gt" class="headerlink" title="不指定&lt;source&gt;"></a>不指定<code>&lt;source&gt;</code></h3><p>在 git push 或 git fetch 时不指定任何 <code>source</code>，方法就是仅保留冒号和 destination 部分，source 部分留空。</p><p>例如：<code>git push origin :side</code>和<code>git fetch origin :bugFix</code></p><ul><li><p>给 push 传空值 source，成功删除了远程仓库中的 <code>side</code> 分支</p></li><li><p>如果 fetch 空 到本地，会在本地创建一个新分支。</p></li></ul><h3 id="Git-Pull"><a href="#Git-Pull" class="headerlink" title="Git Pull"></a>Git Pull</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git pull origin foo <span class="comment"># git fetch origin foo; git merge origin/foo</span></span><br><span class="line">git pull origin bar~1:bugFix <span class="comment"># git fetch origin bar~1:bugFix; git merge bugFix</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">包含初学者学习内容与进阶方法论</summary>
    
    
    
    <category term="计算机" scheme="https://www.uuanqin.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/"/>
    
    
    <category term="git" scheme="https://www.uuanqin.top/tags/git/"/>
    
    <category term="github" scheme="https://www.uuanqin.top/tags/github/"/>
    
    <category term="gitee" scheme="https://www.uuanqin.top/tags/gitee/"/>
    
  </entry>
  
  <entry>
    <title>AHK鼠标增强（CClose源码撷英）</title>
    <link href="https://www.uuanqin.top/p/c318939d.html"/>
    <id>https://www.uuanqin.top/p/c318939d.html</id>
    <published>2023-05-26T15:09:27.000Z</published>
    <updated>2023-05-26T16:14:05.707Z</updated>
    
    <content type="html"><![CDATA[<p>刷抖音刷到一个项目，就是一个可以增加鼠标功能的操作。它为鼠标赋予了以下操作：</p><table><thead><tr><th>Action</th><th>+ Target</th><th>= Result</th></tr></thead><tbody><tr><td>Middle click</td><td>+ title bar</td><td>= close window</td></tr><tr><td>Right click</td><td>+ title bar</td><td>= minimize window</td></tr><tr><td>Hold left click</td><td>+ title bar</td><td>= toggle window always on top</td></tr><tr><td>Double press</td><td>+ Esc key</td><td>= close active window</td></tr><tr><td>Right click</td><td>+ taskbar button</td><td>= move pointer to “Close window”</td></tr></tbody></table><p>软件不大，主要使用AutoHotKey脚本进行开发。鼠标快捷操作挺好用的，尤其是中键关闭窗口的操作，统一了浏览器关闭标签页的动作。但是我看中了其中的脚本语言AutoHotKey，感觉它很有用处，遂决定剖析源码，提取其中执行快捷操作的有用脚本进行学习。</p><p>以下是原项目的地址：</p><blockquote><p><a href="https://github.com/chaohershi/cclose/tree/master">chaohershi/cclose: A Windows utility that helps you close windows faster or pin windows always on top. (github.com)</a></p></blockquote><p>原项目的AutoHotKey脚本语言版本应该是V1，下面我将用V2版本进行改写并对其进行了简化（😥其实是删去我看不懂但实际影响不大的内容）。读者可以摘取其中的片段作为自己的脚本。改进点：</p><ul><li>AutoHotKey语法升级：从V1到V2</li><li>启用部分快捷功能有提示</li></ul><p>解析开始。</p><h1 id="公共函数部分"><a href="#公共函数部分" class="headerlink" title="公共函数部分"></a>公共函数部分</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">#Requires AutoHotkey v2<span class="number">.0</span></span><br><span class="line"></span><br><span class="line">; 检测鼠标是否在指定的WinTitle窗口中</span><br><span class="line">MouseIsOver(WinTitle)</span><br><span class="line">&#123;</span><br><span class="line">MouseGetPos  , , &amp;win</span><br><span class="line"><span class="keyword">return</span> <span class="title function_">WinExist</span><span class="params">(WinTitle <span class="string">&quot; ahk_id &quot;</span> win)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">; 检测鼠标是否悬停在标题</span><br><span class="line">MouseIsOverTitlebar()</span><br><span class="line">&#123;</span><br><span class="line">CoordMode <span class="string">&quot;Mouse&quot;</span>, <span class="string">&quot;Screen&quot;</span></span><br><span class="line">MouseGetPos &amp;x, &amp;y, &amp;win</span><br><span class="line">    ; 用于存储目标窗口左上角的 X 和 Y 坐标的变量的引用</span><br><span class="line">WinGetPos &amp;xWin, &amp;yWin, , , <span class="string">&quot;ahk_id &quot;</span> win  </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="title function_">WinExist</span><span class="params">(<span class="string">&quot;ahk_class Shell_TrayWnd ahk_id &quot;</span> win)</span> || <span class="title function_">WinExist</span><span class="params">(<span class="string">&quot;ahk_class Shell_SecondaryTrayWnd ahk_id &quot;</span> win)</span> ; exclude the taskbar</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (y &gt;= yWin &amp;&amp; y &lt; yWin + <span class="number">30</span> * A_ScreenDPI / <span class="number">96</span>) </span><br><span class="line">    ; <span class="keyword">if</span> within title bar width</span><br><span class="line">&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">; 展示<span class="number">1</span>s钟的标签</span><br><span class="line">ShowToolTip(msg)</span><br><span class="line">&#123;</span><br><span class="line">    ToolTip msg,,<span class="number">0</span></span><br><span class="line">    SetTimer () =&gt; ToolTip(), <span class="number">-1000</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="第一部分-标题操作"><a href="#第一部分-标题操作" class="headerlink" title="第一部分 标题操作"></a>第一部分 标题操作</h1><table><thead><tr><th>Action</th><th>+ Target</th><th>= Result</th></tr></thead><tbody><tr><td>Middle click</td><td>+ title bar</td><td>= close window</td></tr><tr><td>Right click</td><td>+ title bar</td><td>= minimize window</td></tr><tr><td>Hold left click</td><td>+ title bar</td><td>= toggle window always on top</td></tr></tbody></table><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">#HotIf <span class="title function_">MouseIsOverTitlebar</span><span class="params">()</span></span><br><span class="line">; 功能：鼠标中键点击标题关闭窗口</span><br><span class="line">MButton::</span><br><span class="line">&#123;</span><br><span class="line">    ; alternative to WinClose, as WinClose is a somewhat forceful method, e.g., <span class="keyword">if</span> multiple Microsoft Excel instances exist, WinClose will close them all at once. </span><br><span class="line">    ; <span class="number">0x112</span> = WM_SYSCOMMAND, <span class="number">0xF060</span> = SC_CLOSE https:<span class="comment">//autohotkey.com/docs/commands/WinClose.htm#Remarks</span></span><br><span class="line">    ; https:<span class="comment">//learn.microsoft.com/zh-cn/windows/win32/menurc/wm-syscommand</span></span><br><span class="line">    MouseGetPos  , , &amp;win         ; 我加的，要不然它不起作用</span><br><span class="line">    PostMessage <span class="number">0x112</span>, <span class="number">0xF060</span>, , win</span><br><span class="line">    <span class="title function_">ShowToolTip</span><span class="params">(<span class="string">&quot;窗口关闭&quot;</span>)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">; 功能：鼠标右键点击标题最小化窗口</span><br><span class="line">RButton::</span><br><span class="line">&#123;</span><br><span class="line">    err_code := KeyWait(<span class="string">&quot;RButton&quot;</span>, <span class="string">&quot;T0.4&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span>(err_code = <span class="number">0</span>) ;超时</span><br><span class="line">    &#123;</span><br><span class="line">        Send <span class="string">&quot;&#123;Click, Right&#125;&quot;</span> ; n.b., <span class="keyword">do</span> not use Send &#123;RButton&#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        ; https:<span class="comment">//learn.microsoft.com/zh-cn/windows/win32/menurc/wm-syscommand</span></span><br><span class="line">        MouseGetPos  , , &amp;win           ; 我加的，要不然它不起作用</span><br><span class="line">        PostMessage <span class="number">0x112</span>, <span class="number">0xF020</span>, ,win ; alternative to WinMinimize</span><br><span class="line">        <span class="title function_">ShowToolTip</span><span class="params">(<span class="string">&quot;窗口最小化&quot;</span>)</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">; 窗口置顶功能</span><br><span class="line">~LButton::</span><br><span class="line">&#123;</span><br><span class="line">    CoordMode <span class="string">&quot;Mouse&quot;</span>, <span class="string">&quot;Screen&quot;</span></span><br><span class="line">    MouseGetPos &amp;xOld, &amp;yOld, &amp;win</span><br><span class="line">    ExStyle := WinGetExStyle(win)</span><br><span class="line">    <span class="keyword">if</span> (ExStyle &amp; <span class="number">0x8</span>) ; <span class="number">0x8</span> is WS_EX_TOPMOST</span><br><span class="line">    &#123;</span><br><span class="line">        ExStyle := <span class="string">&quot;窗口已取消置顶&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        ExStyle := <span class="string">&quot;窗口已置顶&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    err_code := KeyWait(<span class="string">&quot;LButton&quot;</span>, <span class="string">&quot;T1&quot;</span>) ; wait <span class="keyword">for</span> the left mouse button to be released with timeout <span class="built_in">set</span> to <span class="number">1</span> second</span><br><span class="line">    MouseGetPos &amp;xNew, &amp;yNew</span><br><span class="line">    <span class="title function_">if</span> <span class="params">(xOld = xNew &amp;&amp; yOld = yNew &amp;&amp; err_code = <span class="number">0</span>)</span> ; <span class="keyword">if</span> the mouse did not move during the timeout period</span><br><span class="line">    &#123;</span><br><span class="line">        WinSetAlwaysOnTop <span class="number">-1</span>, <span class="string">&quot;A&quot;</span> ; toggle window always on top</span><br><span class="line">        <span class="title function_">ShowToolTip</span><span class="params">(ExStyle)</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="第二部分-双击Esc关闭窗口"><a href="#第二部分-双击Esc关闭窗口" class="headerlink" title="第二部分 双击Esc关闭窗口"></a>第二部分 双击Esc关闭窗口</h1><table><thead><tr><th>Action</th><th>+ Target</th><th>= Result</th></tr></thead><tbody><tr><td>Double press</td><td>+ Esc key</td><td>= close active window</td></tr></tbody></table><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">; 功能：双击Esc关闭窗口</span><br><span class="line">#HotIf</span><br><span class="line">~Esc::</span><br><span class="line">&#123;</span><br><span class="line">    id_old := WinGetID(<span class="string">&quot;A&quot;</span>)</span><br><span class="line">    process_name := WinGetProcessName(<span class="string">&quot;A&quot;</span>)</span><br><span class="line">    KeyWait <span class="string">&quot;Esc&quot;</span> ; wait <span class="keyword">for</span> the Esc key to be released</span><br><span class="line">    err_code := KeyWait(<span class="string">&quot;Esc&quot;</span>, <span class="string">&quot;D T0.4&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> (err_code = <span class="number">1</span>)&#123;</span><br><span class="line">        id_new := WinGetID(<span class="string">&quot;A&quot;</span>) ; get the window id after the Esc key has being pressed again</span><br><span class="line">        win_class := WinGetClass(<span class="string">&quot;A&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> (id_old = id_new &amp;&amp; win_class != <span class="string">&quot;Shell_TrayWnd&quot;</span> &amp;&amp; win_class != <span class="string">&quot;Shell_SecondaryTrayWnd&quot;</span> &amp;&amp; win_class != <span class="string">&quot;Progman&quot;</span> &amp;&amp; win_class != <span class="string">&quot;WorkerW&quot;</span>) </span><br><span class="line">        &#123;</span><br><span class="line">            ; <span class="keyword">if</span> the current window is the same one as before and is not taskbar or desktop</span><br><span class="line">            Send <span class="string">&quot;!&#123;F4&#125;&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="第三部分-右击任务栏"><a href="#第三部分-右击任务栏" class="headerlink" title="第三部分 右击任务栏"></a>第三部分 右击任务栏</h1><table><thead><tr><th>Action</th><th>+ Target</th><th>= Result</th></tr></thead><tbody><tr><td>Right click</td><td>+ taskbar button</td><td>= move pointer to “Close window”</td></tr></tbody></table><p>右击任务栏后，如果鼠标自动悬停在关闭窗口上：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">; 功能，右击任务栏图标鼠标自动跳转到关闭窗口</span><br><span class="line">#HotIf <span class="title function_">MouseIsOver</span><span class="params">(<span class="string">&quot;ahk_class Shell_TrayWnd&quot;</span>)</span> || <span class="title function_">MouseIsOver</span><span class="params">(<span class="string">&quot;ahk_class Shell_SecondaryTrayWnd&quot;</span>)</span> ; apply the following hotkey only when the mouse is over the taskbar</span><br><span class="line">~RButton:: ; when right clicked</span><br><span class="line">&#123;</span><br><span class="line">    CoordMode <span class="string">&quot;Mouse&quot;</span>, <span class="string">&quot;Screen&quot;</span></span><br><span class="line">    MouseGetPos &amp;xOld, &amp;yOld</span><br><span class="line">    Sleep <span class="number">500</span> ; wait <span class="keyword">for</span> the Jump List to pop up, n.b., this line also helps to provide a uniform waiting experience</span><br><span class="line">    MouseGetPos &amp;xNew, &amp;yNew</span><br><span class="line">    CoordMode <span class="string">&quot;Mouse&quot;</span>, <span class="string">&quot;Window&quot;</span></span><br><span class="line">    <span class="keyword">if</span> (Abs(xNew - xOld) &lt; <span class="number">8</span> &amp;&amp; Abs(yNew - yOld) &lt; <span class="number">8</span>) ; <span class="keyword">if</span> the mouse did not move much</span><br><span class="line">    &#123;</span><br><span class="line">        Loop <span class="number">6</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> <span class="title function_">WinActive</span><span class="params">(<span class="string">&quot;ahk_class Windows.UI.Core.CoreWindow&quot;</span>)</span> ; <span class="keyword">if</span> the Jump List pops <span class="title function_">up</span> <span class="params">(right clicked on the taskbar app buttons)</span></span><br><span class="line">            &#123;</span><br><span class="line">                WinGetPos , , &amp;width, &amp;height ; get the size of the last found <span class="title function_">window</span> <span class="params">(Jump List)</span></span><br><span class="line">                <span class="title function_">MouseMove</span> <span class="params">(width / <span class="number">2</span>)</span>, <span class="params">(height - <span class="number">3</span> * width / <span class="number">32</span>)</span>, 10 ; move the mouse to the bottom of the Jump <span class="title function_">List</span> <span class="params">(<span class="string">&quot;Close window&quot;</span>)</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            &#125;</span><br><span class="line">            Sleep 250 ; wait <span class="keyword">for</span> more time</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>上面的示例代码可以组成一个.ahk文件，实现所有CClose的基本功能。</p><p>开机自启动方法：</p><ol><li>Win+R打开运行窗口，输入shell:startup</li><li>把脚本的快捷方式丢到里面即可</li></ol><p>未来可以改进的地方：</p><ul><li>控制部分功能的启用与禁用（好的，又成CClose的轮子版了）</li><li>进一步，对自己的脚本进行控制和管理</li><li>对使用了管理员权限运行的系统无效</li><li>状态栏图标改一下</li><li>学习制作一个Windows软件</li></ul>]]></content>
    
    
    <summary type="html">提取CClose中有用的脚本代码进行解析</summary>
    
    
    
    <category term="计算机" scheme="https://www.uuanqin.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/"/>
    
    
    <category term="CClose" scheme="https://www.uuanqin.top/tags/CClose/"/>
    
    <category term="快捷键" scheme="https://www.uuanqin.top/tags/%E5%BF%AB%E6%8D%B7%E9%94%AE/"/>
    
    <category term="鼠标" scheme="https://www.uuanqin.top/tags/%E9%BC%A0%E6%A0%87/"/>
    
    <category term="AutoHotKey" scheme="https://www.uuanqin.top/tags/AutoHotKey/"/>
    
  </entry>
  
  <entry>
    <title>开源工具推荐</title>
    <link href="https://www.uuanqin.top/p/b8fe259e.html"/>
    <id>https://www.uuanqin.top/p/b8fe259e.html</id>
    <published>2023-05-13T10:33:32.000Z</published>
    <updated>2023-05-29T16:27:17.504Z</updated>
    
    <content type="html"><![CDATA[<p>整理一下我使用过的好用的开源软件。</p><h1 id="软件列表"><a href="#软件列表" class="headerlink" title="软件列表"></a>软件列表</h1><h2 id="PicGo"><a href="#PicGo" class="headerlink" title="PicGo"></a>PicGo</h2><blockquote><p>一个用于快速上传图片并获取图片 URL 链接的工具</p><p><a href="https://github.com/Molunerfinn/PicGo">Molunerfinn/PicGo: A simple &amp; beautiful tool for pictures uploading built by vue-cli-electron-builder (github.com)</a></p></blockquote><p>Typora写作助攻神器，拖拽到Markdown的图片自动上传到图床并转为网页链接，极大的方便图片管理。</p><p>如果你搭建有使用Markdown写作的博客，那效率直线提升！</p><h2 id="LocalSend"><a href="#LocalSend" class="headerlink" title="LocalSend"></a>LocalSend</h2><blockquote><p>LocalSend是一款免费的开源应用程序，它允许你通过本地网络安全地与附近的设备共享文件和信息，而无需连接互联网。</p><p><a href="https://github.com/localsend/localsend">localsend/localsend: An open source cross-platform alternative to AirDrop (github.com)</a></p></blockquote><p>简洁而功能强大，多平台支持包括Windows、macOS、Linux、Android（鸿蒙）、iOS，我可以使用它而免数据线进行数据传输。手机虚拟机里也可以传输，简直不要太方便。</p><h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><ul><li><p><a href="https://github.com/chaohershi/cclose">CClose</a>：CClose是一个用AutoHotKey编写的Windows实用程序。软件挺好用的，可以对我个人习惯进行统一。但是最近我把他核心代码提取并定制了，所以对它我就不依赖了。详看文章：<a href="https://www.uuanqin.top/p/c318939d.html">AHK鼠标增强（CClose源码撷英） | 半方池水半方田 (uuanqin.top)</a></p></li><li><p>AList（目前正在使用，考察中。注意到部分用户使用阿里云接口会被阿里云封号，感觉有点危险）</p></li></ul>]]></content>
    
    
    <summary type="html">我使用过的优秀开源软件</summary>
    
    
    
    <category term="计算机" scheme="https://www.uuanqin.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/"/>
    
    
    <category term="Github" scheme="https://www.uuanqin.top/tags/Github/"/>
    
    <category term="开源" scheme="https://www.uuanqin.top/tags/%E5%BC%80%E6%BA%90/"/>
    
  </entry>
  
  <entry>
    <title>魔改脚本实现知网导出Bibtex参考格式</title>
    <link href="https://www.uuanqin.top/p/84ae21ea.html"/>
    <id>https://www.uuanqin.top/p/84ae21ea.html</id>
    <published>2023-05-11T08:37:21.000Z</published>
    <updated>2023-05-26T16:19:54.863Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>这篇文章的脚本已发布到Greasy Fork（油叉）平台，你可以前往<a href="https://greasyfork.org/zh-CN/scripts/466046-%E7%9F%A5%E7%BD%91-%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE-bibtex-%E5%A4%A9%E6%B4%A5%E5%A4%A7%E5%AD%A6">知网 参考文献 bibtex 天津大学 (greasyfork.org)</a>进行下载安装。后续脚本更新将在该平台更新。20230511</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230511214253819.png" alt="image-20230511214253819"></p></blockquote><hr><p>最近不是开始写毕业论文了嘛，使用到LaTeX进行写作。其中，导入参考文献部分需要以BibTeX格式写进模板中。</p><p>Google Scholar 网站上存在兼容BibTeX 的参考文献信息，但是知网里没有这种格式的导出，这时就可以借助脚本实现这个功能。</p><p>这里分享我的魔改推导步骤，不想看过程的直接复制后文源码（DIFF文件，记得删前面的+-号）。</p><blockquote><p>注意：本篇文章的实现过程适用于天津大学校内登录用户，代码不具有普遍性。各位读者可以根据思路自行改动。</p></blockquote><h1 id="不借助脚本实现Bibtex参考文献生成及标注方法"><a href="#不借助脚本实现Bibtex参考文献生成及标注方法" class="headerlink" title="不借助脚本实现Bibtex参考文献生成及标注方法"></a>不借助脚本实现Bibtex参考文献生成及标注方法</h1><p>在介绍使用脚本方法之前先简要说明我之前的解决方案。</p><h2 id="使用谷歌学术进行参考文献生成"><a href="#使用谷歌学术进行参考文献生成" class="headerlink" title="使用谷歌学术进行参考文献生成"></a>使用谷歌学术进行参考文献生成</h2><p>通过以下几个步骤，可以轻松完成参考文献的生成。</p><ol><li>在谷歌学术搜索中，点击学术搜索设置。</li><li>页面打开之后，在文献管理软件选项中选择显示导入BibTeX 的链接，单击保存设置，退出。</li><li>在谷歌学术搜索中检索到文献后，在文献条目区域单击导入BibTeX 选项，页面中出现文献的引用信息。<br><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230511164837738.png" alt="image-20230511164837738"></li></ol><p>格式是这样的：</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@article&#123;刘娟2020基于,</span><br><span class="line">  title=&#123;基于 Python 爬虫的职位信息数据分析和可视化系统实现&#125;,</span><br><span class="line">  author=&#123;刘娟 and 管希东&#125;,</span><br><span class="line">  journal=&#123;Software Engineering and Applications&#125;,</span><br><span class="line">  volume=&#123;9&#125;,</span><br><span class="line">  pages=&#123;317&#125;,</span><br><span class="line">  year=&#123;2020&#125;,</span><br><span class="line">  publisher=&#123;中文学术期刊, 汉斯出版社, Hans Publishers&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="转化知网NoteExpress文献导出格式"><a href="#转化知网NoteExpress文献导出格式" class="headerlink" title="转化知网NoteExpress文献导出格式"></a>转化知网NoteExpress文献导出格式</h2><p>知网没有直接导出BibTeX文献导出格式的功能，但是有一个格式跟它很像。</p><ol><li><p>在文章介绍页面点击导出参考文献</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230511165242045.png" alt="image-20230511165242045"></p></li><li><p>选择“更多引用格式”</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230511165317189.png" alt="image-20230511165317189"></p></li><li><p>选择NoteExpress</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230511165344333.png" alt="image-20230511165344333"></p></li></ol><p>对应着BibTeX的格式，你就可以自己写咯。</p><h1 id="脚本解决"><a href="#脚本解决" class="headerlink" title="脚本解决"></a>脚本解决</h1><p>使用浏览器插件Tampermonkey，在Greasy Fork中搜索脚本：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230511165539516.png" alt="image-20230511165539516"></p><blockquote><p>读图片的介绍，知道该脚本的原理就是把知网NodeExpress格式进行转换，理解这一点方便我们进行后续的魔改</p></blockquote><p>安装后，在知网文章介绍页面中会多出按钮，点击后BibTeX格式的参考文献会自动复制到粘贴板中。如果你试过了没有问题，那么本篇文章到此结束。</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230511165810324.png" alt="image-20230511165810324"></p><p>由于我使用的是学校账号打开的知网，知网的网址与相关接口都不一样，这个脚本就不会起作用。那么接下来就是魔改时刻。</p><h2 id="魔改1-脚本需要匹配对应的网址"><a href="#魔改1-脚本需要匹配对应的网址" class="headerlink" title="魔改1-脚本需要匹配对应的网址"></a>魔改1-脚本需要匹配对应的网址</h2><p>这个脚本只有在特定的地址才发挥作用，不然你会看不到上文图中多出的按钮。</p><p>因为我的知网文章首页地址是这样的：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://&lt;一堆字符&gt;.eds.tju.edu.cn/kcms2/article/abstract&lt;后面省略参数&gt;</span><br></pre></td></tr></table></figure><p>所以我就想办法增加这条规则：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://&lt;一堆字符&gt;.eds.tju.edu.cn/kcms2/article/abstract*</span><br></pre></td></tr></table></figure><blockquote><p>添加的URL规则根据你的具体情况进行设计</p></blockquote><h3 id="方法1：js源代码修改"><a href="#方法1：js源代码修改" class="headerlink" title="方法1：js源代码修改"></a>方法1：js源代码修改</h3><p>在源代码中增加这一行规则，ctrl+s保存即可。</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230511171357098.png" alt="image-20230511171357098"></p><h3 id="方法2：设置页面增加设定"><a href="#方法2：设置页面增加设定" class="headerlink" title="方法2：设置页面增加设定"></a>方法2：设置页面增加设定</h3><p>打开TamperMonkey脚本管理界面，点击设置选项卡增加用户匹配：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230511171717236.png" alt="image-20230511171717236"></p><p>保存后重新访问文章简介页试试看，出现BibTex按钮此部分就成功了。</p><h2 id="魔改2-使用正确的接口"><a href="#魔改2-使用正确的接口" class="headerlink" title="魔改2-使用正确的接口"></a>魔改2-使用正确的接口</h2><p>经过上一步后，虽然出现了按钮，但不起作用。打开控制台会出现报错信息：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230511172003104.png" alt="image-20230511172003104"></p><p>看了一下脚本的源码，它发送的POST请求地址为：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://kns.cnki.net/kns8/manage/APIGetExport</span><br></pre></td></tr></table></figure><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230511170918257.png" alt="image-20230511170918257"></p><p>这里的接口地址我们可以改一下。之前我们提到脚本原理就是读取知网NoteExpress格式进行BibTeX的转换。这里我通过抓包，得到接口的地址：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230511172554301.png" alt="image-20230511172554301"></p><p>那么我们就可以把这串地址粗暴的写进去。（注意配合通配符使用）</p><h2 id="魔改3-使用正确的返回数据"><a href="#魔改3-使用正确的返回数据" class="headerlink" title="魔改3-使用正确的返回数据"></a>魔改3-使用正确的返回数据</h2><p>改对了POST请求发送的地址还不够，该脚本不能正确解析返回数据。</p><p>返回的数据是字符串：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul class=&#x27;literature-list&#x27;&gt;</span><br><span class="line">&lt;li&gt;</span><br><span class="line">&#123;Reference Type&#125;: Journal Article&lt;br&gt;</span><br><span class="line">&#123;Title&#125;: Flask框架在数据可视化的应用&lt;br&gt;</span><br><span class="line">&#123;Author&#125;: 陈嘉发;黄宇靖;&lt;br&gt;</span><br><span class="line">&#123;Author Address&#125;: 惠州卫生职业技术学院教育技术与信息中心;&lt;br&gt;</span><br><span class="line">&#123;Journal&#125;: 福建电脑&lt;br&gt;</span><br><span class="line">...</span><br><span class="line">&#123;Database Provider&#125;: CNKI&lt;br&gt;</span><br><span class="line">&lt;/li&gt;</span><br><span class="line">&lt;/ul&gt;</span><br><span class="line">&lt;input id=&quot;traceid&quot; type=&quot;hidden&quot; value=&quot;cf4aca8f33f5471f9c383ebf93578d2f.227.16837969341201267&quot;&gt;</span><br></pre></td></tr></table></figure><p>经过调试与源码推测我们需要的是<code>&lt;li&gt;</code>标签中的内容。</p><p>对应的正则表达式为：（附工具：<a href="https://c.runoob.com/front-end/854/">正则表达式在线测试 | 菜鸟工具 (runoob.com)</a>）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/(?&lt;=&lt;li&gt;).*(?=&lt;/li&gt;)/g</span><br></pre></td></tr></table></figure><p>对应的js语句（多了个转义符<code>\</code>）：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ss = data.<span class="title function_">match</span>(<span class="regexp">/(?&lt;=&lt;li&gt;).*(?=&lt;\/li&gt;)/g</span>)</span><br></pre></td></tr></table></figure><p>一顿编辑源码与BUG修复就OK了（具体编辑看DIFF文件）！</p><p>使用效果：</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">@article&#123;cite<span class="built_in">_</span>label,</span><br><span class="line">   title=&#123;flask框架在数据可视化的应用&#125;,</span><br><span class="line">   author=&#123;陈嘉发;黄宇靖;&#125;,</span><br><span class="line">   authoraddress=&#123;惠州卫生职业技术学院教育技术与信息中心;&#125;,</span><br><span class="line">   journal=&#123;福建电脑&#125;,</span><br><span class="line">   year=&#123;2022&#125;,</span><br><span class="line">   volume=&#123;38&#125;,</span><br><span class="line">   number=&#123;12&#125;,</span><br><span class="line">   pages=&#123;44-48&#125;,</span><br><span class="line">   keywords=&#123;flask框架;python爬虫;数据可视化图表库&#125;,</span><br><span class="line">   abstract=&#123;我就省略了，一大串的&#125;,</span><br><span class="line">   isbn/issn=&#123;1673-2782&#125;,</span><br><span class="line">   notes=&#123;35-1115/tp&#125;,</span><br><span class="line">   doi=&#123;10.16707/j.cnki.fjpc.2022.12.009&#125;,</span><br><span class="line">   databaseprovider=&#123;cnki&#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>提一点，在我的模板中，cite_label不能是中文，否则编译出错。我使用的是天津大学毕业论文模板：<a href="https://gitee.com/tju_embedded/tju_undergraduate_design">嵌入式软件工程实验室/天津大学本科毕业论文Latex模板 - 码云 - 开源中国 (gitee.com)</a></p></blockquote><h1 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h1><blockquote><p>此处不再更新，新版本请前往Greasy Fork平台进行下载安装。DIFF文件进提供修改参考。</p></blockquote><p>diff文件。把减号行删除，删除加号行的加号即可得目的源文件。</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">// ==UserScript==</span><br><span class="line">// @name         知网 参考文献 bibtex</span><br><span class="line">// @namespace    https://github.com/HawkTom</span><br><span class="line">// @require      https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js</span><br><span class="line">// @version      1.1.1</span><br><span class="line">// @description  从知网文献中直接复制bibtex</span><br><span class="line"><span class="deletion">- // @author       Hao</span></span><br><span class="line"><span class="addition">+ // @author       Hao, uuanqin</span></span><br><span class="line">// @match        https://kns.cnki.net/kcms/detail/detail.aspx?dbcode=*</span><br><span class="line">// @match        http://kns.cnki.net/kcms/detail/detail.aspx?dbcode=*</span><br><span class="line"><span class="addition">+ // @match        https://*.eds.tju.edu.cn/kcms2/article/abstract*</span></span><br><span class="line">// @grant        none</span><br><span class="line">// ==/UserScript==</span><br><span class="line"></span><br><span class="line">(function() &#123;</span><br><span class="line">    &#x27;use strict&#x27;;</span><br><span class="line"></span><br><span class="line">    jQuery(document).ready(function($) &#123;</span><br><span class="line"></span><br><span class="line">        window.onload = function()&#123;</span><br><span class="line"></span><br><span class="line">            var a = document.getElementById(&quot;paramdbname&quot;)</span><br><span class="line">            var b = document.getElementById(&quot;paramfilename&quot;)</span><br><span class="line">            var fileid = a.getAttribute(&quot;value&quot;) + &#x27;!&#x27; + b.getAttribute(&quot;value&quot;) +&#x27;!1!0&#x27;</span><br><span class="line"></span><br><span class="line">            var x = document.getElementsByClassName(&quot;btn-tool&quot;)</span><br><span class="line">            var input = document.createElement(&#x27;li&#x27;)</span><br><span class="line">            input.setAttribute(&quot;id&quot;, &quot;bibbtn&quot;)</span><br><span class="line">            input.setAttribute(&quot;class&quot;, &quot;btn-quote&quot;)</span><br><span class="line">            //input.setAttribute(&quot;type&quot;, &quot;button&quot;)</span><br><span class="line">            input.setAttribute(&quot;title&quot;, &quot;Bibtex&quot;)</span><br><span class="line">            //input.setAttribute(&quot;onclick&quot;, &quot;func(this)&quot;) href=\&quot;javascript:void(0)\&quot; onclick=\&quot;getBib()\</span><br><span class="line">            input.innerHTML = &quot;&lt;a&gt;&lt;i&gt;&lt;/i&gt;Bibtex&lt;/a&gt;&quot;</span><br><span class="line">            x[0].children[0].append(input)</span><br><span class="line"></span><br><span class="line">            $(&quot;#bibbtn&quot;).click(function()&#123;</span><br><span class="line"><span class="addition">+           var url = window.location.hostname; // 得到 *.eds.tju.edu.cn</span></span><br><span class="line"><span class="deletion">-            $.post(&quot;https://kns.cnki.net/kns8/manage/APIGetExport&quot;,</span></span><br><span class="line"><span class="addition">+               $.post(`https://$&#123;url&#125;/kns8/manage/ShowExport`,</span></span><br><span class="line">                &#123;</span><br><span class="line">                  filename:fileid,</span><br><span class="line">                  displaymode:&quot;NoteExpress&quot;</span><br><span class="line">                &#125;,</span><br><span class="line">                function(data)&#123;</span><br><span class="line">                    console.log(data);</span><br><span class="line">                    var bibtext = &quot;&quot;</span><br><span class="line"><span class="deletion">-                   var ss = data.data[0].value[0]</span></span><br><span class="line"><span class="deletion">-                   var ssl = ss.split(&quot;&lt;br&gt;&quot;)</span></span><br><span class="line"><span class="addition">+                   var ss = data.match(/(?&lt;=&lt;li&gt;).*(?=&lt;\/li&gt;)/g) // .data[0].value[0]</span></span><br><span class="line"><span class="addition">+                   console.log(ss); // 输出调试而已</span></span><br><span class="line"><span class="addition">+                   var ssl = ss[0].split(&quot;&lt;br&gt;&quot;)</span></span><br><span class="line">                    for (var i=0; i&lt;ssl.length-1; i++)&#123;</span><br><span class="line">                        var k = ssl[i].toLocaleLowerCase().split(&quot; &quot;).join(&quot;&quot;).split(&quot;:&quot;)</span><br><span class="line">                        var item = k[0]</span><br><span class="line">                        var detail = k[1]</span><br><span class="line">                        if (item == &quot;&#123;referencetype&#125;&quot;)&#123;</span><br><span class="line">                            if (detail == &quot;journalarticle&quot;)&#123;</span><br><span class="line">                                bibtext = &quot;@article&#123;cite_label ,\n&quot;</span><br><span class="line">                            &#125;</span><br><span class="line">                            else if(detail == &quot;conferenceproceedings&quot;)&#123;</span><br><span class="line">                                bibtext = &quot;@inproceedings&#123;cite_label ,\n&quot;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        else if(item == &quot;&#123;issue&#125;&quot;)&#123;</span><br><span class="line"><span class="deletion">-                           bibtext = bibtext + &quot;   &#123;number&#125;=&#123;&quot; + detail + &quot;&#125;,\n&quot;</span></span><br><span class="line"><span class="addition">+                           bibtext = bibtext + &quot;   number=&#123;&quot; + detail + &quot;&#125;,\n&quot; // 不明白这里的number为什么要括起来</span></span><br><span class="line">                        &#125;</span><br><span class="line">                        else &#123;</span><br><span class="line">                            bibtext = bibtext + &quot;   &quot; + item.substr(1, item.length-2) + &quot;=&#123;&quot; + detail + &quot;&#125;,\n&quot;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    bibtext += &quot;&#125;&quot;</span><br><span class="line">                    //console.log(bibtext)</span><br><span class="line">                    const copad = document.createElement(&#x27;textarea&#x27;)</span><br><span class="line">                    copad.value = bibtext</span><br><span class="line">                    document.body.appendChild(copad)</span><br><span class="line">                    copad.select()</span><br><span class="line">                    document.execCommand(&#x27;Copy&#x27;)</span><br><span class="line">                    document.body.removeChild(copad)</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><p>参考：</p><ul><li><a href="https://blog.csdn.net/fegxig1230/article/details/118458288">知网 BibTeX自动生成（使用BibTeX引用中文参考文献）_奕小星的博客-CSDN博客</a></li><li><a href="https://www.w3school.com.cn/js/js_string_search.asp">JavaScript 字符串搜索 (w3school.com.cn)</a></li><li><a href="https://c.runoob.com/front-end/854/">正则表达式在线测试 | 菜鸟工具 (runoob.com)</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Regular_Expressions#special-lookahead">正则表达式 - JavaScript | MDN (mozilla.org)</a></li><li><a href="https://blog.csdn.net/u013288800/article/details/82787641">使用JS获取当前页面的URL(网址信息)_js 获取url_Devere的博客-CSDN博客</a></li></ul>]]></content>
    
    
    <summary type="html">修改油叉脚本以适应当前访问知网的网络状况</summary>
    
    
    
    <category term="计算机" scheme="https://www.uuanqin.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/"/>
    
    
    <category term="Tampermonkey" scheme="https://www.uuanqin.top/tags/Tampermonkey/"/>
    
    <category term="BibTeX" scheme="https://www.uuanqin.top/tags/BibTeX/"/>
    
    <category term="知网" scheme="https://www.uuanqin.top/tags/%E7%9F%A5%E7%BD%91/"/>
    
    <category term="Javascript" scheme="https://www.uuanqin.top/tags/Javascript/"/>
    
    <category term="Greasy Fork" scheme="https://www.uuanqin.top/tags/Greasy-Fork/"/>
    
  </entry>
  
  <entry>
    <title>Markdown基本语法示例（Typora）</title>
    <link href="https://www.uuanqin.top/p/3c4a82e6.html"/>
    <id>https://www.uuanqin.top/p/3c4a82e6.html</id>
    <published>2023-05-04T13:02:06.000Z</published>
    <updated>2023-05-04T13:45:53.072Z</updated>
    
    <content type="html"><![CDATA[<p>这是一篇Typora下使用Markdown语法的案例实践分享。这次分享的是一个Markdown文件，最早创建于2021年11月之前。与其他Markdown教程不同的是，这个案例实践用自己的语法来介绍自己，通过从预览效果和源代码中切换学习Markdown语法。即使是Typora最后一个免费版本（0.11.18）也依然适用。</p><p>案例食用方法：下载md源文件，用Typora打开（版本不要太老），观察源代码和预览效果学习。</p><p>[下载功能待开发]</p><p>注意，本篇文章后面的部分即本案例文件md内容在Hexo渲染下的结果，大部分特性在Hexo渲染下是可用的，而<strong>图</strong>章节仅在Typora才能预览。不可见字符也是学习的一部分，这部分内容仅可在下载案例文件查看源码才行。当然，通过这篇文章你也可以快速洞察Typora与Hexo渲染的区别，以便今后在Typora中进行Markdown博客写作中更合理使用Hexo支持的Markdown语法，适时选择Hexo标签外挂。</p><p>不喜欢这种MarkDown学习方式？你可以参考GitHub学习相关Markdown规范：<a href="https://docs.github.com/zh/get-started/writing-on-github/getting-started-with-writing-and-formatting-on-github/basic-writing-and-formatting-syntax">基本撰写和格式语法 - GitHub 文档</a></p><p>下面即为案例文件在Hexo下的渲染效果：</p><h1 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h1><p>[TOC]<br>一级标题：标题的第一种写法[^1]<br>======<br>二级标题</p><hr><h1 id="一级标题：标题的第二种写法-2"><a href="#一级标题：标题的第二种写法-2" class="headerlink" title="一级标题：标题的第二种写法[^2]"></a>一级标题：标题的第二种写法[^2]</h1><h2 id="二级标题"><a href="#二级标题" class="headerlink" title="二级标题"></a>二级标题</h2><h3 id="三级标题"><a href="#三级标题" class="headerlink" title="三级标题"></a>三级标题</h3><h4 id="四级标题"><a href="#四级标题" class="headerlink" title="四级标题"></a>四级标题</h4><h5 id="五级标题"><a href="#五级标题" class="headerlink" title="五级标题"></a>五级标题</h5><h6 id="六级标题"><a href="#六级标题" class="headerlink" title="六级标题"></a>六级标题</h6><h1 id="段落"><a href="#段落" class="headerlink" title="段落"></a>段落</h1><h3 id="换行"><a href="#换行" class="headerlink" title="换行"></a>换行</h3><p>段落的换行是使用两个以上的空格加回车<sup>在Typora编辑器里是<kbd>Shift</kbd>+<kbd>Enter</kbd></sup><br>或者使用HTML标签<br>进行换行<br>不要吝惜回车，在一些情况下回车会被吞掉！</p><h3 id="段首缩进"><a href="#段首缩进" class="headerlink" title="段首缩进"></a>段首缩进</h3><p> 使用特殊占位符，不同占位符所占空白是不一样大的（请在源码模式下查看）：<br>&ensp;或者&#8194;  表示一个半角的空格<br>&emsp;或者&#8195;  表示一个全角的空格<br>&emsp;或者&emsp;  两个全角的空格（用的比较多）<br>&nbsp;或者&#160;  不断行的空白格</p><h1 id="字体及脚注"><a href="#字体及脚注" class="headerlink" title="字体及脚注"></a>字体及脚注</h1><p><em>斜体</em>        <em>斜体</em><br><strong>粗体</strong>     <strong>粗体</strong><br><em><strong>粗斜体</strong></em>     <em><strong>粗斜体</strong></em><br><del>删除线</del><br>我是^上标^  我是<del>下标</del> ==文本高亮==（Typora编辑器中需要在偏好设置中的Markdown拓展语法开启上下标、文本高亮格式）<br><u>使用HTML的标签实现下划线</u><br>创建脚注格式的效果如<a href="%E8%84%9A%E6%B3%A8%E5%86%85%E5%AE%B9%E5%9C%A8%E8%BF%99%E9%87%8C%E7%BC%96%E8%BE%91">^我是脚注</a></p><h1 id="特殊符号"><a href="#特殊符号" class="headerlink" title="特殊符号"></a>特殊符号</h1><p>&copy;  &trade;  &amp;  &lt;  &gt;  &pound; &yen; &euro; &reg; &plusmn; &sect;  X&sup2; Y&sup3; &frac34; &laquo; &raquo; 37.2&ordm;C</p><h1 id="emoji"><a href="#emoji" class="headerlink" title="emoji"></a>emoji</h1><p>:smile: :camera_flash::hamburger: :cloud_with_rain: :musical_keyboard: :hocho:</p><p>两个冒号之间填名称，输入时会触发自动填充选项。可以通过按<kbd>Esc</kbd>来打开和关闭。</p><h1 id="分割线"><a href="#分割线" class="headerlink" title="分割线"></a>分割线</h1><p>分割线使用三个以上符号[^分割线]。符号中间可以插入空格。</p><hr><hr><hr><hr><hr><hr><hr /><h1 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h1><h3 id="无序列表"><a href="#无序列表" class="headerlink" title="无序列表"></a>无序列表</h3><ul><li>使用星号、加号或减号作为无序列表标记（注意符号后面加空格）</li><li>这是第二项<ul><li>使用加号<ul><li>使用减号<h3 id="有序列表"><a href="#有序列表" class="headerlink" title="有序列表"></a>有序列表</h3></li></ul></li></ul></li></ul><ol><li>有序列表标记，数字加上点</li><li>这是第二项<ul><li>在子列表前加四个空格进行列表嵌套</li><li>这是第二项的第二个元素<h1 id="Task-list"><a href="#Task-list" class="headerlink" title="Task list"></a>Task list</h1></li></ul></li></ol><ul><li><input checked="" disabled="" type="checkbox"> 英语第二次作文</li><li><input disabled="" type="checkbox"> 程序设计原理实践<ul><li><input checked="" disabled="" type="checkbox"> PA1</li><li><input disabled="" type="checkbox"> PA2</li><li><input checked="" disabled="" type="checkbox"> PA3</li><li><input disabled="" type="checkbox"> PA4</li></ul></li></ul><h1 id="区块引用"><a href="#区块引用" class="headerlink" title="区块引用"></a>区块引用</h1><blockquote><p>区块引用<br>记得&gt;符号后面紧跟空格</p></blockquote><blockquote><p>区块嵌套</p><blockquote><p>第一层嵌套</p><blockquote><p>第二层嵌套</p></blockquote></blockquote></blockquote><blockquote><p>区块中使用列表</p><ol><li>这是第一项</li><li>这是第二项</li></ol><ul><li>这是使用了星号的无序列表</li><li>这是第二项</li></ul></blockquote><ul><li>列表中使用区块 <blockquote><p>使用区块，记得用四个空格进行缩进</p></blockquote></li><li>第二项</li><li>第三项</li></ul><h1 id="代码块"><a href="#代码块" class="headerlink" title="代码块"></a>代码块</h1><p>一个函数片段可以用反引号（英文输入状态下左上角）把他包起来，比如<br><code>printf()</code> 函数。</p><p>代码块的输入：使用四个空格或Tab键。或使用<code>```</code>包围代码，并指定一种语言（也可以不指定） </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;hello world&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="链接"><a href="#链接" class="headerlink" title="链接"></a>链接</h1><h3 id="行内形式"><a href="#行内形式" class="headerlink" title="行内形式"></a>行内形式</h3><p>一个链接：<a href="https://www.baidu.com/">连接名称</a></p><h3 id="参考形式"><a href="#参考形式" class="headerlink" title="参考形式"></a>参考形式</h3><p>链接还可以使用变量，比如<br><a href="https://www.github.com/">仝♂觩蕞♂汏同.鮏佼♂铕网.站</a></p><p><a href="https://github.com/uuanqin" title="可加标题">Myprofile</a><br>有些网站要加<code>https://</code>才行</p><p>文档的结尾为变量赋值</p><h3 id="自动连接"><a href="#自动连接" class="headerlink" title="自动连接"></a>自动连接</h3><p>直接写地址：&lt;<a href="http://www.bing.com&gt;/">www.bing.com&gt;</a></p><h3 id="文内连接"><a href="#文内连接" class="headerlink" title="文内连接"></a>文内连接</h3><p><a href="https://blog.csdn.net/Bule_daze/article/details/107319043">Markdown 文档中文内锚点链接跳转（中文）_Bule_daze的博客-CSDN博客_markdown文件内链接</a></p><h1 id="图片"><a href="#图片" class="headerlink" title="图片"></a>图片</h1><h3 id="行内形式-1"><a href="#行内形式-1" class="headerlink" title="行内形式"></a>行内形式</h3><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/A042DF30-C232-46F3-8436-7D6C35351BBD.jpg" alt="alt 属性文本，这里放上图片的替代文字" title="图片标题EXAMPLE（可选项）"></p><h3 id="参考形式-1"><a href="#参考形式-1" class="headerlink" title="参考形式"></a>参考形式</h3><p>可以像网址那样使用变量：![属性文本][2]<br>[2]: <a href="http://www.gov.cn/govweb/xhtml/2016gov/images/public/logo_wz1.jpg">http://www.gov.cn/govweb/xhtml/2016gov/images/public/logo_wz1.jpg</a> “政府”</p><h3 id="使用HTML标签"><a href="#使用HTML标签" class="headerlink" title="使用HTML标签"></a>使用HTML标签</h3><p>可以使用普通的<code>&lt;img&gt;</code>标签指定图片的高度与宽度：<br><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/fca60437-8165-440f-bf93-4c0d39607e3d.png" width="30%"></p><h1 id="表格"><a href="#表格" class="headerlink" title="表格"></a>表格</h1><table><thead><tr><th>表头</th><th>表头(使用<code>-</code>分隔表头和其他行)</th></tr></thead><tbody><tr><td>单元格 (使用`</td><td>`分隔不同的单元格)</td></tr><tr><td>单元格</td><td>单元格</td></tr><tr><td>可以设置表格的对齐方式[^对齐]</td><td></td></tr><tr><td>左对齐</td><td>右对齐</td></tr><tr><td>:—-</td><td>——:</td></tr><tr><td>单元格</td><td>单元格</td></tr><tr><td>单元格</td><td>单元格</td></tr></tbody></table><p>可借助<a href="https://www.tablesgenerator.com/markdown_tables">在线表格生成工具</a>生成表格。</p><h1 id="高级技巧"><a href="#高级技巧" class="headerlink" title="高级技巧"></a>高级技巧</h1><h2 id="转义符"><a href="#转义符" class="headerlink" title="转义符\"></a>转义符<code>\</code></h2><p>以下符号可以转义[^backslash escapes]</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">\   backslash</span><br><span class="line">`   backtick</span><br><span class="line">*   asterisk</span><br><span class="line">_   underscore</span><br><span class="line">&#123;&#125;  curly braces</span><br><span class="line">[]  square brackets</span><br><span class="line">()  parentheses</span><br><span class="line">#   hash mark</span><br><span class="line">+   plus sign</span><br><span class="line">-   minus sign (hyphen)</span><br><span class="line">.   dot</span><br><span class="line">!   exclamation mark</span><br></pre></td></tr></table></figure><h2 id="公式"><a href="#公式" class="headerlink" title="公式"></a>公式</h2><p>使用<code>$</code>包裹的行内公式（Typora需要在偏好设置中开启）$ M_2 \times M_1 $<br>使用<code>$$</code>包裹LaTex或TeX格式的数学公式<br>$$<br>f(x)=\int^{+\infty}_{-\infty}\frac{1}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}dx=\Phi(x)<br>$$</p><h2 id="支持HTML的部分标签"><a href="#支持HTML的部分标签" class="headerlink" title="支持HTML的部分标签"></a>支持HTML的部分标签</h2><p><a href="https://support.typora.io/HTML/">https://support.typora.io/HTML/</a></p><p><a href="https://www.runoob.com/html/html-tutorial.html">点我学习HTML5</a></p><h3 id="一般标签"><a href="#一般标签" class="headerlink" title="一般标签"></a>一般标签</h3><p>不在Markdown涵盖范围之内的标签，都可以直接在文档里面用HTML撰写。</p><p>使用<kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>A</kbd>快速打开QQ截屏工具，这里使用了<code>&lt;kbd&gt;</code>标签</p><p>这是<sub>下标</sub>   这是<sup>上标</sup>    换行标签<br>换行了</p><p>下面是看起来没啥用的标签：<br><em>强调的内容(好像和斜体差不多)</em> [^斜体]   <strong>语气更强(粗体？)</strong>[^加粗]    <code>代码scanf()</code>    <var>变量</var>    <cite>引用</cite></p><h3 id="字体、颜色和大小"><a href="#字体、颜色和大小" class="headerlink" title="字体、颜色和大小"></a>字体、颜色和大小</h3><p><b>粗体文本</b>    <i>斜体文本</i>    <big>大号字体</big>    <small>小号字体</small>    <tt>等宽文本</tt>  <u>下划线</u> </p><p><font face="黑体">黑体</font>  <font face="微软雅黑">微软雅黑</font>  <font face="STCAIYUN">华文彩云</font>  <font face="华文行楷" >华文行楷</font>  <font face="时尚中黑" >时尚中黑</font>  （我猜你电脑里装有什么字体就能用什么字体）</p><p><mark>黄色高亮</mark></p><p><font color=#00ffff size=3>#00ffff</font>   <font color=gray size=3>gray色</font>    <font color=#0099ff size=5 face="黑体">#0099ff size=5 黑体</font><br><a href='#color'>附录：颜色名列表</a></p><h3 id="折叠段落"><a href="#折叠段落" class="headerlink" title="折叠段落"></a>折叠段落</h3><details><summary>Title</summary>content</details><h3 id="设置锚点"><a href="#设置锚点" class="headerlink" title="设置锚点"></a>设置锚点</h3><p><a href='#jump'>点我跳转（Typora下按住Ctrl键点击）</a></p><p><a href="#jump_two">点我跳转2</a></p><p>这里给出两种方法实现锚点<del>，你最喜欢哪一种呢？请在评论区留言告诉小编吧！</del></p><p><a name='jump'>跳转到这里</a></p><p><span id = "jump_two">跳转到这里2</span></p><h3 id="表格-1"><a href="#表格-1" class="headerlink" title="表格"></a>表格</h3><table><tbody>    <tr>        <th rowspan="3">我占了三行</th>        <th><font color="Green">第一列</font></th>        <th>第二列</th>        <th>第三列</th>    </tr>    <tr>        <td bgcolor="Tomato">第一列</td>        <td>第二列</td>        <td>第三列</td>    </tr>    <tr>        <td>第一列</td>        <td>第二列</td>        <td>第三列</td>    </tr></table>  <h2 id="图"><a href="#图" class="headerlink" title="图"></a>图</h2><h3 id="流程图"><a href="#流程图" class="headerlink" title="流程图"></a>流程图</h3><h4 id="横向流程图"><a href="#横向流程图" class="headerlink" title="横向流程图"></a>横向流程图</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line">A[方形] --&gt;B(圆角)</span><br><span class="line">    B --&gt; C&#123;条件a&#125;</span><br><span class="line">    C --&gt;|a=1| D[结果1]</span><br><span class="line">    C --&gt;|a=2| E[结果2]</span><br><span class="line">    F[横向流程图]</span><br></pre></td></tr></table></figure><h4 id="竖向流程图"><a href="#竖向流程图" class="headerlink" title="竖向流程图"></a>竖向流程图</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">graph TD</span><br><span class="line">A[方形] --&gt; B(圆角)</span><br><span class="line">    B --&gt; C&#123;条件a&#125;</span><br><span class="line">    C --&gt; |a=1| D[结果1]</span><br><span class="line">    C --&gt; |a=2| E[结果2]</span><br><span class="line">    F[竖向流程图]</span><br></pre></td></tr></table></figure><h4 id="标准流程图"><a href="#标准流程图" class="headerlink" title="标准流程图"></a>标准流程图</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">st=&gt;start: 开始框</span><br><span class="line">op=&gt;operation: 处理框</span><br><span class="line">cond=&gt;condition: 判断框(是或否?)</span><br><span class="line">sub1=&gt;subroutine: 子流程</span><br><span class="line">io=&gt;inputoutput: 输入输出框</span><br><span class="line">e=&gt;end: 结束框</span><br><span class="line">st-&gt;op-&gt;cond</span><br><span class="line">cond(yes)-&gt;io-&gt;e</span><br><span class="line">cond(no)-&gt;sub1(right)-&gt;op</span><br></pre></td></tr></table></figure><p>流程图代码分两块，上面一块是创建你的流程（创建元素），然后隔一行，创建流程的走向(连接元素)。</p><ul><li>创建流程（元素）：tag=&gt;type: content:&gt;url<ul><li>tag 是流程图中的标签，在第二段连接元素时会用到。名称可以任意，一般为流程的英文缩写和数字的组合。</li><li>type 用来确定标签的类型，<code>=&gt;</code>后面表示类型。由于标签的名称可以任意指定，所以要依赖type来确定标签的类型（start、end、operation、subroutine、condition、inputoutput）</li><li>content 是流程图文本框中的描述内容，<code>:</code> 后面表示内容，中英文均可。特别注意，<strong>冒号与文本之间一定要有个空格</strong></li><li>url是一个连接，与框框中的文本相绑定，<code>:&gt;</code>后面就是对应的 url 链接，点击文本时可以通过链接跳转到 url 指定页面</li></ul></li><li>指向流程(连接元素)：标识（类别）-&gt;下一个标识<ul><li>使用 -&gt; 来连接两个元素</li><li>对于condition类型，有yes和no两个分支，如示例中的cond(yes)和cond(no)</li><li>每个元素可以制定分支走向，默认向下，也可以用right指向右边，如示例中cond2(yes,right)。<h4 id="标准流程图（横向）"><a href="#标准流程图（横向）" class="headerlink" title="标准流程图（横向）"></a>标准流程图（横向）</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">st=&gt;start: 开始框</span><br><span class="line">op=&gt;operation: 处理框</span><br><span class="line">cond=&gt;condition: 判断框(是或否?)</span><br><span class="line">sub1=&gt;subroutine: 子流程</span><br><span class="line">io=&gt;inputoutput: 输入输出框</span><br><span class="line">e=&gt;end: 结束框</span><br><span class="line">st(right)-&gt;op(right)-&gt;cond</span><br><span class="line">cond(yes)-&gt;io(bottom)-&gt;e</span><br><span class="line">cond(no)-&gt;sub1(right)-&gt;op</span><br></pre></td></tr></table></figure><h3 id="时序图"><a href="#时序图" class="headerlink" title="时序图"></a>时序图</h3></li></ul></li></ul><h4 id="UML时序图"><a href="#UML时序图" class="headerlink" title="UML时序图"></a>UML时序图</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">对象A-&gt;对象B: 对象B你好吗?（请求）</span><br><span class="line">Note right of 对象B: 对象B的描述</span><br><span class="line">Note left of 对象A: 对象A的描述(提示)</span><br><span class="line">对象B--&gt;对象A: 我很好(响应)</span><br><span class="line">对象A-&gt;对象B: 你真的好吗？</span><br></pre></td></tr></table></figure><h4 id="UML标准时序图复杂"><a href="#UML标准时序图复杂" class="headerlink" title="UML标准时序图复杂"></a>UML标准时序图复杂</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Title: 标题：复杂使用</span><br><span class="line">对象A-&gt;对象B: 对象B你好吗?（请求）</span><br><span class="line">Note right of 对象B: 对象B的描述</span><br><span class="line">Note left of 对象A: 对象A的描述(提示)</span><br><span class="line">对象B--&gt;对象A: 我很好(响应)</span><br><span class="line">对象B-&gt;小三: 你好吗</span><br><span class="line">小三--&gt;&gt;对象A: 对象B找我了</span><br><span class="line">对象A-&gt;对象B: 你真的好吗？</span><br><span class="line">Note over 小三,对象B: 我们是朋友</span><br><span class="line">participant C</span><br><span class="line">Note right of C: 没人陪我玩</span><br></pre></td></tr></table></figure><h4 id="UML标准时序图"><a href="#UML标准时序图" class="headerlink" title="UML标准时序图"></a>UML标准时序图</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">%% 时序图例子,-&gt; 直线，--&gt;虚线，-&gt;&gt;实线箭头</span><br><span class="line">  sequenceDiagram</span><br><span class="line">    participant 张三</span><br><span class="line">    participant 李四</span><br><span class="line">    张三-&gt;王五: 王五你好吗？</span><br><span class="line">    loop 健康检查</span><br><span class="line">        王五-&gt;王五: 与疾病战斗</span><br><span class="line">    end</span><br><span class="line">    Note right of 王五: 合理 食物 &lt;br/&gt;看医生...</span><br><span class="line">    李四--&gt;&gt;张三: 很好!</span><br><span class="line">    王五-&gt;李四: 你怎么样?</span><br><span class="line">    李四--&gt;王五: 很好!</span><br></pre></td></tr></table></figure><h3 id="甘特图"><a href="#甘特图" class="headerlink" title="甘特图"></a>甘特图</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">%% 语法示例</span><br><span class="line">        gantt</span><br><span class="line">        dateFormat  YYYY-MM-DD</span><br><span class="line">        title 软件开发甘特图</span><br><span class="line">        section 设计</span><br><span class="line">        需求                      :done,    des1, 2014-01-06,2014-01-08</span><br><span class="line">        原型                      :active,  des2, 2014-01-09, 3d</span><br><span class="line">        UI设计                     :         des3, after des2, 5d</span><br><span class="line">    未来任务                     :         des4, after des3, 5d</span><br><span class="line">        section 开发</span><br><span class="line">        学习准备理解需求                      :crit, done, 2014-01-06,24h</span><br><span class="line">        设计框架                             :crit, done, after des2, 2d</span><br><span class="line">        开发                                 :crit, active, 3d</span><br><span class="line">        未来任务                              :crit, 5d</span><br><span class="line">        耍                                   :2d</span><br><span class="line">        section 测试</span><br><span class="line">        功能测试                              :active, a1, after des3, 3d</span><br><span class="line">        压力测试                               :after a1  , 20h</span><br><span class="line">        测试报告                               : 48h</span><br></pre></td></tr></table></figure><h1 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h1><h4 id="颜色名列表"><a href="#颜色名列表" class="headerlink" title="颜色名列表"></a>颜色名列表</h4> <details><summary><a name = "color">颜色名列表</a></summary><div class="table-box"><table><tbody><tr><th>颜色名</th><th>十六进制颜色值</th><th>颜色</th></tr><tr><td><font color="AliceBlue">AliceBlue</font></td><td><font color="#F0F8FF">#F0F8FF</font></td><td bgcolor="#F0F8FF">rgb(240, 248, 255)</td></tr><tr><td><font color="AntiqueWhite">AntiqueWhite</font></td><td><font color="#FAEBD7">#FAEBD7</font></td><td bgcolor="#FAEBD7">rgb(250, 235, 215)</td></tr><tr><td><font color="Aqua">Aqua</font></td><td><font color="#00FFFF">#00FFFF</font></td><td bgcolor="#00FFFF">rgb(0, 255, 255)</td></tr><tr><td><font color="Aquamarine">Aquamarine</font></td><td><font color="#7FFFD4">#7FFFD4</font></td><td bgcolor="#7FFFD4">rgb(127, 255, 212)</td></tr><tr><td><font color="Azure">Azure</font></td><td><font color="#F0FFFF">#F0FFFF</font></td><td bgcolor="#F0FFFF">rgb(240, 255, 255)</td></tr><tr><td><font color="Beige">Beige</font></td><td><font color="#F5F5DC">#F5F5DC</font></td><td bgcolor="#F5F5DC">rgb(245, 245, 220)</td></tr><tr><td><font color="Bisque">Bisque</font></td><td><font color="#FFE4C4">#FFE4C4</font></td><td bgcolor="#FFE4C4">rgb(255, 228, 196)</td></tr><tr><td><font color="Black">Black</font></td><td><font color="#000000">#000000</font></td><td bgcolor="#000000">rgb(0, 0, 0)</td></tr><tr><td><font color="BlanchedAlmond">BlanchedAlmond</font></td><td><font color="#FFEBCD">#FFEBCD</font></td><td bgcolor="#FFEBCD">rgb(255, 235, 205)</td></tr><tr><td><font color="Blue">Blue</font></td><td><font color="#0000FF">#0000FF</font></td><td bgcolor="#0000FF">rgb(0, 0, 255)</td></tr><tr><td><font color="BlueViolet">BlueViolet</font></td><td><font color="#8A2BE2">#8A2BE2</font></td><td bgcolor="#8A2BE2">rgb(138, 43, 226)</td></tr><tr><td><font color="Brown">Brown</font></td><td><font color="#A52A2A">#A52A2A</font></td><td bgcolor="#A52A2A">rgb(165, 42, 42)</td></tr><tr><td><font color="BurlyWood">BurlyWood</font></td><td><font color="#DEB887">#DEB887</font></td><td bgcolor="#DEB887">rgb(222, 184, 135)</td></tr><tr><td><font color="CadetBlue">CadetBlue</font></td><td><font color="#5F9EA0">#5F9EA0</font></td><td bgcolor="#5F9EA0">rgb(95, 158, 160)</td></tr><tr><td><font color="Chartreuse">Chartreuse</font></td><td><font color="#7FFF00">#7FFF00</font></td><td bgcolor="#7FFF00">rgb(127, 255, 0)</td></tr><tr><td><font color="Chocolate">Chocolate</font></td><td><font color="#D2691E">#D2691E</font></td><td bgcolor="#D2691E">rgb(210, 105, 30)</td></tr><tr><td><font color="Coral">Coral</font></td><td><font color="#FF7F50">#FF7F50</font></td><td bgcolor="#FF7F50">rgb(255, 127, 80)</td></tr><tr><td><font color="CornflowerBlue">CornflowerBlue</font></td><td><font color="#6495ED">#6495ED</font></td><td bgcolor="#6495ED">rgb(100, 149, 237)</td></tr><tr><td><font color="Cornsilk">Cornsilk</font></td><td><font color="#FFF8DC">#FFF8DC</font></td><td bgcolor="#FFF8DC">rgb(255, 248, 220)</td></tr><tr><td><font color="Crimson">Crimson</font></td><td><font color="#DC143C">#DC143C</font></td><td bgcolor="#DC143C">rgb(220, 20, 60)</td></tr><tr><td><font color="Cyan">Cyan</font></td><td><font color="#00FFFF">#00FFFF</font></td><td bgcolor="#00FFFF">rgb(0, 255, 255)</td></tr><tr><td><font color="DarkBlue">DarkBlue</font></td><td><font color="#00008B">#00008B</font></td><td bgcolor="#00008B">rgb(0, 0, 139)</td></tr><tr><td><font color="DarkCyan">DarkCyan</font></td><td><font color="#008B8B">#008B8B</font></td><td bgcolor="#008B8B">rgb(0, 139, 139)</td></tr><tr><td><font color="DarkGoldenRod">DarkGoldenRod</font></td><td><font color="#B8860B">#B8860B</font></td><td bgcolor="#B8860B">rgb(184, 134, 11)</td></tr><tr><td><font color="DarkGray">DarkGray</font></td><td><font color="#A9A9A9">#A9A9A9</font></td><td bgcolor="#A9A9A9">rgb(169, 169, 169)</td></tr><tr><td><font color="DarkGreen">DarkGreen</font></td><td><font color="#006400">#006400</font></td><td bgcolor="#006400">rgb(0, 100, 0)</td></tr><tr><td><font color="DarkKhaki">DarkKhaki</font></td><td><font color="#BDB76B">#BDB76B</font></td><td bgcolor="#BDB76B">rgb(189, 183, 107)</td></tr><tr><td><font color="DarkMagenta">DarkMagenta</font></td><td><font color="#8B008B">#8B008B</font></td><td bgcolor="#8B008B">rgb(139, 0, 139)</td></tr><tr><td><font color="DarkOliveGreen">DarkOliveGreen</font></td><td><font color="#556B2F">#556B2F</font></td><td bgcolor="#556B2F">rgb(85, 107, 47)</td></tr><tr><td><font color="Darkorange">Darkorange</font></td><td><font color="#FF8C00">#FF8C00</font></td><td bgcolor="#FF8C00">rgb(255, 140, 0)</td></tr><tr><td><font color="DarkOrchid">DarkOrchid</font></td><td><font color="#9932CC">#9932CC</font></td><td bgcolor="#9932CC">rgb(153, 50, 204)</td></tr><tr><td><font color="DarkRed">DarkRed</font></td><td><font color="#8B0000">#8B0000</font></td><td bgcolor="#8B0000">rgb(139, 0, 0)</td></tr><tr><td><font color="DarkSalmon">DarkSalmon</font></td><td><font color="#E9967A">#E9967A</font></td><td bgcolor="#E9967A">rgb(233, 150, 122)</td></tr><tr><td><font color="DarkSeaGreen">DarkSeaGreen</font></td><td><font color="#8FBC8F">#8FBC8F</font></td><td bgcolor="#8FBC8F">rgb(143, 188, 143)</td></tr><tr><td><font color="DarkSlateBlue">DarkSlateBlue</font></td><td><font color="#483D8B">#483D8B</font></td><td bgcolor="#483D8B">rgb(72, 61, 139)</td></tr><tr><td><font color="DarkSlateGray">DarkSlateGray</font></td><td><font color="#2F4F4F">#2F4F4F</font></td><td bgcolor="#2F4F4F">rgb(47, 79, 79)</td></tr><tr><td><font color="DarkTurquoise">DarkTurquoise</font></td><td><font color="#00CED1">#00CED1</font></td><td bgcolor="#00CED1">rgb(0, 206, 209)</td></tr><tr><td><font color="DarkViolet">DarkViolet</font></td><td><font color="#9400D3">#9400D3</font></td><td bgcolor="#9400D3">rgb(148, 0, 211)</td></tr><tr><td><font color="DeepPink">DeepPink</font></td><td><font color="#FF1493">#FF1493</font></td><td bgcolor="#FF1493">rgb(255, 20, 147)</td></tr><tr><td><font color="DeepSkyBlue">DeepSkyBlue</font></td><td><font color="#00BFFF">#00BFFF</font></td><td bgcolor="#00BFFF">rgb(0, 191, 255)</td></tr><tr><td><font color="DimGray">DimGray</font></td><td><font color="#696969">#696969</font></td><td bgcolor="#696969">rgb(105, 105, 105)</td></tr><tr><td><font color="DodgerBlue">DodgerBlue</font></td><td><font color="#1E90FF">#1E90FF</font></td><td bgcolor="#1E90FF">rgb(30, 144, 255)</td></tr><tr><td><font color="Feldspar">Feldspar</font></td><td><font color="#D19275">#D19275</font></td><td bgcolor="#D19275">rgb(209, 146, 117)</td></tr><tr><td><font color="FireBrick">FireBrick</font></td><td><font color="#B22222">#B22222</font></td><td bgcolor="#B22222">rgb(178, 34, 34)</td></tr><tr><td><font color="FloralWhite">FloralWhite</font></td><td><font color="#FFFAF0">#FFFAF0</font></td><td bgcolor="#FFFAF0">rgb(255, 250, 240)</td></tr><tr><td><font color="ForestGreen">ForestGreen</font></td><td><font color="#228B22">#228B22</font></td><td bgcolor="#228B22">rgb(34, 139, 34)</td></tr><tr><td><font color="Fuchsia">Fuchsia</font></td><td><font color="#FF00FF">#FF00FF</font></td><td bgcolor="#FF00FF">rgb(255, 0, 255)</td></tr><tr><td><font color="Gainsboro">Gainsboro</font></td><td><font color="#DCDCDC">#DCDCDC</font></td><td bgcolor="#DCDCDC">rgb(220, 220, 220)</td></tr><tr><td><font color="GhostWhite">GhostWhite</font></td><td><font color="#F8F8FF">#F8F8FF</font></td><td bgcolor="#F8F8FF">rgb(248, 248, 255)</td></tr><tr><td><font color="Gold">Gold</font></td><td><font color="#FFD700">#FFD700</font></td><td bgcolor="#FFD700">rgb(255, 215, 0)</td></tr><tr><td><font color="GoldenRod">GoldenRod</font></td><td><font color="#DAA520">#DAA520</font></td><td bgcolor="#DAA520">rgb(218, 165, 32)</td></tr><tr><td><font color="Gray">Gray</font></td><td><font color="#808080">#808080</font></td><td bgcolor="#808080">rgb(128, 128, 128)</td></tr><tr><td><font color="Green">Green</font></td><td><font color="#008000">#008000</font></td><td bgcolor="#008000">rgb(0, 128, 0)</td></tr><tr><td><font color="GreenYellow">GreenYellow</font></td><td><font color="#ADFF2F">#ADFF2F</font></td><td bgcolor="#ADFF2F">rgb(173, 255, 47)</td></tr><tr><td><font color="HoneyDew">HoneyDew</font></td><td><font color="#F0FFF0">#F0FFF0</font></td><td bgcolor="#F0FFF0">rgb(240, 255, 240)</td></tr><tr><td><font color="HotPink">HotPink</font></td><td><font color="#FF69B4">#FF69B4</font></td><td bgcolor="#FF69B4">rgb(255, 105, 180)</td></tr><tr><td><font color="IndianRed">IndianRed</font></td><td><font color="#CD5C5C">#CD5C5C</font></td><td bgcolor="#CD5C5C">rgb(205, 92, 92)</td></tr><tr><td><font color="Indigo">Indigo</font></td><td><font color="#4B0082">#4B0082</font></td><td bgcolor="#4B0082">rgb(75, 0, 130)</td></tr><tr><td><font color="Ivory">Ivory</font></td><td><font color="#FFFFF0">#FFFFF0</font></td><td bgcolor="#FFFFF0">rgb(255, 255, 240)</td></tr><tr><td><font color="Khaki">Khaki</font></td><td><font color="#F0E68C">#F0E68C</font></td><td bgcolor="#F0E68C">rgb(240, 230, 140)</td></tr><tr><td><font color="Lavender">Lavender</font></td><td><font color="#E6E6FA">#E6E6FA</font></td><td bgcolor="#E6E6FA">rgb(230, 230, 250)</td></tr><tr><td><font color="LavenderBlush">LavenderBlush</font></td><td><font color="#FFF0F5">#FFF0F5</font></td><td bgcolor="#FFF0F5">rgb(255, 240, 245)</td></tr><tr><td><font color="LawnGreen">LawnGreen</font></td><td><font color="#7CFC00">#7CFC00</font></td><td bgcolor="#7CFC00">rgb(124, 252, 0)</td></tr><tr><td><font color="LemonChiffon">LemonChiffon</font></td><td><font color="#FFFACD">#FFFACD</font></td><td bgcolor="#FFFACD">rgb(255, 250, 205)</td></tr><tr><td><font color="LightBlue">LightBlue</font></td><td><font color="#ADD8E6">#ADD8E6</font></td><td bgcolor="#ADD8E6">rgb(173, 216, 230)</td></tr><tr><td><font color="LightCoral">LightCoral</font></td><td><font color="#F08080">#F08080</font></td><td bgcolor="#F08080">rgb(240, 128, 128)</td></tr><tr><td><font color="LightCyan">LightCyan</font></td><td><font color="#E0FFFF">#E0FFFF</font></td><td bgcolor="#E0FFFF">rgb(224, 255, 255)</td></tr><tr><td><font color="LightGoldenRodYellow">LightGoldenRodYellow</font></td><td><font color="#FAFAD2">#FAFAD2</font></td><td bgcolor="#FAFAD2">rgb(250, 250, 210)</td></tr><tr><td><font color="LightGrey">LightGrey</font></td><td><font color="#D3D3D3">#D3D3D3</font></td><td bgcolor="#D3D3D3">rgb(211, 211, 211)</td></tr><tr><td><font color="LightGreen">LightGreen</font></td><td><font color="#90EE90">#90EE90</font></td><td bgcolor="#90EE90">rgb(144, 238, 144)</td></tr><tr><td><font color="LightPink">LightPink</font></td><td><font color="#FFB6C1">#FFB6C1</font></td><td bgcolor="#FFB6C1">rgb(255, 182, 193)</td></tr><tr><td><font color="LightSalmon">LightSalmon</font></td><td><font color="#FFA07A">#FFA07A</font></td><td bgcolor="#FFA07A">rgb(255, 160, 122)</td></tr><tr><td><font color="LightSeaGreen">LightSeaGreen</font></td><td><font color="#20B2AA">#20B2AA</font></td><td bgcolor="#20B2AA">rgb(32, 178, 170)</td></tr><tr><td><font color="LightSkyBlue">LightSkyBlue</font></td><td><font color="#87CEFA">#87CEFA</font></td><td bgcolor="#87CEFA">rgb(135, 206, 250)</td></tr><tr><td><font color="LightSlateBlue">LightSlateBlue</font></td><td><font color="#8470FF">#8470FF</font></td><td bgcolor="#8470FF">rgb(132, 112, 255)</td></tr><tr><td><font color="LightSlateGray">LightSlateGray</font></td><td><font color="#778899">#778899</font></td><td bgcolor="#778899">rgb(119, 136, 153)</td></tr><tr><td><font color="LightSteelBlue">LightSteelBlue</font></td><td><font color="#B0C4DE">#B0C4DE</font></td><td bgcolor="#B0C4DE">rgb(176, 196, 222)</td></tr><tr><td><font color="LightYellow">LightYellow</font></td><td><font color="#FFFFE0">#FFFFE0</font></td><td bgcolor="#FFFFE0">rgb(255, 255, 224)</td></tr><tr><td><font color="Lime">Lime</font></td><td><font color="#00FF00">#00FF00</font></td><td bgcolor="#00FF00">rgb(0, 255, 0)</td></tr><tr><td><font color="LimeGreen">LimeGreen</font></td><td><font color="#32CD32">#32CD32</font></td><td bgcolor="#32CD32">rgb(50, 205, 50)</td></tr><tr><td><font color="Linen">Linen</font></td><td><font color="#FAF0E6">#FAF0E6</font></td><td bgcolor="#FAF0E6">rgb(250, 240, 230)</td></tr><tr><td><font color="Magenta">Magenta</font></td><td><font color="#FF00FF">#FF00FF</font></td><td bgcolor="#FF00FF">rgb(255, 0, 255)</td></tr><tr><td><font color="Maroon">Maroon</font></td><td><font color="#800000">#800000</font></td><td bgcolor="#800000">rgb(128, 0, 0)</td></tr><tr><td><font color="MediumAquaMarine">MediumAquaMarine</font></td><td><font color="#66CDAA">#66CDAA</font></td><td bgcolor="#66CDAA">rgb(102, 205, 170)</td></tr><tr><td><font color="MediumBlue">MediumBlue</font></td><td><font color="#0000CD">#0000CD</font></td><td bgcolor="#0000CD">rgb(0, 0, 205)</td></tr><tr><td><font color="MediumOrchid">MediumOrchid</font></td><td><font color="#BA55D3">#BA55D3</font></td><td bgcolor="#BA55D3">rgb(186, 85, 211)</td></tr><tr><td><font color="MediumPurple">MediumPurple</font></td><td><font color="#9370D8">#9370D8</font></td><td bgcolor="#9370D8">rgb(147, 112, 216)</td></tr><tr><td><font color="MediumSeaGreen">MediumSeaGreen</font></td><td><font color="#3CB371">#3CB371</font></td><td bgcolor="#3CB371">rgb(60, 179, 113)</td></tr><tr><td><font color="MediumSlateBlue">MediumSlateBlue</font></td><td><font color="#7B68EE">#7B68EE</font></td><td bgcolor="#7B68EE">rgb(123, 104, 238)</td></tr><tr><td><font color="MediumSpringGreen">MediumSpringGreen</font></td><td><font color="#00FA9A">#00FA9A</font></td><td bgcolor="#00FA9A">rgb(0, 250, 154)</td></tr><tr><td><font color="MediumTurquoise">MediumTurquoise</font></td><td><font color="#48D1CC">#48D1CC</font></td><td bgcolor="#48D1CC">rgb(72, 209, 204)</td></tr><tr><td><font color="MediumVioletRed">MediumVioletRed</font></td><td><font color="#C71585">#C71585</font></td><td bgcolor="#C71585">rgb(199, 21, 133)</td></tr><tr><td><font color="MidnightBlue">MidnightBlue</font></td><td><font color="#191970">#191970</font></td><td bgcolor="#191970">rgb(25, 25, 112)</td></tr><tr><td><font color="MintCream">MintCream</font></td><td><font color="#F5FFFA">#F5FFFA</font></td><td bgcolor="#F5FFFA">rgb(245, 255, 250)</td></tr><tr><td><font color="MistyRose">MistyRose</font></td><td><font color="#FFE4E1">#FFE4E1</font></td><td bgcolor="#FFE4E1">rgb(255, 228, 225)</td></tr><tr><td><font color="Moccasin">Moccasin</font></td><td><font color="#FFE4B5">#FFE4B5</font></td><td bgcolor="#FFE4B5">rgb(255, 228, 181)</td></tr><tr><td><font color="NavajoWhite">NavajoWhite</font></td><td><font color="#FFDEAD">#FFDEAD</font></td><td bgcolor="#FFDEAD">rgb(255, 222, 173)</td></tr><tr><td><font color="Navy">Navy</font></td><td><font color="#000080">#000080</font></td><td bgcolor="#000080">rgb(0, 0, 128)</td></tr><tr><td><font color="OldLace">OldLace</font></td><td><font color="#FDF5E6">#FDF5E6</font></td><td bgcolor="#FDF5E6">rgb(253, 245, 230)</td></tr><tr><td><font color="Olive">Olive</font></td><td><font color="#808000">#808000</font></td><td bgcolor="#808000">rgb(128, 128, 0)</td></tr><tr><td><font color="OliveDrab">OliveDrab</font></td><td><font color="#6B8E23">#6B8E23</font></td><td bgcolor="#6B8E23">rgb(107, 142, 35)</td></tr><tr><td><font color="Orange">Orange</font></td><td><font color="#FFA500">#FFA500</font></td><td bgcolor="#FFA500">rgb(255, 165, 0)</td></tr><tr><td><font color="OrangeRed">OrangeRed</font></td><td><font color="#FF4500">#FF4500</font></td><td bgcolor="#FF4500">rgb(255, 69, 0)</td></tr><tr><td><font color="Orchid">Orchid</font></td><td><font color="#DA70D6">#DA70D6</font></td><td bgcolor="#DA70D6">rgb(218, 112, 214)</td></tr><tr><td><font color="PaleGoldenRod">PaleGoldenRod</font></td><td><font color="#EEE8AA">#EEE8AA</font></td><td bgcolor="#EEE8AA">rgb(238, 232, 170)</td></tr><tr><td><font color="PaleGreen">PaleGreen</font></td><td><font color="#98FB98">#98FB98</font></td><td bgcolor="#98FB98">rgb(152, 251, 152)</td></tr><tr><td><font color="PaleTurquoise">PaleTurquoise</font></td><td><font color="#AFEEEE">#AFEEEE</font></td><td bgcolor="#AFEEEE">rgb(175, 238, 238)</td></tr><tr><td><font color="PaleVioletRed">PaleVioletRed</font></td><td><font color="#D87093">#D87093</font></td><td bgcolor="#D87093">rgb(216, 112, 147)</td></tr><tr><td><font color="PapayaWhip">PapayaWhip</font></td><td><font color="#FFEFD5">#FFEFD5</font></td><td bgcolor="#FFEFD5">rgb(255, 239, 213)</td></tr><tr><td><font color="PeachPuff">PeachPuff</font></td><td><font color="#FFDAB9">#FFDAB9</font></td><td bgcolor="#FFDAB9">rgb(255, 218, 185)</td></tr><tr><td><font color="Peru">Peru</font></td><td><font color="#CD853F">#CD853F</font></td><td bgcolor="#CD853F">rgb(205, 133, 63)</td></tr><tr><td><font color="Pink">Pink</font></td><td><font color="#FFC0CB">#FFC0CB</font></td><td bgcolor="#FFC0CB">rgb(255, 192, 203)</td></tr><tr><td><font color="Plum">Plum</font></td><td><font color="#DDA0DD">#DDA0DD</font></td><td bgcolor="#DDA0DD">rgb(221, 160, 221)</td></tr><tr><td><font color="PowderBlue">PowderBlue</font></td><td><font color="#B0E0E6">#B0E0E6</font></td><td bgcolor="#B0E0E6">rgb(176, 224, 230)</td></tr><tr><td><font color="Purple">Purple</font></td><td><font color="#800080">#800080</font></td><td bgcolor="#800080">rgb(128, 0, 128)</td></tr><tr><td><font color="Red">Red</font></td><td><font color="#FF0000">#FF0000</font></td><td bgcolor="#FF0000">rgb(255, 0, 0)</td></tr><tr><td><font color="RosyBrown">RosyBrown</font></td><td><font color="#BC8F8F">#BC8F8F</font></td><td bgcolor="#BC8F8F">rgb(188, 143, 143)</td></tr><tr><td><font color="RoyalBlue">RoyalBlue</font></td><td><font color="#4169E1">#4169E1</font></td><td bgcolor="#4169E1">rgb(65, 105, 225)</td></tr><tr><td><font color="SaddleBrown">SaddleBrown</font></td><td><font color="#8B4513">#8B4513</font></td><td bgcolor="#8B4513">rgb(139, 69, 19)</td></tr><tr><td><font color="Salmon">Salmon</font></td><td><font color="#FA8072">#FA8072</font></td><td bgcolor="#FA8072">rgb(250, 128, 114)</td></tr><tr><td><font color="SandyBrown">SandyBrown</font></td><td><font color="#F4A460">#F4A460</font></td><td bgcolor="#F4A460">rgb(244, 164, 96)</td></tr><tr><td><font color="SeaGreen">SeaGreen</font></td><td><font color="#2E8B57">#2E8B57</font></td><td bgcolor="#2E8B57">rgb(46, 139, 87)</td></tr><tr><td><font color="SeaShell">SeaShell</font></td><td><font color="#FFF5EE">#FFF5EE</font></td><td bgcolor="#FFF5EE">rgb(255, 245, 238)</td></tr><tr><td><font color="Sienna">Sienna</font></td><td><font color="#A0522D">#A0522D</font></td><td bgcolor="#A0522D">rgb(160, 82, 45)</td></tr><tr><td><font color="Silver">Silver</font></td><td><font color="#C0C0C0">#C0C0C0</font></td><td bgcolor="#C0C0C0">rgb(192, 192, 192)</td></tr><tr><td><font color="SkyBlue">SkyBlue</font></td><td><font color="#87CEEB">#87CEEB</font></td><td bgcolor="#87CEEB">rgb(135, 206, 235)</td></tr><tr><td><font color="SlateBlue">SlateBlue</font></td><td><font color="#6A5ACD">#6A5ACD</font></td><td bgcolor="#6A5ACD">rgb(106, 90, 205)</td></tr><tr><td><font color="SlateGray">SlateGray</font></td><td><font color="#708090">#708090</font></td><td bgcolor="#708090">rgb(112, 128, 144)</td></tr><tr><td><font color="Snow">Snow</font></td><td><font color="#FFFAFA">#FFFAFA</font></td><td bgcolor="#FFFAFA">rgb(255, 250, 250)</td></tr><tr><td><font color="SpringGreen">SpringGreen</font></td><td><font color="#00FF7F">#00FF7F</font></td><td bgcolor="#00FF7F">rgb(0, 255, 127)</td></tr><tr><td><font color="SteelBlue">SteelBlue</font></td><td><font color="#4682B4">#4682B4</font></td><td bgcolor="#4682B4">rgb(70, 130, 180)</td></tr><tr><td><font color="Tan">Tan</font></td><td><font color="#D2B48C">#D2B48C</font></td><td bgcolor="#D2B48C">rgb(210, 180, 140)</td></tr><tr><td><font color="Teal">Teal</font></td><td><font color="#008080">#008080</font></td><td bgcolor="#008080">rgb(0, 128, 128)</td></tr><tr><td><font color="Thistle">Thistle</font></td><td><font color="#D8BFD8">#D8BFD8</font></td><td bgcolor="#D8BFD8">rgb(216, 191, 216)</td></tr><tr><td><font color="Tomato">Tomato</font></td><td><font color="#FF6347">#FF6347</font></td><td bgcolor="#FF6347">rgb(255, 99, 71)</td></tr><tr><td><font color="Turquoise">Turquoise</font></td><td><font color="#40E0D0">#40E0D0</font></td><td bgcolor="#40E0D0">rgb(64, 224, 208)</td></tr><tr><td><font color="Violet">Violet</font></td><td><font color="#EE82EE">#EE82EE</font></td><td bgcolor="#EE82EE">rgb(238, 130, 238)</td></tr><tr><td><font color="VioletRed">VioletRed</font></td><td><font color="#D02090">#D02090</font></td><td bgcolor="#D02090">rgb(208, 32, 144)</td></tr><tr><td><font color="Wheat">Wheat</font></td><td><font color="#F5DEB3">#F5DEB3</font></td><td bgcolor="#F5DEB3">rgb(245, 222, 179)</td></tr><tr><td><font color="White">White</font></td><td><font color="#FFFFFF">#FFFFFF</font></td><td bgcolor="#FFFFFF">rgb(255, 255, 255)</td></tr><tr><td><font color="WhiteSmoke">WhiteSmoke</font></td><td><font color="#F5F5F5">#F5F5F5</font></td><td bgcolor="#F5F5F5">rgb(245, 245, 245)</td></tr><tr><td><font color="Yellow">Yellow</font></td><td><font color="#FFFF00">#FFFF00</font></td><td bgcolor="#FFFF00">rgb(255, 255, 0)</td></tr><tr><td><font color="YellowGreen">YellowGreen</font></td><td><font color="#9ACD32">#9ACD32</font></td><td bgcolor="#9ACD32">rgb(154, 205, 50)</td></tr></tbody></table></div> </details><h1 id="脚注"><a href="#脚注" class="headerlink" title="脚注"></a>脚注</h1><p>[^1]:使用类 Setext 形式创建标题。注意使用Shift+Enter换行<br>[^2]:类 Atx 形式：使用此方法创建标题，一共可以有6个级别<br>[^分割线]:注意：最后一条使用了HTML标签<br>[^对齐]:github似乎不支持表格里的对齐<br>[^斜体]: Markdown treats asterisks (<code>*</code>) and underscores (<code>_</code>) as indicators of emphasis. Text wrapped with one <code>*</code> or <code>_</code> will be wrapped with an HTML <code>&lt;em&gt;</code> tag<br>[^加粗]: A double <code>*</code> or <code>_</code> will cause its enclosed contents to be wrapped with an HTML <code>&lt;strong&gt;</code> tag<br>[^backslash escapes]: <a href="https://daringfireball.net/projects/markdown/syntax">https://daringfireball.net/projects/markdown/syntax</a></p>]]></content>
    
    
    <summary type="html">通过源码案例学习Typora渲染下的Markdown</summary>
    
    
    
    <category term="计算机" scheme="https://www.uuanqin.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/"/>
    
    
    <category term="源码案例驱动" scheme="https://www.uuanqin.top/tags/%E6%BA%90%E7%A0%81%E6%A1%88%E4%BE%8B%E9%A9%B1%E5%8A%A8/"/>
    
    <category term="Typora" scheme="https://www.uuanqin.top/tags/Typora/"/>
    
    <category term="Markdown" scheme="https://www.uuanqin.top/tags/Markdown/"/>
    
  </entry>
  
  <entry>
    <title>极简图书管理系统，快速上手Flask+Vue前后端开发</title>
    <link href="https://www.uuanqin.top/p/a329ff74.html"/>
    <id>https://www.uuanqin.top/p/a329ff74.html</id>
    <published>2023-05-04T08:29:14.000Z</published>
    <updated>2023-05-07T04:56:00.072Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>本文章源代码是经由视频<a href="https://www.bilibili.com/video/BV1Jr4y1771i%E6%89%8B%E6%95%B2%E8%80%8C%E6%9D%A5%EF%BC%8C%E5%86%8D%E7%BB%8F%E8%BF%87%E5%AE%9E%E9%99%85%E6%83%85%E5%86%B5%E5%81%9A%E4%BA%86%E5%B0%8F%E7%9A%84%E6%94%B9%E8%89%AF%EF%BC%88%E4%BD%BF%E7%94%A8MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%89%EF%BC%8C%E6%98%AF%E8%A7%86%E9%A2%91%E6%95%99%E7%A8%8B%E5%86%85%E5%AE%B9%E7%9A%84%E6%BA%90%E7%A0%81%E9%83%A8%E5%88%86%E7%9A%84%E8%A1%A5%E5%85%85%EF%BC%8C%E5%BC%BA%E7%83%88%E5%BB%BA%E8%AE%AE%E9%85%8D%E5%90%88%E8%A7%86%E9%A2%91%E9%A3%9F%E7%94%A8%E3%80%82">https://www.bilibili.com/video/BV1Jr4y1771i手敲而来，再经过实际情况做了小的改良（使用MySQL数据库），是视频教程内容的源码部分的补充，强烈建议配合视频食用。</a></p><p>当然有一定相关知识基础，但不愿意看视频的，可以<strong>直接理解源码，读代码注解</strong>即可。</p></blockquote><p>[附件下载功能开发中]</p><p>不管你做过多少的项目，<strong>图书管理系统</strong>你总该做过吧？</p><blockquote><p><em>面试官：你是我见过的第XXX个做图书管理系统的。</em></p></blockquote><p>像这种不大不小的前后端开发项目，是最适合个人学习新技术的。这篇文章分享一个极简图书管理系统的前后端开发项目源码学习实践，帮助你快速熟悉Flask+Vue前后端分离的开发流程。适合基本了解Vue与Flask基本功能，但想进行前后端交互实践的学习者，动手体验自己造一个小项目。</p><p>前置知识：</p><ul><li>Python基础，懂python基本的语法</li><li>一点点HTML+CSS+Javascript+AJAX基础，不需要特别深入</li><li>Vue基础，这里推荐做完互动教程（API风格：组合式）就行：<a href="https://cn.vuejs.org/tutorial/#step-1">教程 | Vue.js (vuejs.org)</a></li><li>Flask基础，推荐一边做一边查阅：<a href="https://tutorial.helloflask.com/">Flask 入门教程 (helloflask.com)</a></li><li>MySQL基础（非必需）</li></ul><h1 id="功能展示"><a href="#功能展示" class="headerlink" title="功能展示"></a>功能展示</h1><p>基本页面：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230504170537219.png" alt="image-20230504170537219"></p><p>实现了图书管理系统增删改查功能。</p><h1 id="环境与依赖"><a href="#环境与依赖" class="headerlink" title="环境与依赖"></a>环境与依赖</h1><p>环境：Python 3.10</p><p>后端：</p><ul><li>Python安装Flask</li><li>pip安装Flask-Cors、Flask-Cors、PyMySQL</li></ul><p>前端：Vite、Vue、axios、element-plus</p><h1 id="案例代码使用"><a href="#案例代码使用" class="headerlink" title="案例代码使用"></a>案例代码使用</h1><h2 id="后端"><a href="#后端" class="headerlink" title="后端"></a>后端</h2><p>创建好Flask项目后，把以下文件放入项目文件夹中即可</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">后端项目</span><br><span class="line">│  .env         # python-dotenv 相关</span><br><span class="line">│  .flaskenv    # python-dotenv 相关</span><br><span class="line">│  app.py       # flask主程序</span><br><span class="line">│  demo.http    # HTTP请求测试文件</span><br><span class="line">│  extension.py # 扩展</span><br><span class="line">│  models.py    # 数据库</span><br></pre></td></tr></table></figure><p>你在PyCharm看到的应该是这样的：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230504174717777.png" alt="image-20230504174717777"></p><p>通过以下命令启动后端服务器:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flask run</span><br><span class="line"><span class="comment"># 或</span></span><br><span class="line">python app.py</span><br></pre></td></tr></table></figure><h2 id="前端"><a href="#前端" class="headerlink" title="前端"></a>前端</h2><p>通过Vite创建Vue项目后，把/src/assets/main.css中的内容注释掉，免得后面网页显示异常。</p><p>用本案例的两个文件替换原项目的对应文件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">App.vue</span><br><span class="line">main.js</span><br></pre></td></tr></table></figure><p>你在VSCode看到的应该是这样的：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230504175239052.png" alt="image-20230504175239052"></p><p>通过以下命令启动客户端：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run dev</span><br></pre></td></tr></table></figure><h1 id="问题解决记录"><a href="#问题解决记录" class="headerlink" title="问题解决记录"></a>问题解决记录</h1><p>这个板块记录我在参照视频敲代码所遇到的问题。在我提供的代码中，这些问题已被解决。</p><p><strong>Q: 我使用的数据库是mysql</strong></p><p>A: 安装PyMySQL Python包之后，app.config可以这样写：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.config[<span class="string">&#x27;SQLALCHEMY_DATABASE_URI&#x27;</span>] = <span class="string">&#x27;mysql+pymysql://root:&lt;your mysql key&gt;@localhost:3306/&lt;your database name&gt;?charset=utf8mb4&#x27;</span></span><br></pre></td></tr></table></figure><p>改变上述代码中的：</p><ul><li>&lt;your mysql key&gt;：你的Mysql数据库密码</li><li>&lt;your database name&gt;：你创建的数据库名，记得要预先创建好</li></ul><p><strong>Q: js中模板字符串 <code>$&#123;var&#125;</code> 无效</strong></p><p>A: 注意，字符串用`来括住，不是单引号，不是双引号。</p><p>参考：<a href="https://bbs.csdn.net/topics/392194597">ES6 模板字符串 ${} 无效-CSDN社区</a></p><p><strong>Q: 出现跨域问题</strong></p><p>A: 代码里已经解决了跨域问题，请检查请求的URL是否正确</p><p>参考：<a href="https://zhuanlan.zhihu.com/p/75738155">flask restful 处理跨域请求 - 知乎 (zhihu.com)</a></p><p><strong>Q: 希望服务端的响应报文返回中文而不是Unicode字符串</strong></p><p>A: 对服务端的返回结果进行处理，如：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ret= &#123; <span class="string">&#x27;&#x27;&#x27;your data&#x27;&#x27;&#x27;</span> &#125;</span><br><span class="line"><span class="keyword">return</span> json.dumps(ret, ensure_ascii=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><p>注意，由于Flask版本更新，为Flask app设置变量<code>JSON_AS_ASCII</code>的方法已经失效。</p><p>参考：</p><ul><li>[flask或flask-restful的接口开发，返回的json数据能显示中文的方法_flask 设置json数据显示中文格式_fj_changing的博客-CSDN博客](<a href="https://blog.csdn.net/fj_changing/article/details/116385130#:~:text=%E7%94%A8,flask">https://blog.csdn.net/fj_changing/article/details/116385130#:~:text=用,flask</a> 或flask-restful开发接口时，返回给前端的json数据中若有中文，在postman的raw里或浏览器直接访问，中文会显示成unicode编码之后的形式，下面是使之显示成中文的方法。)</li><li><a href="https://flask.palletsprojects.com/en/2.3.x/changes/?highlight=json_as_ascii">Changes — Flask Documentation (2.3.x) (palletsprojects.com)</a></li></ul><h1 id="额外收获"><a href="#额外收获" class="headerlink" title="额外收获"></a>额外收获</h1><p>用HTTP文件调试API的技能学习，参考这篇文章学会写http的测试请求：<a href="https://marketplace.visualstudio.com/items?itemName=humao.rest-client">REST Client - Visual Studio Marketplace</a></p><p>RESTful风格API：<a href="http://ruanyifeng.com/blog/2014/05/restful_api.html">RESTful API 设计指南 - 阮一峰的网络日志 (ruanyifeng.com)</a></p>]]></content>
    
    
    <summary type="html">源码项目学习实践，快速掌握Flask+Vue的前后端开发流程</summary>
    
    
    
    <category term="计算机" scheme="https://www.uuanqin.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/"/>
    
    
    <category term="源码案例驱动" scheme="https://www.uuanqin.top/tags/%E6%BA%90%E7%A0%81%E6%A1%88%E4%BE%8B%E9%A9%B1%E5%8A%A8/"/>
    
    <category term="Python" scheme="https://www.uuanqin.top/tags/Python/"/>
    
    <category term="Flask" scheme="https://www.uuanqin.top/tags/Flask/"/>
    
    <category term="Vite" scheme="https://www.uuanqin.top/tags/Vite/"/>
    
    <category term="Vue" scheme="https://www.uuanqin.top/tags/Vue/"/>
    
    <category term="ElementPlus" scheme="https://www.uuanqin.top/tags/ElementPlus/"/>
    
    <category term="MySQL" scheme="https://www.uuanqin.top/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>代码驱动学习-快速入门AJAX</title>
    <link href="https://www.uuanqin.top/p/9f885dad.html"/>
    <id>https://www.uuanqin.top/p/9f885dad.html</id>
    <published>2023-05-02T12:39:49.000Z</published>
    <updated>2023-05-04T13:32:56.992Z</updated>
    
    <content type="html"><![CDATA[<p>本文附件：【待补充】</p><h1 id="什么是AJAX？"><a href="#什么是AJAX？" class="headerlink" title="什么是AJAX？"></a>什么是AJAX？</h1><p>AJAX，读作”/eɪdʒæks/，也可以念为“阿贾克斯”。最大的特点就是在不刷新网页的情况下向服务端发请求并获取结果。AJAX不是新的编程语言，而是一种将现有的标准组合在一起使用的新方式。</p><p><a href="https://www.w3school.com.cn/js/js_ajax_intro.asp">AJAX 简介 (w3school.com.cn)</a></p><blockquote><p>XML可扩展标记语言，XML被设计用来传输和存储数据。XML和 HTML类似，不同的是HTML中都是预定义标签，而XML中没有预定义标签，全都是自定义标签，用来表示一些数据。不过现在AJAX多使用JSON格式了。</p><p>XML简介：<a href="https://www.w3school.com.cn/x.asp">XML系列教程 (w3school.com.cn)</a></p></blockquote><p>AJAX的优点：</p><ul><li>可以无需刷新页面而与服务器端进行通信。</li><li>允许你根据用户事件来更新部分页面内容。</li></ul><p>AJAX的缺点：</p><ul><li>没有浏览历史，不能回退</li><li>存在跨域问题(同源)</li><li>SEO不友好</li></ul><h1 id="学习准备"><a href="#学习准备" class="headerlink" title="学习准备"></a>学习准备</h1><h2 id="预备知识"><a href="#预备知识" class="headerlink" title="预备知识"></a>预备知识</h2><p>本文章在于通过代码实践快速掌握AJAX基本使用。阅读前你需要具备一定的HTML、CSS、JS知识，了解HTTP协议的请求报文和响应报文的结构。</p><ul><li><p>JS基础请看：<a href="https://developer.mozilla.org/zh-CN/docs/Learn/Getting_started_with_the_web/JavaScript_basics">JavaScript 基础 - 学习 Web 开发 | MDN (mozilla.org)</a></p></li><li><p>HTTP结构：<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Messages">HTTP 消息 - HTTP | MDN (mozilla.org)</a></p></li></ul><p>学习前我们需要懂得使用Chrome、Edge浏览器开发者模式（按F12），查看查看HTTP报文接收和发送情况。</p><p>本文章主要通过可运行的案例代码以驱动学习，学习者可以通过理解代码并试图在本机运行以加深理解。建议你在学习时打开F12调试窗口，查看控制台输出与网络请求。</p><p>本篇文章的实践内容参考：<a href="https://www.bilibili.com/video/BV1WC4y1b78y%EF%BC%8C%E8%A7%86%E9%A2%91%E6%97%B6%E9%95%BF%E7%BA%A63%E5%B0%8F%E6%97%B6%E3%80%82">https://www.bilibili.com/video/BV1WC4y1b78y，视频时长约3小时。</a></p><h2 id="软件安装"><a href="#软件安装" class="headerlink" title="软件安装"></a>软件安装</h2><h3 id="Node-js"><a href="#Node-js" class="headerlink" title="Node.js"></a>Node.js</h3><p>安装Node.js：<a href="https://nodejs.org/en">Node.js (nodejs.org)</a>。</p><p>安装完毕后在终端输入命令：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node -v</span><br></pre></td></tr></table></figure><p>若显示版本号即安装成功。</p><h3 id="Express服务端框架"><a href="#Express服务端框架" class="headerlink" title="Express服务端框架"></a>Express服务端框架</h3><p>为了更好的演示AJAX操作，我们需要自己启动一个服务端。接下来的实验我们只需要对这个服务端进行消息的发送。在这一小节中，我们只需要了解Express的最小知识。</p><p>安装前保证安装了Node.js，输入：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i express</span><br></pre></td></tr></table></figure><p>npm是Node.js提供的包管理工具。通过该命令安装express。</p><p>新建js文件，可以将其命名为server.js，内容如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 引入express</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 创建应用对象</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 创建路由规则</span></span><br><span class="line"><span class="comment">// request是对请求报文的封装，response是对响应报文的封装</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/server&#x27;</span>,<span class="function">(<span class="params">request,response</span>)=&gt;</span>&#123;</span><br><span class="line">    response.<span class="title function_">setHeader</span>(<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>,<span class="string">&quot;*&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//设置一个简单的响应</span></span><br><span class="line">    response.<span class="title function_">send</span>(<span class="string">&#x27;HELLO AJAX!&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. 监听端口启动服务</span></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">8000</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;服务已经启动，8000端口监听中...&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>打开终端，执行以下命令启动服务：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node &lt;your server.js&gt; </span><br></pre></td></tr></table></figure><p>终端输出”服务已经启动，8000端口监听中…”。打开浏览器输入127.0.0.1:8000，若显示’‘’HELLO AJAX!’，则服务启动成功。</p><p>注意，每次修改server.js文件，<strong>保存后</strong>需要关闭当前正在运行的服务，再次启动server.js才能应用新的更改。如果我们想要每次修改server.js保存后自动重启服务器，我们可以安装modemon进行解决。</p><p>常见错误：</p><ul><li><p><strong>启动失败 address already in use :::8000</strong></p><p>这表明8000端口已经被占用，你可能忘记中断之前打开的服务，尝试中断之前的服务，或换一个端口号尝试。</p></li><li><p><strong>输入命令后没有反应</strong></p><p>检查你是不是粘贴后没有保存。</p></li></ul><h3 id="nodemon工具安装"><a href="#nodemon工具安装" class="headerlink" title="nodemon工具安装"></a>nodemon工具安装</h3><p>官网链接：<a href="https://www.npmjs.com/package/nodemon">nodemon - npm (npmjs.com)</a></p><p>安装前保证安装好了Node.js。安装命令：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g nodemon</span><br></pre></td></tr></table></figure><p>以后每次启动server.js脚本可以改为使用以下命令：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nodemon &lt;your server.js&gt;</span><br></pre></td></tr></table></figure><h3 id="axios"><a href="#axios" class="headerlink" title="axios"></a>axios</h3><p>axio是前端热门的AJAX工具库：<a href="https://github.com/axios/axios">axios/axios: Promise based HTTP client for the browser and node.js (github.com)</a></p><p>使用axio我们可以直接通过页面链接引用。</p><p>但是官网给的CDN链接是在国外的，所以我们可以通过<a href="https://www.bootcdn.cn/">BootCDN</a>查询并替换网址。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://cdn.bootcdn.net/ajax/libs/axios/1.3.6/axios.min.js</span><br></pre></td></tr></table></figure><h3 id="【非必须】VSCode插件-Live-Server"><a href="#【非必须】VSCode插件-Live-Server" class="headerlink" title="【非必须】VSCode插件-Live Server"></a>【非必须】VSCode插件-Live Server</h3><p>如果你是在VSCode环境下进行操作的话，可以安装一个Live Server插件。这个插件右键可以将html网页用服务器打开，以模拟跨域同源实验。</p><h1 id="第一章节：AJAX请求基本实践"><a href="#第一章节：AJAX请求基本实践" class="headerlink" title="第一章节：AJAX请求基本实践"></a>第一章节：AJAX请求基本实践</h1><p>本章节包含两个文件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">server.js 服务器文件</span><br><span class="line">client.html 案例</span><br></pre></td></tr></table></figure><p>案例食用说明：</p><ol><li>在终端输入命令执行server.js <code>nodemon &lt;your server.js&gt;</code></li><li>浏览器打开client.html</li></ol><p>阅读源码和注解理解即可。</p><p>要点提示：</p><ul><li><p>Chapter 1：本章节演示了AJAX操作的基本步骤</p></li><li><p>Chapter 2：演示使用GET方法传参与请求头设置</p><p>打开F12查看请求标头，可以发现自定义标头已添加。</p></li></ul><p>​    <img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230426170053196.png" alt="image-20230426170053196"></p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230426170810095.png" alt="image-20230426170810095"></p><p>小技巧：解决IE缓存问题。神奇的IE浏览器会对AJAX进行缓存，解决方法：在请求地址后加上随机的参数，比如：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xhr.<span class="title function_">open</span>(<span class="string">&quot;GET&quot;</span>,<span class="string">&quot;http://127.0.0.1:8000/server?t=&quot;</span>+<span class="title class_">Date</span>.<span class="title function_">now</span>())</span><br></pre></td></tr></table></figure><p>或者在调试器中禁用缓存。</p><ul><li><p>Chapter 3：演示AJAX发送POST请求</p></li><li><p>Chapter 4：演示AJAX超时设置以及设置网络异常时的回调</p><p>调试器可以方便地断开网络：</p></li></ul><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230426183213807.png" alt="image-20230426183213807"></p><ul><li>Chapter 5：防抖的演示。防抖在于防止用户反复点击按钮发送多个请求，这里的代码可以实现用户每次只能发送一个请求。</li><li>Chapter 6：axios演示</li><li>Chapter 7：fetch演示</li></ul><h1 id="第二章节：跨域-同源"><a href="#第二章节：跨域-同源" class="headerlink" title="第二章节：跨域/同源"></a>第二章节：跨域/同源</h1><p>同源策略(Same-Origin Policy)最早由Netscape公司提出，是浏览器的一种安全策略，也就是当前网页URL和AJAX请求的目标URL必须<strong>同源</strong>（协议、域名、端口号必须完全相同）。AJAX发送请求时默认遵循同源策略。违背同源策略就是<strong>跨域</strong>。</p><p>跨域的解决方案有以下两种：</p><ul><li><p>Jsonp：JSONP（JSON with Padding)，是一个非官方的跨域解决方案，只支持get请求。<br>JSONp怎么工作的？在网页有一些标签天生具有跨域能力，比如：img、link iframe、script。JSONP就是利用script标签的跨域能力来发送请求的。</p></li><li><p>CORS：CORS（Cross-Origin Resource Sharing），跨域资源共享。CORS是官方的跨域解决方案，它的特点是不需要在客户端做任何特殊的操作，完全在服务器中进行处理，支持get和post请求。跨域资源共享标准新增了一组HTTP首部字段，允许服务器声明哪些源站通过浏览器有权限访问哪些资源。CORS怎么工作的？CORS是通过设置一个响应头来告诉浏览器，该请求允许跨域，浏览器收到该响应以后就会对响应放行。</p></li></ul><p>本章节包含两个文件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">server.js 服务器文件（就是上一章节那个）</span><br><span class="line">same-origin-policy.html 案例</span><br><span class="line">handle.js 示例js文件（需保证与server.js放在同一层级下）</span><br></pre></td></tr></table></figure><p>案例食用说明：</p><ol><li>在终端输入命令执行server.js <code>nodemon &lt;your server.js&gt;</code></li><li>使用不同的端口或协议打开same-origin-policy.html</li></ol><p>阅读源码和注解理解即可。</p><p>要点提示：</p><ul><li>Chapter 1：同源策略示例</li><li>Chapter 2：Jsonp简单示例</li><li>Chapter 3：原生使用Jsonp</li><li>Chapter 4：服务端设置CROS响应头实现跨域</li></ul>]]></content>
    
    
    <summary type="html">通读代码快速理解AJAX原理</summary>
    
    
    
    <category term="计算机" scheme="https://www.uuanqin.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/"/>
    
    
    <category term="AJAX" scheme="https://www.uuanqin.top/tags/AJAX/"/>
    
    <category term="JavaScript" scheme="https://www.uuanqin.top/tags/JavaScript/"/>
    
    <category term="VSCode" scheme="https://www.uuanqin.top/tags/VSCode/"/>
    
    <category term="源码案例驱动" scheme="https://www.uuanqin.top/tags/%E6%BA%90%E7%A0%81%E6%A1%88%E4%BE%8B%E9%A9%B1%E5%8A%A8/"/>
    
  </entry>
  
  <entry>
    <title>使用PR实现GIF动图画面拼接</title>
    <link href="https://www.uuanqin.top/p/7a52ccab.html"/>
    <id>https://www.uuanqin.top/p/7a52ccab.html</id>
    <published>2023-05-01T09:41:12.000Z</published>
    <updated>2023-05-01T13:13:15.439Z</updated>
    
    <content type="html"><![CDATA[<p>想自己组合一个GIF，本来以为这种简单的东西交给在线网站做就行了，不必用到PR来做，不然有点大材小用的感觉。但是在互联网找一圈后，能成功达到我的要求的根本没有，主要槽点在于：</p><ul><li>没有符合我需求的GIF处理。我要的是<strong>画面上的拼接</strong>，不是<strong>GIF前后合并</strong></li><li>不能直击痛点。WPS图像处理也有GIF编辑，但是功能少和简陋。一些网站提供图像拼接，但是只能在规定的框架格式下运行（还要关注公众号）</li><li>不能逐帧操作。WPS图像处理可以逐帧操作，但简陋，不好调整图片<br>额……突然发现我的需求还是挺复杂的。那么，刁钻的要求往往需要专业的软件解决，于是我就打算使用PR完成这个需求。<br>其实到最后，PR也没能一键解决最后的需求。</li></ul><h1 id="需求描述"><a href="#需求描述" class="headerlink" title="需求描述"></a>需求描述</h1><p>我拥有GIF图一张，PNG素材两张（两个气泡框），我需要把他们整合到同一个画面生成GIF，并且最后生成的GIF不同的帧显示我指定的PNG。</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230501182132872.png" alt="image-20230501182132872"></p><h1 id="打开PR"><a href="#打开PR" class="headerlink" title="打开PR"></a>打开PR</h1><h2 id="素材导入"><a href="#素材导入" class="headerlink" title="素材导入"></a>素材导入</h2><p>两个气泡框的素材制作完成后，把所需要的文件导进来：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230501182627900.png" alt="image-20230501182627900"></p><p>调整好时间轴，刀片切割和拼接这些“视频条”（不懂专业名词）就不用我多说了吧：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230501182750698.png" alt="image-20230501182750698"></p><h2 id="扩展画布"><a href="#扩展画布" class="headerlink" title="扩展画布"></a>扩展画布</h2><p>时间轴上选中GIF后，打开序列设置：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230501182849883.png" alt="image-20230501182849883"></p><p>调整画布大小：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230501183003235.png" alt="image-20230501183003235"></p><h2 id="素材移动"><a href="#素材移动" class="headerlink" title="素材移动"></a>素材移动</h2><p>为每一个片段添加“变换”效果（双击）：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230501183134619.png" alt="image-20230501183134619"></p><p>在效果控件里调整位置、大小等参数：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230501183306716.png" alt="image-20230501183306716"></p><h2 id="导出"><a href="#导出" class="headerlink" title="导出"></a>导出</h2><p>在老版本的PR里，GIF的导出不支持把Alpha通道导出，也就是导出的GIF是黑色背景的。你可以看这篇文章确定一下你的PR是否可以直接导出透明背景的的GIF：<a href="https://zhuanlan.zhihu.com/p/546279499">Premiere 2022直接导出带透明通道GIF动画 - 知乎 (zhihu.com)</a>，注意，导出格式选择<strong>动画GIF</strong>，不是<strong>GIF</strong>！</p><p>如果你成功导出透明背景的GIF了，那么这篇文章就结束了！</p><p>如果上面这篇文章不能解决问题，那么你可以试着导出PNG序列：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230501183800474.png" alt="image-20230501183800474"></p><h1 id="PNG序列生成GIF"><a href="#PNG序列生成GIF" class="headerlink" title="PNG序列生成GIF"></a>PNG序列生成GIF</h1><p>你可以用任何工具把PNG序列生成GIF，如PS等。</p><p>这里我选择WPS图片处理：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230501183952279.png" alt="image-20230501183952279"></p><p>添加PNG文件后调整速度，选择导出即可。</p><p>参考：</p><ul><li><a href="https://jingyan.baidu.com/article/4853e1e5387e2b5809f726b6.html">pr2020如何调整画布大小-百度经验 (baidu.com)</a></li><li><a href="https://jingyan.baidu.com/article/d5c4b52bb1c48eda570dc542.html">在PR中怎么将两个视频内容拼接到一起显示-百度经验 (baidu.com)</a></li><li><a href="https://jingyan.baidu.com/article/f3ad7d0f5d39bb09c3345bf1.html">Pr怎么导出gif动图-百度经验 (baidu.com)</a></li><li><a href="https://jingyan.baidu.com/article/f0e83a25bcbda463e59101ae.html">Premiere怎样导出带有透明背景的GIF动画-百度经验 (baidu.com)</a></li><li><a href="https://zhuanlan.zhihu.com/p/546279499">Premiere 2022直接导出带透明通道GIF动画 - 知乎 (zhihu.com)</a></li></ul>]]></content>
    
    
    <summary type="html">文章介绍通过素材进行画面拼接和合并的技巧和方法</summary>
    
    
    
    <category term="计算机" scheme="https://www.uuanqin.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/"/>
    
    
    <category term="PR" scheme="https://www.uuanqin.top/tags/PR/"/>
    
    <category term="GIF" scheme="https://www.uuanqin.top/tags/GIF/"/>
    
    <category term="WPS" scheme="https://www.uuanqin.top/tags/WPS/"/>
    
    <category term="PPT" scheme="https://www.uuanqin.top/tags/PPT/"/>
    
  </entry>
  
  <entry>
    <title>将CDN缓存自动刷新加入到Hexo博客发布的工作流</title>
    <link href="https://www.uuanqin.top/p/b05ac1ee.html"/>
    <id>https://www.uuanqin.top/p/b05ac1ee.html</id>
    <published>2023-04-30T16:15:18.000Z</published>
    <updated>2023-05-02T05:32:09.781Z</updated>
    
    <content type="html"><![CDATA[<p>使用了CDN加速源站的小伙伴可能会遇到一个问题，那就是每次发布博客到服务器后，都需要手动在腾讯云控制台进行节点的缓存刷新，很是麻烦。这里我介绍一种通过脚本的思路实现一键发布的方法，也是对腾讯云SDK工具的探索和应用。末尾含编写的脚本原件。</p><h1 id="思路（package-json编写）"><a href="#思路（package-json编写）" class="headerlink" title="思路（package.json编写）"></a>思路（package.json编写）</h1><p>在接触Hexo博客建站的时候，你一定会知道Hexo三连：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br><span class="line"><span class="comment"># 当然可以简写成</span></span><br><span class="line">hexo clean &amp;&amp; hexo d -g</span><br></pre></td></tr></table></figure><blockquote><p>命令含义参考：<a href="https://hexo.io/zh-cn/docs/commands">指令 | Hexo</a></p></blockquote><p>上面的命令可以写进<code>[blog_root]/package.json</code>的<code>scripts</code>中，如：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;publish&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hexo clean &amp;&amp; hexo d -g&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hexo clean &amp;&amp; hexo g &amp;&amp; hexo s&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure><p>这样每次部署我们只需要运行<code>npm run publish</code>即可完成连击。</p><p>在完成博客部署连击后，我们可以再执行一个脚本刷新腾讯云CDN缓存。我打算写一个js脚本<code>auto_flush_cdn.js</code>用node运行（毕竟玩Hexo总会装有Node.js的吧）。</p><p>这样我们的部署脚本就会是这样：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;publish&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hexo clean &amp;&amp; hexo d -g &amp;&amp; node .\\auto_flush_cdn.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure><p>展示一下我的：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/%25E8%2584%259A%25E6%259C%25AC%25E5%258A%25A0%25E5%2585%25A565465.jpg" alt="脚本加入65465"></p><p>现在的问题就是auto_flush_cdn.js该如何写。</p><h1 id="使用腾讯云SDK进行开发"><a href="#使用腾讯云SDK进行开发" class="headerlink" title="使用腾讯云SDK进行开发"></a>使用腾讯云SDK进行开发</h1><p>登录腾讯云后，打开云产品&gt;云API：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230501153225264.png" alt="image-20230501153225264"></p><p>我们要使用腾讯云SDK，需要先安装依赖：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/%25E4%25BE%259D%25E8%25B5%2596%25E4%25B8%258B%25E8%25BD%25BDdfsdf.jpg" alt="依赖下载dfsdf"></p><p>这里我就安装在博客目录了：博客下新建终端运行命令<code>npm install tencentcloud-sdk-nodejs-cdn --save</code></p><blockquote><p>实践中遇到找不到模块的问题，安装好依赖后记得重启终端、VSCode甚至电脑。如果不行请另外搜索解决方案。</p></blockquote><p>然后找到对应的API，按照平台指示的说明填写好参数，充分利用其诊断工具进行在线调试。（一般不会出什么问题）</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/%25E7%25BA%25BF%25E4%25B8%258A%25E5%25B0%259D%25E8%25AF%2595%25E6%258E%25A5%25E5%258F%25A3dfdff.jpg" alt="线上尝试接口dfdff"></p><p>没有问题的话我们就可以把平台代码复制下来了，在代码中改改API ID和API KEY参数即可*。</p><blockquote><p>*建议不要在代码中写入任何的密匙，详情看下一小节。</p></blockquote><p>运行一下我们的脚本文件尝试一下：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/%25E6%2588%2590%25E5%258A%259Fddf.jpg" alt="成功ddf"></p><p>没有返回错误信息，看了看控制台确实进行了刷新。如果出现问题，可以把RequestId粘贴到<a href="https://console.cloud.tencent.com/api/diagnosis">API Doctor(使用诊断) - 云 API - 控制台 (tencent.com)</a>进行诊断。</p><p>附控制台看刷新纪录的方法，打开内容分发网络找刷新预热的操作记录：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/%25E6%259F%25A5%25E7%259C%258B%25E6%259C%2589%25E6%25B2%25A1%25E6%259C%2589%25E5%2588%25B7%25E6%2596%25B0%25E6%2588%2590%25E5%258A%259F6546.jpg" alt="查看有没有刷新成功6546"></p><p>参考：</p><ul><li><a href="https://cloud.tencent.com/document/product/1278/46697">云 API 使用 API Explorer-快速入门-文档中心-腾讯云 (tencent.com)</a></li><li><a href="https://cloud.tencent.com/document/sdk/Node.js">Node.js-SDK 中心-腾讯云 (tencent.com)</a></li><li><a href="https://blog.csdn.net/qq_41684621/article/details/111463672">npm 安装包的路径在哪里_npm install在哪里输入_兮动人的博客-CSDN博客</a></li><li><a href="https://blog.csdn.net/sunnyjingqi/article/details/107000607">npm之安装、更新、卸载本地安装包_samllplum的博客-CSDN博客</a></li></ul><h1 id="安全使用API-KEY"><a href="#安全使用API-KEY" class="headerlink" title="安全使用API KEY"></a>安全使用API KEY</h1><p>在使用腾讯云SDK进行开发时，不可避免的需要传入API KEY，但是把密匙硬写在代码中是不安全的。</p><blockquote><p>代码泄露可能会导致 SecretId 和 SecretKey 泄露，并威胁账号下所有资源的安全性。建议不要在代码中使用持久 SecretId 和 SecretKey</p><p>——腾讯云</p></blockquote><p>这里介绍的是通过环境变量读取SecretId 和 SecretKey方案。</p><p>首先在自己的系统中配置环境变量，把自己的SecretId 和 SecretKey填进去：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/%25E7%25A4%25BA%25E4%25BE%258Benv546546.jpg" alt="示例env546546"></p><p>我们可以写一个demo测试一下：</p><p>新建test_env.js，写入两行代码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">Key</span> = process.<span class="property">env</span>.<span class="property">TENCENT_API_SECRETID</span>; </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Key</span>)</span><br></pre></td></tr></table></figure><p>运行脚本：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node &lt;your test_env.js&gt;</span><br></pre></td></tr></table></figure><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/test%2520env%2520%25E6%2588%2590%25E5%258A%259Fdfsdf.jpg" alt="test env 成功dfsdf"></p><p>若成功输出即配置成功。</p><blockquote><p>注意：环境变量配置好后，记得重启你的终端、VSCode（如果你使用VSCode的终端）。太玄学的话，你懂的，重启电脑。</p></blockquote><p>在你刚刚从腾讯云复制下来的代码文件中做以下修改：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">const tencentcloud = require(&quot;tencentcloud-sdk-nodejs-cdn&quot;);</span><br><span class="line"></span><br><span class="line">const CdnClient = tencentcloud.cdn.v20180606.Client;</span><br><span class="line"></span><br><span class="line"><span class="addition">+ var secretId = process.env.TENCENT_API_SECRETID; </span></span><br><span class="line"><span class="addition">+ var secretKey = process.env.TENCENT_API_SECRETKEY; </span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">const clientConfig = &#123;</span><br><span class="line">  credential: &#123;</span><br><span class="line"><span class="deletion">-   secretId: &quot;SecretId&quot;,</span></span><br><span class="line"><span class="deletion">-   secretKey: &quot;SecretKey&quot;,</span></span><br><span class="line"><span class="addition">+   secretId: secretId,</span></span><br><span class="line"><span class="addition">+   secretKey: secretKey,</span></span><br><span class="line">  &#125;,</span><br><span class="line">  ...</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>完成。</p><p>参考：<a href="https://cloud.tencent.com/document/product/1278/85305">云 API 云 API 密钥安全方案推荐-开发指南-文档中心-腾讯云 (tencent.com)</a></p><h1 id="附件"><a href="#附件" class="headerlink" title="附件"></a>附件</h1><p>最后的脚本文件文件：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Depends on tencentcloud-sdk-nodejs version 4.0.3 or higher</span></span><br><span class="line"><span class="keyword">const</span> tencentcloud = <span class="built_in">require</span>(<span class="string">&quot;tencentcloud-sdk-nodejs-cdn&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">CdnClient</span> = tencentcloud.<span class="property">cdn</span>.<span class="property">v20180606</span>.<span class="property">Client</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> secretId = process.<span class="property">env</span>.<span class="property">TENCENT_API_SECRETID</span>; </span><br><span class="line"><span class="keyword">var</span> secretKey = process.<span class="property">env</span>.<span class="property">TENCENT_API_SECRETKEY</span>; </span><br><span class="line"></span><br><span class="line"><span class="comment">// 实例化一个认证对象，入参需要传入腾讯云账户 SecretId 和 SecretKey，此处还需注意密钥对的保密</span></span><br><span class="line"><span class="comment">// 代码泄露可能会导致 SecretId 和 SecretKey 泄露，并威胁账号下所有资源的安全性。以下代码示例仅供参考，建议采用更安全的方式来使用密钥，请参见：https://cloud.tencent.com/document/product/1278/85305</span></span><br><span class="line"><span class="comment">// 密钥可前往官网控制台 https://console.cloud.tencent.com/cam/capi 进行获取</span></span><br><span class="line"><span class="keyword">const</span> clientConfig = &#123;</span><br><span class="line">  <span class="attr">credential</span>: &#123;</span><br><span class="line">    <span class="attr">secretId</span>: secretId,</span><br><span class="line">    <span class="attr">secretKey</span>: secretKey,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">region</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="attr">profile</span>: &#123;</span><br><span class="line">    <span class="attr">httpProfile</span>: &#123;</span><br><span class="line">      <span class="attr">endpoint</span>: <span class="string">&quot;cdn.tencentcloudapi.com&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实例化要请求产品的client对象,clientProfile是可选的</span></span><br><span class="line"><span class="keyword">const</span> client = <span class="keyword">new</span> <span class="title class_">CdnClient</span>(clientConfig);</span><br><span class="line"><span class="keyword">const</span> params = &#123;</span><br><span class="line">    <span class="string">&quot;Paths&quot;</span>: [</span><br><span class="line">      <span class="comment">/* 替换成你的网址 */</span></span><br><span class="line">        <span class="string">&quot;https://uuanqin.top&quot;</span>,</span><br><span class="line">        <span class="string">&quot;https://www.uuanqin.top&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="string">&quot;FlushType&quot;</span>: <span class="string">&quot;delete&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line">client.<span class="title class_">PurgePathCache</span>(params).<span class="title function_">then</span>(</span><br><span class="line">  <span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;error&quot;</span>, err);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">本文有腾讯云SDK的使用介绍以及API KEY安全使用方法</summary>
    
    
    
    <category term="计算机" scheme="https://www.uuanqin.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/"/>
    
    <category term="Hexo" scheme="https://www.uuanqin.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/Hexo/"/>
    
    
    <category term="JavaScript" scheme="https://www.uuanqin.top/tags/JavaScript/"/>
    
    <category term="CDN" scheme="https://www.uuanqin.top/tags/CDN/"/>
    
    <category term="API" scheme="https://www.uuanqin.top/tags/API/"/>
    
    <category term="node" scheme="https://www.uuanqin.top/tags/node/"/>
    
  </entry>
  
  <entry>
    <title>博客网站网页变灰的操作方法</title>
    <link href="https://www.uuanqin.top/p/26a31d07.html"/>
    <id>https://www.uuanqin.top/p/26a31d07.html</id>
    <published>2023-04-30T13:44:54.000Z</published>
    <updated>2023-04-30T13:45:00.040Z</updated>
    
    <content type="html"><![CDATA[<h1 id="核心代码"><a href="#核心代码" class="headerlink" title="核心代码"></a>核心代码</h1><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">html</span> &#123;</span><br><span class="line">    -webkit-<span class="attribute">filter</span>: <span class="built_in">grayscale</span>(<span class="number">100%</span>);</span><br><span class="line">    -moz-<span class="attribute">filter</span>: <span class="built_in">grayscale</span>(<span class="number">100%</span>);</span><br><span class="line">    -ms-<span class="attribute">filter</span>: <span class="built_in">grayscale</span>(<span class="number">100%</span>);</span><br><span class="line">    -o-<span class="attribute">filter</span>: <span class="built_in">grayscale</span>(<span class="number">100%</span>);</span><br><span class="line">    <span class="attribute">filter</span>: <span class="built_in">grayscale</span>(<span class="number">100%</span>);</span><br><span class="line">    <span class="attribute">filter</span>: progid:DXImageTransform.Microsoft.<span class="built_in">BasicImage</span>(grayscale=<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Hexo"><a href="#Hexo" class="headerlink" title="Hexo"></a>Hexo</h1><p>这里以Butterfly主题为例。新建css文件，包含以上代码内容，然后在主题配置文件中inject即可。（放最后吧）</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="comment"># - &lt;link rel=&quot;stylesheet&quot; href=&quot;/xxx.css&quot;&gt;</span></span><br><span class="line">    <span class="comment"># 网页变灰CSS</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;/css/gray.css&quot;&gt;</span></span><br></pre></td></tr></table></figure><p>参考：<a href="https://zhuanlan.zhihu.com/p/125708748">用代码如何实现整个网站变灰？ - 知乎 (zhihu.com)</a></p><h1 id="Wordpress博客网站"><a href="#Wordpress博客网站" class="headerlink" title="Wordpress博客网站"></a>Wordpress博客网站</h1><h2 id="让所有网页变灰"><a href="#让所有网页变灰" class="headerlink" title="让所有网页变灰"></a>让所有网页变灰</h2><p>在主题自定义中，找到“额外CSS”选项，加入上方代码片段。</p><h2 id="仅让首页变灰"><a href="#仅让首页变灰" class="headerlink" title="仅让首页变灰"></a>仅让首页变灰</h2><p>打开仪表盘，进入外观中的主题文件编辑器中，找到functions.php文件。在其最末尾添加上：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">nicetheme_global_greyscale</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="title function_ invoke__">is_home</span>() )&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;style type=&quot;text/css&quot;&gt;html&#123;-webkit-filter:grayscale(1);-webkit-filter:grayscale(100%);filter:grayscale(100%);-webkit-filter:gray;filter:gray;filter:progid:DXImageTransform.Microsoft.BasicImage(grayscale=1);&#125;&lt;/style&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">add_action</span>(<span class="string">&#x27;wp_head&#x27;</span>, <span class="string">&#x27;nicetheme_global_greyscale&#x27;</span>);</span><br></pre></td></tr></table></figure><p>更多情形，详见以下参考链接：</p><p><a href="https://cloud.tencent.com/developer/article/1944792">wordpress 如何让网站变成灰色 - 云+社区 - 腾讯云 (tencent.com)</a></p><p><a href="https://www.ourboke.com/1749.html">用代码轻松实现WordPress网站全站变灰教程 Ourboke联盟</a></p><p><a href="http://www.maqingxi.com/archives/4901.html">WordPress 网站如何实现全站变灰？ - 醒悟的凡灵 (maqingxi.com)</a></p><p><a href="https://www.mbx0.com/4117.html">wordpress网站全站变灰教程 - 墨白社区 (mbx0.com)</a></p>]]></content>
    
    
    <summary type="html">在“额外CSS”中加入代码。</summary>
    
    
    
    <category term="计算机" scheme="https://www.uuanqin.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/"/>
    
    
    <category term="搬运" scheme="https://www.uuanqin.top/tags/%E6%90%AC%E8%BF%90/"/>
    
    <category term="CSS" scheme="https://www.uuanqin.top/tags/CSS/"/>
    
  </entry>
  
  <entry>
    <title>Hexo博客添加漂浮物效果（可定制显示页面）</title>
    <link href="https://www.uuanqin.top/p/28a4bfe2.html"/>
    <id>https://www.uuanqin.top/p/28a4bfe2.html</id>
    <published>2023-04-30T10:53:23.000Z</published>
    <updated>2023-04-30T14:12:02.926Z</updated>
    
    <content type="html"><![CDATA[<p>本文为Hexo Butterfly主题的优雅改（只引入js文件）。<br>原码参考自：<a href="https://yisous.xyz/posts/670e47f/#%E8%90%BD%E6%A8%B1%E7%89%B9%E6%95%88%E6%90%AD%E9%85%8D%E5%8D%9A%E5%AE%A2%E8%AE%BE%E7%BD%AE%E9%A3%9F%E7%94%A8">博客魔改日记（3） | Ariasakaの小窝 (yisous.xyz)</a>，在其中做了改动：</p><ul><li>替换了部分变量和注释名</li><li>增加可定制显示漂浮物页面的逻辑<br>使用方法：</li><li>需要所有博客页面都显示漂浮物：将<code>allowAll = true</code></li><li>指定显示漂浮物的页面：将<code>allowAll = false</code>，在urlAllowList中列出需要显示漂浮物的网页相对地址。如<code>/about/</code>。<br>缺点显而易见：<strong>不灵活</strong>。后续将会改进。</li></ul><p>js代码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 漂浮物</span></span><br><span class="line"><span class="comment">// 新增函数 </span></span><br><span class="line"><span class="comment">// 首先获取 Url，然后把 Url 通过 // 截成两部分，再从后一部分中截取相对路径。如果截取到的相对路径中有参数，则把参数去掉。</span></span><br><span class="line"><span class="comment">// 获取相对路径</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">GetUrlRelativePath</span>(<span class="params"></span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> url = <span class="variable language_">document</span>.<span class="property">location</span>.<span class="title function_">toString</span>();</span><br><span class="line">    <span class="keyword">var</span> arrUrl = url.<span class="title function_">split</span>(<span class="string">&quot;//&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> start = arrUrl[<span class="number">1</span>].<span class="title function_">indexOf</span>(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> relUrl = arrUrl[<span class="number">1</span>].<span class="title function_">substring</span>(start);<span class="comment">//stop省略，截取从start开始到结尾的所有字符</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(relUrl.<span class="title function_">indexOf</span>(<span class="string">&quot;?&quot;</span>) != -<span class="number">1</span>)&#123;</span><br><span class="line">        relUrl = relUrl.<span class="title function_">split</span>(<span class="string">&quot;?&quot;</span>)[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> relUrl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> allowAll = <span class="literal">false</span>; <span class="comment">// true 则允许所有网页存在漂浮物</span></span><br><span class="line"><span class="comment">// 允许显示漂浮物的网址列表</span></span><br><span class="line"><span class="keyword">var</span> urlAllowList = [</span><br><span class="line">    <span class="string">&quot;/about/&quot;</span>,</span><br><span class="line">    <span class="string">&quot;/link/friends/&quot;</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> isAllowFloat = <span class="literal">false</span>;   <span class="comment">// 全局变量，允许使用漂浮特效</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">decide</span>(<span class="params"></span>)&#123;</span><br><span class="line">    isAllowFloat = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">if</span>(!allowAll)&#123;</span><br><span class="line">        <span class="comment">// 判断当前页面是否为指定页面</span></span><br><span class="line">        <span class="keyword">var</span> url = <span class="title class_">GetUrlRelativePath</span>();</span><br><span class="line">        <span class="keyword">var</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(;i&lt;urlAllowList.<span class="property">length</span>;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(url===urlAllowList[i])&#123;</span><br><span class="line">                <span class="comment">// console.log(i);</span></span><br><span class="line">                isAllowFloat = <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(i===urlAllowList.<span class="property">length</span>)&#123;</span><br><span class="line">            isAllowFloat = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(isAllowFloat)</span><br><span class="line">    <span class="keyword">if</span>(isAllowFloat)<span class="title function_">startFloat</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> stop, staticx;</span><br><span class="line"><span class="keyword">var</span> img = <span class="keyword">new</span> <span class="title class_">Image</span>();</span><br><span class="line">img.<span class="property">src</span> = <span class="string">&quot;/image/star_float.png&quot;</span>; <span class="comment">// 图片</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Float</span>(<span class="params">x, y, s, r, fn</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">x</span> = x;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">y</span> = y;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">s</span> = s;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">r</span> = r;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">fn</span> = fn;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Float</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">draw</span> = <span class="keyword">function</span>(<span class="params">cxt</span>) &#123;</span><br><span class="line">    cxt.<span class="title function_">save</span>();</span><br><span class="line">    <span class="keyword">var</span> xc = <span class="number">40</span> * <span class="variable language_">this</span>.<span class="property">s</span> / <span class="number">4</span>;</span><br><span class="line">    cxt.<span class="title function_">translate</span>(<span class="variable language_">this</span>.<span class="property">x</span>, <span class="variable language_">this</span>.<span class="property">y</span>);</span><br><span class="line">    cxt.<span class="title function_">rotate</span>(<span class="variable language_">this</span>.<span class="property">r</span>);</span><br><span class="line">    cxt.<span class="title function_">drawImage</span>(img, <span class="number">0</span>, <span class="number">0</span>, <span class="number">35</span> * <span class="variable language_">this</span>.<span class="property">s</span>, <span class="number">35</span> * <span class="variable language_">this</span>.<span class="property">s</span>)</span><br><span class="line">    <span class="comment">//漂浮物大小</span></span><br><span class="line">    cxt.<span class="title function_">restore</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Float</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">update</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">x</span> = <span class="variable language_">this</span>.<span class="property">fn</span>.<span class="title function_">x</span>(<span class="variable language_">this</span>.<span class="property">x</span>, <span class="variable language_">this</span>.<span class="property">y</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">y</span> = <span class="variable language_">this</span>.<span class="property">fn</span>.<span class="title function_">y</span>(<span class="variable language_">this</span>.<span class="property">y</span>, <span class="variable language_">this</span>.<span class="property">y</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">r</span> = <span class="variable language_">this</span>.<span class="property">fn</span>.<span class="title function_">r</span>(<span class="variable language_">this</span>.<span class="property">r</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">x</span> &gt; <span class="variable language_">window</span>.<span class="property">innerWidth</span> || <span class="variable language_">this</span>.<span class="property">x</span> &lt; <span class="number">0</span> || <span class="variable language_">this</span>.<span class="property">y</span> &gt; <span class="variable language_">window</span>.<span class="property">innerHeight</span> || <span class="variable language_">this</span>.<span class="property">y</span> &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">r</span> = <span class="title function_">getRandom</span>(<span class="string">&#x27;fnr&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="title class_">Math</span>.<span class="title function_">random</span>() &gt; <span class="number">0.4</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">x</span> = <span class="title function_">getRandom</span>(<span class="string">&#x27;x&#x27;</span>);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">y</span> = <span class="number">0</span>;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">s</span> = <span class="title function_">getRandom</span>(<span class="string">&#x27;s&#x27;</span>);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">r</span> = <span class="title function_">getRandom</span>(<span class="string">&#x27;r&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">x</span> = <span class="variable language_">window</span>.<span class="property">innerWidth</span>;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">y</span> = <span class="title function_">getRandom</span>(<span class="string">&#x27;y&#x27;</span>);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">s</span> = <span class="title function_">getRandom</span>(<span class="string">&#x27;s&#x27;</span>);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">r</span> = <span class="title function_">getRandom</span>(<span class="string">&#x27;r&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">FloatList</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">list</span> = [];</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">FloatList</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">push</span> = <span class="keyword">function</span>(<span class="params">float</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">list</span>.<span class="title function_">push</span>(float);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">FloatList</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">update</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = <span class="variable language_">this</span>.<span class="property">list</span>.<span class="property">length</span>; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">list</span>[i].<span class="title function_">update</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">FloatList</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">draw</span> = <span class="keyword">function</span>(<span class="params">cxt</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = <span class="variable language_">this</span>.<span class="property">list</span>.<span class="property">length</span>; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">list</span>[i].<span class="title function_">draw</span>(cxt);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">FloatList</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">get</span> = <span class="keyword">function</span>(<span class="params">i</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">list</span>[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">FloatList</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">size</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">list</span>.<span class="property">length</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getRandom</span>(<span class="params">option</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> ret, random;</span><br><span class="line">    <span class="keyword">switch</span> (option) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;x&#x27;</span>:</span><br><span class="line">        ret = <span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="variable language_">window</span>.<span class="property">innerWidth</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;y&#x27;</span>:</span><br><span class="line">        ret = <span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="variable language_">window</span>.<span class="property">innerHeight</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;s&#x27;</span>:</span><br><span class="line">        ret = <span class="title class_">Math</span>.<span class="title function_">random</span>();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;r&#x27;</span>:</span><br><span class="line">        ret = <span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">6</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;fnx&#x27;</span>:</span><br><span class="line">        random = -<span class="number">0.5</span> + <span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">1</span>;</span><br><span class="line">        ret = <span class="keyword">function</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> x + <span class="number">0.5</span> * random - <span class="number">0.6</span>;</span><br><span class="line">            <span class="comment">//x轴速度</span></span><br><span class="line">        &#125;</span><br><span class="line">        ;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;fny&#x27;</span>:</span><br><span class="line">        random = <span class="number">0.8</span> + <span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">0.7</span></span><br><span class="line">        <span class="comment">//y轴速度</span></span><br><span class="line">        ret = <span class="keyword">function</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> y + random;</span><br><span class="line">        &#125;</span><br><span class="line">        ;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;fnr&#x27;</span>:</span><br><span class="line">        random = <span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">0.03</span>;</span><br><span class="line">        ret = <span class="keyword">function</span>(<span class="params">r</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> r + random;</span><br><span class="line">        &#125;</span><br><span class="line">        ;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">startFloat</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    requestAnimationFrame = <span class="variable language_">window</span>.<span class="property">requestAnimationFrame</span> || <span class="variable language_">window</span>.<span class="property">mozRequestAnimationFrame</span> || <span class="variable language_">window</span>.<span class="property">webkitRequestAnimationFrame</span> || <span class="variable language_">window</span>.<span class="property">msRequestAnimationFrame</span> || <span class="variable language_">window</span>.<span class="property">oRequestAnimationFrame</span>;</span><br><span class="line">    <span class="keyword">var</span> canvas = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;canvas&#x27;</span>), cxt;</span><br><span class="line">    staticx = <span class="literal">true</span>;</span><br><span class="line">    canvas.<span class="property">height</span> = <span class="variable language_">window</span>.<span class="property">innerHeight</span>;</span><br><span class="line">    canvas.<span class="property">width</span> = <span class="variable language_">window</span>.<span class="property">innerWidth</span>;</span><br><span class="line">    canvas.<span class="title function_">setAttribute</span>(<span class="string">&#x27;style&#x27;</span>, <span class="string">&#x27;position: fixed;left: 0;top: 0;pointer-events: none;&#x27;</span>);</span><br><span class="line">    canvas.<span class="title function_">setAttribute</span>(<span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;canvas_float&#x27;</span>);</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;body&#x27;</span>)[<span class="number">0</span>].<span class="title function_">appendChild</span>(canvas);</span><br><span class="line">    cxt = canvas.<span class="title function_">getContext</span>(<span class="string">&#x27;2d&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> floatList = <span class="keyword">new</span> <span class="title class_">FloatList</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">        <span class="comment">//漂浮物数量</span></span><br><span class="line">        <span class="keyword">var</span> float, randomX, randomY, randomS, randomR, randomFnx, randomFny;</span><br><span class="line">        randomX = <span class="title function_">getRandom</span>(<span class="string">&#x27;x&#x27;</span>);</span><br><span class="line">        randomY = <span class="title function_">getRandom</span>(<span class="string">&#x27;y&#x27;</span>);</span><br><span class="line">        randomR = <span class="title function_">getRandom</span>(<span class="string">&#x27;r&#x27;</span>);</span><br><span class="line">        randomS = <span class="title function_">getRandom</span>(<span class="string">&#x27;s&#x27;</span>);</span><br><span class="line">        randomFnx = <span class="title function_">getRandom</span>(<span class="string">&#x27;fnx&#x27;</span>);</span><br><span class="line">        randomFny = <span class="title function_">getRandom</span>(<span class="string">&#x27;fny&#x27;</span>);</span><br><span class="line">        randomFnR = <span class="title function_">getRandom</span>(<span class="string">&#x27;fnr&#x27;</span>);</span><br><span class="line">        float = <span class="keyword">new</span> <span class="title class_">Float</span>(randomX,randomY,randomS,randomR,&#123;</span><br><span class="line">            <span class="attr">x</span>: randomFnx,</span><br><span class="line">            <span class="attr">y</span>: randomFny,</span><br><span class="line">            <span class="attr">r</span>: randomFnR</span><br><span class="line">        &#125;);</span><br><span class="line">        float.<span class="title function_">draw</span>(cxt);</span><br><span class="line">        floatList.<span class="title function_">push</span>(float);</span><br><span class="line">    &#125;</span><br><span class="line">    stop = <span class="title function_">requestAnimationFrame</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        cxt.<span class="title function_">clearRect</span>(<span class="number">0</span>, <span class="number">0</span>, canvas.<span class="property">width</span>, canvas.<span class="property">height</span>);</span><br><span class="line">        floatList.<span class="title function_">update</span>();</span><br><span class="line">        floatList.<span class="title function_">draw</span>(cxt);</span><br><span class="line">        stop = <span class="title function_">requestAnimationFrame</span>(<span class="variable language_">arguments</span>.<span class="property">callee</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">onresize</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(!isAllowFloat)<span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">var</span> canvasSnow = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;canvas_float&#x27;</span>);</span><br><span class="line">    canvasSnow.<span class="property">width</span> = <span class="variable language_">window</span>.<span class="property">innerWidth</span>;</span><br><span class="line">    canvasSnow.<span class="property">height</span> = <span class="variable language_">window</span>.<span class="property">innerHeight</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">stopp</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!e &amp;&amp; <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;canvas_float&quot;</span>)) &#123;</span><br><span class="line">        <span class="keyword">var</span> child = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;canvas_float&quot;</span>);</span><br><span class="line">        child.<span class="property">parentNode</span>.<span class="title function_">removeChild</span>(child);</span><br><span class="line">        <span class="variable language_">window</span>.<span class="title function_">cancelAnimationFrame</span>(stop);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (e &amp;&amp; !<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;canvas_float&quot;</span>)) &#123;</span><br><span class="line">        <span class="title function_">decide</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;DOMContentLoaded&quot;</span>,decide);</span><br></pre></td></tr></table></figure><p>也许不够优雅，但也够用了。</p><p>未来计划：节日触发漂浮物效果，以及优雅进行实现。<a href="https://blog.csdn.net/LEVsunshine/article/details/109069345">js处理时间戳为各种格式/js判断公历/农历/周历节日和节气_js 二十四节气计算_to Zero-的博客-CSDN博客</a></p>]]></content>
    
    
    <summary type="html">为博客添加漂浮物效果，并可定制需要显示漂浮物的页面。Hexo优雅改。</summary>
    
    
    
    <category term="计算机" scheme="https://www.uuanqin.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/"/>
    
    <category term="Hexo" scheme="https://www.uuanqin.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/Hexo/"/>
    
    
    <category term="JavaScript" scheme="https://www.uuanqin.top/tags/JavaScript/"/>
    
    <category term="ButterFly" scheme="https://www.uuanqin.top/tags/ButterFly/"/>
    
  </entry>
  
  <entry>
    <title>在你的Hexo博客上加入进度条（Butterfly）</title>
    <link href="https://www.uuanqin.top/p/4dfb77c6.html"/>
    <id>https://www.uuanqin.top/p/4dfb77c6.html</id>
    <published>2023-04-28T12:03:02.000Z</published>
    <updated>2023-05-02T12:38:45.542Z</updated>
    
    <content type="html"><![CDATA[<h1 id="引入方法"><a href="#引入方法" class="headerlink" title="引入方法"></a>引入方法</h1><p>如果你使用的是Butterfly主题，可以在主题配置文件中加入：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">src=&quot;https://npm.elemecdn.com/pace-js@latest/pace.min.js&quot;&gt;&lt;/script&gt;</span> <span class="comment"># pace.js文件</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;/css/&lt;your_pace.css&gt;&quot;&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>新版本Butterfly配置文件中有内置的pace选项，但是它的pace.js使用的jsdelivr提供的CDN，国内访问困难，CDN项也没有相应更改的地方，建议按照这篇文章的说明使用老方法进行进度条的引入。</p></blockquote><h1 id="基本样式"><a href="#基本样式" class="headerlink" title="基本样式"></a>基本样式</h1><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230428202826301.png" alt="image-20230428202826301"></p><p>PACE官网给出的示例，这里已把官网的jsdelivr连接替换掉了：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://cdn.bootcdn.net/ajax/libs/pace/1.2.4/pace-theme-default.min.css</span><br></pre></td></tr></table></figure><h1 id="官网样式"><a href="#官网样式" class="headerlink" title="官网样式"></a>官网样式</h1><p>可以在这里挑选你喜欢的样式并下载对应的CSS文件：<a href="https://codebyzach.github.io/pace/">PACE — Automatic page load progress bars (codebyzach.github.io)</a></p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230428200140054.png" alt="image-20230428200140054"></p><h1 id="其他样式"><a href="#其他样式" class="headerlink" title="其他样式"></a>其他样式</h1><p>也可以尝试这一种：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230428195652087.png" alt="image-20230428195652087"></p><h2 id="基础版本"><a href="#基础版本" class="headerlink" title="基础版本"></a>基础版本</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.pace</span> &#123;</span><br><span class="line">    -webkit-<span class="attribute">pointer-events</span>: none;</span><br><span class="line">    <span class="attribute">pointer-events</span>: none;</span><br><span class="line">    -webkit-user-select: none;</span><br><span class="line">    -moz-user-select: none;</span><br><span class="line">    user-select: none;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">2000</span>;</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">margin</span>: auto;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">4px</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">4rem</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#eaecf2</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> <span class="number">#e3e8f7</span>;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.pace-inactive</span> <span class="selector-class">.pace-progress</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">transition</span>: .<span class="number">3s</span> ease-in</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.pace</span> <span class="selector-class">.pace-progress</span> &#123;</span><br><span class="line">    -webkit-<span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">    -moz-<span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">    -ms-<span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">    -o-<span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">    <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">    -webkit-<span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    -moz-<span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    -ms-<span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    -o-<span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="attribute">max-width</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">2000</span>;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(<span class="number">215deg</span>, <span class="number">#05662a</span> <span class="number">0%</span>, <span class="number">#bffc16</span> <span class="number">100%</span>);</span><br><span class="line">    <span class="attribute">animation</span>: gradient <span class="number">2s</span> ease infinite;</span><br><span class="line">    <span class="attribute">background-size</span>: <span class="number">200%</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.pace</span><span class="selector-class">.pace-inactive</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">transition</span>: .<span class="number">3s</span>;</span><br><span class="line">    <span class="attribute">top</span>: -<span class="number">8px</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="动态版本"><a href="#动态版本" class="headerlink" title="动态版本"></a>动态版本</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.pace</span> &#123;</span><br><span class="line">    -webkit-<span class="attribute">pointer-events</span>: none;</span><br><span class="line">    <span class="attribute">pointer-events</span>: none;</span><br><span class="line">    -webkit-user-select: none;</span><br><span class="line">    -moz-user-select: none;</span><br><span class="line">    user-select: none;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">2000</span>;</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">margin</span>: auto;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">4px</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">4rem</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#eaecf2</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> <span class="number">#e3e8f7</span>;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.pace-inactive</span> <span class="selector-class">.pace-progress</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">transition</span>: .<span class="number">3s</span> ease-in</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.pace</span> <span class="selector-class">.pace-progress</span> &#123;</span><br><span class="line">    -webkit-<span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">    -moz-<span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">    -ms-<span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">    -o-<span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">    <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">    -webkit-<span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    -moz-<span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    -ms-<span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    -o-<span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="attribute">max-width</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">2000</span>;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(-<span class="number">45deg</span>, <span class="number">#ee7752</span>, <span class="number">#e73c7e</span>, <span class="number">#23a6d5</span>, <span class="number">#23d5ab</span>);</span><br><span class="line">    <span class="attribute">animation</span>: gradient <span class="number">1.5s</span> ease infinite;</span><br><span class="line">    <span class="attribute">background-size</span>: <span class="number">200%</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.pace</span><span class="selector-class">.pace-inactive</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">transition</span>: .<span class="number">3s</span>;</span><br><span class="line">    <span class="attribute">top</span>: -<span class="number">8px</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@keyframes</span> gradient &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">background-position</span>: <span class="number">0%</span> <span class="number">50%</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">50%</span> &#123;</span><br><span class="line">    <span class="attribute">background-position</span>: <span class="number">100%</span> <span class="number">50%</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">    <span class="attribute">background-position</span>: <span class="number">0%</span> <span class="number">50%</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>对比两个版本的差异，相信你能自定义出一套自己的进度条。</p><p>参考：<a href="https://blog.trfox.ml/p/81434d957ca9/">给你的网站/博客顶部加上加载进度条 | Teror (trfox.ml)</a></p>]]></content>
    
    
    <summary type="html">通过进入pace.js以及本地css实现网站顶部进度条</summary>
    
    
    
    <category term="计算机" scheme="https://www.uuanqin.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/"/>
    
    <category term="Hexo" scheme="https://www.uuanqin.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/Hexo/"/>
    
    
    <category term="pace" scheme="https://www.uuanqin.top/tags/pace/"/>
    
  </entry>
  
  <entry>
    <title>国内访问Hexo优化加速-替换jsdelivr的CDN链接</title>
    <link href="https://www.uuanqin.top/p/7b17333d.html"/>
    <id>https://www.uuanqin.top/p/7b17333d.html</id>
    <published>2023-04-28T09:34:18.000Z</published>
    <updated>2023-05-30T16:29:56.487Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>其他优化博客网站的好文（我没仔细看，但是他讲的好有道理）：</p><ul><li><a href="https://akilar.top/posts/7c16c4bb/">Hexo博客优化蓝图 | Akilarの糖果屋</a></li><li><a href="https://blog.mrzefr.cn/posts/hexo-speed/">MrZeFr的小窝 - Hello World</a></li></ul></blockquote><p>假设你刚搭建了个人博客，发现网站的访问速度实在堪忧，怎么办？解决方法无非以下几种方法：</p><ul><li>有经济实力的，考虑提升硬件性能和带宽（购买高级服务器、增大带宽）</li><li>正确使用CDN加速源站和图片。CDN加速源站方法详看这篇文章：<a href="https://www.uuanqin.top/p/36451a4e.html">只要一篇文章——CDN实操 | 半方池水半方田 (uuanqin.top)</a>，如果对象存储已加入Typora的工作流，那图片的处理就更方便了：<a href="https://www.uuanqin.top/p/edfe8057.html">Typora+PicGo(app)+腾讯云COS实现图床 | 半方池水半方田 (uuanqin.top)</a></li><li>如果你的个人博客网站是动态网站（如Wordpress），但实在没有必要必须是动态网站时，可尝试改成静态框架，详看我的这篇文章：<a href="https://www.uuanqin.top/p/ad28b4a.html">部署Hexo个人博客框架到服务器 | 半方池水半方田 (uuanqin.top)</a></li></ul><p>如果以上的方法你都尝试过，但博客网站可能遇到页面卡顿、显示不全、功能异常（图标、评论、搜索等各种异常）等情况，比如：</p><ul><li>fontawesome加载迟、卡，拖慢网页加载（fontawesome可以考虑更换图标库，请看我之前的文章《》）</li><li>algolia搜索按钮按不出来</li><li>Waline评论系统不显示或评论数据无法获取（处理这个问题前请看我之前的文章：<a href="https://www.uuanqin.top/p/591f2165.html">Hexo框架Btterfly主题引入Waline评论系统及国内正常访问 | 半方池水半方田 (uuanqin.top)</a>）</li></ul><p>而使用魔法访问时却一切正常。这时候我们该考虑是不是CDN出现问题了。</p><p>本地调试自己的博客网站后，打开浏览器的开发者面板（F12）-&gt;禁用缓存-&gt;点击网络选项卡-&gt;刷新页面：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/jsdeliver%E6%83%B9%E7%9A%84%E7%A5%B81.png" alt="jsdeliver惹的祸1"></p><p>你会发现一些js文件或css文件无法被加载，这些文件大多来源于jsdelivr的CDN连接。</p><blockquote><p>不熟悉CDN的小伙伴可以理解为，jsdelivr里存放了大量的js文件或css文件，你的博客网站需要引入这些文件，但是由于某种原因，jsdelivr结点的链接状况在国内时好时坏（使用魔法就好）。</p></blockquote><p>这时我们可以考虑把获取这些js或css文件的链接替换掉。在你的主题配置上进行替换，这里以Butterfly主题为例，在主题配置文件下找到：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">CDN:</span></span><br><span class="line">    <span class="attr">option:</span> </span><br><span class="line">        <span class="attr">fontawesome:</span> <span class="string">&lt;替换的cdn&gt;</span></span><br></pre></td></tr></table></figure><p>建议你把涉及jsdelivr都替换掉把，让中国宝宝访问你的博客网站更快更方便。</p><p>各种资源CDN链接参考：<a href="https://blog.zhheo.com/p/790087d9.html">Butterfly CDN链接更改指南，替换jsdelivr提升访问速度 | 张洪Heo (zhheo.com)</a></p><p>也可以在下面的两个网站找：</p><ul><li><a href="https://cdnjs.com/">https://cdnjs.com/</a></li><li><a href="https://www.bootcdn.cn/">https://www.bootcdn.cn/</a></li></ul><p>也可以把文件放在自己的存储桶中（注意看好你的钱包）。</p><p>参考：</p><ul><li><a href="https://blog.zhheo.com/p/790087d9.html">Butterfly CDN链接更改指南，替换jsdelivr提升访问速度 | 张洪Heo (zhheo.com)</a></li><li><a href="https://blog.csdn.net/u013014254/article/details/122045331">jsdelivr炸了如何解决|用这些免费cdn_地域男孩的博客-CSDN博客</a></li><li><a href="https://butterfly.js.org/posts/ceeb73f/#custom-format">Butterfly 安裝文檔(四) 主題配置-2 | Butterfly</a></li><li><a href="https://github.com/jerryc127/hexo-theme-butterfly/issues/1243">fontawesome图标问题 · Issue #1243 · jerryc127/hexo-theme-butterfly (github.com)</a></li></ul>]]></content>
    
    
    <summary type="html">由于某种原因，jsdelivr的状况时好时坏，本文介绍Butterfly下替换CDN链接的解决方案</summary>
    
    
    
    <category term="计算机" scheme="https://www.uuanqin.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/"/>
    
    <category term="Hexo" scheme="https://www.uuanqin.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/Hexo/"/>
    
    
    <category term="CDN" scheme="https://www.uuanqin.top/tags/CDN/"/>
    
    <category term="Butterfly" scheme="https://www.uuanqin.top/tags/Butterfly/"/>
    
    <category term="jsdelivr" scheme="https://www.uuanqin.top/tags/jsdelivr/"/>
    
  </entry>
  
  <entry>
    <title>定制自己的Waline评论系统</title>
    <link href="https://www.uuanqin.top/p/dd188b35.html"/>
    <id>https://www.uuanqin.top/p/dd188b35.html</id>
    <published>2023-04-28T08:15:12.000Z</published>
    <updated>2023-04-29T14:02:58.150Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Waline邮件通知"><a href="#Waline邮件通知" class="headerlink" title="Waline邮件通知"></a>Waline邮件通知</h1><p>Waline发送邮件，首先你得有一个专门发送通知的邮箱，任何支持STMP协议的都行。这里以腾讯企业邮作域名邮箱为例。</p><h2 id="拥有域名邮箱"><a href="#拥有域名邮箱" class="headerlink" title="拥有域名邮箱"></a>拥有域名邮箱</h2><p>注册一个企业微信，企业微信完成企业创建后，可以申请域名邮箱：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230428231218707.png" alt="image-20230428231218707"></p><h2 id="解析设置"><a href="#解析设置" class="headerlink" title="解析设置"></a>解析设置</h2><p>然后在阿里云云解析进行设置：（其他云服务商解析设置方法参考：<a href="https://open.work.weixin.qq.com/help2/pc/19814?person_id=1&searchData=">如何确认域名的服务商以及各大域名商的域名设置方法-帮助中心-企业微信 (qq.com)</a>）</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230428230939924.png" alt="image-20230428230939924"></p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230428231010712.png" alt="image-20230428231010712"></p><h2 id="邮箱设置好密码"><a href="#邮箱设置好密码" class="headerlink" title="邮箱设置好密码"></a>邮箱设置好密码</h2><p>拥有企业邮箱之后，登录邮箱设置好密码。可参考[成员如何设置邮箱密码？_腾讯企业邮箱帮助中心 (qq.com)](<a href="https://service.exmail.qq.com/cgi-bin/help?subtype=1&amp;&amp;id=7&amp;&amp;no=1001558#:~:text=%E6%88%90%E5%91%98%E5%A6%82%E4%BD%95%E8%AE%BE%E7%BD%AE%E9%82%AE%E7%AE%B1%E5%AF%86%E7%A0%81%EF%BC%9F">https://service.exmail.qq.com/cgi-bin/help?subtype=1&amp;&amp;id=7&amp;&amp;no=1001558#:~:text=成员如何设置邮箱密码？</a> _腾讯企业邮箱帮助中心 成员如何设置邮箱密码？,注意：成员初次需要使用 “手机号%2B验证码”方式登录后，便可以自行设置邮箱密码。 登录后，在“设置-帐户-帐户安全”，设置密码即可，后续也可修改密码。)</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230428222407581.png" alt="image-20230428222407581"></p><h2 id="环境变量配置"><a href="#环境变量配置" class="headerlink" title="环境变量配置"></a>环境变量配置</h2><p>设置好域名邮箱密码后，打开Vercel服务端项目，点击环境变量：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230428223656516.png" alt="image-20230428223656516"></p><p>然后按照Waline官方文档的指导设置好服务端的环境变量：<a href="https://waline.js.org/guide/features/notification.html#%E9%82%AE%E4%BB%B6%E9%80%9A%E7%9F%A5">评论通知 | Waline</a>，腾讯企业邮相关参数如下：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;QQex&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;aliases&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;QQ Enterprise&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;domains&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;exmail.qq.com&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;host&quot;</span><span class="punctuation">:</span> <span class="string">&quot;smtp.exmail.qq.com&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;port&quot;</span><span class="punctuation">:</span> <span class="number">465</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;secure&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure><p>参考：<a href="https://cloud.tencent.com/developer/article/2067294">Fluid -15- Waline 邮件通知 - 腾讯云开发者社区-腾讯云 (tencent.com)</a></p><h2 id="信件模板"><a href="#信件模板" class="headerlink" title="信件模板"></a>信件模板</h2><p>关于邮件内容的模板，即环境变量<strong>MAIL_TEMPLATE_ADMIN</strong>如何写，可自行搜索样例。</p><p>这里我参考了洪涝的针对Twikoo评论系统的示例：<a href="https://blog.zhheo.com/p/169a1abb.html">Twikoo评论回复邮件模板：Acrylic Mail 粉 | 张洪Heo (zhheo.com)</a></p><p>其实与Waline大差不差，只是有一些写法需要注意。</p><blockquote><p>目前该模板存在问题：电脑端QQ邮箱显示灰色方框显示有误。在这里记录一下。</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;page flex-col&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box_3 flex-col&quot;</span> <span class="attr">style</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">    display: flex;</span></span></span><br><span class="line"><span class="string"><span class="tag">    position: relative;</span></span></span><br><span class="line"><span class="string"><span class="tag">    width: 100%;</span></span></span><br><span class="line"><span class="string"><span class="tag">    height: 206px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    background: #859cef2e;</span></span></span><br><span class="line"><span class="string"><span class="tag">    top: 0;</span></span></span><br><span class="line"><span class="string"><span class="tag">    left: 0;</span></span></span><br><span class="line"><span class="string"><span class="tag">    justify-content: center;</span></span></span><br><span class="line"><span class="string"><span class="tag">  &quot;</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;section_1 flex-col&quot;</span> <span class="attr">style</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">    background-image: url(https://typora-1301301520.file.myqcloud.com/img/qlogo.png);</span></span></span><br><span class="line"><span class="string"><span class="tag">    position: absolute;</span></span></span><br><span class="line"><span class="string"><span class="tag">    width: 152px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    height: 152px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    display: flex;</span></span></span><br><span class="line"><span class="string"><span class="tag">    top: 130px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    background-size: cover;</span></span></span><br><span class="line"><span class="string"><span class="tag">  &quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box_4 flex-col&quot;</span> <span class="attr">style</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">    margin-top: 92px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    display: flex;</span></span></span><br><span class="line"><span class="string"><span class="tag">    flex-direction: column;</span></span></span><br><span class="line"><span class="string"><span class="tag">    align-items: center;</span></span></span><br><span class="line"><span class="string"><span class="tag">  &quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;text-group_5 flex-col justify-between&quot;</span> <span class="attr">style</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">    display: flex;</span></span></span><br><span class="line"><span class="string"><span class="tag">    flex-direction: column;</span></span></span><br><span class="line"><span class="string"><span class="tag">    align-items: center;</span></span></span><br><span class="line"><span class="string"><span class="tag">    margin: 0 20px;</span></span></span><br><span class="line"><span class="string"><span class="tag">  &quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;text_1&quot;</span> <span class="attr">style</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">    font-size: 26px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    font-family: PingFang-SC-Bold, PingFang-SC;</span></span></span><br><span class="line"><span class="string"><span class="tag">    font-weight: bold;</span></span></span><br><span class="line"><span class="string"><span class="tag">    color: #000000;</span></span></span><br><span class="line"><span class="string"><span class="tag">    line-height: 37px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    text-align: center;</span></span></span><br><span class="line"><span class="string"><span class="tag">  &quot;</span>&gt;</span>嘿！你在<span class="symbol">&amp;nbsp;</span>&#123;&#123;site.name|safe&#125;&#125;<span class="symbol">&amp;nbsp;</span>博客中收到一条新回复。<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;text_2&quot;</span> <span class="attr">style</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">    font-size: 16px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    font-family: PingFang-SC-Bold, PingFang-SC;</span></span></span><br><span class="line"><span class="string"><span class="tag">    font-weight: bold;</span></span></span><br><span class="line"><span class="string"><span class="tag">    color: #00000030;</span></span></span><br><span class="line"><span class="string"><span class="tag">    line-height: 22px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    margin-top: 21px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    text-align: center;</span></span></span><br><span class="line"><span class="string"><span class="tag">  &quot;</span>&gt;</span>你之前的评论<span class="symbol">&amp;nbsp;</span>在<span class="symbol">&amp;nbsp;</span>&#123;&#123;site.name|safe&#125;&#125; 博客中收到来自<span class="symbol">&amp;nbsp;</span>&#123;&#123;self.nick&#125;&#125;<span class="symbol">&amp;nbsp;</span>的回复<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box_2 flex-row&quot;</span> <span class="attr">style</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">    margin: 0 20px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    min-height: 128px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    background: #F7F7F7;</span></span></span><br><span class="line"><span class="string"><span class="tag">    border-radius: 12px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    margin-top: 34px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    display: flex;</span></span></span><br><span class="line"><span class="string"><span class="tag">    flex-direction: column;</span></span></span><br><span class="line"><span class="string"><span class="tag">    align-items: flex-start;</span></span></span><br><span class="line"><span class="string"><span class="tag">    padding: 32px 16px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    width: calc(100% - 40px);</span></span></span><br><span class="line"><span class="string"><span class="tag">  &quot;</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;text-wrapper_4 flex-col justify-between&quot;</span> <span class="attr">style</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">    display: flex;</span></span></span><br><span class="line"><span class="string"><span class="tag">    flex-direction: column;</span></span></span><br><span class="line"><span class="string"><span class="tag">    margin-left: 30px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    margin-bottom: 16px;</span></span></span><br><span class="line"><span class="string"><span class="tag">  &quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;text_3&quot;</span> <span class="attr">style</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">    height: 22px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    font-size: 16px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    font-family: PingFang-SC-Bold, PingFang-SC;</span></span></span><br><span class="line"><span class="string"><span class="tag">    font-weight: bold;</span></span></span><br><span class="line"><span class="string"><span class="tag">    color: #2a67ce;</span></span></span><br><span class="line"><span class="string"><span class="tag">    line-height: 22px;</span></span></span><br><span class="line"><span class="string"><span class="tag">  &quot;</span>&gt;</span>&#123;&#123;parent.nick|safe&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;text_4&quot;</span> <span class="attr">style</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">    margin-top: 6px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    margin-right: 22px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    font-size: 16px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    font-family: PingFangSC-Regular, PingFang SC;</span></span></span><br><span class="line"><span class="string"><span class="tag">    font-weight: 400;</span></span></span><br><span class="line"><span class="string"><span class="tag">    color: #000000;</span></span></span><br><span class="line"><span class="string"><span class="tag">    line-height: 22px;</span></span></span><br><span class="line"><span class="string"><span class="tag">  &quot;</span>&gt;</span>&#123;&#123;parent.comment|safe&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">hr</span> <span class="attr">style</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">      display: flex;</span></span></span><br><span class="line"><span class="string"><span class="tag">      position: relative;</span></span></span><br><span class="line"><span class="string"><span class="tag">      border: 1px dashed #859cef2e;</span></span></span><br><span class="line"><span class="string"><span class="tag">      box-sizing: content-box;</span></span></span><br><span class="line"><span class="string"><span class="tag">      height: 0px;</span></span></span><br><span class="line"><span class="string"><span class="tag">      overflow: visible;</span></span></span><br><span class="line"><span class="string"><span class="tag">      width: 100%;</span></span></span><br><span class="line"><span class="string"><span class="tag">  &quot;</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;text-wrapper_4 flex-col justify-between&quot;</span> <span class="attr">style</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">    display: flex;</span></span></span><br><span class="line"><span class="string"><span class="tag">    flex-direction: column;</span></span></span><br><span class="line"><span class="string"><span class="tag">    margin-left: 30px;</span></span></span><br><span class="line"><span class="string"><span class="tag">  &quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;text_3&quot;</span> <span class="attr">style</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">    height: 22px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    font-size: 16px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    font-family: PingFang-SC-Bold, PingFang-SC;</span></span></span><br><span class="line"><span class="string"><span class="tag">    font-weight: bold;</span></span></span><br><span class="line"><span class="string"><span class="tag">    color: #2a67ce;</span></span></span><br><span class="line"><span class="string"><span class="tag">    line-height: 22px;</span></span></span><br><span class="line"><span class="string"><span class="tag">  &quot;</span>&gt;</span>&#123;&#123;self.nick|safe&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;text_4&quot;</span> <span class="attr">style</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">    margin-top: 6px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    margin-right: 22px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    font-size: 16px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    font-family: PingFangSC-Regular, PingFang SC;</span></span></span><br><span class="line"><span class="string"><span class="tag">    font-weight: 400;</span></span></span><br><span class="line"><span class="string"><span class="tag">    color: #000000;</span></span></span><br><span class="line"><span class="string"><span class="tag">    line-height: 22px;</span></span></span><br><span class="line"><span class="string"><span class="tag">  &quot;</span>&gt;</span>&#123;&#123;self.comment|safe&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;text-wrapper_2 flex-col&quot;</span> <span class="attr">style</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">    min-width: 106px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    height: 38px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    background: #859cef2e;</span></span></span><br><span class="line"><span class="string"><span class="tag">    border-radius: 32px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    display: flex;</span></span></span><br><span class="line"><span class="string"><span class="tag">    align-items: center;</span></span></span><br><span class="line"><span class="string"><span class="tag">    justify-content: center;</span></span></span><br><span class="line"><span class="string"><span class="tag">    text-decoration: none;</span></span></span><br><span class="line"><span class="string"><span class="tag">    margin: auto;</span></span></span><br><span class="line"><span class="string"><span class="tag">    margin-top: 32px;</span></span></span><br><span class="line"><span class="string"><span class="tag">  &quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://&#123;&#123;site.postUrl&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;text_5&quot;</span> <span class="attr">style</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">    color: #218adb;</span></span></span><br><span class="line"><span class="string"><span class="tag">  &quot;</span>&gt;</span>查看详情<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;text-group_6 flex-col justify-between&quot;</span> <span class="attr">style</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">    display: flex;</span></span></span><br><span class="line"><span class="string"><span class="tag">    flex-direction: column;</span></span></span><br><span class="line"><span class="string"><span class="tag">    align-items: center;</span></span></span><br><span class="line"><span class="string"><span class="tag">    margin-top: 34px;</span></span></span><br><span class="line"><span class="string"><span class="tag">  &quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;text_6&quot;</span> <span class="attr">style</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">    height: 17px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    font-size: 12px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    font-family: PingFangSC-Regular, PingFang SC;</span></span></span><br><span class="line"><span class="string"><span class="tag">    font-weight: 400;</span></span></span><br><span class="line"><span class="string"><span class="tag">    color: #00000045;</span></span></span><br><span class="line"><span class="string"><span class="tag">    line-height: 17px;</span></span></span><br><span class="line"><span class="string"><span class="tag">  &quot;</span>&gt;</span>此邮件由评论服务自动发出，直接回复无效。<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;text_7&quot;</span> <span class="attr">style</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">    height: 17px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    font-size: 12px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    font-family: PingFangSC-Regular, PingFang SC;</span></span></span><br><span class="line"><span class="string"><span class="tag">    font-weight: 400;</span></span></span><br><span class="line"><span class="string"><span class="tag">    color: #218adb;</span></span></span><br><span class="line"><span class="string"><span class="tag">    line-height: 17px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    margin-top: 6px;</span></span></span><br><span class="line"><span class="string"><span class="tag">    text-decoration: none;</span></span></span><br><span class="line"><span class="string"><span class="tag">  &quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://&#123;&#123;site.url&#125;&#125;&quot;</span>&gt;</span>前往博客<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>适配Waline后改动的地方：</p><ul><li>把洪涝示例中变量的形式改成Waline中变量的形式，比如<code>$&#123;NICK&#125;</code>改为<code>&#123;&#123;self.nick&#125;&#125;</code></li><li>评论内容记得加上<code>save</code>，否则信件中显示的是raw html字符。如：<code>&#123;&#123;self.comment|safe&#125;&#125;</code>。参考：[<a href="https://github.com/walinejs/waline/issues/1034">Bug]: 自定义邮件通知模板后评论内容显示问题 · Issue #1034 · walinejs/waline (github.com)</a></li><li>链接地址加上<code>https://</code>，否则点不了。如<code>href=&quot;https://&#123;&#123;site.url&#125;&#125;&quot;</code></li></ul><p>效果：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230429151028085.png" alt="image-20230429151028085"></p><p>其他样例参考：</p><ul><li><a href="https://www.sarakale.top/blog/posts/537344b2.html">waline 邮件通知模板样式一览 | SaraKale’s blog</a></li><li><a href="https://blog.jyhao.cn/posts/17978.html">自定义Waline/Twikoo邮件通知样式 | Night1918 Blog (jyhao.cn)</a></li><li><a href="https://cloud.tencent.com/developer/article/2211729">Fluid -29- 修改 waline 邮箱通知模板 - 腾讯云开发者社区-腾讯云 (tencent.com)</a></li></ul><h1 id="输入QQ邮箱自动获取QQ头像"><a href="#输入QQ邮箱自动获取QQ头像" class="headerlink" title="输入QQ邮箱自动获取QQ头像"></a>输入QQ邮箱自动获取QQ头像</h1><p>如果你的Waline服务端是按照官方推荐的Vercel部署方式，那么你可以打开Vercel对应的Github仓库，修改index.js文件，将以下内容添加至方框位置：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">此方法或传入一个 comment 对象，你可以通过 comment.mail 获取邮箱。若返回值为 string 类型，则会直接调用返回值作为头像地址，否则正常生成 MD5。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">async</span> <span class="title function_">avatarUrl</span>(<span class="params">comment</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> reg = <span class="keyword">new</span> <span class="title class_">RegExp</span>(<span class="string">&#x27;(\\d+)@qq\\.com$&#x27;</span>, <span class="string">&#x27;i&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> mail = comment.<span class="property">mail</span>;</span><br><span class="line">    <span class="keyword">if</span> (reg.<span class="title function_">test</span>(mail)) &#123;</span><br><span class="line">      <span class="keyword">const</span> q = mail.<span class="title function_">replace</span>(<span class="regexp">/@qq\.com/i</span>, <span class="string">&#x27;&#x27;</span>).<span class="title function_">toLowerCase</span>();</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;https://q1.qlogo.cn/headimg_dl?dst_uin=&#x27;</span> + q + <span class="string">&#x27;&amp;spec=4&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230428162327261.png" alt="image-20230428162327261"></p><blockquote><p>你也可以试着写一个根据QQ号自动获取头像和邮箱的函数</p></blockquote><p>参考：<a href="https://waline.js.org/reference/server/config.html#afterdelete-commentid">服务端配置 | Waline</a></p><h1 id="评论区美化（客户端配置）"><a href="#评论区美化（客户端配置）" class="headerlink" title="评论区美化（客户端配置）"></a>评论区美化（客户端配置）</h1><blockquote><p>本小结以Hexo的Butterfly主题为例。</p></blockquote><p>Butterfly的主题配置文件中Waline有一个option字段，里面可以定制自己想要的客户端。在Waline官方文档中有很多定制选项。</p><p>如何将Waline官方文档中的内容与option字段结合起来？我的理解是，关注官网js示例中的init字段，把自定义的地方放到option中。那怎么放，放什么，格式是什么，接下来跟着我的示例进行即可。</p><h2 id="自定义显示文字"><a href="#自定义显示文字" class="headerlink" title="自定义显示文字"></a>自定义显示文字</h2><p>打开主题配置文件，在option中进行配置，配置方法：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">waline:</span></span><br><span class="line">  <span class="attr">option:</span></span><br><span class="line">    <span class="attr">locale:</span> &#123;</span><br><span class="line">      <span class="attr">nick:</span> <span class="string">&#x27;昵称&#x27;</span>,</span><br><span class="line">      <span class="attr">mail:</span> <span class="string">&#x27;邮箱&#x27;</span>,</span><br><span class="line">      <span class="attr">link:</span> <span class="string">&#x27;你的网站&#x27;</span>,</span><br><span class="line">      <span class="attr">placeholder:</span> <span class="string">&#x27;填写数字QQ邮箱可以自动获取QQ头像&#x27;</span>,</span><br><span class="line">      <span class="attr">requiredMeta:</span> [],</span><br><span class="line">      <span class="attr">sofa:</span> <span class="string">&#x27;评论区空空如也~呜呜呜&#x27;</span>,</span><br><span class="line">      <span class="attr">anonymous:</span> <span class="string">&#x27;匿名的野猫&#x27;</span>,</span><br><span class="line">      <span class="attr">login:</span> <span class="string">&#x27;登录(可选)&#x27;</span></span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure><p>locale写法参照<a href="https://waline.js.org/cookbook/customize/locale.html#locale-%E9%80%89%E9%A1%B9">自定义语言 | Waline</a></p><p>参考：<a href="https://afish.org/2022/11/01/waline_comment/">Hexo|Butterfly 添加Waline评论系统 | 小鱼のblog (afish.org)</a></p><h2 id="表情选项卡配置"><a href="#表情选项卡配置" class="headerlink" title="表情选项卡配置"></a>表情选项卡配置</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">waline:</span></span><br><span class="line">  <span class="attr">option:</span></span><br><span class="line">    <span class="attr">emoji:</span> </span><br><span class="line">    <span class="bullet">-</span> <span class="string">&#x27;//unpkg.com/@waline/emojis@1.1.0/bilibili&#x27;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&#x27;//unpkg.com/@waline/emojis@1.1.0/qq&#x27;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&#x27;//unpkg.com/@waline/emojis@1.1.0/tieba&#x27;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&#x27;//unpkg.com/@waline/emojis@1.1.0/weibo&#x27;</span></span><br></pre></td></tr></table></figure><p>注意到官网配置中emoji是一个列表的写法，那转写到Butterfly主题配置文件中就以yaml的列表写法。</p><p>emoji写法参照：<a href="https://waline.js.org/guide/features/emoji.html">表情选项卡 | Waline</a></p><h2 id="反应配置"><a href="#反应配置" class="headerlink" title="反应配置"></a>反应配置</h2><p>Waline中反应指的是文章下方的表态：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230429172431151.png" alt="image-20230429172431151"></p><p>写法：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">waline:</span></span><br><span class="line">  <span class="attr">option:</span></span><br><span class="line">    <span class="attr">reaction:</span> <span class="literal">true</span> <span class="comment"># 开启快速反应</span></span><br></pre></td></tr></table></figure><p>或自己自定义反应：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">waline:</span></span><br><span class="line">  <span class="attr">option:</span></span><br><span class="line">    <span class="attr">reaction:</span> </span><br><span class="line">    <span class="bullet">-</span> <span class="string">表情地址1</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">表情地址2</span></span><br><span class="line">    <span class="comment"># 最多支持9个</span></span><br></pre></td></tr></table></figure><p>reaction写法参照：<a href="https://waline.js.org/guide/features/reaction.html">文章反应 | Waline</a></p><h2 id="魔改CSS"><a href="#魔改CSS" class="headerlink" title="魔改CSS"></a>魔改CSS</h2><p>本来涉及CSS的修改，应该另写css文件再通过inject引入的（这也是Waline官方推荐的做法）。但是试了不太成功，所以打算把waline.css下载到本地，再将CDN指向本地位置。不优雅，但能凑合用。</p><h3 id="主题颜色修改"><a href="#主题颜色修改" class="headerlink" title="主题颜色修改"></a>主题颜色修改</h3><p>css下载到了本地就好办了。根据官方给的<a href="https://waline.js.org/reference/client/style.html">CSS 变量</a>说明，我们可以自己更改css文件。</p><h3 id="评论区背景图"><a href="#评论区背景图" class="headerlink" title="评论区背景图"></a>评论区背景图</h3><p>我的做法是在css中加上：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.wl-editor</span> &#123;</span><br><span class="line">    <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">图片地址</span>);</span><br><span class="line">    <span class="attribute">background-size</span>: <span class="number">10%</span>;</span><br><span class="line">    <span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line">    <span class="attribute">background-position</span>: right bottom;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="attribute">resize</span>: vertical</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.wl-editor</span><span class="selector-pseudo">:focus</span>&#123;</span><br><span class="line">    <span class="attribute">background-position</span>-x: <span class="number">800px</span>;</span><br><span class="line">    <span class="attribute">background-position</span>-y: <span class="number">1000px</span>;</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="number">0.2s</span> ease-in-out <span class="number">0s</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上面代码是从其他人美化Valine改编以适应Waline来的，然而我的前端知识薄弱，不太懂得每个参数的确切含义与整体文件意义，参数是我自己随便调的。</p><p>参考文章：<a href="https://zhuanlan.zhihu.com/p/581640626">Hexo中Buttefly主题Valine评论系统配置以及美化（七） - 知乎 (zhihu.com)</a></p><h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p>输入提示我没能实现：<a href="https://blog.leonus.cn/2022/inputAlert.html">给你的评论添加一个输入提醒吧 | Leonus</a></p>]]></content>
    
    
    <summary type="html">通过修改客户端或服务端的配置定制自己的Waline评论区</summary>
    
    
    
    <category term="计算机" scheme="https://www.uuanqin.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/"/>
    
    <category term="Hexo" scheme="https://www.uuanqin.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/Hexo/"/>
    
    
    <category term="Github" scheme="https://www.uuanqin.top/tags/Github/"/>
    
    <category term="Waline" scheme="https://www.uuanqin.top/tags/Waline/"/>
    
    <category term="Vercel" scheme="https://www.uuanqin.top/tags/Vercel/"/>
    
  </entry>
  
  <entry>
    <title>Hexo框架Btterfly主题引入Waline评论系统及国内正常访问</title>
    <link href="https://www.uuanqin.top/p/591f2165.html"/>
    <id>https://www.uuanqin.top/p/591f2165.html</id>
    <published>2023-04-27T08:27:09.000Z</published>
    <updated>2023-04-28T11:33:17.039Z</updated>
    
    <content type="html"><![CDATA[<h1 id="引入Waline评论"><a href="#引入Waline评论" class="headerlink" title="引入Waline评论"></a>引入Waline评论</h1><p>Hexo博客框架Butterfly主题中引入Waline评论操作可以参考以下文章解决：</p><ul><li><a href="https://butterfly.js.org/posts/ceeb73f/#%E8%A9%95%E8%AB%96">Butterfly 安裝文檔(四) 主題配置-2 | Butterfly</a></li><li><a href="https://waline.js.org/guide/get-started/">快速上手 | Waline</a></li></ul><p>注意：</p><ul><li><p>在<a href="https://waline.js.org/guide/get-started/">快速上手 | Waline</a>这篇文章中，请按照指引完成Vercel的部署，并完成<strong>域名绑定</strong>小节（虽然它说可选，但我强烈建议你完成，否则你的评论系统只能在严苛的网络环境中运行）</p></li><li><p>在Butterfly的主题配置文件中有两处需要改：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">comments:</span></span><br><span class="line">  <span class="attr">use:</span> <span class="string">Waline</span> <span class="comment"># Valine,Disqus</span></span><br><span class="line">  <span class="comment"># ...</span></span><br><span class="line">  </span><br><span class="line"><span class="attr">waline:</span></span><br><span class="line">  <span class="attr">serverURL:</span> <span class="string">https://pl.uuanqin.top</span> <span class="comment"># Waline server address url</span></span><br></pre></td></tr></table></figure><p>注意serverURL填自己创建子域名</p></li></ul><h1 id="可能遇到的问题"><a href="#可能遇到的问题" class="headerlink" title="可能遇到的问题"></a>可能遇到的问题</h1><p><strong>问题：评论框已经能在博客中显示，但是获取不到评论内容，且无法发布评论。出现Failed to Fetch错误。但使用魔法后评论系统正常运行。</strong></p><p>解决：打开F12控制台并重新加载问题页面，你可能会发现vervel.app无法访问：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/vercal%E8%AF%84%E8%AE%BA%E9%97%AE%E9%A2%98.png" alt="vercal评论问题"></p><p>注意到页面向vercel.app发送了GET请求，但此时vercel.app在国内环境是无法访问的。</p><p>排查方向：</p><ul><li><p>首先确保按照<a href="https://waline.js.org/guide/get-started/">快速上手 | Waline</a>设置好了评论系统子域名，或再参考一下这篇文章<a href="https://blog.csdn.net/Panzer_Jack/article/details/127418379?spm=1001.2101.3001.6650.13&utm_medium=distribute.pc_relevant.none-task-blog-2~default~OPENSEARCH~Rate-13-127418379-blog-127204331.pc_relevant_recovery_v2&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~OPENSEARCH~Rate-13-127418379-blog-127204331.pc_relevant_recovery_v2&utm_relevant_index=14">关于waline国内无法使用的解决方案 （vercel.app国内无法使用问题）_vercel 国内访问-CSDN博客</a></p><p>在域名服务器商（例如 阿里云&gt;云解析DNS&gt;域名解析&gt;解析设置）处添加新的 <code>CNAME</code> 解析记录：</p><table><thead><tr><th>Type</th><th>Name</th><th>Value</th></tr></thead><tbody><tr><td><strong>CNAME</strong></td><td><em>example</em>（你想要的子域名名称）</td><td><strong>cname.vercel-dns.com</strong> （也可以是<strong>cname-china.vercel-dns.com</strong>）</td></tr></tbody></table></li><li><p>确保在Butterfly的主题配置文件中设置了正确的Waline服务器地址（比如设置为<em>example.yourdomain.com</em>）。</p></li></ul>]]></content>
    
    
    <summary type="html">由于vercel.app国内访问失败，可通过配置子域名的方法解决</summary>
    
    
    
    <category term="计算机" scheme="https://www.uuanqin.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/"/>
    
    <category term="Hexo" scheme="https://www.uuanqin.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/Hexo/"/>
    
    
    <category term="问题解决" scheme="https://www.uuanqin.top/tags/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/"/>
    
    <category term="Butterfly" scheme="https://www.uuanqin.top/tags/Butterfly/"/>
    
    <category term="Waline" scheme="https://www.uuanqin.top/tags/Waline/"/>
    
    <category term="Vercel" scheme="https://www.uuanqin.top/tags/Vercel/"/>
    
  </entry>
  
  <entry>
    <title>校园网有线网连接相关问题</title>
    <link href="https://www.uuanqin.top/p/14a6085b.html"/>
    <id>https://www.uuanqin.top/p/14a6085b.html</id>
    <published>2023-04-17T14:48:01.000Z</published>
    <updated>2023-04-28T11:33:17.031Z</updated>
    
    <content type="html"><![CDATA[<h1 id="有线网的连接"><a href="#有线网的连接" class="headerlink" title="有线网的连接"></a>有线网的连接</h1><p>首先仔细查阅本校校园网的有线连接说明。若学校校园网支持PPPoE链接，则可以按照以下步骤进行拨号连接，无需下载其他PPPoE拨号客户端。</p><p>打开网络设置：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230417225031498.png" alt="image-20230417225031498"></p><p>设置新链接：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230417225948370.png" alt="image-20230417225948370"></p><p>选择连接到Internet：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230417230005682.png" alt="image-20230417230005682"></p><p>点击设置新连接：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230417230107904.png" alt="image-20230417230107904"></p><p>点击，下一页：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230417230137355.png" alt="image-20230417230137355"></p><p>输入用户名和密码，具体请查阅本校校园网配置说明。</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230417230208019.png" alt="image-20230417230208019"></p><p>以TJU为例：<a href="https://wiki.tjubot.cn/e-life/network">校园网 - 北洋维基 (tjubot.cn)</a></p><p>注意：连接名称推荐设置为英文名称，以避免以后不必要的麻烦。</p><h1 id="开机自动拨号"><a href="#开机自动拨号" class="headerlink" title="开机自动拨号"></a>开机自动拨号</h1><p>PPPoE拨号设置好后，每次开机都需要手动拨号十分麻烦，我们可以在Windows计划中添加自动拨号的计划任务。</p><p>具体操作请参考这篇文章：<a href="https://blog.csdn.net/weixin_43667077/article/details/112468243?ydreferer=aHR0cHM6Ly9jbi5iaW5nLmNvbS8=">WIN10 电脑设置自动拨号联网任务，实现开机、断网自动重连_我才是一卓的博客-CSDN博客</a>。当然，里面的配置按需配置。</p><h1 id="不必要的麻烦"><a href="#不必要的麻烦" class="headerlink" title="不必要的麻烦"></a>不必要的麻烦</h1><h2 id="Clash魔法失效"><a href="#Clash魔法失效" class="headerlink" title="Clash魔法失效"></a>Clash魔法失效</h2><p>问题描述：使用Clash代理服务，在Windows上按照教程配置好时，无法使用魔法。排除订阅的配置文件的问题。</p><p>解决：校园网拨号连接名称改为英文试试。参考：<a href="https://github.com/Fndroid/clash_for_windows_pkg/issues/4182">开启系统代理后无法使用，左上角数据一直显示0 · Issue #4182 · Fndroid/clash_for_windows_pkg (github.com)</a></p>]]></content>
    
    
    <summary type="html">本文涉及PPPoE拨号指导以及开机自动拨号教程</summary>
    
    
    
    <category term="计算机" scheme="https://www.uuanqin.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/"/>
    
    
    <category term="Windows" scheme="https://www.uuanqin.top/tags/Windows/"/>
    
    <category term="Clash" scheme="https://www.uuanqin.top/tags/Clash/"/>
    
    <category term="有线网" scheme="https://www.uuanqin.top/tags/%E6%9C%89%E7%BA%BF%E7%BD%91/"/>
    
    <category term="PPPoE" scheme="https://www.uuanqin.top/tags/PPPoE/"/>
    
  </entry>
  
  <entry>
    <title>解决Bing搜索页自动返回顶部的问题</title>
    <link href="https://www.uuanqin.top/p/f3706885.html"/>
    <id>https://www.uuanqin.top/p/f3706885.html</id>
    <published>2023-04-16T09:03:32.000Z</published>
    <updated>2023-04-28T11:33:17.037Z</updated>
    
    <content type="html"><![CDATA[<p>使用Bing搜索你可能会遇到这个问题：点击一条搜索结果后过段时间再返回搜索页面，搜索页自动返回顶部。就这一点问题，如果你没注意到还好说，认为是一个无痛无痒的小Bug。一旦你开始被这个Bug影响，你就会陷入无限抓狂状态！！</p><p>解决方法，Edge下载Tampermonkey插件：<a href="https://microsoftedge.microsoft.com/addons/detail/tampermonkey/iikmkjmpaadaobahmlepeloendndfphd">Tampermonkey - Microsoft Edge Addons</a></p><p>获取新脚本：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230416171417352.png" alt="image-20230416171417352"></p><p>打开“油叉”：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230416171510008.png" alt="image-20230416171510008"></p><p>搜索FIX for “Bing Search returns to the top” !脚本进行安装即可。</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230416171521865.png" alt="image-20230416171521865"></p><p>注意，部分用户可能要改一下脚本的代码，全流程看下图：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230416171802268.png" alt="image-20230416171802268"></p><p>参考：<a href="https://tieba.baidu.com/p/8007376009">必应搜索页过一段时间就会自动回到页面开始位置_必应吧_百度贴吧 (baidu.com)</a></p>]]></content>
    
    
    <summary type="html">Stop doing weird things, Bing ! ;)</summary>
    
    
    
    <category term="计算机" scheme="https://www.uuanqin.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/"/>
    
    
    <category term="Bing" scheme="https://www.uuanqin.top/tags/Bing/"/>
    
    <category term="Edge" scheme="https://www.uuanqin.top/tags/Edge/"/>
    
    <category term="Tampermonkey" scheme="https://www.uuanqin.top/tags/Tampermonkey/"/>
    
  </entry>
  
  <entry>
    <title>部署Hexo个人博客框架到服务器</title>
    <link href="https://www.uuanqin.top/p/ad28b4a.html"/>
    <id>https://www.uuanqin.top/p/ad28b4a.html</id>
    <published>2023-04-13T10:10:00.000Z</published>
    <updated>2023-04-28T11:33:17.045Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><h2 id="我为什么要从Wordpress换为Hexo"><a href="#我为什么要从Wordpress换为Hexo" class="headerlink" title="我为什么要从Wordpress换为Hexo"></a>我为什么要从Wordpress换为Hexo</h2><p>一个关键字：卡！Wordpress太卡了，十分笨重和不方便。对于小小服务器来说简直是难以承受。况且对于内容为主的博客，Wordpress显得过于臃肿，有大量插件可以用，也意味着你要看更多的广告和垃圾信息。此外，Wordpress用户数量多，社区庞大，但社区内容鱼龙混杂，充斥大量商业化甚至无用的信息，不够纯粹，质量偏低</p><p>Wordpress对于小白来说好上手，无脑后台管理。而拥有一点点编程经验的我完全可以凭一点点知识储备和动手能力砍掉多余的，无用的东西。Hexo相较于Wordpress，更轻，静态页面对SEO更友好，文章数据管理更方便、更让人贴心。</p><h2 id="实现思路和原理"><a href="#实现思路和原理" class="headerlink" title="实现思路和原理"></a>实现思路和原理</h2><p>整个过程实现的原理可以用下图表示。</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/view" alt="preview"></p><p>可参照下文顺序进行配置。</p><h1 id="本地"><a href="#本地" class="headerlink" title="本地"></a>本地</h1><h2 id="Hexo"><a href="#Hexo" class="headerlink" title="Hexo"></a>Hexo</h2><p>本地启用Hexo：按照官方文档搭建基本环境（Node.js，Git），在本地尝试部署并熟悉hexo的写作流程，了解配置文件结构，此处不再赘述。<a href="https://hexo.io/zh-cn/docs/">官方文档 | Hexo</a></p><p>在本地Hexo站点目录下安装hexo-deployer-git插件：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><h2 id="配置SSH密匙"><a href="#配置SSH密匙" class="headerlink" title="配置SSH密匙"></a>配置SSH密匙</h2><p>为了使本地可以跟远程的 github 建立联系，需要在本地配置 SSH 密钥，这样我们就可以在本地直接提交代码到 GitHub 上或者远端 git 仓库。<br>如果是第一次配置 SSH，则配置一下 git 的 username 和 email</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name <span class="string">&quot;你要设置的名字&quot;</span></span><br><span class="line">git config --global user.email <span class="string">&quot;你要设置的邮箱&quot;</span></span><br></pre></td></tr></table></figure><p>之后生成 SSH 密钥：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C <span class="string">&quot;你刚刚设置的邮箱&quot;</span></span><br></pre></td></tr></table></figure><p>如果不需要设置密码的话，连续三个回车就好了。</p><p>复制好公钥后面要用：</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230408233136534.png" alt="image-20230408233136534"></p><h1 id="服务器端"><a href="#服务器端" class="headerlink" title="服务器端"></a>服务器端</h1><blockquote><p>重新初始化阿里云盘后进行的演示。</p></blockquote><p>阿里云盘初始化后，再次使用ssh连接时会有<code>WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!</code>的提示。解决方法：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -R &lt;之前连接时的网段IP&gt;</span><br></pre></td></tr></table></figure><p>再次SSL连接：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh root@60.205.223.216</span><br></pre></td></tr></table></figure><p>出现一句：<br>Are you sure you want to continue connecting (yes/no)?</p><p>输入：yes 回车 </p><p>参考：<a href="https://blog.csdn.net/wangguchao/article/details/85614914">问题解决——SSH时出现WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!_口袋里のInit的博客-CSDN博客</a></p><h2 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h2><p>安装Nginx并配置好域名（如果有）。具体操作详见我的这篇文章。</p><h2 id="Git"><a href="#Git" class="headerlink" title="Git"></a>Git</h2><h3 id="git的安装与用户创建"><a href="#git的安装与用户创建" class="headerlink" title="git的安装与用户创建"></a>git的安装与用户创建</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装git</span></span><br><span class="line">yum install git</span><br><span class="line"><span class="comment"># 创建git账户</span></span><br><span class="line">adduser git</span><br><span class="line"><span class="comment"># 添加Git账户权限</span></span><br><span class="line"><span class="built_in">chmod</span> 740 /etc/sudoers</span><br><span class="line">vim /etc/sudoers</span><br></pre></td></tr></table></figure><p>在vim编辑模式下，这个地方加上一行<code>git     ALL=(ALL)     ALL</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">## Allow root to run any commands anywhere</span><br><span class="line">root    ALL=(ALL)     ALL</span><br><span class="line">git     ALL=(ALL)     ALL</span><br></pre></td></tr></table></figure><p>执行：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> 400 /etc/sudoers  <span class="comment"># 改回权限</span></span><br><span class="line">sudo passwd git<span class="comment"># 设置 git 账户密码</span></span><br></pre></td></tr></table></figure><p>输两次密码即可：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Changing password <span class="keyword">for</span> user git.</span><br><span class="line">New password:<span class="comment"># 输的时候是看不到的</span></span><br><span class="line">Retype new password:</span><br><span class="line">passwd: all authentication tokens updated successfully.</span><br></pre></td></tr></table></figure><p>执行：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">su git<span class="comment"># 切换至 git 用户</span></span><br><span class="line"><span class="comment"># 创建 ~/.ssh 文件夹和 ~/.ssh/authorized_keys 文件，并赋予相应的权限</span></span><br><span class="line"><span class="built_in">mkdir</span> ~/.ssh</span><br><span class="line">vim ~/.ssh/authorized_keys</span><br><span class="line">然后把本地公钥粘贴在authorized_keys里（详见上文）</span><br><span class="line"><span class="built_in">chmod</span> 600 ~/.ssh/authorized_keys</span><br><span class="line"><span class="built_in">chmod</span> 700 ~/.ssh</span><br></pre></td></tr></table></figure><p>这里提一嘴，有时候切换不了git用户，即<code>su git</code>执行不了。其实也没事，就是知道git用户目录是<code>/home/git/</code>就行，即上面命令中的<code>~</code>指的是<code>/home/git/</code></p><p>在本地电脑中，终端执行：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -v git@&lt;你的服务器主机IP&gt;</span><br></pre></td></tr></table></figure><p>如果能免密登录，那就成了。</p><h3 id="仓库创建与钩子创建"><a href="#仓库创建与钩子创建" class="headerlink" title="仓库创建与钩子创建"></a>仓库创建与钩子创建</h3><p>保证之前在Nginx配置里的网站根目录的权限：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chown</span> -R git:git &lt;网站根目录&gt;</span><br><span class="line"><span class="built_in">chmod</span> -R 755 &lt;网站根目录&gt;</span><br></pre></td></tr></table></figure><p>创建仓库：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> repo <span class="comment"># 我选择在git的用户目录下创建</span></span><br><span class="line"><span class="built_in">cd</span> repo   <span class="comment"># 创建空白的git仓库</span></span><br><span class="line">git init --bare hexo.git<span class="comment"># 创建一个空白的 git 仓库</span></span><br><span class="line"><span class="built_in">chown</span> -R git:git hexo.git<span class="comment"># 注意保证权限</span></span><br><span class="line">vim ~/repo/hexo.git/hooks/post-receive</span><br></pre></td></tr></table></figure><p>在post-receive里边输入：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">git --work-tree=/var/www/uuanqin.top --git-dir=/home/git/repo/hexo.git checkout -f</span><br></pre></td></tr></table></figure><p>以上内容建议手打。可以看出第一个参数对应的是网站根目录，第二个参数是代码仓库目录。</p><p>添加权限：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chown</span> -R git:git hexo.git/hooks/post-receive</span><br><span class="line"><span class="built_in">chmod</span> +x hexo.git/hooks/post-receive</span><br></pre></td></tr></table></figure><h1 id="本地-1"><a href="#本地-1" class="headerlink" title="本地"></a>本地</h1><h2 id="Hexo配置"><a href="#Hexo配置" class="headerlink" title="Hexo配置"></a>Hexo配置</h2><p>进入本地电脑 hexo 博客的根目录，编辑<strong>站点配置文件 _config.yml</strong>，找到 deploy，修改成以下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  #repo改为repo: git@&lt;服务器IP&gt;:&lt;服务器端的仓库&gt;</span><br><span class="line">  repo: git@hjxlog.com:/var/repo/hexo.git</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure><p>最后在本地电脑 hexo 博客的根目录执行命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo d -g</span><br></pre></td></tr></table></figure><p>出现错误记得检查服务器端权限问题：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chown -R git:git &lt;你的仓库&gt;</span><br><span class="line">chown -R git:git &lt;网站根目录&gt;</span><br></pre></td></tr></table></figure><p>在浏览器输入网址即可。</p><p><img src= "/image/loading.gif" data-lazy-src="https://typora-1301301520.file.myqcloud.com/img/image-20230409160319825.png" alt="image-20230409160319825"></p><p>嫌每次都输入两个命令麻烦，可以在 package.json 中添加 npm 脚本：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;publish&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hexo clean &amp;&amp; hexo g -d&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hexo clean &amp;&amp; hexo g &amp;&amp; hexo s&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>下次执行时可以直接：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run publish</span><br></pre></td></tr></table></figure><h1 id="其他问题"><a href="#其他问题" class="headerlink" title="其他问题"></a>其他问题</h1><h2 id="钩子不起作用"><a href="#钩子不起作用" class="headerlink" title="钩子不起作用"></a>钩子不起作用</h2><p>出现已经推送到服务器但是钩子不起作用，且出现cannot run hooks/post-receive: No such file or directory的提示：</p><p>请重新创建并<strong>手打</strong>post-receive文件，保证该文件有可执行权。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x post-receive</span><br><span class="line"><span class="built_in">chown</span> -R git:git post-receive</span><br></pre></td></tr></table></figure><p>参考：<a href="https://blog.csdn.net/qq_48736958/article/details/113444533"> cannot run hooks/post-receive: No such file or directory_渣渣林的博客-CSDN博客</a></p><h2 id="hexo-d命令报错"><a href="#hexo-d命令报错" class="headerlink" title="hexo d命令报错"></a>hexo d命令报错</h2><p>hexo d命令报错 ERROR Deployer not found: git</p><p>解决方案</p><p>这是因为没安装<code>hexo-deployer-git</code>插件，在<strong>站点目录</strong>下输入下面的插件安装就好了：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><p>然后在使用<code>Hexo d</code>命令就可以推送了。</p><p>参考：<a href="https://blog.csdn.net/qq_21808961/article/details/84476504">hexo d命令报错 ERROR Deployer not found: git_蓝蓝223的博客-CSDN博客</a></p><p>文章参考：<a href="https://blog.csdn.net/qq_44706030/article/details/112759634">将 Hexo 部署到阿里云轻量服务器_hexo部署到阿里云_小阳coding的博客-CSDN博客</a></p>]]></content>
    
    
    <summary type="html">将博客框架Hexo部署到ECS服务器。</summary>
    
    
    
    <category term="计算机" scheme="https://www.uuanqin.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/"/>
    
    <category term="Hexo" scheme="https://www.uuanqin.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/Hexo/"/>
    
    
    <category term="Linux" scheme="https://www.uuanqin.top/tags/Linux/"/>
    
    <category term="ECS" scheme="https://www.uuanqin.top/tags/ECS/"/>
    
  </entry>
  
</feed>
