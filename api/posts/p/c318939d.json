{"data":{"title":"AHK é¼ æ ‡å¢å¼ºï¼ˆCClose æºç æ’·è‹±ï¼‰","slug":"æ ¸å¿ƒååŒ/è‡ªåŠ¨åŒ–/AHK é¼ æ ‡å¢å¼ºï¼ˆCClose æºç æ’·è‹±ï¼‰","description":"æå–CCloseä¸­æœ‰ç”¨çš„è„šæœ¬ä»£ç è¿›è¡Œè§£æ","date":"2023-05-26T15:09:27.000Z","updated":"2026-02-01T06:21:46.983Z","language":"zh-CN","comments":true,"url":"p/c318939d/","cover":"https://cdn.gallery.uuanqin.top/img/cclosecover.png","images":[],"content":"<p>åˆ·æŠ–éŸ³åˆ·åˆ°ä¸€ä¸ªé¡¹ç›®ï¼Œå°±æ˜¯ä¸€ä¸ªå¯ä»¥å¢åŠ é¼ æ ‡åŠŸèƒ½çš„æ“ä½œã€‚å®ƒä¸ºé¼ æ ‡èµ‹äºˆäº†ä»¥ä¸‹æ“ä½œï¼š</p>\n<table>\n<thead>\n<tr>\n<th>Action</th>\n<th>+ Target</th>\n<th>= Result</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Middle click</td>\n<td rowspan=\"3\">+ title bar</td>\n<td>= close window</td>\n</tr>\n<tr>\n<td>Right click</td>\n<td>= minimize window</td>\n</tr>\n<tr>\n<td>Hold left click</td>\n<td>= toggle window always on top</td>\n</tr>\n<tr>\n<td>Double press</td>\n<td>+ Esc key</td>\n<td>= close active window</td>\n</tr>\n<tr>\n<td>Right click</td>\n<td>+ taskbar button</td>\n<td>= move pointer to â€œClose windowâ€</td>\n</tr>\n</tbody>\n</table>\n<p>è½¯ä»¶ä¸å¤§ï¼Œä¸»è¦ä½¿ç”¨ AutoHotKey è„šæœ¬è¿›è¡Œå¼€å‘ã€‚é¼ æ ‡å¿«æ·æ“ä½œæŒºå¥½ç”¨çš„ï¼Œå°¤å…¶æ˜¯ä¸­é”®å…³é—­çª—å£çš„æ“ä½œï¼Œç»Ÿä¸€äº†æµè§ˆå™¨å…³é—­æ ‡ç­¾é¡µçš„åŠ¨ä½œã€‚ä½†æ˜¯æˆ‘çœ‹ä¸­äº†å…¶ä¸­çš„è„šæœ¬è¯­è¨€ AutoHotKeyï¼Œæ„Ÿè§‰å®ƒå¾ˆæœ‰ç”¨å¤„ï¼Œé‚å†³å®šå‰–ææºç ï¼Œæå–å…¶ä¸­æ‰§è¡Œå¿«æ·æ“ä½œçš„æœ‰ç”¨è„šæœ¬è¿›è¡Œå­¦ä¹ ã€‚</p>\n<p>ä»¥ä¸‹æ˜¯åŸé¡¹ç›®çš„åœ°å€ï¼š</p>\n<blockquote>\n<p><a href=\"https://github.com/chaohershi/cclose/tree/master\">chaohershi/cclose: A Windows utility that helps you close windows faster or pin windows always on top. (github.com)</a></p>\n</blockquote>\n<p>åŸé¡¹ç›®çš„ AutoHotKey è„šæœ¬è¯­è¨€ç‰ˆæœ¬åº”è¯¥æ˜¯ V1ï¼Œä¸‹é¢æˆ‘å°†ç”¨ V2 ç‰ˆæœ¬è¿›è¡Œæ”¹å†™å¹¶å¯¹å…¶è¿›è¡Œäº†ç®€åŒ– <s>ï¼ˆğŸ˜¥ å…¶å®æ˜¯åˆ å»æˆ‘çœ‹ä¸æ‡‚ä½†å®é™…å½±å“ä¸å¤§çš„å†…å®¹ï¼‰</s> ã€‚è¯»è€…å¯ä»¥æ‘˜å–å…¶ä¸­çš„ç‰‡æ®µä½œä¸ºè‡ªå·±çš„è„šæœ¬ã€‚æ”¹è¿›ç‚¹ï¼š</p>\n<ul>\n<li>AutoHotKey è¯­æ³•å‡çº§ï¼šä» V1 åˆ° V2</li>\n<li>å¯ç”¨éƒ¨åˆ†å¿«æ·åŠŸèƒ½æœ‰æç¤º</li>\n</ul>\n<p>è§£æå¼€å§‹ ğŸ”½</p>\n<h1 id=\"å…¬å…±å‡½æ•°éƒ¨åˆ†\"><a class=\"markdownIt-Anchor\" href=\"#å…¬å…±å‡½æ•°éƒ¨åˆ†\"></a> å…¬å…±å‡½æ•°éƒ¨åˆ†</h1>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#Requires AutoHotkey v2<span class=\"number\">.0</span></span><br><span class=\"line\"></span><br><span class=\"line\">; æ£€æµ‹é¼ æ ‡æ˜¯å¦åœ¨æŒ‡å®šçš„WinTitleçª—å£ä¸­</span><br><span class=\"line\">MouseIsOver(WinTitle)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\tMouseGetPos  , , &amp;win</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"title function_\">WinExist</span><span class=\"params\">(WinTitle <span class=\"string\">&quot; ahk_id &quot;</span> win)</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">; æ£€æµ‹é¼ æ ‡æ˜¯å¦æ‚¬åœåœ¨æ ‡é¢˜</span><br><span class=\"line\">MouseIsOverTitlebar()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\tCoordMode <span class=\"string\">&quot;Mouse&quot;</span>, <span class=\"string\">&quot;Screen&quot;</span></span><br><span class=\"line\">\tMouseGetPos &amp;x, &amp;y, &amp;win</span><br><span class=\"line\">    ; ç”¨äºå­˜å‚¨ç›®æ ‡çª—å£å·¦ä¸Šè§’çš„ X å’Œ Y åæ ‡çš„å˜é‡çš„å¼•ç”¨</span><br><span class=\"line\">\tWinGetPos &amp;xWin, &amp;yWin, , , <span class=\"string\">&quot;ahk_id &quot;</span> win</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> <span class=\"title function_\">WinExist</span><span class=\"params\">(<span class=\"string\">&quot;ahk_class Shell_TrayWnd ahk_id &quot;</span> win)</span> || <span class=\"title function_\">WinExist</span><span class=\"params\">(<span class=\"string\">&quot;ahk_class Shell_SecondaryTrayWnd ahk_id &quot;</span> win)</span> ; exclude the taskbar</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"literal\">false</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (y &gt;= yWin &amp;&amp; y &lt; yWin + <span class=\"number\">30</span> * A_ScreenDPI / <span class=\"number\">96</span>)</span><br><span class=\"line\">    ; <span class=\"keyword\">if</span> within title bar width</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">false</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">; å±•ç¤º<span class=\"number\">1</span>sé’Ÿçš„æ ‡ç­¾</span><br><span class=\"line\">ShowToolTip(msg)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    ToolTip msg,,<span class=\"number\">0</span></span><br><span class=\"line\">    SetTimer () =&gt; ToolTip(), <span class=\"number\">-1000</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"ç¬¬ä¸€éƒ¨åˆ†-æ ‡é¢˜æ“ä½œ\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬ä¸€éƒ¨åˆ†-æ ‡é¢˜æ“ä½œ\"></a> ç¬¬ä¸€éƒ¨åˆ† æ ‡é¢˜æ“ä½œ</h1>\n<table>\n<thead>\n<tr>\n<th>Action</th>\n<th>+ Target</th>\n<th>= Result</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Middle click</td>\n<td rowspan=\"3\">+ title bar</td>\n<td>= close window</td>\n</tr>\n<tr>\n<td>Right click</td>\n<td>= minimize window</td>\n</tr>\n<tr>\n<td>Hold left click</td>\n<td>= toggle window always on top</td>\n</tr>\n</tbody>\n</table>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#HotIf <span class=\"title function_\">MouseIsOverTitlebar</span><span class=\"params\">()</span></span><br><span class=\"line\">; åŠŸèƒ½ï¼šé¼ æ ‡ä¸­é”®ç‚¹å‡»æ ‡é¢˜å…³é—­çª—å£</span><br><span class=\"line\">MButton::</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    ; alternative to WinClose, as WinClose is a somewhat forceful method, e.g., <span class=\"keyword\">if</span> multiple Microsoft Excel instances exist, WinClose will close them all at once.</span><br><span class=\"line\">    ; <span class=\"number\">0x112</span> = WM_SYSCOMMAND, <span class=\"number\">0xF060</span> = SC_CLOSE https:<span class=\"comment\">//autohotkey.com/docs/commands/WinClose.htm#Remarks</span></span><br><span class=\"line\">    ; https:<span class=\"comment\">//learn.microsoft.com/zh-cn/windows/win32/menurc/wm-syscommand</span></span><br><span class=\"line\">    MouseGetPos  , , &amp;win         ; æˆ‘åŠ çš„ï¼Œè¦ä¸ç„¶å®ƒä¸èµ·ä½œç”¨</span><br><span class=\"line\">    PostMessage <span class=\"number\">0x112</span>, <span class=\"number\">0xF060</span>, , win</span><br><span class=\"line\">    <span class=\"title function_\">ShowToolTip</span><span class=\"params\">(<span class=\"string\">&quot;çª—å£å…³é—­&quot;</span>)</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">; åŠŸèƒ½ï¼šé¼ æ ‡å³é”®ç‚¹å‡»æ ‡é¢˜æœ€å°åŒ–çª—å£</span><br><span class=\"line\">RButton::</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    err_code := KeyWait(<span class=\"string\">&quot;RButton&quot;</span>, <span class=\"string\">&quot;T0.4&quot;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(err_code = <span class=\"number\">0</span>) ;è¶…æ—¶</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        Send <span class=\"string\">&quot;&#123;Click, Right&#125;&quot;</span> ; n.b., <span class=\"keyword\">do</span> not use Send &#123;RButton&#125;</span><br><span class=\"line\">    &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">        ; https:<span class=\"comment\">//learn.microsoft.com/zh-cn/windows/win32/menurc/wm-syscommand</span></span><br><span class=\"line\">        MouseGetPos  , , &amp;win           ; æˆ‘åŠ çš„ï¼Œè¦ä¸ç„¶å®ƒä¸èµ·ä½œç”¨</span><br><span class=\"line\">        PostMessage <span class=\"number\">0x112</span>, <span class=\"number\">0xF020</span>, ,win ; alternative to WinMinimize</span><br><span class=\"line\">        <span class=\"title function_\">ShowToolTip</span><span class=\"params\">(<span class=\"string\">&quot;çª—å£æœ€å°åŒ–&quot;</span>)</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">; çª—å£ç½®é¡¶åŠŸèƒ½</span><br><span class=\"line\">~LButton::</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    CoordMode <span class=\"string\">&quot;Mouse&quot;</span>, <span class=\"string\">&quot;Screen&quot;</span></span><br><span class=\"line\">    MouseGetPos &amp;xOld, &amp;yOld, &amp;win</span><br><span class=\"line\">    ExStyle := WinGetExStyle(win)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (ExStyle &amp; <span class=\"number\">0x8</span>) ; <span class=\"number\">0x8</span> is WS_EX_TOPMOST</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        ExStyle := <span class=\"string\">&quot;çª—å£å·²å–æ¶ˆç½®é¡¶&quot;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        ExStyle := <span class=\"string\">&quot;çª—å£å·²ç½®é¡¶&quot;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    err_code := KeyWait(<span class=\"string\">&quot;LButton&quot;</span>, <span class=\"string\">&quot;T1&quot;</span>) ; wait <span class=\"keyword\">for</span> the left mouse button to be released with timeout <span class=\"built_in\">set</span> to <span class=\"number\">1</span> second</span><br><span class=\"line\">    MouseGetPos &amp;xNew, &amp;yNew</span><br><span class=\"line\">    <span class=\"title function_\">if</span> <span class=\"params\">(xOld = xNew &amp;&amp; yOld = yNew &amp;&amp; err_code = <span class=\"number\">0</span>)</span> ; <span class=\"keyword\">if</span> the mouse did not move during the timeout period</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        WinSetAlwaysOnTop <span class=\"number\">-1</span>, <span class=\"string\">&quot;A&quot;</span> ; toggle window always on top</span><br><span class=\"line\">        <span class=\"title function_\">ShowToolTip</span><span class=\"params\">(ExStyle)</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"ç¬¬äºŒéƒ¨åˆ†-åŒå‡»-esc-å…³é—­çª—å£\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬äºŒéƒ¨åˆ†-åŒå‡»-esc-å…³é—­çª—å£\"></a> ç¬¬äºŒéƒ¨åˆ† åŒå‡» Esc å…³é—­çª—å£</h1>\n<table>\n<thead>\n<tr>\n<th>Action</th>\n<th>+ Target</th>\n<th>= Result</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Double press</td>\n<td>+ Esc key</td>\n<td>= close active window</td>\n</tr>\n</tbody>\n</table>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">; åŠŸèƒ½ï¼šåŒå‡»Escå…³é—­çª—å£</span><br><span class=\"line\">#HotIf</span><br><span class=\"line\">~Esc::</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    id_old := WinGetID(<span class=\"string\">&quot;A&quot;</span>)</span><br><span class=\"line\">    process_name := WinGetProcessName(<span class=\"string\">&quot;A&quot;</span>)</span><br><span class=\"line\">    KeyWait <span class=\"string\">&quot;Esc&quot;</span> ; wait <span class=\"keyword\">for</span> the Esc key to be released</span><br><span class=\"line\">    err_code := KeyWait(<span class=\"string\">&quot;Esc&quot;</span>, <span class=\"string\">&quot;D T0.4&quot;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (err_code = <span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">        id_new := WinGetID(<span class=\"string\">&quot;A&quot;</span>) ; get the window id after the Esc key has being pressed again</span><br><span class=\"line\">        win_class := WinGetClass(<span class=\"string\">&quot;A&quot;</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (id_old = id_new &amp;&amp; win_class != <span class=\"string\">&quot;Shell_TrayWnd&quot;</span> &amp;&amp; win_class != <span class=\"string\">&quot;Shell_SecondaryTrayWnd&quot;</span> &amp;&amp; win_class != <span class=\"string\">&quot;Progman&quot;</span> &amp;&amp; win_class != <span class=\"string\">&quot;WorkerW&quot;</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            ; <span class=\"keyword\">if</span> the current window is the same one as before and is not taskbar or desktop</span><br><span class=\"line\">            Send <span class=\"string\">&quot;!&#123;F4&#125;&quot;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"ç¬¬ä¸‰éƒ¨åˆ†-å³å‡»ä»»åŠ¡æ \"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬ä¸‰éƒ¨åˆ†-å³å‡»ä»»åŠ¡æ \"></a> ç¬¬ä¸‰éƒ¨åˆ† å³å‡»ä»»åŠ¡æ </h1>\n<table>\n<thead>\n<tr>\n<th>Action</th>\n<th>+ Target</th>\n<th>= Result</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Right click</td>\n<td>+ taskbar button</td>\n<td>= move pointer to â€œClose windowâ€</td>\n</tr>\n</tbody>\n</table>\n<p>å³å‡»ä»»åŠ¡æ åï¼Œå¦‚æœé¼ æ ‡è‡ªåŠ¨æ‚¬åœåœ¨å…³é—­çª—å£ä¸Šï¼š</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">; åŠŸèƒ½ï¼Œå³å‡»ä»»åŠ¡æ å›¾æ ‡é¼ æ ‡è‡ªåŠ¨è·³è½¬åˆ°å…³é—­çª—å£</span><br><span class=\"line\">#HotIf <span class=\"title function_\">MouseIsOver</span><span class=\"params\">(<span class=\"string\">&quot;ahk_class Shell_TrayWnd&quot;</span>)</span> || <span class=\"title function_\">MouseIsOver</span><span class=\"params\">(<span class=\"string\">&quot;ahk_class Shell_SecondaryTrayWnd&quot;</span>)</span> ; apply the following hotkey only when the mouse is over the taskbar</span><br><span class=\"line\">~RButton:: ; when right clicked</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    CoordMode <span class=\"string\">&quot;Mouse&quot;</span>, <span class=\"string\">&quot;Screen&quot;</span></span><br><span class=\"line\">    MouseGetPos &amp;xOld, &amp;yOld</span><br><span class=\"line\">    Sleep <span class=\"number\">500</span> ; wait <span class=\"keyword\">for</span> the Jump List to pop up, n.b., this line also helps to provide a uniform waiting experience</span><br><span class=\"line\">    MouseGetPos &amp;xNew, &amp;yNew</span><br><span class=\"line\">    CoordMode <span class=\"string\">&quot;Mouse&quot;</span>, <span class=\"string\">&quot;Window&quot;</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (Abs(xNew - xOld) &lt; <span class=\"number\">8</span> &amp;&amp; Abs(yNew - yOld) &lt; <span class=\"number\">8</span>) ; <span class=\"keyword\">if</span> the mouse did not move much</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        Loop <span class=\"number\">6</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> <span class=\"title function_\">WinActive</span><span class=\"params\">(<span class=\"string\">&quot;ahk_class Windows.UI.Core.CoreWindow&quot;</span>)</span> ; <span class=\"keyword\">if</span> the Jump List pops <span class=\"title function_\">up</span> <span class=\"params\">(right clicked on the taskbar app buttons)</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                WinGetPos , , &amp;width, &amp;height ; get the size of the last found <span class=\"title function_\">window</span> <span class=\"params\">(Jump List)</span></span><br><span class=\"line\">                <span class=\"title function_\">MouseMove</span> <span class=\"params\">(width / <span class=\"number\">2</span>)</span>, <span class=\"params\">(height - <span class=\"number\">3</span> * width / <span class=\"number\">32</span>)</span>, 10 ; move the mouse to the bottom of the Jump <span class=\"title function_\">List</span> <span class=\"params\">(<span class=\"string\">&quot;Close window&quot;</span>)</span></span><br><span class=\"line\">                <span class=\"keyword\">break</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            Sleep 250 ; wait <span class=\"keyword\">for</span> more time</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"æ€»ç»“\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“\"></a> æ€»ç»“</h1>\n<p>ä¸Šé¢çš„ç¤ºä¾‹ä»£ç å¯ä»¥ç»„æˆä¸€ä¸ª.ahk æ–‡ä»¶ï¼Œå®ç°æ‰€æœ‰ CClose çš„åŸºæœ¬åŠŸèƒ½ã€‚</p>\n<p>å¼€æœºè‡ªå¯åŠ¨æ–¹æ³•ï¼š</p>\n<ol>\n<li>Win+R æ‰“å¼€è¿è¡Œçª—å£ï¼Œè¾“å…¥ shell:startup</li>\n<li>æŠŠè„šæœ¬çš„å¿«æ·æ–¹å¼ä¸¢åˆ°é‡Œé¢å³å¯</li>\n</ol>\n<p>æœªæ¥å¯ä»¥æ”¹è¿›çš„åœ°æ–¹ï¼š</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input class=\"task-list-item-checkbox\" disabled=\"\" type=\"checkbox\"> æ§åˆ¶éƒ¨åˆ†åŠŸèƒ½çš„å¯ç”¨ä¸ç¦ç”¨ï¼ˆå¥½çš„ï¼Œåˆæˆ CClose çš„è½®å­ç‰ˆäº†ğŸ˜…ï¼‰</li>\n<li class=\"task-list-item\"><input class=\"task-list-item-checkbox\" disabled=\"\" type=\"checkbox\"> è¿›ä¸€æ­¥ï¼Œå¯¹è‡ªå·±çš„è„šæœ¬è¿›è¡Œæ§åˆ¶å’Œç®¡ç†</li>\n<li class=\"task-list-item\"><input class=\"task-list-item-checkbox\" disabled=\"\" type=\"checkbox\"> å¯¹ä½¿ç”¨äº†ç®¡ç†å‘˜æƒé™è¿è¡Œçš„ç³»ç»Ÿæ— æ•ˆ</li>\n<li class=\"task-list-item\"><input class=\"task-list-item-checkbox\" disabled=\"\" type=\"checkbox\"> çŠ¶æ€æ å›¾æ ‡æ”¹ä¸€ä¸‹</li>\n<li class=\"task-list-item\"><input class=\"task-list-item-checkbox\" disabled=\"\" type=\"checkbox\"> å­¦ä¹ åˆ¶ä½œä¸€ä¸ª Windows è½¯ä»¶</li>\n</ul>\n<p>ç›®å‰å­˜åœ¨çš„é—®é¢˜ï¼š</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input class=\"task-list-item-checkbox\" disabled=\"\" type=\"checkbox\"> åœ¨è¿è¡Œã€Šè’é‡å¤§é•–å®¢ 2ã€‹æ—¶éƒ¨åˆ†æƒ…å†µä¸‹ä¼šè§¦å‘ã€‚ä¼°è®¡å…¨å±æ¸¸æˆéƒ½ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ï¼Œå¾…ä¿®å¤å’Œæ”¹è¿›ã€‚</li>\n</ul>\n","raw":"---\ntitle: AHK é¼ æ ‡å¢å¼ºï¼ˆCClose æºç æ’·è‹±ï¼‰\ntags:\n  - CClose\n  - å¿«æ·é”®\n  - é¼ æ ‡\n  - AutoHotKey\ncover: https://cdn.gallery.uuanqin.top/img/cclosecover.png\ndescription: æå–CCloseä¸­æœ‰ç”¨çš„è„šæœ¬ä»£ç è¿›è¡Œè§£æ\nabbrlink: c318939d\ncategories:\n  - æ ¸å¿ƒååŒ\n  - è‡ªåŠ¨åŒ–\nsummary: >-\n  æœ¬æ–‡ä»‹ç»äº†å¦‚ä½•é€šè¿‡AutoHotkeyè„šæœ¬è¯­è¨€æ”¹å†™å¹¶ç®€åŒ–ä¸€ä¸ªç°æœ‰çš„Windowså·¥å…·ï¼Œè¯¥å·¥å…·å¯ä»¥å¸®åŠ©ç”¨æˆ·æ›´å¿«åœ°å…³é—­çª—å£æˆ–å°†çª—å£å›ºå®šåœ¨é¡¶éƒ¨ã€‚åŸé¡¹ç›®ä½¿ç”¨äº†V1ç‰ˆæœ¬çš„AutoHotkeyè„šæœ¬è¯­è¨€ï¼Œä½œè€…é€‰æ‹©äº†V2ç‰ˆæœ¬è¿›è¡Œé‡å†™ï¼Œå¹¶ç§»é™¤äº†ä¸€äº›ä½œè€…æ— æ³•ç†è§£ä½†å¯¹åŠŸèƒ½æ— å®é™…å½±å“çš„å†…å®¹ã€‚æ–‡ç« è¯¦ç»†è§£æäº†è„šæœ¬ä¸­çš„å…¬å…±å‡½æ•°éƒ¨åˆ†ï¼ŒåŒ…æ‹¬æ£€æµ‹é¼ æ ‡ä½ç½®ã€æ˜¾ç¤ºå·¥å…·æç¤ºã€å¤„ç†é¼ æ ‡äº‹ä»¶ç­‰åŠŸèƒ½ã€‚æ¥ç€ï¼Œæ–‡ç« åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†è¯¦ç»†é˜è¿°äº†çª—å£å…³é—­çš„ä¸åŒå¿«æ·æ“ä½œï¼šä¸­é”®å…³é—­ã€åŒå‡»Escå…³é—­ä»¥åŠå³å‡»ä»»åŠ¡æ åè·³è½¬è‡³å…³é—­çª—å£ã€‚æœ€åï¼Œä½œè€…æ€»ç»“äº†è¿™äº›ä»£ç ç‰‡æ®µå¯ä»¥ç»„åˆæˆä¸€ä¸ªå®Œæ•´çš„é¼ æ ‡å¢å¼ºå·¥å…·ï¼Œæ—¨åœ¨æé«˜ç”¨æˆ·åœ¨Windowsæ“ä½œç³»ç»Ÿä¸­çš„å·¥ä½œæ•ˆç‡ã€‚\ndate: 2023-05-26 23:09:27\ntop_img:\n---\n\nåˆ·æŠ–éŸ³åˆ·åˆ°ä¸€ä¸ªé¡¹ç›®ï¼Œå°±æ˜¯ä¸€ä¸ªå¯ä»¥å¢åŠ é¼ æ ‡åŠŸèƒ½çš„æ“ä½œã€‚å®ƒä¸ºé¼ æ ‡èµ‹äºˆäº†ä»¥ä¸‹æ“ä½œï¼š\n\n| Action          | + Target         | = Result                         |\n| --------------- | ---------------- | -------------------------------- |\n| Middle click    | + title bar      | = close window                   |\n| Right click     | + title bar      | = minimize window                |\n| Hold left click | + title bar      | = toggle window always on top    |\n| Double press    | + Esc key        | = close active window            |\n| Right click     | + taskbar button | = move pointer to \"Close window\" |\n\nè½¯ä»¶ä¸å¤§ï¼Œä¸»è¦ä½¿ç”¨ AutoHotKey è„šæœ¬è¿›è¡Œå¼€å‘ã€‚é¼ æ ‡å¿«æ·æ“ä½œæŒºå¥½ç”¨çš„ï¼Œå°¤å…¶æ˜¯ä¸­é”®å…³é—­çª—å£çš„æ“ä½œï¼Œç»Ÿä¸€äº†æµè§ˆå™¨å…³é—­æ ‡ç­¾é¡µçš„åŠ¨ä½œã€‚ä½†æ˜¯æˆ‘çœ‹ä¸­äº†å…¶ä¸­çš„è„šæœ¬è¯­è¨€ AutoHotKeyï¼Œæ„Ÿè§‰å®ƒå¾ˆæœ‰ç”¨å¤„ï¼Œé‚å†³å®šå‰–ææºç ï¼Œæå–å…¶ä¸­æ‰§è¡Œå¿«æ·æ“ä½œçš„æœ‰ç”¨è„šæœ¬è¿›è¡Œå­¦ä¹ ã€‚\n\nä»¥ä¸‹æ˜¯åŸé¡¹ç›®çš„åœ°å€ï¼š\n\n> [chaohershi/cclose: A Windows utility that helps you close windows faster or pin windows always on top. (github.com)](https://github.com/chaohershi/cclose/tree/master)\n\nåŸé¡¹ç›®çš„ AutoHotKey è„šæœ¬è¯­è¨€ç‰ˆæœ¬åº”è¯¥æ˜¯ V1ï¼Œä¸‹é¢æˆ‘å°†ç”¨ V2 ç‰ˆæœ¬è¿›è¡Œæ”¹å†™å¹¶å¯¹å…¶è¿›è¡Œäº†ç®€åŒ– ~~ï¼ˆğŸ˜¥ å…¶å®æ˜¯åˆ å»æˆ‘çœ‹ä¸æ‡‚ä½†å®é™…å½±å“ä¸å¤§çš„å†…å®¹ï¼‰~~ ã€‚è¯»è€…å¯ä»¥æ‘˜å–å…¶ä¸­çš„ç‰‡æ®µä½œä¸ºè‡ªå·±çš„è„šæœ¬ã€‚æ”¹è¿›ç‚¹ï¼š\n\n- AutoHotKey è¯­æ³•å‡çº§ï¼šä» V1 åˆ° V2\n- å¯ç”¨éƒ¨åˆ†å¿«æ·åŠŸèƒ½æœ‰æç¤º\n\nè§£æå¼€å§‹ ğŸ”½\n\n# å…¬å…±å‡½æ•°éƒ¨åˆ†\n\n```c\n#Requires AutoHotkey v2.0\n\n; æ£€æµ‹é¼ æ ‡æ˜¯å¦åœ¨æŒ‡å®šçš„WinTitleçª—å£ä¸­\nMouseIsOver(WinTitle)\n{\n\tMouseGetPos  , , &win\n\treturn WinExist(WinTitle \" ahk_id \" win)\n}\n\n; æ£€æµ‹é¼ æ ‡æ˜¯å¦æ‚¬åœåœ¨æ ‡é¢˜\nMouseIsOverTitlebar()\n{\n\tCoordMode \"Mouse\", \"Screen\"\n\tMouseGetPos &x, &y, &win\n    ; ç”¨äºå­˜å‚¨ç›®æ ‡çª—å£å·¦ä¸Šè§’çš„ X å’Œ Y åæ ‡çš„å˜é‡çš„å¼•ç”¨\n\tWinGetPos &xWin, &yWin, , , \"ahk_id \" win\n\n\tif WinExist(\"ahk_class Shell_TrayWnd ahk_id \" win) || WinExist(\"ahk_class Shell_SecondaryTrayWnd ahk_id \" win) ; exclude the taskbar\n\t{\n\t\treturn false\n\t}\n\telse if (y >= yWin && y < yWin + 30 * A_ScreenDPI / 96)\n    ; if within title bar width\n\t{\n        return true\n\t}\n    return false\n}\n\n; å±•ç¤º1sé’Ÿçš„æ ‡ç­¾\nShowToolTip(msg)\n{\n    ToolTip msg,,0\n    SetTimer () => ToolTip(), -1000\n}\n```\n\n# ç¬¬ä¸€éƒ¨åˆ† æ ‡é¢˜æ“ä½œ\n\n| Action          | + Target    | = Result                      |\n| --------------- | ----------- | ----------------------------- |\n| Middle click    | + title bar | = close window                |\n| Right click     | + title bar | = minimize window             |\n| Hold left click | + title bar | = toggle window always on top |\n\n```C\n#HotIf MouseIsOverTitlebar()\n; åŠŸèƒ½ï¼šé¼ æ ‡ä¸­é”®ç‚¹å‡»æ ‡é¢˜å…³é—­çª—å£\nMButton::\n{\n    ; alternative to WinClose, as WinClose is a somewhat forceful method, e.g., if multiple Microsoft Excel instances exist, WinClose will close them all at once.\n    ; 0x112 = WM_SYSCOMMAND, 0xF060 = SC_CLOSE https://autohotkey.com/docs/commands/WinClose.htm#Remarks\n    ; https://learn.microsoft.com/zh-cn/windows/win32/menurc/wm-syscommand\n    MouseGetPos  , , &win         ; æˆ‘åŠ çš„ï¼Œè¦ä¸ç„¶å®ƒä¸èµ·ä½œç”¨\n    PostMessage 0x112, 0xF060, , win\n    ShowToolTip(\"çª—å£å…³é—­\")\n}\n\n; åŠŸèƒ½ï¼šé¼ æ ‡å³é”®ç‚¹å‡»æ ‡é¢˜æœ€å°åŒ–çª—å£\nRButton::\n{\n    err_code := KeyWait(\"RButton\", \"T0.4\")\n    if(err_code = 0) ;è¶…æ—¶\n    {\n        Send \"{Click, Right}\" ; n.b., do not use Send {RButton}\n    }else{\n        ; https://learn.microsoft.com/zh-cn/windows/win32/menurc/wm-syscommand\n        MouseGetPos  , , &win           ; æˆ‘åŠ çš„ï¼Œè¦ä¸ç„¶å®ƒä¸èµ·ä½œç”¨\n        PostMessage 0x112, 0xF020, ,win ; alternative to WinMinimize\n        ShowToolTip(\"çª—å£æœ€å°åŒ–\")\n    }\n}\n\n; çª—å£ç½®é¡¶åŠŸèƒ½\n~LButton::\n{\n    CoordMode \"Mouse\", \"Screen\"\n    MouseGetPos &xOld, &yOld, &win\n    ExStyle := WinGetExStyle(win)\n    if (ExStyle & 0x8) ; 0x8 is WS_EX_TOPMOST\n    {\n        ExStyle := \"çª—å£å·²å–æ¶ˆç½®é¡¶\"\n    }\n    else\n    {\n        ExStyle := \"çª—å£å·²ç½®é¡¶\"\n    }\n    err_code := KeyWait(\"LButton\", \"T1\") ; wait for the left mouse button to be released with timeout set to 1 second\n    MouseGetPos &xNew, &yNew\n    if (xOld = xNew && yOld = yNew && err_code = 0) ; if the mouse did not move during the timeout period\n    {\n        WinSetAlwaysOnTop -1, \"A\" ; toggle window always on top\n        ShowToolTip(ExStyle)\n    }\n}\n```\n\n# ç¬¬äºŒéƒ¨åˆ† åŒå‡» Esc å…³é—­çª—å£\n\n| Action       | + Target  | = Result              |\n| ------------ | --------- | --------------------- |\n| Double press | + Esc key | = close active window |\n\n```C\n; åŠŸèƒ½ï¼šåŒå‡»Escå…³é—­çª—å£\n#HotIf\n~Esc::\n{\n    id_old := WinGetID(\"A\")\n    process_name := WinGetProcessName(\"A\")\n    KeyWait \"Esc\" ; wait for the Esc key to be released\n    err_code := KeyWait(\"Esc\", \"D T0.4\")\n    if (err_code = 1){\n        id_new := WinGetID(\"A\") ; get the window id after the Esc key has being pressed again\n        win_class := WinGetClass(\"A\")\n        if (id_old = id_new && win_class != \"Shell_TrayWnd\" && win_class != \"Shell_SecondaryTrayWnd\" && win_class != \"Progman\" && win_class != \"WorkerW\")\n        {\n            ; if the current window is the same one as before and is not taskbar or desktop\n            Send \"!{F4}\"\n        }\n    }\n}\n```\n\n# ç¬¬ä¸‰éƒ¨åˆ† å³å‡»ä»»åŠ¡æ \n\n| Action      | + Target         | = Result                         |\n| ----------- | ---------------- | -------------------------------- |\n| Right click | + taskbar button | = move pointer to \"Close window\" |\n\nå³å‡»ä»»åŠ¡æ åï¼Œå¦‚æœé¼ æ ‡è‡ªåŠ¨æ‚¬åœåœ¨å…³é—­çª—å£ä¸Šï¼š\n\n```C\n; åŠŸèƒ½ï¼Œå³å‡»ä»»åŠ¡æ å›¾æ ‡é¼ æ ‡è‡ªåŠ¨è·³è½¬åˆ°å…³é—­çª—å£\n#HotIf MouseIsOver(\"ahk_class Shell_TrayWnd\") || MouseIsOver(\"ahk_class Shell_SecondaryTrayWnd\") ; apply the following hotkey only when the mouse is over the taskbar\n~RButton:: ; when right clicked\n{\n    CoordMode \"Mouse\", \"Screen\"\n    MouseGetPos &xOld, &yOld\n    Sleep 500 ; wait for the Jump List to pop up, n.b., this line also helps to provide a uniform waiting experience\n    MouseGetPos &xNew, &yNew\n    CoordMode \"Mouse\", \"Window\"\n    if (Abs(xNew - xOld) < 8 && Abs(yNew - yOld) < 8) ; if the mouse did not move much\n    {\n        Loop 6\n        {\n            if WinActive(\"ahk_class Windows.UI.Core.CoreWindow\") ; if the Jump List pops up (right clicked on the taskbar app buttons)\n            {\n                WinGetPos , , &width, &height ; get the size of the last found window (Jump List)\n                MouseMove (width / 2), (height - 3 * width / 32), 10 ; move the mouse to the bottom of the Jump List (\"Close window\")\n                break\n            }\n            Sleep 250 ; wait for more time\n        }\n    }\n}\n```\n\n# æ€»ç»“\n\nä¸Šé¢çš„ç¤ºä¾‹ä»£ç å¯ä»¥ç»„æˆä¸€ä¸ª.ahk æ–‡ä»¶ï¼Œå®ç°æ‰€æœ‰ CClose çš„åŸºæœ¬åŠŸèƒ½ã€‚\n\nå¼€æœºè‡ªå¯åŠ¨æ–¹æ³•ï¼š\n\n1. Win+R æ‰“å¼€è¿è¡Œçª—å£ï¼Œè¾“å…¥ shell:startup\n2. æŠŠè„šæœ¬çš„å¿«æ·æ–¹å¼ä¸¢åˆ°é‡Œé¢å³å¯\n\næœªæ¥å¯ä»¥æ”¹è¿›çš„åœ°æ–¹ï¼š\n\n- [ ] æ§åˆ¶éƒ¨åˆ†åŠŸèƒ½çš„å¯ç”¨ä¸ç¦ç”¨ï¼ˆå¥½çš„ï¼Œåˆæˆ CClose çš„è½®å­ç‰ˆäº†ğŸ˜…ï¼‰\n- [ ] è¿›ä¸€æ­¥ï¼Œå¯¹è‡ªå·±çš„è„šæœ¬è¿›è¡Œæ§åˆ¶å’Œç®¡ç†\n- [ ] å¯¹ä½¿ç”¨äº†ç®¡ç†å‘˜æƒé™è¿è¡Œçš„ç³»ç»Ÿæ— æ•ˆ\n- [ ] çŠ¶æ€æ å›¾æ ‡æ”¹ä¸€ä¸‹\n- [ ] å­¦ä¹ åˆ¶ä½œä¸€ä¸ª Windows è½¯ä»¶\n\nç›®å‰å­˜åœ¨çš„é—®é¢˜ï¼š\n\n- [ ] åœ¨è¿è¡Œã€Šè’é‡å¤§é•–å®¢ 2ã€‹æ—¶éƒ¨åˆ†æƒ…å†µä¸‹ä¼šè§¦å‘ã€‚ä¼°è®¡å…¨å±æ¸¸æˆéƒ½ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ï¼Œå¾…ä¿®å¤å’Œæ”¹è¿›ã€‚","categories":[{"name":"æ ¸å¿ƒååŒ","api":"api/categories/æ ¸å¿ƒååŒ.json"},{"name":"è‡ªåŠ¨åŒ–","api":"api/categories/æ ¸å¿ƒååŒ/è‡ªåŠ¨åŒ–.json"}],"tags":[{"name":"CClose","api":"api/tags/CClose.json"},{"name":"å¿«æ·é”®","api":"api/tags/å¿«æ·é”®.json"},{"name":"é¼ æ ‡","api":"api/tags/é¼ æ ‡.json"},{"name":"AutoHotKey","api":"api/tags/AutoHotKey.json"}]},"api":"api/posts/p/c318939d.json"}