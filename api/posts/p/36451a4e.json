{"data":{"title":"使用 CDN 加速 WordPress 博客网站","slug":"Archive/OutOfDate/使用 CDN 加速 WordPress 博客网站","description":"使用CDN进行资源加速。以腾讯云CDN为例。","date":"2022-04-17T04:46:36.000Z","updated":"2024-12-12T18:01:36.701Z","language":"zh-CN","comments":true,"url":"p/36451a4e/","cover":"https://cdn.gallery.uuanqin.top/img/new-out-of-date-cover.png","images":[],"content":"\n<div class=\"callout\" data-callout=\"warning\">\n<div class=\"callout-title\">\n<div class=\"callout-title-icon\">\n<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"lucide lucide-alert-triangle\"><path d=\"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z\"/><path d=\"M12 9v4\"/><path d=\"M12 17h.01\"/></svg>\n</div>\n<div class=\"callout-title-inner\">这是一篇过期文章 <code>230824</code></div>\n</div>\n<div class=\"callout-content\"><p>本篇文章已过期。</p>\n<ul>\n<li>本文为网站早期文章，内容过于粗糙和简单</li>\n<li>站长已不再使用 Wordpress，文章停止维护</li>\n<li>PicGo 配置已随版本更新而变化</li>\n<li>部分内容已整合至其他文章中</li>\n</ul>\n</div></div><h1 id=\"为-wordpress-博客网站开启-cdn-加速\"><a class=\"markdownIt-Anchor\" href=\"#为-wordpress-博客网站开启-cdn-加速\"></a> 为 WordPress 博客网站开启 CDN 加速</h1>\n<p>服务器部署在阿里云，使用了腾讯云的 CDN 加速。</p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/202412130200776.webp\" alt=\"image.png\" /></p>\n<p>使用 CDN：<a href=\"https://cloud.tencent.com/document/product/228/3149\">内容分发网络 CDN 从零开始配置 CDN - 快速入门 - 文档中心 - 腾讯云 (tencent.com)</a></p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/QQ截图20220412210237.png\" alt=\"QQ截图20220412210237\" /></p>\n<p>源站配置应该像下图这样。如果选择 COS，那么还要去腾讯云那里接入备案，接入备案前提还要买它的服务器…</p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/image-47-1024x427.png\" alt=\"image-47-1024x427\" /></p>\n<p>如果网站支持 HTTPS，并开启了强制跳转，那么这里回源协议不用选 HTTPS。</p>\n<p>啊，关于 CDN 的理解，走了很多弯路，现提供以下网址进行学习：</p>\n<p><a href=\"https://cloud.tencent.com/developer/article/1959818\">使用腾讯CDN加速WordPress - 云+社区 - 腾讯云 (tencent.com)</a></p>\n<p><a href=\"https://cloud.tencent.com/document/product/228/41334\">内容分发网络 CDN 源站配置 - 配置指南 - 文档中心 - 腾讯云 (tencent.com)</a></p>\n<p><a href=\"https://help.aliyun.com/document_detail/40117.html\">CDN的配置回源HOST与源站的区别 (aliyun.com)</a></p>\n<p>提示：不管是在对 CDN 操作也好，还是对域名解析进行操作也好，都要等待一段时间才能生效。控制台提示操作成功了，也是要再等一会的。</p>\n<p>开启 CDN 的过程中，出现了登录问题，解决方案是（腾讯云）：</p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/image-42-1024x375.png\" alt=\"image-42-1024x375\" /></p>\n<p>参考：</p>\n<p><a href=\"https://blog.csdn.net/weixin_35521315/article/details/116098343\">php用cdn打不开,开启 CDN 后 wordpress 后台打不开的解决办法_柳不是刘的博客-CSDN博客</a></p>\n<p><a href=\"https://blog.csdn.net/meiqia888/article/details/115404498\">解决WordPress配置百度云CDN，后台无法登录问题_美洽技术的博客-CSDN博客</a></p>\n<p><a href=\"https://cloud.tencent.com/document/product/228/43672\">内容分发网络 CDN 域名接入常见问题 - 快速入门 - 文档中心 - 腾讯云 (tencent.com)</a></p>\n<p><a href=\"https://www.csdn.net/tags/MtTaIgwsMjQ4MTU3LWJsb2cO0O0O.html\">wordpress 不更新 加了CDN 用户购买 - CSDN</a></p>\n<h1 id=\"为-cos-开启-cdn\"><a class=\"markdownIt-Anchor\" href=\"#为-cos-开启-cdn\"></a> 为 COS 开启 CDN</h1>\n<p>如果需要对 COS 存储桶进行加速，我采用文档（<a href=\"https://cloud.tencent.com/document/product/436/18669\">对象存储 CDN 加速概述 - 开发者指南 - 文档中心 - 腾讯云 (tencent.com)</a>）提供的第一种方法，使用默认 CDN 加速域名进行加速。</p>\n<p>配置好后的配置图如下：</p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/image-45-1024x231.png\" alt=\"image-45-1024x231\" /></p>\n<p>如果平时在粘贴地址时使用了 PicGo 软件，注意在“使用自定义域名”这一栏填上默认 CDN 加速域名：</p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/image-46.png\" alt=\"\" /></p>\n<p>这样，在 PicGo 上传图片后得到的地址就是加速域名地址。</p>\n<p>参考：<a href=\"https://cloud.tencent.com/document/product/228/37849\">内容分发网络 CDN COS-CDN 计费说明 - 购买指南 - 文档中心 - 腾讯云 (tencent.com)</a></p>\n<p>上面两项做完结果：</p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/image-48-1024x148.png\" alt=\"\" /></p>\n<h1 id=\"问题\"><a class=\"markdownIt-Anchor\" href=\"#问题\"></a> 问题</h1>\n<p>如果页面缓存还是有点问题，比如编辑了文章后，查看文章时并没有刷新。进入文章页面没有显示用户登录等。目前还没想到比较好的解决方法，在腾讯云 <a href=\"https://console.cloud.tencent.com/cdn/refresh\">刷新预热-内容分发网络 - 控制台 (tencent.com)</a> 这里提交 URL 可以暂时的解决问题。</p>\n<p>尝试的解决方案：在 functions.php 下添加自动刷新腾讯云控制台 CDN 缓存的操作。不懂有没有用（来源：<a href=\"https://www.ly522.com/1506.html\">wordpress腾讯CDN缓存实现发布/更新文章/评论自动刷新-轻刻年轮 (ly522.com)</a>）。有用！有用！</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/* 需要填写你的密钥，访问 https://console.qcloud.com/capi 获取 SecretId 及 $secretKey */</span></span><br><span class=\"line\"><span class=\"variable\">$secretKey</span> = <span class=\"string\">&#x27;填写你的密钥&#x27;</span>;</span><br><span class=\"line\"><span class=\"variable\">$secretId</span> = <span class=\"string\">&#x27;填写你的密钥&#x27;</span>;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\">//更新或发布文章清理本文和首页CDN缓存</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">add_action</span>(<span class=\"string\">&#x27;publish_post&#x27;</span>, <span class=\"string\">&#x27;Clean_By_Publish&#x27;</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\">//提交评论更新本文CDN缓存</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">add_action</span>(<span class=\"string\">&#x27;comment_post&#x27;</span>, <span class=\"string\">&#x27;Clean_By_Comments&#x27;</span>,<span class=\"number\">0</span>);</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\">//评论被审核更新本文CDN缓存</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">add_action</span>(<span class=\"string\">&#x27;comment_unapproved_to_approved&#x27;</span>, <span class=\"string\">&#x27;Clean_By_Approved&#x27;</span>,<span class=\"number\">0</span>);</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\">//发布文章更新CDN缓存函数</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Clean_By_Publish</span>(<span class=\"params\"><span class=\"variable\">$post_ID</span></span>)</span>&#123;</span><br><span class=\"line\"><span class=\"keyword\">global</span> <span class=\"variable\">$secretKey</span>,<span class=\"variable\">$secretId</span>;</span><br><span class=\"line\"><span class=\"variable\">$url</span> = <span class=\"title function_ invoke__\">get_permalink</span>(<span class=\"variable\">$post_ID</span>);</span><br><span class=\"line\"><span class=\"variable\">$action</span>=<span class=\"string\">&#x27;RefreshCdnUrl&#x27;</span>;</span><br><span class=\"line\"><span class=\"comment\">/*要清理的页面，默认包含首页和文章页面，需要清理其他页面请自行发挥*/</span></span><br><span class=\"line\"><span class=\"variable\">$PRIVATE_PARAMS</span> = <span class=\"keyword\">array</span>(</span><br><span class=\"line\"><span class=\"string\">&#x27;urls.0&#x27;</span> =&gt; <span class=\"title function_ invoke__\">home_url</span>(),</span><br><span class=\"line\"><span class=\"string\">&#x27;urls.1&#x27;</span> =&gt; <span class=\"variable\">$url</span> ,</span><br><span class=\"line\">);</span><br><span class=\"line\"><span class=\"variable\">$HttpUrl</span>=<span class=\"string\">&quot;cdn.api.qcloud.com&quot;</span>;</span><br><span class=\"line\"><span class=\"comment\">/*除非有特殊说明，如MultipartUploadVodFile，其它接口都支持GET及POST*/</span></span><br><span class=\"line\"><span class=\"variable\">$HttpMethod</span>=<span class=\"string\">&quot;POST&quot;</span>;</span><br><span class=\"line\"><span class=\"comment\">/*是否https协议，大部分接口都必须为https，只有少部分接口除外（如MultipartUploadVodFile）*/</span></span><br><span class=\"line\"><span class=\"variable\">$isHttps</span> =<span class=\"literal\">true</span>;</span><br><span class=\"line\"><span class=\"comment\">/*下面这五个参数为所有接口的 公共参数；对于某些接口没有地域概念，则不用传递Region（如DescribeDeals）*/</span></span><br><span class=\"line\"><span class=\"variable\">$COMMON_PARAMS</span> = <span class=\"keyword\">array</span>(</span><br><span class=\"line\"><span class=\"string\">&#x27;Nonce&#x27;</span> =&gt; <span class=\"title function_ invoke__\">rand</span>(),</span><br><span class=\"line\"><span class=\"string\">&#x27;Timestamp&#x27;</span> =&gt;<span class=\"title function_ invoke__\">time</span>(<span class=\"literal\">NULL</span>),</span><br><span class=\"line\"><span class=\"string\">&#x27;Action&#x27;</span> =&gt;<span class=\"variable\">$action</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;SecretId&#x27;</span> =&gt; <span class=\"variable\">$secretId</span>,</span><br><span class=\"line\">);</span><br><span class=\"line\"><span class=\"comment\">/***********************************************************************************/</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">CreateRequest</span>(<span class=\"variable\">$HttpUrl</span>,<span class=\"variable\">$HttpMethod</span>,<span class=\"variable\">$COMMON_PARAMS</span>,<span class=\"variable\">$secretKey</span>, <span class=\"variable\">$PRIVATE_PARAMS</span>, <span class=\"variable\">$isHttps</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\">//提交评论清理文章CDN函数</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Clean_By_Comments</span>(<span class=\"params\"><span class=\"variable\">$comment_id</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\"><span class=\"keyword\">global</span> <span class=\"variable\">$secretKey</span>,<span class=\"variable\">$secretId</span>;</span><br><span class=\"line\"><span class=\"variable\">$comment</span> = <span class=\"title function_ invoke__\">get_comment</span>(<span class=\"variable\">$comment_id</span>);</span><br><span class=\"line\"><span class=\"variable\">$url</span> = <span class=\"title function_ invoke__\">get_permalink</span>(<span class=\"variable\">$comment</span>-&gt;comment_post_ID);</span><br><span class=\"line\"><span class=\"variable\">$action</span>=<span class=\"string\">&#x27;RefreshCdnUrl&#x27;</span>;</span><br><span class=\"line\"><span class=\"comment\">/*参数*/</span></span><br><span class=\"line\"><span class=\"variable\">$PRIVATE_PARAMS</span> = <span class=\"keyword\">array</span>(</span><br><span class=\"line\"><span class=\"string\">&#x27;urls.0&#x27;</span> =&gt; <span class=\"variable\">$url</span>,</span><br><span class=\"line\">);</span><br><span class=\"line\"><span class=\"variable\">$HttpUrl</span>=<span class=\"string\">&quot;cdn.api.qcloud.com&quot;</span>;</span><br><span class=\"line\"><span class=\"comment\">/*除非有特殊说明，如MultipartUploadVodFile，其它接口都支持GET及POST*/</span></span><br><span class=\"line\"><span class=\"variable\">$HttpMethod</span>=<span class=\"string\">&quot;POST&quot;</span>;</span><br><span class=\"line\"><span class=\"comment\">/*是否https协议，大部分接口都必须为https，只有少部分接口除外（如MultipartUploadVodFile）*/</span></span><br><span class=\"line\"><span class=\"variable\">$isHttps</span> =<span class=\"literal\">true</span>;</span><br><span class=\"line\"><span class=\"comment\">/*下面这五个参数为所有接口的 公共参数；对于某些接口没有地域概念，则不用传递Region（如DescribeDeals）*/</span></span><br><span class=\"line\"><span class=\"variable\">$COMMON_PARAMS</span> = <span class=\"keyword\">array</span>(</span><br><span class=\"line\"><span class=\"string\">&#x27;Nonce&#x27;</span> =&gt; <span class=\"title function_ invoke__\">rand</span>(),</span><br><span class=\"line\"><span class=\"string\">&#x27;Timestamp&#x27;</span> =&gt;<span class=\"title function_ invoke__\">time</span>(<span class=\"literal\">NULL</span>),</span><br><span class=\"line\"><span class=\"string\">&#x27;Action&#x27;</span> =&gt;<span class=\"variable\">$action</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;SecretId&#x27;</span> =&gt; <span class=\"variable\">$secretId</span>,</span><br><span class=\"line\">);</span><br><span class=\"line\"><span class=\"comment\">/***********************************************************************************/</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">CreateRequest</span>(<span class=\"variable\">$HttpUrl</span>,<span class=\"variable\">$HttpMethod</span>,<span class=\"variable\">$COMMON_PARAMS</span>,<span class=\"variable\">$secretKey</span>, <span class=\"variable\">$PRIVATE_PARAMS</span>, <span class=\"variable\">$isHttps</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\">//评论被审核清理CDN缓存函数</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Clean_By_Approved</span>(<span class=\"params\"><span class=\"variable\">$comment</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\"><span class=\"keyword\">global</span> <span class=\"variable\">$secretKey</span>,<span class=\"variable\">$secretId</span>;</span><br><span class=\"line\"><span class=\"variable\">$url</span> = <span class=\"title function_ invoke__\">get_permalink</span>(<span class=\"variable\">$comment</span>-&gt;comment_post_ID);</span><br><span class=\"line\"><span class=\"variable\">$action</span>=<span class=\"string\">&#x27;RefreshCdnUrl&#x27;</span>;</span><br><span class=\"line\"><span class=\"comment\">/*参数*/</span></span><br><span class=\"line\"><span class=\"variable\">$PRIVATE_PARAMS</span> = <span class=\"keyword\">array</span>(</span><br><span class=\"line\"><span class=\"string\">&#x27;urls.0&#x27;</span> =&gt; <span class=\"variable\">$url</span>,</span><br><span class=\"line\">);</span><br><span class=\"line\"><span class=\"variable\">$HttpUrl</span>=<span class=\"string\">&quot;cdn.api.qcloud.com&quot;</span>;</span><br><span class=\"line\"><span class=\"comment\">/*除非有特殊说明，如MultipartUploadVodFile，其它接口都支持GET及POST*/</span></span><br><span class=\"line\"><span class=\"variable\">$HttpMethod</span>=<span class=\"string\">&quot;POST&quot;</span>;</span><br><span class=\"line\"><span class=\"comment\">/*是否https协议，大部分接口都必须为https，只有少部分接口除外（如MultipartUploadVodFile）*/</span></span><br><span class=\"line\"><span class=\"variable\">$isHttps</span> =<span class=\"literal\">true</span>;</span><br><span class=\"line\"><span class=\"comment\">/*下面这五个参数为所有接口的 公共参数；对于某些接口没有地域概念，则不用传递Region（如DescribeDeals）*/</span></span><br><span class=\"line\"><span class=\"variable\">$COMMON_PARAMS</span> = <span class=\"keyword\">array</span>(</span><br><span class=\"line\"><span class=\"string\">&#x27;Nonce&#x27;</span> =&gt; <span class=\"title function_ invoke__\">rand</span>(),</span><br><span class=\"line\"><span class=\"string\">&#x27;Timestamp&#x27;</span> =&gt;<span class=\"title function_ invoke__\">time</span>(<span class=\"literal\">NULL</span>),</span><br><span class=\"line\"><span class=\"string\">&#x27;Action&#x27;</span> =&gt;<span class=\"variable\">$action</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;SecretId&#x27;</span> =&gt; <span class=\"variable\">$secretId</span>,</span><br><span class=\"line\">);</span><br><span class=\"line\"><span class=\"comment\">/***********************************************************************************/</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">CreateRequest</span>(<span class=\"variable\">$HttpUrl</span>,<span class=\"variable\">$HttpMethod</span>,<span class=\"variable\">$COMMON_PARAMS</span>,<span class=\"variable\">$secretKey</span>, <span class=\"variable\">$PRIVATE_PARAMS</span>, <span class=\"variable\">$isHttps</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\">//请求主函数，无需改动</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">CreateRequest</span>(<span class=\"params\"><span class=\"variable\">$HttpUrl</span>,<span class=\"variable\">$HttpMethod</span>,<span class=\"variable\">$COMMON_PARAMS</span>,<span class=\"variable\">$secretKey</span>, <span class=\"variable\">$PRIVATE_PARAMS</span>, <span class=\"variable\">$isHttps</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\"><span class=\"variable\">$FullHttpUrl</span> = <span class=\"variable\">$HttpUrl</span>.<span class=\"string\">&quot;/v2/index.php&quot;</span>;</span><br><span class=\"line\"><span class=\"comment\">/***************对请求参数 按参数名 做字典序升序排列，注意此排序区分大小写*************/</span></span><br><span class=\"line\"><span class=\"variable\">$ReqParaArray</span> = <span class=\"title function_ invoke__\">array_merge</span>(<span class=\"variable\">$COMMON_PARAMS</span>, <span class=\"variable\">$PRIVATE_PARAMS</span>);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">ksort</span>(<span class=\"variable\">$ReqParaArray</span>);</span><br><span class=\"line\"><span class=\"comment\">/**********************************生成签名原文**********************************</span></span><br><span class=\"line\"><span class=\"comment\">* 将 请求方法, URI地址,及排序好的请求参数 按照下面格式 拼接在一起, 生成签名原文，此请求中的原文为</span></span><br><span class=\"line\"><span class=\"comment\">* GETcvm.api.qcloud.com/v2/index.php?Action=DescribeInstances&amp;Nonce=345122&amp;Region=gz</span></span><br><span class=\"line\"><span class=\"comment\">* &amp;SecretId=AKIDz8krbsJ5yKBZQ ·1pn74WFkmLPx3gnPhESA&amp;Timestamp=1408704141</span></span><br><span class=\"line\"><span class=\"comment\">* &amp;instanceIds.0=qcvm12345&amp;instanceIds.1=qcvm56789</span></span><br><span class=\"line\"><span class=\"comment\">* ****************************************************************************/</span></span><br><span class=\"line\"><span class=\"variable\">$SigTxt</span> = <span class=\"variable\">$HttpMethod</span>.<span class=\"variable\">$FullHttpUrl</span>.<span class=\"string\">&quot;?&quot;</span>;</span><br><span class=\"line\"><span class=\"variable\">$isFirst</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\"><span class=\"keyword\">foreach</span> (<span class=\"variable\">$ReqParaArray</span> <span class=\"keyword\">as</span> <span class=\"variable\">$key</span> =&gt; <span class=\"variable\">$value</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (!<span class=\"variable\">$isFirst</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"variable\">$SigTxt</span> = <span class=\"variable\">$SigTxt</span>.<span class=\"string\">&quot;&amp;&quot;</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"variable\">$isFirst</span>= <span class=\"literal\">false</span>;</span><br><span class=\"line\"><span class=\"comment\">/*拼接签名原文时，如果参数名称中携带_，需要替换成.*/</span></span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"title function_ invoke__\">strpos</span>(<span class=\"variable\">$key</span>, <span class=\"string\">&#x27;_&#x27;</span>))</span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"variable\">$key</span> = <span class=\"title function_ invoke__\">str_replace</span>(<span class=\"string\">&#x27;_&#x27;</span>, <span class=\"string\">&#x27;.&#x27;</span>, <span class=\"variable\">$key</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"variable\">$SigTxt</span>=<span class=\"variable\">$SigTxt</span>.<span class=\"variable\">$key</span>.<span class=\"string\">&quot;=&quot;</span>.<span class=\"variable\">$value</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/*********************根据签名原文字符串 $SigTxt，生成签名 Signature******************/</span></span><br><span class=\"line\"><span class=\"variable\">$Signature</span> = <span class=\"title function_ invoke__\">base64_encode</span>(<span class=\"title function_ invoke__\">hash_hmac</span>(<span class=\"string\">&#x27;sha1&#x27;</span>, <span class=\"variable\">$SigTxt</span>, <span class=\"variable\">$secretKey</span>, <span class=\"literal\">true</span>));</span><br><span class=\"line\"><span class=\"comment\">/***************拼接请求串,对于请求参数及签名，需要进行urlencode编码********************/</span></span><br><span class=\"line\"><span class=\"variable\">$Req</span> = <span class=\"string\">&quot;Signature=&quot;</span>.<span class=\"title function_ invoke__\">urlencode</span>(<span class=\"variable\">$Signature</span>);</span><br><span class=\"line\"><span class=\"keyword\">foreach</span> (<span class=\"variable\">$ReqParaArray</span> <span class=\"keyword\">as</span> <span class=\"variable\">$key</span> =&gt; <span class=\"variable\">$value</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"variable\">$Req</span>=<span class=\"variable\">$Req</span>.<span class=\"string\">&quot;&amp;&quot;</span>.<span class=\"variable\">$key</span>.<span class=\"string\">&quot;=&quot;</span>.<span class=\"title function_ invoke__\">urlencode</span>(<span class=\"variable\">$value</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/*********************************发送请求********************************/</span></span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"variable\">$HttpMethod</span> === <span class=\"string\">&#x27;GET&#x27;</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"variable\">$isHttps</span> === <span class=\"literal\">true</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"variable\">$Req</span>=<span class=\"string\">&quot;https://&quot;</span>.<span class=\"variable\">$FullHttpUrl</span>.<span class=\"string\">&quot;?&quot;</span>.<span class=\"variable\">$Req</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"variable\">$Req</span>=<span class=\"string\">&quot;http://&quot;</span>.<span class=\"variable\">$FullHttpUrl</span>.<span class=\"string\">&quot;?&quot;</span>.<span class=\"variable\">$Req</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"variable\">$Rsp</span> = <span class=\"title function_ invoke__\">file_get_contents</span>(<span class=\"variable\">$Req</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"variable\">$isHttps</span> === <span class=\"literal\">true</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"variable\">$Rsp</span>= <span class=\"title function_ invoke__\">SendPost</span>(<span class=\"string\">&quot;https://&quot;</span>.<span class=\"variable\">$FullHttpUrl</span>,<span class=\"variable\">$Req</span>,<span class=\"variable\">$isHttps</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"variable\">$Rsp</span>= <span class=\"title function_ invoke__\">SendPost</span>(<span class=\"string\">&quot;http://&quot;</span>.<span class=\"variable\">$FullHttpUrl</span>,<span class=\"variable\">$Req</span>,<span class=\"variable\">$isHttps</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//var_export(json_decode($Rsp,true));</span></span><br><span class=\"line\"><span class=\"keyword\">return</span> <span class=\"title function_ invoke__\">json_decode</span>(<span class=\"variable\">$Rsp</span>,<span class=\"literal\">true</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">SendPost</span>(<span class=\"params\"><span class=\"variable\">$FullHttpUrl</span>, <span class=\"variable\">$Req</span>, <span class=\"variable\">$isHttps</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\"><span class=\"variable\">$ch</span> = <span class=\"title function_ invoke__\">curl_init</span>();</span><br><span class=\"line\"><span class=\"title function_ invoke__\">curl_setopt</span>(<span class=\"variable\">$ch</span>, CURLOPT_POST, <span class=\"number\">1</span>);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">curl_setopt</span>(<span class=\"variable\">$ch</span>, CURLOPT_POSTFIELDS, <span class=\"variable\">$Req</span>);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">curl_setopt</span>(<span class=\"variable\">$ch</span>, CURLOPT_URL, <span class=\"variable\">$FullHttpUrl</span>);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">curl_setopt</span>(<span class=\"variable\">$ch</span>, CURLOPT_RETURNTRANSFER, <span class=\"number\">1</span>);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">curl_setopt</span>(<span class=\"variable\">$ch</span>, CURLOPT_TIMEOUT, <span class=\"number\">1</span> );</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"variable\">$isHttps</span> === <span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\"><span class=\"title function_ invoke__\">curl_setopt</span>(<span class=\"variable\">$ch</span>, CURLOPT_SSL_VERIFYPEER, <span class=\"literal\">false</span>);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">curl_setopt</span>(<span class=\"variable\">$ch</span>, CURLOPT_SSL_VERIFYHOST, <span class=\"literal\">false</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"variable\">$result</span> = <span class=\"title function_ invoke__\">curl_exec</span>(<span class=\"variable\">$ch</span>);</span><br><span class=\"line\"><span class=\"keyword\">return</span> <span class=\"variable\">$result</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","raw":"---\ntitle: 使用 CDN 加速 WordPress 博客网站\ntags:\n  - CDN\n  - COS\n  - PicGo\n  - 对象存储\n  - 腾讯云\ncategories:\n  - Archive\n  - OutOfDate\ndescription: 使用CDN进行资源加速。以腾讯云CDN为例。\ncover: 'https://cdn.gallery.uuanqin.top/img/new-out-of-date-cover.png'\nabbrlink: 36451a4e\ndate: 2022-04-17 12:46:36\n---\n\n> [!warning] 这是一篇过期文章 `230824`\n> 本篇文章已过期。\n>\n> - 本文为网站早期文章，内容过于粗糙和简单\n> - 站长已不再使用 Wordpress，文章停止维护\n> - PicGo 配置已随版本更新而变化\n> - 部分内容已整合至其他文章中\n\n# 为 WordPress 博客网站开启 CDN 加速\n\n服务器部署在阿里云，使用了腾讯云的 CDN 加速。\n\n![image.png](https://cdn.gallery.uuanqin.top/img/202412130200776.webp)\n\n使用 CDN：[内容分发网络 CDN 从零开始配置 CDN - 快速入门 - 文档中心 - 腾讯云 (tencent.com)](https://cloud.tencent.com/document/product/228/3149)\n\n![QQ截图20220412210237](https://cdn.gallery.uuanqin.top/img/QQ%E6%88%AA%E5%9B%BE20220412210237.png)\n\n源站配置应该像下图这样。如果选择 COS，那么还要去腾讯云那里接入备案，接入备案前提还要买它的服务器...\n\n![image-47-1024x427](https://cdn.gallery.uuanqin.top/img/image-47-1024x427.png)\n\n如果网站支持 HTTPS，并开启了强制跳转，那么这里回源协议不用选 HTTPS。\n\n啊，关于 CDN 的理解，走了很多弯路，现提供以下网址进行学习：\n\n[使用腾讯CDN加速WordPress - 云+社区 - 腾讯云 (tencent.com)](https://cloud.tencent.com/developer/article/1959818)\n\n[内容分发网络 CDN 源站配置 - 配置指南 - 文档中心 - 腾讯云 (tencent.com)](https://cloud.tencent.com/document/product/228/41334)\n\n[CDN的配置回源HOST与源站的区别 (aliyun.com)](https://help.aliyun.com/document_detail/40117.html)\n\n提示：不管是在对 CDN 操作也好，还是对域名解析进行操作也好，都要等待一段时间才能生效。控制台提示操作成功了，也是要再等一会的。\n\n开启 CDN 的过程中，出现了登录问题，解决方案是（腾讯云）：\n\n![image-42-1024x375](https://cdn.gallery.uuanqin.top/img/image-42-1024x375.png)\n\n参考：\n\n[php用cdn打不开,开启 CDN 后 wordpress 后台打不开的解决办法\\_柳不是刘的博客-CSDN博客](https://blog.csdn.net/weixin_35521315/article/details/116098343)\n\n[解决WordPress配置百度云CDN，后台无法登录问题\\_美洽技术的博客-CSDN博客](https://blog.csdn.net/meiqia888/article/details/115404498)\n\n[内容分发网络 CDN 域名接入常见问题 - 快速入门 - 文档中心 - 腾讯云 (tencent.com)](https://cloud.tencent.com/document/product/228/43672)\n\n[wordpress 不更新 加了CDN 用户购买 - CSDN](https://www.csdn.net/tags/MtTaIgwsMjQ4MTU3LWJsb2cO0O0O.html)\n\n# 为 COS 开启 CDN\n\n如果需要对 COS 存储桶进行加速，我采用文档（[对象存储 CDN 加速概述 - 开发者指南 - 文档中心 - 腾讯云 (tencent.com)](https://cloud.tencent.com/document/product/436/18669)）提供的第一种方法，使用默认 CDN 加速域名进行加速。\n\n配置好后的配置图如下：\n\n![image-45-1024x231](https://cdn.gallery.uuanqin.top/img/image-45-1024x231.png)\n\n如果平时在粘贴地址时使用了 PicGo 软件，注意在“使用自定义域名”这一栏填上默认 CDN 加速域名：\n\n![](https://cdn.gallery.uuanqin.top/img/image-46.png)\n\n这样，在 PicGo 上传图片后得到的地址就是加速域名地址。\n\n参考：[内容分发网络 CDN COS-CDN 计费说明 - 购买指南 - 文档中心 - 腾讯云 (tencent.com)](https://cloud.tencent.com/document/product/228/37849)\n\n上面两项做完结果：\n\n![](https://cdn.gallery.uuanqin.top/img/image-48-1024x148.png)\n\n# 问题\n\n如果页面缓存还是有点问题，比如编辑了文章后，查看文章时并没有刷新。进入文章页面没有显示用户登录等。目前还没想到比较好的解决方法，在腾讯云 [刷新预热-内容分发网络 - 控制台 (tencent.com)](https://console.cloud.tencent.com/cdn/refresh) 这里提交 URL 可以暂时的解决问题。\n\n尝试的解决方案：在 functions.php 下添加自动刷新腾讯云控制台 CDN 缓存的操作。不懂有没有用（来源：[wordpress腾讯CDN缓存实现发布/更新文章/评论自动刷新-轻刻年轮 (ly522.com)](https://www.ly522.com/1506.html)）。有用！有用！\n\n```php\n/* 需要填写你的密钥，访问 https://console.qcloud.com/capi 获取 SecretId 及 $secretKey */\n$secretKey = '填写你的密钥';\n$secretId = '填写你的密钥';\n \n//更新或发布文章清理本文和首页CDN缓存\nadd_action('publish_post', 'Clean_By_Publish', 0);\n \n//提交评论更新本文CDN缓存\nadd_action('comment_post', 'Clean_By_Comments',0);\n \n//评论被审核更新本文CDN缓存\nadd_action('comment_unapproved_to_approved', 'Clean_By_Approved',0);\n \n//发布文章更新CDN缓存函数\nfunction Clean_By_Publish($post_ID){\nglobal $secretKey,$secretId;\n$url = get_permalink($post_ID);\n$action='RefreshCdnUrl';\n/*要清理的页面，默认包含首页和文章页面，需要清理其他页面请自行发挥*/\n$PRIVATE_PARAMS = array(\n'urls.0' => home_url(),\n'urls.1' => $url ,\n);\n$HttpUrl=\"cdn.api.qcloud.com\";\n/*除非有特殊说明，如MultipartUploadVodFile，其它接口都支持GET及POST*/\n$HttpMethod=\"POST\";\n/*是否https协议，大部分接口都必须为https，只有少部分接口除外（如MultipartUploadVodFile）*/\n$isHttps =true;\n/*下面这五个参数为所有接口的 公共参数；对于某些接口没有地域概念，则不用传递Region（如DescribeDeals）*/\n$COMMON_PARAMS = array(\n'Nonce' => rand(),\n'Timestamp' =>time(NULL),\n'Action' =>$action,\n'SecretId' => $secretId,\n);\n/***********************************************************************************/\nCreateRequest($HttpUrl,$HttpMethod,$COMMON_PARAMS,$secretKey, $PRIVATE_PARAMS, $isHttps);\n}\n \n//提交评论清理文章CDN函数\nfunction Clean_By_Comments($comment_id)\n{\nglobal $secretKey,$secretId;\n$comment = get_comment($comment_id);\n$url = get_permalink($comment->comment_post_ID);\n$action='RefreshCdnUrl';\n/*参数*/\n$PRIVATE_PARAMS = array(\n'urls.0' => $url,\n);\n$HttpUrl=\"cdn.api.qcloud.com\";\n/*除非有特殊说明，如MultipartUploadVodFile，其它接口都支持GET及POST*/\n$HttpMethod=\"POST\";\n/*是否https协议，大部分接口都必须为https，只有少部分接口除外（如MultipartUploadVodFile）*/\n$isHttps =true;\n/*下面这五个参数为所有接口的 公共参数；对于某些接口没有地域概念，则不用传递Region（如DescribeDeals）*/\n$COMMON_PARAMS = array(\n'Nonce' => rand(),\n'Timestamp' =>time(NULL),\n'Action' =>$action,\n'SecretId' => $secretId,\n);\n/***********************************************************************************/\nCreateRequest($HttpUrl,$HttpMethod,$COMMON_PARAMS,$secretKey, $PRIVATE_PARAMS, $isHttps);\n}\n \n//评论被审核清理CDN缓存函数\nfunction Clean_By_Approved($comment)\n{\nglobal $secretKey,$secretId;\n$url = get_permalink($comment->comment_post_ID);\n$action='RefreshCdnUrl';\n/*参数*/\n$PRIVATE_PARAMS = array(\n'urls.0' => $url,\n);\n$HttpUrl=\"cdn.api.qcloud.com\";\n/*除非有特殊说明，如MultipartUploadVodFile，其它接口都支持GET及POST*/\n$HttpMethod=\"POST\";\n/*是否https协议，大部分接口都必须为https，只有少部分接口除外（如MultipartUploadVodFile）*/\n$isHttps =true;\n/*下面这五个参数为所有接口的 公共参数；对于某些接口没有地域概念，则不用传递Region（如DescribeDeals）*/\n$COMMON_PARAMS = array(\n'Nonce' => rand(),\n'Timestamp' =>time(NULL),\n'Action' =>$action,\n'SecretId' => $secretId,\n);\n/***********************************************************************************/\nCreateRequest($HttpUrl,$HttpMethod,$COMMON_PARAMS,$secretKey, $PRIVATE_PARAMS, $isHttps);\n}\n \n//请求主函数，无需改动\nfunction CreateRequest($HttpUrl,$HttpMethod,$COMMON_PARAMS,$secretKey, $PRIVATE_PARAMS, $isHttps)\n{\n$FullHttpUrl = $HttpUrl.\"/v2/index.php\";\n/***************对请求参数 按参数名 做字典序升序排列，注意此排序区分大小写*************/\n$ReqParaArray = array_merge($COMMON_PARAMS, $PRIVATE_PARAMS);\nksort($ReqParaArray);\n/**********************************生成签名原文**********************************\n* 将 请求方法, URI地址,及排序好的请求参数 按照下面格式 拼接在一起, 生成签名原文，此请求中的原文为\n* GETcvm.api.qcloud.com/v2/index.php?Action=DescribeInstances&Nonce=345122&Region=gz\n* &SecretId=AKIDz8krbsJ5yKBZQ ·1pn74WFkmLPx3gnPhESA&Timestamp=1408704141\n* &instanceIds.0=qcvm12345&instanceIds.1=qcvm56789\n* ****************************************************************************/\n$SigTxt = $HttpMethod.$FullHttpUrl.\"?\";\n$isFirst = true;\nforeach ($ReqParaArray as $key => $value)\n{\nif (!$isFirst)\n{\n$SigTxt = $SigTxt.\"&\";\n}\n$isFirst= false;\n/*拼接签名原文时，如果参数名称中携带_，需要替换成.*/\nif(strpos($key, '_'))\n{\n$key = str_replace('_', '.', $key);\n}\n$SigTxt=$SigTxt.$key.\"=\".$value;\n}\n/*********************根据签名原文字符串 $SigTxt，生成签名 Signature******************/\n$Signature = base64_encode(hash_hmac('sha1', $SigTxt, $secretKey, true));\n/***************拼接请求串,对于请求参数及签名，需要进行urlencode编码********************/\n$Req = \"Signature=\".urlencode($Signature);\nforeach ($ReqParaArray as $key => $value)\n{\n$Req=$Req.\"&\".$key.\"=\".urlencode($value);\n}\n/*********************************发送请求********************************/\nif($HttpMethod === 'GET')\n{\nif($isHttps === true)\n{\n$Req=\"https://\".$FullHttpUrl.\"?\".$Req;\n}\nelse\n{\n$Req=\"http://\".$FullHttpUrl.\"?\".$Req;\n}\n$Rsp = file_get_contents($Req);\n}\nelse\n{\nif($isHttps === true)\n{\n$Rsp= SendPost(\"https://\".$FullHttpUrl,$Req,$isHttps);\n}\nelse\n{\n$Rsp= SendPost(\"http://\".$FullHttpUrl,$Req,$isHttps);\n}\n}\n//var_export(json_decode($Rsp,true));\nreturn json_decode($Rsp,true);\n}\nfunction SendPost($FullHttpUrl, $Req, $isHttps)\n{\n$ch = curl_init();\ncurl_setopt($ch, CURLOPT_POST, 1);\ncurl_setopt($ch, CURLOPT_POSTFIELDS, $Req);\ncurl_setopt($ch, CURLOPT_URL, $FullHttpUrl);\ncurl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);\ncurl_setopt($ch, CURLOPT_TIMEOUT, 1 );\nif ($isHttps === true) {\ncurl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);\ncurl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false);\n}\n$result = curl_exec($ch);\nreturn $result;\n}\n```","categories":[{"name":"Archive","api":"api/categories/Archive.json"},{"name":"OutOfDate","api":"api/categories/Archive/OutOfDate.json"}],"tags":[{"name":"CDN","api":"api/tags/CDN.json"},{"name":"腾讯云","api":"api/tags/腾讯云.json"},{"name":"COS","api":"api/tags/COS.json"},{"name":"对象存储","api":"api/tags/对象存储.json"},{"name":"PicGo","api":"api/tags/PicGo.json"}]},"api":"api/posts/p/36451a4e.json"}