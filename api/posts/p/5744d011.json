{"data":{"title":"对电脑端微信小程序抓包","slug":"核心协同/对电脑端微信小程序抓包","description":"关闸远离我","date":"2024-04-17T14:54:39.000Z","updated":"2024-11-01T18:30:21.751Z","language":"zh-CN","comments":true,"url":"p/5744d011/","cover":"https://cdn.gallery.uuanqin.top/img/20240417234049.webp","images":[],"content":"\n<div class=\"callout\" data-callout=\"warning\">\n<div class=\"callout-title\">\n<div class=\"callout-title-icon\">\n<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"lucide lucide-alert-triangle\"><path d=\"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z\"/><path d=\"M12 9v4\"/><path d=\"M12 17h.01\"/></svg>\n</div>\n<div class=\"callout-title-inner\">免责声明：本文仅供学习和交流，切勿用于违法行为。本文作者不对读者的不当使用负责。</div>\n</div>\n<div class=\"callout-content\"><p></p>\n</div></div><p>起因是我所住的宿舍水电费用得很快，不知道什么时候欠费就把闸给关了。我们交电费和查电费是通过微信小程序进行的，想想能不能抓到 API 地址，以后派爬虫定时去查。避免关闸情况的发生。</p>\n<p>前期简单调研了解到直接通过电脑抓手机的包可能有点麻烦，现尝试能不能通过在电脑上登录小程序抓取我们需要的东西。</p>\n<p>这篇文章就以获取某小程序余额数据为例演示电脑抓包过程。</p>\n<h1 id=\"准备工作\"><a class=\"markdownIt-Anchor\" href=\"#准备工作\"></a> 准备工作</h1>\n<p>软件安装：</p>\n<ul>\n<li><a href=\"https://www.charlesproxy.com/latest-release/download.do\">Charles</a>（30 天试用，应该有破解版）</li>\n<li><a href=\"https://portswigger.net/burp/releases/professional-community-2024-2-1-5\">Burp Suite</a>（下载社区版应该不要钱）</li>\n</ul>\n<blockquote>\n<p>实测：N 个月后软件还能用，起码这篇文章的操作是可以完成的。</p>\n</blockquote>\n<p>然后看一下电脑端小程序能不能正常查询水电费余额：</p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/20240417230300.webp\" alt=\"image.png\" width=\"300px\" /></p>\n<h1 id=\"charles-软件中的操作\"><a class=\"markdownIt-Anchor\" href=\"#charles-软件中的操作\"></a> Charles 软件中的操作</h1>\n<p>如下图所示安装证书：</p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/20240417231307.webp\" alt=\"image.png\" width=\"500px\" /></p>\n<p>安装到受信任的根证书颁发机构：</p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/20240417231541.webp\" alt=\"image.png\" /></p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/20240417231610.webp\" alt=\"image.png\" /></p>\n<p>接下来配置代理：</p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/20240417231656.webp\" alt=\"image.png\" width=\"350px\" /></p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/20240417231721.webp\" alt=\"image.png\" width=\"500px\" /></p>\n<p>接下来配置 SSL 代理设置：</p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/20240417231753.webp\" alt=\"image.png\" width=\"375px\" /></p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/20240417231842.webp\" alt=\"image.png\" width=\"500px\" /></p>\n<p><code>*</code> 是代表抓取任意端口和域名，如果只抓取固定的端口 or 域名可自行设置。</p>\n<p>接下来配置将数据包代理到 BurpSuite：</p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/20240417231941.webp\" alt=\"image.png\" width=\"375px\" /></p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/20240417232026.webp\" alt=\"image.png\" width=\"500px\" /></p>\n<p>注意，Web Proxy（HTTP）和 Secure Web Peoxy（HTTPS）都需要填写 127.0.0.1 以及端口（这里填的都是 8091），这和后续配置 BurpSuite 代理的端口一致。</p>\n<h1 id=\"burp-suite-软件中的操作\"><a class=\"markdownIt-Anchor\" href=\"#burp-suite-软件中的操作\"></a> Burp Suite 软件中的操作</h1>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/20240417232205.webp\" alt=\"image.png\" width=\"500px\" /></p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/20240417232219.webp\" alt=\"image.png\" width=\"500px\" /></p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/20240417232714.webp\" alt=\"image.png\" /></p>\n<p>接下来你就可以在拦截历史中抓到包了：</p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/20240417232835.webp\" alt=\"image.png\" width=\"500px\" /></p>\n<p>通过返回的数据可以精准定位我们需要的 GET 参数。</p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/20240417233412.webp\" alt=\"image.png\" /></p>\n<h1 id=\"本文参考\"><a class=\"markdownIt-Anchor\" href=\"#本文参考\"></a> 本文参考</h1>\n<ul>\n<li><a href=\"https://zhuanlan.zhihu.com/p/663596907\">【Windows】 一个能用的微信小程序抓包方式（亲测） - 知乎 (zhihu.com)</a></li>\n</ul>\n","raw":"---\ntitle: 对电脑端微信小程序抓包\ntags:\n  - 微信小程序\n  - 微信\n  - Charles\n  - Burp\ncover: 'https://cdn.gallery.uuanqin.top/img/20240417234049.webp'\ndescription: 关闸远离我\nabbrlink: 5744d011\ncategories:\n  - 核心协同\ndate: 2024-04-17 22:54:39\ntop_img:\n---\n\n> [!warning] 免责声明：本文仅供学习和交流，切勿用于违法行为。本文作者不对读者的不当使用负责。\n\n起因是我所住的宿舍水电费用得很快，不知道什么时候欠费就把闸给关了。我们交电费和查电费是通过微信小程序进行的，想想能不能抓到 API 地址，以后派爬虫定时去查。避免关闸情况的发生。\n\n前期简单调研了解到直接通过电脑抓手机的包可能有点麻烦，现尝试能不能通过在电脑上登录小程序抓取我们需要的东西。\n\n这篇文章就以获取某小程序余额数据为例演示电脑抓包过程。\n\n# 准备工作\n\n软件安装：\n\n- [Charles](https://www.charlesproxy.com/latest-release/download.do)（30 天试用，应该有破解版）\n- [Burp Suite](https://portswigger.net/burp/releases/professional-community-2024-2-1-5)（下载社区版应该不要钱）\n\n> 实测：N 个月后软件还能用，起码这篇文章的操作是可以完成的。\n\n然后看一下电脑端小程序能不能正常查询水电费余额：\n\n![image.png|300](https://cdn.gallery.uuanqin.top/img/20240417230300.webp)\n\n# Charles 软件中的操作\n\n如下图所示安装证书：\n\n![image.png|500](https://cdn.gallery.uuanqin.top/img/20240417231307.webp)\n\n安装到受信任的根证书颁发机构：\n\n![image.png](https://cdn.gallery.uuanqin.top/img/20240417231541.webp)\n\n![image.png](https://cdn.gallery.uuanqin.top/img/20240417231610.webp)\n\n接下来配置代理：\n\n![image.png|350](https://cdn.gallery.uuanqin.top/img/20240417231656.webp)\n\n![image.png|500](https://cdn.gallery.uuanqin.top/img/20240417231721.webp)\n\n接下来配置 SSL 代理设置：\n\n![image.png|375](https://cdn.gallery.uuanqin.top/img/20240417231753.webp)\n\n![image.png|500](https://cdn.gallery.uuanqin.top/img/20240417231842.webp)\n\n`*` 是代表抓取任意端口和域名，如果只抓取固定的端口 or 域名可自行设置。\n\n接下来配置将数据包代理到 BurpSuite：\n\n![image.png|375](https://cdn.gallery.uuanqin.top/img/20240417231941.webp)\n\n![image.png|500](https://cdn.gallery.uuanqin.top/img/20240417232026.webp)\n\n注意，Web Proxy（HTTP）和 Secure Web Peoxy（HTTPS）都需要填写 127.0.0.1 以及端口（这里填的都是 8091），这和后续配置 BurpSuite 代理的端口一致。\n\n# Burp Suite 软件中的操作\n\n![image.png|500](https://cdn.gallery.uuanqin.top/img/20240417232205.webp)\n\n![image.png|500](https://cdn.gallery.uuanqin.top/img/20240417232219.webp)\n\n![image.png](https://cdn.gallery.uuanqin.top/img/20240417232714.webp)\n\n接下来你就可以在拦截历史中抓到包了：\n\n![image.png|500](https://cdn.gallery.uuanqin.top/img/20240417232835.webp)\n\n通过返回的数据可以精准定位我们需要的 GET 参数。\n\n![image.png](https://cdn.gallery.uuanqin.top/img/20240417233412.webp)\n\n# 本文参考\n- [【Windows】 一个能用的微信小程序抓包方式（亲测） - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/663596907)\n","categories":[{"name":"核心协同","api":"api/categories/核心协同.json"}],"tags":[{"name":"微信小程序","api":"api/tags/微信小程序.json"},{"name":"微信","api":"api/tags/微信.json"},{"name":"Charles","api":"api/tags/Charles.json"},{"name":"Burp","api":"api/tags/Burp.json"}]},"api":"api/posts/p/5744d011.json"}