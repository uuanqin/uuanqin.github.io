{"data":{"title":"学会通过看文档配置 Butterfly 主题中的 Waline 客户端","slug":"博客站点维护/Waline/学会通过看文档配置 Butterfly 主题中的 Waline 客户端","description":"授人以渔","date":"2023-04-28T08:15:12.000Z","updated":"2026-02-01T08:42:42.022Z","language":"zh-CN","comments":true,"url":"p/eeb2ee0e/","cover":"https://cdn.gallery.uuanqin.top/img/diy-waline.png","images":[],"content":"\n<div class=\"callout\" data-callout=\"note\">\n<div class=\"callout-title\">\n<div class=\"callout-title-icon\">\n<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"lucide lucide-pencil\"><path d=\"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z\"/><path d=\"m15 5 4 4\"/></svg>\n</div>\n<div class=\"callout-title-inner\">文章解耦 <code>241024</code>：解耦自 <a class=\"uuanqin-bilink\" target=\"_blank\" href=\"/p/dd188b35/\"><span class=\"bilink-pop-up\">站内文章</span>【索引】定制自己的 Waline 评论系统</a></div>\n</div>\n<div class=\"callout-content\"><p></p>\n</div></div><blockquote>\n<p>本文以 Hexo 的 Butterfly 主题为例。</p>\n</blockquote>\n<p>Butterfly 的主题配置文件中 Waline 有一个 <code>option</code> 字段，里面可以定制自己想要的客户端。在 <code>_config.butterfly.yml</code> 中是这样的：</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">waline:</span></span><br><span class=\"line\">  <span class=\"attr\">serverURL:</span>  <span class=\"comment\"># Waline server address url</span></span><br><span class=\"line\">  <span class=\"attr\">bg:</span> <span class=\"comment\"># waline background</span></span><br><span class=\"line\">  <span class=\"attr\">pageview:</span> <span class=\"literal\">false</span></span><br><span class=\"line\">  <span class=\"attr\">option:</span></span><br></pre></td></tr></table></figure>\n<p>在 Waline 官方文档中有很多定制选项，一般官方文档中提到 <code>@waline/client</code> 的配置，都可以使用本文方法进行自定义。</p>\n<p>如何将 Waline 官方文档中的内容与 Butterfly 主题配置中 <code>option</code> 字段结合起来？我们只需要关注官网文档示例中 JavaScript 代码片段里的 <code>init</code> 字段，把自定义的地方放到 <code>option</code> 中。</p>\n<p>下面将通过更多示例演示具体的配置方法。</p>\n<h1 id=\"自定义显示文字-locale\"><a class=\"markdownIt-Anchor\" href=\"#自定义显示文字-locale\"></a> 自定义显示文字 <code>locale</code></h1>\n<p>官网文档中 <code>locale</code> 配置示例如下：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title class_\">Waline</span>.<span class=\"title function_\">init</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">locale</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">level0</span>: <span class=\"string\">&#x27;炼体&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">level1</span>: <span class=\"string\">&#x27;炼气&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">level2</span>: <span class=\"string\">&#x27;筑基&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">level3</span>: <span class=\"string\">&#x27;金丹&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">level4</span>: <span class=\"string\">&#x27;元婴&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">level5</span>: <span class=\"string\">&#x27;化神&#x27;</span>,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<p>回到我们的主题配置文件 <code>_config.butterfly.yml</code> ，在 option 中这样配置：</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">waline:</span></span><br><span class=\"line\">  <span class=\"attr\">option:</span></span><br><span class=\"line\">    <span class=\"attr\">locale:</span> &#123;</span><br><span class=\"line\">      <span class=\"attr\">nick:</span> <span class=\"string\">&#x27;昵称&#x27;</span>,</span><br><span class=\"line\">      <span class=\"attr\">mail:</span> <span class=\"string\">&#x27;邮箱&#x27;</span>,</span><br><span class=\"line\">      <span class=\"attr\">link:</span> <span class=\"string\">&#x27;你的网站&#x27;</span>,</span><br><span class=\"line\">      <span class=\"attr\">placeholder:</span> <span class=\"string\">&#x27;填写数字QQ邮箱可以自动获取QQ头像&#x27;</span>,</span><br><span class=\"line\">      <span class=\"attr\">requiredMeta:</span> [],</span><br><span class=\"line\">      <span class=\"attr\">sofa:</span> <span class=\"string\">&#x27;评论区空空如也~呜呜呜&#x27;</span>,</span><br><span class=\"line\">      <span class=\"attr\">anonymous:</span> <span class=\"string\">&#x27;匿名的野猫&#x27;</span>,</span><br><span class=\"line\">      <span class=\"attr\">login:</span> <span class=\"string\">&#x27;登录(可选)&#x27;</span></span><br><span class=\"line\">      &#125;</span><br></pre></td></tr></table></figure>\n<p><code>locale</code> 写法参照 <a href=\"https://waline.js.org/cookbook/customize/locale.html#locale-%E9%80%89%E9%A1%B9\">自定义语言 | Waline</a>，接下来就照猫画虎设置即可。</p>\n<p>参考：<a href=\"https://afish.org/2022/11/01/waline_comment/\">Hexo|Butterfly 添加 Waline 评论系统 | 小鱼の blog (afish.org)</a></p>\n<h1 id=\"表情选项卡-emoji\"><a class=\"markdownIt-Anchor\" href=\"#表情选项卡-emoji\"></a> 表情选项卡 <code>emoji</code></h1>\n<p><code>_config.butterfly.yml</code> 示例配置：</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">waline:</span></span><br><span class=\"line\">  <span class=\"attr\">option:</span></span><br><span class=\"line\">    <span class=\"attr\">emoji:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">&#x27;//unpkg.com/@waline/emojis@1.2.0/bilibili&#x27;</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">&#x27;//unpkg.com/@waline/emojis@1.2.0/qq&#x27;</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">&#x27;//unpkg.com/@waline/emojis@1.2.0/tieba&#x27;</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">&#x27;//unpkg.com/@waline/emojis@1.2.0/weibo&#x27;</span></span><br></pre></td></tr></table></figure>\n<p>官网配置中 emoji 是一个列表的写法，那转写到 Butterfly 主题配置文件中就以 yaml 的列表写法。</p>\n<p><code>emoji</code> 写法参照：<a href=\"https://waline.js.org/guide/features/emoji.html\">表情选项卡 | Waline</a></p>\n<p>注意到，官方示例提供表情包的链接为 unpkg 提供的 CDN，在实际使用中，unpkg 虽然在国内访问不算很慢，但表情包有点耗时。目前解决方案为使用 <a href=\"http://github.elemecdn.com\">github.elemecdn.com</a>（饿了么）提供的 unpkg 镜像，实测访问速度显著提升。示例配置如下（其实也就是换一下域名而已）：</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">waline:</span></span><br><span class=\"line\">  <span class=\"attr\">option:</span> </span><br><span class=\"line\">    <span class=\"attr\">emoji:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">https://github.elemecdn.com/@waline/emojis@1.2.0/tieba/</span> </span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">https://github.elemecdn.com/@waline/emojis@1.2.0/bilibili/</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">https://github.elemecdn.com/@waline/emojis@1.2.0/qq/</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">https://github.elemecdn.com/@waline/emojis@1.1.0/weibo</span></span><br></pre></td></tr></table></figure>\n<p>如果想把原有评论数据中的表情链接也替换，可以尝试使用以下 SQL 语句：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">UPDATE</span> wl_Comment <span class=\"keyword\">SET</span> `comment`<span class=\"operator\">=</span>REPLACE(`comment`,<span class=\"string\">&#x27;src=&quot;https://unpkg.com/&#x27;</span>,<span class=\"string\">&#x27;src=&quot;https://github.elemecdn.com/&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<h1 id=\"反应配置-reaction\"><a class=\"markdownIt-Anchor\" href=\"#反应配置-reaction\"></a> 反应配置 <code>reaction</code></h1>\n<p>Waline 中反应指的是文章下方的表态：</p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/image-20230429172431151.png\" alt=\"image-20230429172431151\" width=\"375px\" /></p>\n<p>写法：</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">waline:</span></span><br><span class=\"line\">  <span class=\"attr\">option:</span></span><br><span class=\"line\">    <span class=\"attr\">reaction:</span> <span class=\"literal\">true</span> <span class=\"comment\"># 开启快速反应</span></span><br></pre></td></tr></table></figure>\n<p>或自己自定义反应：</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">waline:</span></span><br><span class=\"line\">  <span class=\"attr\">option:</span></span><br><span class=\"line\">    <span class=\"attr\">reaction:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">表情地址1</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">表情地址2</span></span><br><span class=\"line\">    <span class=\"comment\"># 最多支持9个</span></span><br></pre></td></tr></table></figure>\n<p><code>reaction</code> 写法参照：<a href=\"https://waline.js.org/guide/features/reaction.html\">文章反应 | Waline</a></p>\n<h1 id=\"关闭表情搜索按钮-search\"><a class=\"markdownIt-Anchor\" href=\"#关闭表情搜索按钮-search\"></a> 关闭表情搜索按钮 <code>search</code></h1>\n<p>这个搜索动图的功能真的没啥用，而且还卡。我还遭遇过恶意用户通过这个功能发表垃圾评论。</p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/202410241559032.webp\" alt=\"image.png\" width=\"450px\" /></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">waline:</span></span><br><span class=\"line\">  <span class=\"attr\">option:</span></span><br><span class=\"line\">    <span class=\"attr\">search:</span> <span class=\"literal\">false</span></span><br></pre></td></tr></table></figure>\n<p>文档：<a href=\"https://waline.js.org/guide/features/search.html#%E7%A6%81%E7%94%A8\">表情包搜索 | Waline</a></p>\n<h1 id=\"探索更多\"><a class=\"markdownIt-Anchor\" href=\"#探索更多\"></a> 探索更多</h1>\n<p>更多客户端属性可在 <a href=\"https://waline.js.org/reference/client/props.html\">组件属性 | Waline</a> 中进行探索。</p>\n","raw":"---\ntitle: 学会通过看文档配置 Butterfly 主题中的 Waline 客户端\ntags:\n  - Waline\n  - Butterfly\n  - yaml\ncover: https://cdn.gallery.uuanqin.top/img/diy-waline.png\ndescription: 授人以渔\ncategories:\n  - 博客站点维护\n  - Waline\nabbrlink: eeb2ee0e\nsummary: >-\n  本文以 Hexo 的 Butterfly 主题为例，讲解了如何在主题配置文件中定制 Waline 客户端。通过解耦 241024，详细介绍了如何在 _config.butterfly.yml 文件中配置 Waline 的 option 字段，实现自定义显示文字 locale、表情选项卡 emoji、反应配置 reaction 以及关闭表情搜索按钮 search 等功能。此外，还提到了如何在实际使用中优化表情包链接的访问速度，并提供了相关的 SQL 语句用于修改评论数据中的表情链接。更多客户端属性可在组件属性 | Waline 中进行探索。\ndate: 2023-04-28 16:15:12\ntop_img:\n---\n\n> [!note] 文章解耦 `241024`：解耦自 [[【索引】定制自己的 Waline 评论系统]]\n\n> 本文以 Hexo 的 Butterfly 主题为例。\n\nButterfly 的主题配置文件中 Waline 有一个 `option` 字段，里面可以定制自己想要的客户端。在 `_config.butterfly.yml` 中是这样的：\n\n```yaml\nwaline:\n  serverURL:  # Waline server address url\n  bg: # waline background\n  pageview: false\n  option:\n```\n\n在 Waline 官方文档中有很多定制选项，一般官方文档中提到 `@waline/client` 的配置，都可以使用本文方法进行自定义。\n\n如何将 Waline 官方文档中的内容与 Butterfly 主题配置中 `option` 字段结合起来？我们只需要关注官网文档示例中 JavaScript 代码片段里的 `init` 字段，把自定义的地方放到 `option` 中。\n\n下面将通过更多示例演示具体的配置方法。\n\n# 自定义显示文字 `locale`\n\n官网文档中 `locale` 配置示例如下：\n\n```js\nWaline.init({\n  locale: {\n    level0: '炼体',\n    level1: '炼气',\n    level2: '筑基',\n    level3: '金丹',\n    level4: '元婴',\n    level5: '化神',\n  },\n});\n```\n\n回到我们的主题配置文件 `_config.butterfly.yml` ，在 option 中这样配置：\n\n```yaml\nwaline:\n  option:\n    locale: {\n      nick: '昵称',\n      mail: '邮箱',\n      link: '你的网站',\n      placeholder: '填写数字QQ邮箱可以自动获取QQ头像',\n      requiredMeta: [],\n      sofa: '评论区空空如也~呜呜呜',\n      anonymous: '匿名的野猫',\n      login: '登录(可选)'\n      }\n```\n\n`locale` 写法参照 [自定义语言 | Waline](https://waline.js.org/cookbook/customize/locale.html#locale-选项)，接下来就照猫画虎设置即可。\n\n参考：[Hexo|Butterfly 添加 Waline 评论系统 | 小鱼の blog (afish.org)](https://afish.org/2022/11/01/waline_comment/)\n\n# 表情选项卡 `emoji`\n\n `_config.butterfly.yml` 示例配置：\n\n```yaml\nwaline:\n  option:\n    emoji:\n    - '//unpkg.com/@waline/emojis@1.2.0/bilibili'\n    - '//unpkg.com/@waline/emojis@1.2.0/qq'\n    - '//unpkg.com/@waline/emojis@1.2.0/tieba'\n    - '//unpkg.com/@waline/emojis@1.2.0/weibo'\n```\n\n官网配置中 emoji 是一个列表的写法，那转写到 Butterfly 主题配置文件中就以 yaml 的列表写法。\n\n`emoji` 写法参照：[表情选项卡 | Waline](https://waline.js.org/guide/features/emoji.html)\n\n注意到，官方示例提供表情包的链接为 unpkg 提供的 CDN，在实际使用中，unpkg 虽然在国内访问不算很慢，但表情包有点耗时。目前解决方案为使用 github.elemecdn.com（饿了么）提供的 unpkg 镜像，实测访问速度显著提升。示例配置如下（其实也就是换一下域名而已）：\n\n```yaml\nwaline:\n  option: \n    emoji:\n      - https://github.elemecdn.com/@waline/emojis@1.2.0/tieba/ \n      - https://github.elemecdn.com/@waline/emojis@1.2.0/bilibili/\n      - https://github.elemecdn.com/@waline/emojis@1.2.0/qq/\n      - https://github.elemecdn.com/@waline/emojis@1.1.0/weibo\n```\n\n如果想把原有评论数据中的表情链接也替换，可以尝试使用以下 SQL 语句：\n\n```sql\nUPDATE wl_Comment SET `comment`=REPLACE(`comment`,'src=\"https://unpkg.com/','src=\"https://github.elemecdn.com/')\n```\n\n# 反应配置 `reaction`\n\nWaline 中反应指的是文章下方的表态：\n\n![image-20230429172431151|375](https://cdn.gallery.uuanqin.top/img/image-20230429172431151.png)\n\n写法：\n\n```yaml\nwaline:\n  option:\n    reaction: true # 开启快速反应\n```\n\n或自己自定义反应：\n\n```yaml\nwaline:\n  option:\n    reaction:\n    - 表情地址1\n    - 表情地址2\n    # 最多支持9个\n```\n\n`reaction` 写法参照：[文章反应 | Waline](https://waline.js.org/guide/features/reaction.html)\n\n# 关闭表情搜索按钮 `search`\n\n这个搜索动图的功能真的没啥用，而且还卡。我还遭遇过恶意用户通过这个功能发表垃圾评论。\n\n![image.png|450](https://cdn.gallery.uuanqin.top/img/202410241559032.webp)\n\n```yaml\nwaline:\n  option:\n    search: false\n```\n\n文档：[表情包搜索 | Waline](https://waline.js.org/guide/features/search.html#%E7%A6%81%E7%94%A8)\n\n# 探索更多\n\n更多客户端属性可在 [组件属性 | Waline](https://waline.js.org/reference/client/props.html) 中进行探索。","categories":[{"name":"博客站点维护","api":"api/categories/博客站点维护.json"},{"name":"Waline","api":"api/categories/博客站点维护/Waline.json"}],"tags":[{"name":"Waline","api":"api/tags/Waline.json"},{"name":"Butterfly","api":"api/tags/Butterfly.json"},{"name":"yaml","api":"api/tags/yaml.json"}]},"api":"api/posts/p/eeb2ee0e.json"}