{"data":{"title":"【索引】定制自己的 Waline 评论系统","slug":"博客站点维护/Waline/【索引】定制自己的 Waline 评论系统","description":"通过修改客户端或服务端的配置定制自己的 Waline 评论区","date":"2023-04-28T08:15:12.000Z","updated":"2025-01-17T11:46:17.095Z","language":"zh-CN","comments":true,"url":"p/dd188b35/","cover":"https://cdn.gallery.uuanqin.top/img/diy-waline.png","images":[],"content":"\n<div class=\"callout\" data-callout=\"example\">\n<div class=\"callout-title\">\n<div class=\"callout-title-icon\">\n<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"lucide lucide-list\"><line x1=\"8\" x2=\"21\" y1=\"6\" y2=\"6\"/><line x1=\"8\" x2=\"21\" y1=\"12\" y2=\"12\"/><line x1=\"8\" x2=\"21\" y1=\"18\" y2=\"18\"/><line x1=\"3\" x2=\"3.01\" y1=\"6\" y2=\"6\"/><line x1=\"3\" x2=\"3.01\" y1=\"12\" y2=\"12\"/><line x1=\"3\" x2=\"3.01\" y1=\"18\" y2=\"18\"/></svg>\n</div>\n<div class=\"callout-title-inner\">这也许是一篇索引文章</div>\n</div>\n<div class=\"callout-content\"><p>温馨提示，文章包含大量站内站外链接，建议加入收藏夹/集锦以备不时之需。</p>\n</div></div><p>Waline 定制无非涉及以下几个地方：</p>\n<ol>\n<li>修改环境变量达到自定义效果。</li>\n<li>服务端配置自定义的逻辑选项。Vercel 托管着 GitHub 仓库，通过在 <code>index.js</code> 使用服务端 API 即可实现复杂逻辑。</li>\n<li>客户端配置选项。根据自身的主题，在客户端中自定义 Waline 前端选项。</li>\n<li>修改 <code>waline.js</code> 或 <code>waline.css</code> 文件</li>\n</ol>\n\n<div class=\"callout\" data-callout=\"hint\">\n<div class=\"callout-title\">\n<div class=\"callout-title-icon\">\n<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"lucide lucide-flame\"><path d=\"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z\"/></svg>\n</div>\n<div class=\"callout-title-inner\">本文评论区可以测试，不过请尽量发有意义的内容。不要单纯评论 <code>123</code>、<code>test</code> 等。</div>\n</div>\n<div class=\"callout-content\"><p></p>\n</div></div><h1 id=\"waline-邮件通知\"><a class=\"markdownIt-Anchor\" href=\"#waline-邮件通知\"></a> Waline 邮件通知</h1>\n<p><a class=\"uuanqin-bilink\" target=\"_blank\" href=\"/p/81d7e338/\"><span class=\"yukari\">站内文章</span>Waline 邮件通知以及个性化邮件的设置</a> ，文章介绍为网站建设邮件服务以及设置信纸的操作步骤。</p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/20230712235714.png\" alt=\"image.png\" width=\"450px\" /></p>\n<h1 id=\"头像服务配置\"><a class=\"markdownIt-Anchor\" href=\"#头像服务配置\"></a> 头像服务配置</h1>\n<p>Waline 默认的头像服务加载速度还是不够快，且对于大多数用户没有进行正确的头像匹配。</p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/202410130115039.webp\" alt=\"image.png\" width=\"56px\" /></p>\n<p><a class=\"uuanqin-bilink\" target=\"_blank\" href=\"/p/1d248fa3/\"><span class=\"yukari\">站内文章</span>Waline 配置头像服务（含常用公共头像服务介绍）</a> ，这篇文章包含「修改 Waline 默认头像」、「通过 QQ 邮箱自动获取头像」的方法。</p>\n<h1 id=\"客户端自定义显示文字-表情选项卡定制\"><a class=\"markdownIt-Anchor\" href=\"#客户端自定义显示文字-表情选项卡定制\"></a> 客户端自定义——显示文字、表情选项卡定制</h1>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/202410250031393.webp\" alt=\"image.png\" width=\"400px\" /></p>\n<p><a class=\"uuanqin-bilink\" target=\"_blank\" href=\"/p/eeb2ee0e/\"><span class=\"yukari\">站内文章</span>学会通过看文档配置 Butterfly 主题中的 Waline 客户端</a> 介绍 Butterfly 主题下配置显示文字、表情选项卡定制等客户端配置内容。</p>\n<h1 id=\"评论安全\"><a class=\"markdownIt-Anchor\" href=\"#评论安全\"></a> 评论安全</h1>\n<p><a class=\"uuanqin-bilink\" target=\"_blank\" href=\"/p/81aef33e/\"><span class=\"yukari\">站内文章</span>Waline 评论安全</a> 介绍最大限度减少垃圾评论的措施，包括 IP 黑名单、关键词屏蔽以及发言频率限制等。</p>\n<h1 id=\"评论区外链中间页跳转\"><a class=\"markdownIt-Anchor\" href=\"#评论区外链中间页跳转\"></a> 评论区外链中间页跳转</h1>\n<p>中间页主要是为了规避外链风险。一般 Hexo 渲染插件无法对 Waline 评论系统进行处理，我们可以通过安装 Waline 插件完成中间页替换的功能。</p>\n<p>具体做法详见这篇文章：<a class=\"uuanqin-bilink\" target=\"_blank\" href=\"/p/e1ee5eca/\"><span class=\"yukari\">站内文章</span>Hexo 博客与 Waline 评论区实现外链跳转中间页</a></p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/202408041758490.webp\" alt=\"image.png\" width=\"425px\" /></p>\n<h1 id=\"魔改-css\"><a class=\"markdownIt-Anchor\" href=\"#魔改-css\"></a> 魔改 CSS</h1>\n<p>本来涉及 CSS 的修改，应该另写 css 文件再通过 inject 引入的（这也是 Waline 官方推荐的做法）。但是试了不太成功，所以打算把 <code>waline.css</code> 下载到本地，再将 CDN 指向本地位置。不优雅，但能凑合用。</p>\n<h2 id=\"主题颜色修改\"><a class=\"markdownIt-Anchor\" href=\"#主题颜色修改\"></a> 主题颜色修改</h2>\n<p>CSS 下载到了本地就好办了。根据官方给的 <a href=\"https://waline.js.org/reference/client/style.html\">CSS 变量</a> 说明，我们可以自己更改 css 文件。</p>\n<h2 id=\"评论区背景图\"><a class=\"markdownIt-Anchor\" href=\"#评论区背景图\"></a> 评论区背景图</h2>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/202410250032677.webp\" alt=\"image.png\" width=\"500px\" /></p>\n<p>截取自 <a href=\"https://www.zaqizaba.xyz/\">@阿波尔</a> 网站：</p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/202411210417051.webp\" alt=\"image.png\" width=\"500px\" /></p>\n<blockquote>\n<p>Hexo 的 Butterfly 主题提供了替换 Waline 背景图的选项，参考：<a href=\"https://butterfly.js.org/posts/4aa8abbe/#%E8%A9%95%E8%AB%96\">Butterfly 文檔(三) 主題配置 | Butterfly</a></p>\n</blockquote>\n<p>我的做法是在 css 中加上：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.wl-editor</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">background-image</span>: <span class=\"built_in\">url</span>(<span class=\"string\">&lt;图片地址&gt;</span>);</span><br><span class=\"line\">    <span class=\"attribute\">background-size</span>: <span class=\"number\">10%</span>;</span><br><span class=\"line\">    <span class=\"attribute\">background-repeat</span>: no-repeat;</span><br><span class=\"line\">    <span class=\"attribute\">background-position</span>: right bottom;</span><br><span class=\"line\">    <span class=\"attribute\">background-color</span>: <span class=\"built_in\">rgba</span>(<span class=\"number\">255</span>, <span class=\"number\">255</span>, <span class=\"number\">255</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"attribute\">resize</span>: vertical</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.wl-editor</span><span class=\"selector-pseudo\">:focus</span>&#123;</span><br><span class=\"line\">    <span class=\"attribute\">background-position</span>-<span class=\"attribute\">x</span>: <span class=\"number\">800px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">background-position</span>-<span class=\"attribute\">y</span>: <span class=\"number\">1000px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">transition</span>: all <span class=\"number\">0.2s</span> ease-in-out <span class=\"number\">0s</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>记得隔一段时间就和官网 CSS 同步一下。</p>\n<p>参考文章：<a href=\"https://zhuanlan.zhihu.com/p/581640626\">Hexo 中 Buttefly 主题 Valine 评论系统配置以及美化（七） - 知乎 (zhihu.com)</a></p>\n<h2 id=\"为评论区增加输入提醒\"><a class=\"markdownIt-Anchor\" href=\"#为评论区增加输入提醒\"></a> 为评论区增加输入提醒</h2>\n<p>为评论区的输入增加气泡提示。</p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/202410250026177.webp\" alt=\"image.png\" width=\"500px\" /></p>\n<p>截取自 <a href=\"https://blog.leonus.cn/\">@Leonus</a> 的网站：</p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/20230711235642.png\" alt=\"image.png\" width=\"500px\" /></p>\n<p>截自 <a href=\"https://www.uf4te.cn/\">@uf4te</a> 的网站：</p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/QQ20241123-043559.webp\" alt=\"img\" width=\"500px\" /></p>\n<p>具体做法详看这篇文章：<a class=\"uuanqin-bilink\" target=\"_blank\" href=\"/p/b3be711f/\"><span class=\"yukari\">站内文章</span>为评论系统增加输入提醒【Waline】</a></p>\n","raw":"---\ntitle: 【索引】定制自己的 Waline 评论系统\ntags:\n  - Waline\n  - Vercel\n  - GitHub\n  - Butterfly\ncover: 'https://cdn.gallery.uuanqin.top/img/diy-waline.png'\ndescription: 通过修改客户端或服务端的配置定制自己的 Waline 评论区\nabbrlink: dd188b35\ncategories:\n  - 博客站点维护\n  - Waline\ndate: 2023-04-28 16:15:12\n---\n\n> [!Example] 这也许是一篇索引文章\n> 温馨提示，文章包含大量站内站外链接，建议加入收藏夹/集锦以备不时之需。\n\nWaline 定制无非涉及以下几个地方：\n\n1. 修改环境变量达到自定义效果。\n2. 服务端配置自定义的逻辑选项。Vercel 托管着 GitHub 仓库，通过在 `index.js` 使用服务端 API 即可实现复杂逻辑。\n3. 客户端配置选项。根据自身的主题，在客户端中自定义 Waline 前端选项。\n4. 修改 `waline.js` 或 `waline.css` 文件\n\n> [!Hint] 本文评论区可以测试，不过请尽量发有意义的内容。不要单纯评论 `123`、`test` 等。\n\n# Waline 邮件通知\n\n[[Waline 邮件通知以及个性化邮件的设置]] ，文章介绍为网站建设邮件服务以及设置信纸的操作步骤。\n\n![image.png|450](https://cdn.gallery.uuanqin.top/img/20230712235714.png)\n\n# 头像服务配置\n\nWaline 默认的头像服务加载速度还是不够快，且对于大多数用户没有进行正确的头像匹配。\n\n![image.png|56](https://cdn.gallery.uuanqin.top/img/202410130115039.webp)\n\n[[Waline 配置头像服务（含常用公共头像服务介绍）]] ，这篇文章包含「修改 Waline 默认头像」、「通过 QQ 邮箱自动获取头像」的方法。\n\n# 客户端自定义——显示文字、表情选项卡定制\n\n![image.png|400](https://cdn.gallery.uuanqin.top/img/202410250031393.webp)\n\n[[学会通过看文档配置 Butterfly 主题中的 Waline 客户端]] 介绍 Butterfly 主题下配置显示文字、表情选项卡定制等客户端配置内容。\n\n# 评论安全\n\n[[Waline 评论安全]] 介绍最大限度减少垃圾评论的措施，包括 IP 黑名单、关键词屏蔽以及发言频率限制等。\n\n# 评论区外链中间页跳转\n\n中间页主要是为了规避外链风险。一般 Hexo 渲染插件无法对 Waline 评论系统进行处理，我们可以通过安装 Waline 插件完成中间页替换的功能。\n\n具体做法详见这篇文章：[[Hexo 博客与 Waline 评论区实现外链跳转中间页]]\n\n![image.png|425](https://cdn.gallery.uuanqin.top/img/202408041758490.webp)\n\n# 魔改 CSS\n\n本来涉及 CSS 的修改，应该另写 css 文件再通过 inject 引入的（这也是 Waline 官方推荐的做法）。但是试了不太成功，所以打算把 `waline.css` 下载到本地，再将 CDN 指向本地位置。不优雅，但能凑合用。\n\n## 主题颜色修改\n\nCSS 下载到了本地就好办了。根据官方给的 [CSS 变量](https://waline.js.org/reference/client/style.html) 说明，我们可以自己更改 css 文件。\n\n## 评论区背景图\n\n![image.png|500](https://cdn.gallery.uuanqin.top/img/202410250032677.webp)\n\n截取自 [@阿波尔](https://www.zaqizaba.xyz/) 网站：\n\n![image.png|500](https://cdn.gallery.uuanqin.top/img/202411210417051.webp)\n\n> Hexo 的 Butterfly 主题提供了替换 Waline 背景图的选项，参考：[Butterfly 文檔(三) 主題配置 | Butterfly](https://butterfly.js.org/posts/4aa8abbe/#%E8%A9%95%E8%AB%96)\n\n我的做法是在 css 中加上：\n\n```css\n.wl-editor {\n    background-image: url(<图片地址>);\n    background-size: 10%;\n    background-repeat: no-repeat;\n    background-position: right bottom;\n    background-color: rgba(255, 255, 255, 0);\n    resize: vertical\n}\n.wl-editor:focus{\n    background-position-x: 800px;\n    background-position-y: 1000px;\n    transition: all 0.2s ease-in-out 0s;\n}\n```\n\n记得隔一段时间就和官网 CSS 同步一下。\n\n参考文章：[Hexo 中 Buttefly 主题 Valine 评论系统配置以及美化（七） - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/581640626)\n\n## 为评论区增加输入提醒\n\n为评论区的输入增加气泡提示。\n\n![image.png|500](https://cdn.gallery.uuanqin.top/img/202410250026177.webp)\n\n截取自 [@Leonus](https://blog.leonus.cn/) 的网站：\n\n![image.png|500](https://cdn.gallery.uuanqin.top/img/20230711235642.png)\n\n截自 [@uf4te](https://www.uf4te.cn/) 的网站：\n\n![img|500](https://cdn.gallery.uuanqin.top/img/QQ20241123-043559.webp)\n\n具体做法详看这篇文章：[[为评论系统增加输入提醒【Waline】]]\n","categories":[{"name":"博客站点维护","api":"api/categories/博客站点维护.json"},{"name":"Waline","api":"api/categories/博客站点维护/Waline.json"}],"tags":[{"name":"Waline","api":"api/tags/Waline.json"},{"name":"GitHub","api":"api/tags/GitHub.json"},{"name":"Butterfly","api":"api/tags/Butterfly.json"},{"name":"Vercel","api":"api/tags/Vercel.json"}]},"api":"api/posts/p/dd188b35.json"}