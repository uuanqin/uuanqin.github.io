<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>「多媒体与信号处理」课程笔记 | 半方池水半方田</title><meta name="author" content="wuanqin"><meta name="copyright" content="wuanqin"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="科软嵌入式必选课程笔记">
<meta property="og:type" content="article">
<meta property="og:title" content="「多媒体与信号处理」课程笔记">
<meta property="og:url" content="https://blog.uuanqin.top/p/6c1cb5ed/index.html">
<meta property="og:site_name" content="半方池水半方田">
<meta property="og:description" content="科软嵌入式必选课程笔记">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.gallery.uuanqin.top/img/jshkcover.webp">
<meta property="article:published_time" content="2023-11-22T14:10:23.000Z">
<meta property="article:modified_time" content="2024-09-03T15:26:19.059Z">
<meta property="article:author" content="wuanqin">
<meta property="article:tag" content="嵌入式">
<meta property="article:tag" content="笔记">
<meta property="article:tag" content="多媒体">
<meta property="article:tag" content="MP3">
<meta property="article:tag" content="AVC">
<meta property="article:tag" content="010编辑器">
<meta property="article:tag" content="JPEG">
<meta property="article:tag" content="WAV">
<meta property="article:tag" content="AVI">
<meta property="article:tag" content="BMP">
<meta property="article:tag" content="DCT">
<meta property="article:tag" content="USTC">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.gallery.uuanqin.top/img/jshkcover.webp"><link rel="shortcut icon" href="/image/qlogo.png"><link rel="canonical" href="https://blog.uuanqin.top/p/6c1cb5ed/index.html"><link rel="preconnect" href="//unpkg.com"><link rel="preconnect" href="//hm.baidu.com"><link rel="preconnect" href="//www.clarity.ms"><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="baidu-site-verification" content="codeva-IupgPifNxU"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/font-awesome/6.6.0/css/all.min.css"><link rel="stylesheet" href="https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/node-snackbar/0.1.16/snackbar.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/fancyapps-ui/5.0.17/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        if (name && globalFn[key][name]) return
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          const hour = new Date().getHours()
          const isNight = hour <= 8 || hour >= 23
          if (theme === undefined) isNight ? activateDarkMode() : activateLightMode()
          else theme === 'light' ? activateLightMode() : activateDarkMode()
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?877eb1cd1993b0865452ed4011fcd2d8";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
btf.addGlobalFn('pjaxComplete', () => {
  _hmt.push(['_trackPageview',window.location.pathname])
}, 'baidu_analytics')
</script><script>(function(c,l,a,r,i,t,y){
    c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
    t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
    y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
})(window, document, "clarity", "script", "gwn59ub66c");</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: {"appId":"2JINTHATAF","apiKey":"086110423d680367cda9c0216b336eb8","indexName":"blog.uuanqin.top","hitsPerPage":6,"languages":{"input_placeholder":"搜索文章","hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，耗时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"这个页面已经有","messageNext":"天没有更新了，文章部分内容可能已经过时"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":350,"highlightFullpage":true,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"已切换为繁体中文","cht_to_chs":"已切换为简体中文","day_to_night":"已切换为深色模式","night_to_day":"已切换为浅色模式","bgLight":"#177ecd","bgDark":"#1f1f1f","position":"top-center"},
  infinitegrid: {
    js: 'https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/egjs-infinitegrid/4.12.0/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '「多媒体与信号处理」课程笔记',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-09-03 23:26:19'
}</script><link rel="stylesheet" href="//at.alicdn.com/t/c/font_4037705_1siso1mnybf.css"><link rel="stylesheet" href="/css/iconfont_custom.css"><script src="/js/random.js?8"></script><script src="https://npm.elemecdn.com/pace-js@latest/pace.min.js"></script><link rel="stylesheet" href="/css/pace-barber-shop.css?2"><link rel="stylesheet" href="/css/seamless_card.css"><link rel="stylesheet" href="/css/footer.css"><link rel="stylesheet" href="/css/darktheme_modify.css"><link rel="stylesheet" href="/css/markdown-it-obsidian-callouts.css"><link rel="stylesheet" href="/css/bi-links.css"><link rel="stylesheet" href="/css/links-card.css"><link rel="stylesheet" href="/css/links-bilibili-card.css"><link rel="stylesheet" href="/css/links-art-card.css"><link rel="stylesheet" href="/css/example-3.css"><link rel="stylesheet" href="https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/KaTeX/0.16.9/katex.min.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/Swiper/4.1.6/css/swiper.min.css"><link rel="stylesheet" href="/css/swiperstyle.css"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.2.0"><link rel="alternate" href="/atom.xml" title="半方池水半方田" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/image/avatar.webp" onerror="onerror=null;src='/image/loading.gif'" alt="avatar"></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">142</div></a><a href="/pages/tags/"><div class="headline">标签</div><div class="length-num">317</div></a><a href="/pages/categories/"><div class="headline">分类</div><div class="length-num">20</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-nongtian"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw iconfont icon-guanli"></i><span> 归档</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/DO_NOT_render/cosmoscope/cosmoscope_trim.html"><i class="fa-fw iconfont icon-guanxitu"></i><span> 关系图</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw iconfont icon-timeAxis"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/pages/categories/"><i class="fa-fw iconfont icon-2"></i><span> 分类</span></a></li><li><a class="site-page child" href="/pages/tags/"><i class="fa-fw iconfont icon-24gf-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw iconfont icon-daimaguanli"></i><span> 项目</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/uuanqin/obsidian2cosma"><i class="fa-fw iconfont icon-xinghao"></i><span> PythonCLI obsidian2cosma</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/uuanqin/waline-link-interceptor"><i class="fa-fw iconfont icon-a-lanjiezudangzhangaiwuzuzhi"></i><span> waline-link-interceptor</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/uuanqin/hexo-filter-titlebased-link"><i class="fa-fw iconfont icon-line-bracketszhongkuohao"></i><span> hexo-filter-titlebased-link</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/uuanqin/markdown-it-obsidian-imgsize"><i class="fa-fw iconfont icon-daxiao"></i><span> markdown-it-obsidian-imgsize</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/uuanqin/busuanzi2waline"><i class="fa-fw iconfont icon-suantou"></i><span> PythonCLI busuanzi2waline</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://greasyfork.org/zh-CN/scripts/466046-%E7%9F%A5%E7%BD%91-%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE-bibtex-%E5%A4%A9%E6%B4%A5%E5%A4%A7%E5%AD%A6"><i class="fa-fw iconfont icon-yinyong"></i><span> UserScripts bibtex-TJU</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/uuanqin/hexo-filter-custom-link"><i class="fa-fw iconfont icon-neibujiekou"></i><span> hexo-filter-custom-link</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:randomPost();" rel="external nofollow noreferrer"><i class="fa-fw iconfont icon-suijibofang"></i><span> 随机</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener external nofollow noreferrer" href="https://www.travellings.cn/go-by-clouds.html"><i class="fa-fw iconfont icon-huochepiao"></i><span> 开往</span></a></div><div class="menus_item"><a class="site-page" href="/pages/friends/"><i class="fa-fw iconfont icon-pengyoufill"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/pages/friend_circle/"><i class="fa-fw iconfont icon-pengyouquan"></i><span> 朋友圈</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw iconfont icon-guanfangwangzhan"></i><span> 关于</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/pages/about.html"><i class="fa-fw iconfont icon-mao"></i><span> 关于本站</span></a></li><li><a class="site-page child" href="/sitemap.xml"><i class="fa-fw iconfont icon-ditu"></i><span> 站点地图</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://uuanqin.instatus.com/"><i class="fa-fw iconfont icon-jiankong"></i><span> 站点状态</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img fixed" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/image/logo-bc.png" alt="Logo"><span class="site-name">半方池水半方田</span></a><a class="nav-page-title" href="/"><span class="site-name">「多媒体与信号处理」课程笔记</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-nongtian"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw iconfont icon-guanli"></i><span> 归档</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/DO_NOT_render/cosmoscope/cosmoscope_trim.html"><i class="fa-fw iconfont icon-guanxitu"></i><span> 关系图</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw iconfont icon-timeAxis"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/pages/categories/"><i class="fa-fw iconfont icon-2"></i><span> 分类</span></a></li><li><a class="site-page child" href="/pages/tags/"><i class="fa-fw iconfont icon-24gf-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw iconfont icon-daimaguanli"></i><span> 项目</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/uuanqin/obsidian2cosma"><i class="fa-fw iconfont icon-xinghao"></i><span> PythonCLI obsidian2cosma</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/uuanqin/waline-link-interceptor"><i class="fa-fw iconfont icon-a-lanjiezudangzhangaiwuzuzhi"></i><span> waline-link-interceptor</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/uuanqin/hexo-filter-titlebased-link"><i class="fa-fw iconfont icon-line-bracketszhongkuohao"></i><span> hexo-filter-titlebased-link</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/uuanqin/markdown-it-obsidian-imgsize"><i class="fa-fw iconfont icon-daxiao"></i><span> markdown-it-obsidian-imgsize</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/uuanqin/busuanzi2waline"><i class="fa-fw iconfont icon-suantou"></i><span> PythonCLI busuanzi2waline</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://greasyfork.org/zh-CN/scripts/466046-%E7%9F%A5%E7%BD%91-%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE-bibtex-%E5%A4%A9%E6%B4%A5%E5%A4%A7%E5%AD%A6"><i class="fa-fw iconfont icon-yinyong"></i><span> UserScripts bibtex-TJU</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/uuanqin/hexo-filter-custom-link"><i class="fa-fw iconfont icon-neibujiekou"></i><span> hexo-filter-custom-link</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:randomPost();" rel="external nofollow noreferrer"><i class="fa-fw iconfont icon-suijibofang"></i><span> 随机</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener external nofollow noreferrer" href="https://www.travellings.cn/go-by-clouds.html"><i class="fa-fw iconfont icon-huochepiao"></i><span> 开往</span></a></div><div class="menus_item"><a class="site-page" href="/pages/friends/"><i class="fa-fw iconfont icon-pengyoufill"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/pages/friend_circle/"><i class="fa-fw iconfont icon-pengyouquan"></i><span> 朋友圈</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw iconfont icon-guanfangwangzhan"></i><span> 关于</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/pages/about.html"><i class="fa-fw iconfont icon-mao"></i><span> 关于本站</span></a></li><li><a class="site-page child" href="/sitemap.xml"><i class="fa-fw iconfont icon-ditu"></i><span> 站点地图</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://uuanqin.instatus.com/"><i class="fa-fw iconfont icon-jiankong"></i><span> 站点状态</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">「多媒体与信号处理」课程笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-11-22T14:10:23.000Z" title="发表于 2023-11-22 22:10:23">2023-11-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-09-03T15:26:19.059Z" title="更新于 2024-09-03 23:26:19">2024-09-03</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/pages/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F/">嵌入式</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">32.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>114分钟</span></span><span class="post-meta-separator">|</span><span id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span class="waline-pageview-count" data-path="/p/6c1cb5ed/"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/p/6c1cb5ed/#post-comment"><span class="waline-comment-count" data-path="/p/6c1cb5ed/"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div><article class="post-content" id="article-container"><h1 id="笔记说明"><a class="markdownIt-Anchor" href="#笔记说明"></a> 笔记说明</h1>
<p>这是 USTC 软件学院 - 苏州 2023 秋季学期课程笔记（互联网版本）。本着藏着掖着发霉不如对外分享发光的精神，现将其公布。<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/uuanqin/multimedia-signal-processing-notes">原本的笔记</a> 是卡片式的，为了便于互联网传播与收藏，现整合到同一篇文章当中。</p>
<p>这篇笔记的特点在于：</p>
<ul>
<li>有机涵盖 PPT 内容，精心编排，存在本人的理解消化过程</li>
<li>有重点标识、考点标识、实际考察标识</li>
<li>存在一些习题以供复习</li>
<li>部分图片为作者手工制作，便于知识的理解和掌握</li>
</ul>
<p>本笔记存在以下的符号定义：</p>
<ul>
<li>🔺表示老师经常在课上提，为考试重点。</li>
<li><span style="color:#ff0000">红色字体</span>为 <em>部分</em> 实际考察内容（指的是 2023 秋季学期考试）。</li>
</ul>
<p>本笔记的内容来源：</p>
<ul>
<li>主要来源：课程 PPT。注意，笔记的章节顺序是经过梳理调整的，顺序不一定与 PPT 讲授过程相符。</li>
<li>参考补充：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.csdn.net/qq_39266065/article/details/106225637">秃头学长的笔记</a>，补充了一些练习题。</li>
</ul>
<p>笔记共分为 12 个章节。由于作者水平、精力与时间有限，「时频映射」的两个 Slices 以及「H.264」的 PPT 仅记录部分关键内容，内容也较粗糙（打上了「落叶🍂」标记）。由于当时考试不考「MP4」，所以笔记里也不包含这个章节。</p>
<p>临考前老师列出了多媒体信号处理课程知识点（详看 本课知识点 小节）。在后续的章节中这些知识点将以「考点」标注，如下示例：</p>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 X：[考点内容]</div>
</div>
<div class="callout-content"><p></p>
</div></div><p>如果你有以下需求：</p>
<ul>
<li>查看笔记源码</li>
<li>想导入到自己的双向笔记库中</li>
<li>习惯在 Github 上阅读</li>
<li>为笔记做贡献</li>
</ul>
<p>可以访问 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/uuanqin/USTC-SSE-multimedia-signal-processing-notes">本项目</a>：</p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/uuanqin/USTC-SSE-multimedia-signal-processing-notes"><img src="/image/loading.gif" data-lazy-src="https://github-readme-stats.uuanqin.top/api/pin/?username=uuanqin&amp;repo=USTC-SSE-multimedia-signal-processing-notes" alt="Readme Card"></a></p>
<p>任何贡献都 Welcome！🎉🎉如果你有更新本笔记的想法（或者仅仅是纠错）可以通过邮件或评论区联系我！同时也期待你的 star~</p>
<hr>
<h1 id="导论格式概览"><a class="markdownIt-Anchor" href="#导论格式概览"></a> 导论（格式概览）</h1>
<p>什么是多媒体？包括文字、视频、静态图像、动画、交互内容。应用于广告、艺术、教育</p>
<p>什么是信号处理？</p>
<ul>
<li>系统工程、电子工程和应用数学领域</li>
<li>操作、分析模拟信号和数字信号</li>
<li>代表时空变化的物理量</li>
<li>典型的操作和应用：信号获取与重构、信号压缩、特征提取、质量提升（降噪，图像增强等）</li>
</ul>
<h2 id="数据压缩"><a class="markdownIt-Anchor" href="#数据压缩"></a> 🔺 数据压缩</h2>
<p>无损压缩：识别并消除统计冗余，无信息丢失</p>
<ul>
<li>LZW、Huffman coding（哈夫曼编码）、Arithmetic coding（算数编码）</li>
</ul>
<p>有损压缩：识别并移除不重要的信息</p>
<ul>
<li>Quantization（量化）、JPEG</li>
</ul>
<h2 id="数字容器格式-digital-container-format"><a class="markdownIt-Anchor" href="#数字容器格式-digital-container-format"></a> 数字容器格式 Digital Container Format</h2>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 1：音频、图像和视频的格式与容器</div>
</div>
<div class="callout-content"><p></p>
</div></div><p><strong>容器文件用做识别并交织不同数据形式。</strong></p>
<p>容器格式部件的不同名称：</p>
<ul>
<li>RIFF、PNG：chunks 块</li>
<li>QuickTime/MP4：atoms 原子</li>
<li>MPEG-TS：packets 包 （来自通信术语）</li>
<li>JPEG：段</li>
</ul>
<p>🎵 音频独有的容器：</p>
<ul>
<li>AIFF（IFF 文件格式，在 Mac OS 平台上广泛使用）</li>
<li>WAV（RIFF 文件格式，在 Windows 平台上广泛使用）</li>
<li>XMF（可扩展音乐格式）</li>
</ul>
<p>🖼 静态图像独有的容器：</p>
<ul>
<li><strong>TIFF</strong> (Tagged Image File Format，标记图像文件格式) 静止图像和关联的元数据。</li>
</ul>
<p>其他可以接纳多种音视频类型或其他媒体的容器：</p>
<ul>
<li><strong>3GP</strong> (在许多手机中使用；基于 ISO 基本媒体文件格式，是 MP4 的变种）</li>
<li><strong>ASF</strong>（Microsoft WMA 和 WMV 的容器）</li>
<li><strong>AVI</strong>（标准的 Microsoft Windows 容器）</li>
<li>Flash Video (<span style="color:#ff0000">FLV</span>, F4V) （来自 Adobe Systems 的视频和音频容器）</li>
<li>Matroska (MKV) （不限于任何编解码器或系统）</li>
<li>MJ2-Motion JPEG 2000 文件格式.</li>
<li><strong>QuickTime</strong> File Format（Apple 的标准 QuickTime 视频容器）</li>
<li>MPEG program stream (standard container for MPEG-1 and MPEG-2 elementary streams)</li>
<li>MPEG-2 transport stream (a.k.a. MPEG-TS) (standard container for digital broadcasting and for transportation over unreliable media; used also on Blu-ray Disc video)</li>
<li><strong>MP4</strong> (standard audio and video container for the MPEG-4 multimedia portfolio)</li>
<li>Ogg (standard container for <a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cDovL1hpcGgub3Jn">Xiph.org</a> audio format Vorbis and video format Theora)</li>
<li>RM (RealMedia; standard container for RealVideo and RealAudio)</li>
</ul>
<p>其他：SWF、RMVB</p>
<h2 id="音频格式"><a class="markdownIt-Anchor" href="#音频格式"></a> 音频格式 🎵</h2>
<p>非压缩的音频格式：WAVE、AIFF、Raw PCM</p>
<p>无损压缩格式：FLAC、<span style="color:#ff0000">Monkey’s audio (APE extension)</span>, Shorten, WMA Lossless</p>
<p>有损压缩格式：MP3, AAC, <strong>WMA</strong>, AC3</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231101184441.webp" alt="image.png" width="475px"></p>
<h2 id="图像格式"><a class="markdownIt-Anchor" href="#图像格式"></a> 图像格式 🖼</h2>
<p>RAW、BMP、JPEG、JPEG2000、GIF、PNG</p>
<h2 id="视频格式"><a class="markdownIt-Anchor" href="#视频格式"></a> 视频格式 🎞</h2>
<p>MPEG-1、MPEG-2、MPEG-4 visual/AVC、H.261、H.263、H.264</p>
<ul>
<li>Advanced Video Coding（ISO）=H.264（ITO）</li>
</ul>
<blockquote>
<p>tea：H 开头一般和电信相关</p>
</blockquote>
<p>视频压缩标准的历史详看 视频编码 小节。</p>
<h1 id="bmp-wav-avi-格式"><a class="markdownIt-Anchor" href="#bmp-wav-avi-格式"></a> BMP、WAV、AVI 格式</h1>
<h2 id="windows-bitmap"><a class="markdownIt-Anchor" href="#windows-bitmap"></a> Windows Bitmap🖼</h2>
<h3 id="文件结构"><a class="markdownIt-Anchor" href="#文件结构"></a> 文件结构</h3>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 4：Windows Bitmap 文件结构</div>
</div>
<div class="callout-content"><p></p>
</div></div><p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231104183213.webp" alt="image.png"></p>
<p>bfOffBits：是从位图文件头到位图数据的偏移量。即位图信息头 (BITMAPINFOHEADER)+ 全部颜色对照表 (RGBQUAD) 的字节数。</p>
<p>数据由代表位图的连续行或扫描线的字节值数组组成。每条扫描线由连续的字节组成，这些字节按从左到右的顺序代表扫描线中的像素。</p>
<p>代表扫描线的字节数取决于位图的宽度。</p>
<p><span style="color:#ff0000">扫描线以 32bit 为边界</span>，必须用 0 填充至末尾。</p>
<ul>
<li>这意味着宽度为 8 位，20 位或 30 位的单色位图将具有相同的扫描线大小：32 位</li>
<li>40 位宽的单色位图将具有 64 位的扫描线大小。</li>
</ul>
<p>Bitmap 中的扫描线是<strong>自底向上</strong>存的</p>
<ul>
<li>数组中的第一个字节代表 bitmap 左下角</li>
<li>数组中的最后一个字节代表 bitmap 右上角</li>
</ul>
<h3 id="位图种类"><a class="markdownIt-Anchor" href="#位图种类"></a> 位图种类</h3>
<h4 id="灰度位图"><a class="markdownIt-Anchor" href="#灰度位图"></a> 灰度位图</h4>
<ul>
<li>每个像素使用 <strong>8 个比特（1 字节）</strong>。Info Header 中的 biBitCount 将为 8。</li>
<li>每个字节代表 256 种灰度阴影。白色为 FF，黑色为 00</li>
<li>实质上是 8-bit 彩色位图的特例。存在一个颜色表，其中条目 0 指向黑色，条目 255 指向白色，而介于两者之间的条目指向灰色阴影。对于一个给定大小的图像来说，8-bit 灰度位图和 8-bit 彩色位图是一样的</li>
</ul>
<h4 id="24-bit-彩色位图"><a class="markdownIt-Anchor" href="#24-bit-彩色位图"></a> 24-Bit 彩色位图</h4>
<ul>
<li>每个像素使用 <strong>24 个比特（3 个字节）</strong>。Info Header 中的 biBitCount 将为 24。</li>
<li>每个像素 3 个字节代表红绿蓝。白色 FFFFFF，黑色 000000，红色 FF0000，绿色 00FF00，蓝色 0000FF</li>
</ul>
<h4 id="8-bit-彩色位图"><a class="markdownIt-Anchor" href="#8-bit-彩色位图"></a> 8-Bit 彩色位图</h4>
<ul>
<li>每个像素使用 8 个比特，只有 256 种颜色，通过调色板实现</li>
<li>颜色表在 info header 和 Data 之间，每一对含有 4 个字节（R, G, B, 0x0）</li>
</ul>
<p>颜色表：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231101184757.webp" alt="image.png" width="475px"></p>
<h2 id="wav-格式"><a class="markdownIt-Anchor" href="#wav-格式"></a> WAV 格式 🎵</h2>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 5：WAVE 格式</div>
</div>
<div class="callout-content"><p></p>
</div></div>
<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 8：列出一个块的组件</div>
</div>
<div class="callout-content"><p></p>
</div></div><p>WAV 是存储数字音频（waveform）的简单文件格式，使用了 RIFF 结构将文件内容分为不同的块（chunk）。</p>
<ul>
<li>每个块均由标头和数据字节组成。</li>
</ul>
<ul>
<li>Header 指定块数据字节的类型和大小。</li>
</ul>
<p>它支持各种 bit 分辨率、采样率和音频通道</p>
<p>流行于 Windows 平台，广泛应用于处理数字音频波形程序中</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231101184818.webp" alt="image.png"></p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231101184830.webp" alt="image.png"></p>
<p>所有使用 WAV 的应用必须能够读取两个必要块（fmt、data），并且可以有选择的忽略可选块。</p>
<p>程序复制一个 WAV，应该复制 WAV 中所有的块，即使有一些块最后不会被解释</p>
<p>次序要求：在 WAV 文件中，<strong>除了 Format 块必须在 Data 块前外</strong>，块的顺序没有限制</p>
<p>注意，format 块也许不是第一个块。一个 WAV 文件通常有三个 chunk 以及一个可选 chunk，其在文件中的排列方式依次是：</p>
<ol>
<li>RIFF chunk</li>
<li>Format chunk</li>
<li>Fact chunk（附加块，可选）</li>
<li>Data chunk</li>
</ol>
<p>所有的数据都以 8 位字节存储，以<strong>小端</strong>形式存于字节中</p>
<p>「块（的）数据」和「数据块」不是一个概念：<strong>数据块</strong>有「块大小」和一些「块数据」，其他所有块也是如此。</p>
<h3 id="组成"><a class="markdownIt-Anchor" href="#组成"></a> 组成</h3>
<p>WAV 组成：不同类型的 chunk 的集合。每个块包含头及数据，头指定了<strong>块数据</strong>的类型和大小，一些类型的块可能含有子块。<strong>RIFF 文件块必须以 2 个字节（1 word）对齐。</strong></p>
<h4 id="必含fmt-块"><a class="markdownIt-Anchor" href="#必含fmt-块"></a> 【必含】fmt 块</h4>
<p>fmt 块，采样格式，包含描述波形的参数，比如采样率、位分辨率和通道数</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231101185009.webp" alt="image.png"></p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> {</span></span><br><span class="line">    ID chunkID;                 <span class="comment">// 块的标识。总是「fmt 」注意末尾有空格。</span></span><br><span class="line">    <span class="type">long</span> chunkSize;             <span class="comment">// 块的大小（除去chunkID、chunkSize）</span></span><br><span class="line">    <span class="type">short</span> wFormatTag;           <span class="comment">// 存储数据时使用的压缩方法</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">short</span> wChannels;   <span class="comment">// 音频的通道数。 1:单声道; 4:四通道</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> dwSamplesPerSec;  <span class="comment">// 采样率。标准：44.1KHZ 48KHZ 32KHZ 22.05KHZ 96KHZ</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> dwAvgBytesPerSec; <span class="comment">// 每秒播放多少字节，用于估计RAM需要的大小。</span></span><br><span class="line">                                    <span class="comment">// 其值应等于 dwSamplesPerSec * wBlockAlign的上取</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">short</span> wBlockAlign; <span class="comment">// 采样帧的大小（字节）</span></span><br><span class="line">							    <span class="comment">// 其值等于 wChannels * (wBitsPerSample / 8) 的上取</span></span><br><span class="line">								<span class="comment">// 例如：</span></span><br><span class="line">								<span class="comment">// 3个未压缩的通道组成一个块，每个通道2个字节，则Block align=6</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">short</span> wBitsPerSample;   <span class="comment">// 采样点的位分辨率</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">short</span> cbSize;      <span class="comment">// Size of the extension，扩展字段的长度</span></span><br><span class="line">    <span class="comment">// 也许有额外的域, 取决于 wFormatTag</span></span><br><span class="line">} FormatChunk;</span><br></pre></td></tr></tbody></table></figure>
<table>
<thead>
<tr>
<th>🔺wFormatTag 值</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x0001</td>
<td>WAVE_FORMAT_PCM 未压缩的数据</td>
</tr>
<tr>
<td>0x0002</td>
<td>WAVE_FORMAT_ADPCM</td>
</tr>
<tr>
<td>0x0006</td>
<td>WAVE_FORMAT_ALAW （电话格式）</td>
</tr>
<tr>
<td>0x0007</td>
<td>WAVE_FORMAT_MULAW （电话格式）</td>
</tr>
<tr>
<td>0x55=85</td>
<td>WAVE_FORMAT_MP3</td>
</tr>
</tbody>
</table>
<h5 id="waveformatextensible-扩展的-wave-格式块"><a class="markdownIt-Anchor" href="#waveformatextensible-扩展的-wave-格式块"></a> WAVEFORMATEXTENSIBLE 扩展的 WAVE 格式块</h5>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> {</span></span><br><span class="line">    WAVEFORMATEX Format;</span><br><span class="line">    <span class="class"><span class="keyword">union</span> {</span></span><br><span class="line">        WORD wValidBitsPerSample; <span class="comment">// 信号精度的比特数</span></span><br><span class="line">							      <span class="comment">// 假设使用24bit，但只前20位有效，则wValidBitsPerSample=20</span></span><br><span class="line">        WORD wSamplesPerBlock; <span class="comment">// 一个音频压缩块数据的样本数</span></span><br><span class="line">        WORD wReserved;</span><br><span class="line">    } Samples;</span><br><span class="line">    DWORD dwChannelMask; <span class="comment">// 指定流中通道到扬声器位置的分配的位掩码</span></span><br><span class="line">    GUID SubFormat; <span class="comment">// 对每一个波形数据类型定义的 ID。例如WMA中不同压缩方式。</span></span><br><span class="line">} WAVEFORMATEXTENSIBLE</span><br></pre></td></tr></tbody></table></figure>
<p>位掩码 dwChannelMask：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231101185109.webp" alt="image.png" width="500px"></p>
<p><span style="color:#ff0000">用于超过 2 通道或 16 分辨率的音频数据</span>：</p>
<ul>
<li><code>wFormatTag</code> = FFFE（-2）</li>
<li><code>cbSize</code> = 24</li>
</ul>
<p>以 6 通道 5.1 格式为例子：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">WAVEFORMATPCMEX waveFormatPCMEx;</span><br><span class="line"><span class="comment">// FormatChunk</span></span><br><span class="line">wFormatTag = WAVE_FORMAT_EXTENSIBLE; <span class="comment">//FFFE</span></span><br><span class="line">wChannels = <span class="number">6</span>;</span><br><span class="line">dwSamplesPerSec = <span class="number">48000L</span>;</span><br><span class="line">dwAvgBytesPerSec = <span class="number">864000L</span>;          <span class="comment">// nBlkAlign * nSamp/Sec = 18 * 48000 </span></span><br><span class="line">wBlockAlign = <span class="number">18</span>;</span><br><span class="line">wBitsPerSample = <span class="number">24</span>;                 <span class="comment">// Container has 3 bytes</span></span><br><span class="line">cbSize = <span class="number">22</span>;</span><br><span class="line"><span class="comment">// 以下是拓展的域</span></span><br><span class="line">wValidBitsPerSample = <span class="number">20</span>;            <span class="comment">// Top 20 bits have data</span></span><br><span class="line">dwChannelMask = KSAUDIO_SPEAKER_5POINT1;</span><br><span class="line"><span class="comment">// SPEAKER_FRONT_LEFT | SPEAKER_FRONT_RIGHT |</span></span><br><span class="line"><span class="comment">// SPEAKER_FRONT_CENTER |SPEAKER_LOW_FREQUENCY |</span></span><br><span class="line"><span class="comment">// SPEAKER_BACK_LEFT | SPEAKER_BACK_RIGHT</span></span><br><span class="line">SubFormat = KSDATAFORMAT_SUBTYPE_PCM; <span class="comment">// Specify PCM</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="必含data-块"><a class="markdownIt-Anchor" href="#必含data-块"></a> 【必含】data 块</h4>
<p>音频数据，包含实际波形数据，比如所有通道的数据波形</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> {</span></span><br><span class="line">    ID chunkID;</span><br><span class="line">    <span class="type">long</span> chunkSize;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> waveformData[];</span><br><span class="line">} DataChunk;</span><br></pre></td></tr></tbody></table></figure>
<p>交错立体声波样本：多通道采样存储于交错的波形数据中；8bit 样本采用无符号数据表示，其他样本使用有符号数据表示。</p>
<p>对于多声道声音，每个声道的单个采样点是交错的。一组交错的采样点称为一个采样帧。</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231101185123.webp" alt="image.png"></p>
<p>假设存在两个通路，先存放 time1 的左通道和右通道数据，再存放 time2，以此类推。</p>
<h4 id="其他"><a class="markdownIt-Anchor" href="#其他"></a> 其他</h4>
<p>fact 块（详见 音频编码基础 小节 的 ADPCM 章节）、cue 块</p>
<h2 id="avi-格式"><a class="markdownIt-Anchor" href="#avi-格式"></a> AVI 格式 🎵🎞</h2>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 3：AVI 容器</div>
</div>
<div class="callout-content"><p></p>
</div></div><p>AVI 是另一种 RIFF，由微软开发</p>
<p>音视频交织，即视频段数据紧接音频数据。这允许媒体播放器<strong>以块来读数据而不是文件整体</strong>。</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231101185135.webp" alt="image.png" width="475px"></p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231101185202.webp" alt="image.png"></p>
<p>注意 AVI 是 Wave 格式，必须以两个字节（1 word）对齐，填充。解码时不需要考虑填充的数据。</p>
<p>索引目的：为了支持随机访问</p>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 6：解释 FOURCC 中 “00dc”，“vids” 等标签的意思</div>
</div>
<div class="callout-content"><p></p>
</div></div><p>🔺流列表中的四字节码：</p>
<ul>
<li><span style="color:#ff0000">vids：video stream</span></li>
<li>auds：audio stream</li>
<li>mp4v：MEPG4 visual</li>
</ul>
<p>数据块可以直接驻留在 movi 列表中，或者被 res 列表包围。</p>
<p>🔺FOURCC，定义块中信息的类型：</p>
<ul>
<li>db：未压缩的视频帧</li>
<li>d<strong>c</strong>：压缩的视频帧</li>
<li><span style="color:#ff0000">wb：音频流</span></li>
</ul>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231101185239.webp" alt="image.png"></p>

<div class="callout" data-callout="example">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-list"><line x1="8" x2="21" y1="6" y2="6"></line><line x1="8" x2="21" y1="12" y2="12"></line><line x1="8" x2="21" y1="18" y2="18"></line><line x1="3" x2="3.01" y1="6" y2="6"></line><line x1="3" x2="3.01" y1="12" y2="12"></line><line x1="3" x2="3.01" y1="18" y2="18"></line></svg>
</div>
<div class="callout-title-inner">习题助记</div>
</div>
<div class="callout-content"><p></p>
<ol>
<li>What does fourcc code “vids” stands for?</li>
<li>What does fourcc code “auds” stands for?</li>
<li>What does fourcc code “00db” stands for?</li>
<li>What does fourcc code “01wb” stands for?</li>
<li>ln which scemarops is wFormatTag equal to -2 in a WAVE file?<br>
音频通道大于 2，每一个抽样信号大于 16bit</li>
</ol>
</div></div><h1 id="音频编码基础"><a class="markdownIt-Anchor" href="#音频编码基础"></a> 音频编码基础</h1>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102130537.webp" alt="image.png"></p>
<p>数字音频编码器：</p>
<ol>
<li>输入：模拟音频信号</li>
<li>编码器：转换为方便地数字形式</li>
<li>存储、处理、传输</li>
<li>解码器：将数字数据转换为模拟信号</li>
</ol>
<p>🔺音频编码目标：</p>
<ul>
<li>保真度：解码器尽量<strong>提高</strong>感知的音频质量，减少失真</li>
<li>数据率：减少代表原始音频信号的数据量</li>
<li>复杂性：减少计算复杂性</li>
<li>延迟：减少编码延迟</li>
</ul>
<h2 id="pcm最简单的编码器"><a class="markdownIt-Anchor" href="#pcm最简单的编码器"></a> PCM——最简单的编码器</h2>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102130552.webp" alt="image.png" width="475px"></p>
<p>量化是一种有损的过程。</p>
<p>在量化过程中使用的离散值数目越高，输出的信号越接近原始音频</p>
<h2 id="cdcompact-disc-激光唱片"><a class="markdownIt-Anchor" href="#cdcompact-disc-激光唱片"></a> CD：Compact Disc 激光唱片</h2>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 7：CD 的数据率</div>
</div>
<div class="callout-content"><p></p>
</div></div><p>CD 的数据率：44.1k/s × 16 bit × 2 =<span style="color:#ff0000"> 1.4112 Mb/s</span></p>
<ul>
<li>采样：时间间隔 0.023ms（1/0.000023≈43.5k）或采样频率 <strong>44.1k。</strong></li>
<li>每一个采样的比特数为 16bit，这种精度允许 65536 个离散电平来表示音频采样幅度。</li>
<li>2 个通路</li>
</ul>
<h2 id="潜在的编码错误"><a class="markdownIt-Anchor" href="#潜在的编码错误"></a> 潜在的编码错误</h2>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 9：潜在的编码错误</div>
</div>
<div class="callout-content"><p></p>
</div></div><ul>
<li>采样错误——混叠效应（抽样速率小于二倍带宽）</li>
<li>🔺<span style="color:#ff0000">量化错误：过载错误、截断错误（round-off）</span></li>
<li>比特错误：存储和传输错误</li>
</ul>
<h2 id="更复杂的编码器"><a class="markdownIt-Anchor" href="#更复杂的编码器"></a> 更复杂的编码器</h2>
<p>心理声学表明，每个样本理想采样比特为 18-20bits 来描述中等频率（2~5kHz）的音频样本。</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102130608.webp" alt="image.png" width="500px"></p>
<p>冗余：感知冗余、统计冗余</p>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 10：有损压缩和无损压缩</div>
</div>
<div class="callout-content"><p></p>
</div></div><h2 id="有损压缩"><a class="markdownIt-Anchor" href="#有损压缩"></a> 有损压缩</h2>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102130629.webp" alt="image.png"></p>
<p><strong>有损压缩通过量化来实现。</strong></p>
<h3 id="量化"><a class="markdownIt-Anchor" href="#量化"></a> 量化</h3>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102130648.webp" alt="image.png" width="500px"></p>
<p>如果有 R 比特可以表示的最大数为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>R</mi></msup></mrow><annotation encoding="application/x-tex">2^R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span></span></span></span></span></span></span></span>，两种量化方法表示的不同样本/编码数为：</p>
<ul>
<li>midtread 中平：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>R</mi></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^R-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.924661em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>，一般来说效果较好，噪声抑制（小电频通常为噪声，Midtread 会过滤掉）</li>
<li>midrise 中升：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>R</mi></msup></mrow><annotation encoding="application/x-tex">2^R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span></span></span></span></span></span></span></span>，噪声放大</li>
</ul>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 11：均匀量化和非均匀量化</div>
</div>
<div class="callout-content"><p></p>
</div></div><h4 id="均匀量化-uniform-quantization"><a class="markdownIt-Anchor" href="#均匀量化-uniform-quantization"></a> 均匀量化 Uniform Quantization</h4>
<p>定义输入范围所需要的信息：</p>
<ul>
<li>量化器是 midtread 还是 midrise</li>
<li>最大不过载的输入 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">x_{max}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>描述编码的比特数 R</li>
</ul>
<p>R 比特允许我们设置的输入范围：</p>
<ul>
<li>midrise：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><mo>=</mo><mn>2</mn><mo>∗</mo><msub><mi>x</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mi mathvariant="normal">/</mi><msup><mn>2</mn><mi>R</mi></msup></mrow><annotation encoding="application/x-tex">\Delta=2*x_{max}/2^R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">Δ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span></span></span></span></span></span></span></span></li>
<li>midtread：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><mo>=</mo><mn>2</mn><mo>∗</mo><msub><mi>x</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mi>R</mi></msup><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Delta=2*x_{max}/(2^R-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">Δ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li>
</ul>
<h4 id="非均匀量化-nonuniform-quantization"><a class="markdownIt-Anchor" href="#非均匀量化-nonuniform-quantization"></a> 非均匀量化 Nonuniform Quantization</h4>
<p>均匀量化会存在截断误差（最大值为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">\Delta/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Δ</span><span class="mord">/</span><span class="mord">2</span></span></span></span>)，但是，相对于非常低的幅度信号，此误差可能会很大。<strong>由于截取失真的感知与相对误差更相关，因此这意味着均匀量化器在低功率输入信号上的表现要比在高功率信号上的差得多。</strong> 要解决此问题，可以使用非均匀量化。</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102130912.webp" alt="image.png" width="350px"></p>
<p>压缩方法：</p>
<ul>
<li>幂律压缩：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mrow><mi>p</mi><mi>o</mi><mi>w</mi><mi>e</mi><mi>r</mi></mrow></msub><mo stretchy="false">(</mo><mi mathvariant="normal">∣</mi><mi>x</mi><mi mathvariant="normal">∣</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">∣</mi><mi>x</mi><msup><mi mathvariant="normal">∣</mi><mi>p</mi></msup><mtext>，</mtext><mn>0</mn><mo>&lt;</mo><mi>p</mi><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">c_{power}(|x|)=|x|^p，0&lt;p&lt;1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mord">∣</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span><span class="mord cjk_fallback">，</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7335400000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>, (ACC 或 MP3 中 p=0.75）</li>
<li>对数压缩</li>
</ul>
<p>量化错误 Quantization Errors：</p>
<ul>
<li>量化误差：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>x</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>−</mo><msub><mi>x</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(t)=x_{out}(t)-x_{in}(t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></li>
<li>信噪比 SNR（Signal-to-noise ratio） <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>N</mi><mi>R</mi><mo>=</mo><mn>10</mn><mi>log</mi><mo>⁡</mo><mfrac><msubsup><mi>x</mi><mrow><mi>i</mi><mi>n</mi></mrow><mn>2</mn></msubsup><msup><mi>q</mi><mn>2</mn></msup></mfrac></mrow><annotation encoding="application/x-tex">SNR=10 \log{\frac{x_{in}^2}{q^2}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.6152279999999997em;vertical-align:-0.481108em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1341199999999998em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463142857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.5102em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.214em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.481108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></li>
<li><strong>低 量化误差 对应于 高 信噪比</strong></li>
</ul>
<p>截断错误 Round-off Error：产生于将一定范围的信号振幅输入对应到单一编码中</p>
<p>过载错误 Overload Error：</p>
<ul>
<li>出现原因：量化器接收的信号振幅（绝对值）过大</li>
<li>导致爆鸣（突突突的声音），为了避免它，通常把 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">x_{max}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 设置得足够大，但由于 R 比特数固定，这会导致截断错误。量化器设计要求在减少两种类型的误差之间取得平衡。</li>
</ul>
<p>过载错误、截断错误属于量化错误。</p>
<h2 id="无损压缩熵编码"><a class="markdownIt-Anchor" href="#无损压缩熵编码"></a> 无损压缩：熵编码</h2>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 12：熵和哈夫曼编码</div>
</div>
<div class="callout-content"><p></p>
</div></div><p>翻译量化编码为一些代表符号，每个符号使用了一定数量的比特。</p>
<p>使一般的编码更短，从而降低平均的比特率。这需要估计每一个可能编码出现的概率。</p>
<p>比特率计算：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mtext>&nbsp;</mtext><mo>=</mo><mtext>&nbsp;</mtext><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mrow><msub><mi>p</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi>L</mi><mi>i</mi></msub></mrow></mrow><annotation encoding="application/x-tex">R&nbsp;=&nbsp;\sum_{i=1}^n{p_i \cdot L_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord">&nbsp;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.104002em;vertical-align:-0.29971000000000003em;"></span><span class="mord">&nbsp;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">p_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 表示编码出现的概率，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">L_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 表示编码后的长度。</p>
<p><span style="color:#ff0000">熵代表了编码的极限：</span></p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231126174729.webp" alt="image.png"></p>
<p><strong>当我们能确保下一个输出编码是什么时，熵会变低；反之变高。</strong></p>
<p>例：在 2 编码符号系统中，有</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102131253.webp" alt="image.png"></p>
<p>数学图像 <a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cHM6Ly93d3cuZGVzbW9zLmNvbS9jYWxjdWxhdG9yL2ZrZDJncDRqYzU/bGFuZz16aC1DTg==">链接</a></p>
<ul>
<li>当 p=0 或 1 时，熵为 0。我们知道下一个编码是什么，所以我们不需要发送任何 Bits。</li>
<li>当 p=0.5，熵为 1。当所有编码符号出现的概率相同时，达到最大熵。在这种情况下使用熵编码进行压缩没有效果。</li>
<li>对于其他概率，存在一种编码方式使得平均符号编码使用小于 1 个比特</li>
</ul>
<h3 id="哈夫曼编码"><a class="markdownIt-Anchor" href="#哈夫曼编码"></a> 哈夫曼编码</h3>
<p>被用于传真、ASCII 文本数据编码压缩。</p>
<p>是一种统计学编码，平均编码长度最小。</p>
<p>编码长度可变，且越经常使用的字符编码长度越短。</p>
<p>特点：</p>
<ol>
<li>编码过程不唯一（取决于分支的标记或合并符号的选择），但 WPL 相同（在这里指的是比特率 R）且最优</li>
<li>在符号分布概率不均匀的情况下，哈夫曼编码的比特数比固定比特编码方法少</li>
<li>霍夫曼码中每个样本的平均位数在熵的一位以内，即平均采样比特数范围：$$Entropy\le <r>_{Huffman} \le Entropy + 1$$</r></li>
</ol>
<h2 id="wave-ms-adpcm"><a class="markdownIt-Anchor" href="#wave-ms-adpcm"></a> WAVE MS-ADPCM</h2>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 13：MS-ADPCM</div>
</div>
<div class="callout-content"><p></p>
</div></div><p>DPCM 差分脉冲编码调制：</p>
<ul>
<li>以 PCM 为基线，增加了预测采样信号的功能。</li>
<li>与 PCM 直接传输原始 PCM 采样不同的是，DPCM 传输的是原始采样信号与预测值（基于先前采样）之间的差异：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>f</mi><mi>f</mi><mo>=</mo><msub><mi>x</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><mi>x</mi><msub><mi>p</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">diff=x_{n+1}-xp_{n+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.791661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord mathnormal">x</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>预测值计算举例：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><msub><mi>p</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>a</mi><mo>∗</mo><msub><mi>x</mi><mi>n</mi></msub><mo>+</mo><mi>b</mi><mo>∗</mo><msub><mi>x</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">xp_{n+1}=a*x_n+b*x_{n-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord mathnormal">x</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>，a、b 为预测系数</li>
</ul>
<p>diff 通常非常小，我们必须限制它的表示范围，如从 16bits 限制到 4bits。但我们也不能保证 diff 总是小的（如剧烈信号变化），为了解决这个问题，引入了 iDelta。如果 diff 非常大，则 iDelta 也会很大，反之亦然。</p>
<p>于是我们定义：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mi>E</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>r</mi><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi><mo>=</mo><mi>d</mi><mi>i</mi><mi>f</mi><mi>f</mi><mi mathvariant="normal">/</mi><mi>i</mi><mi>D</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">iErrordata = diff / iDelta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">d</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord">/</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span></span></span></span>，这样新的差异值将会稳定。</p>
<p>iErrordata 以 4bit 保存，称为「nibble」，范围为 -8~7。每次新的 iErrordata 生成后，iDelta 相应做出改变。</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">iDelta = iDelta * AdaptableTable[(<span class="type">unsigned</span>)nibble]/<span class="number">256</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> AdaptationTable[ ] = {</span><br><span class="line"><span class="number">230</span>, <span class="number">230</span>, <span class="number">230</span>, <span class="number">230</span>, <span class="number">307</span>, <span class="number">409</span>, <span class="number">512</span>, <span class="number">614</span>,    <span class="comment">// 对应nibble：</span></span><br><span class="line"><span class="number">768</span>, <span class="number">614</span>, <span class="number">512</span>, <span class="number">409</span>, <span class="number">307</span>, <span class="number">230</span>, <span class="number">230</span>, <span class="number">230</span> };  <span class="comment">// 对应nibble：</span></span><br></pre></td></tr></tbody></table></figure>
<h3 id="waveformat"><a class="markdownIt-Anchor" href="#waveformat"></a> WAVEFORMAT</h3>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231105205607.webp" alt="image.png"></p>
<p>MS-ADPCM 的 wave 文件中，存在与 fmt 块和 data 块的另一种块：fact 块</p>
<ul>
<li>fact 块存储采样长度</li>
<li>data 块中，数据以块的方式存储，一个接着一个</li>
<li>块有三个部分：头、数据和填充</li>
</ul>
<h3 id="编码过程"><a class="markdownIt-Anchor" href="#编码过程"></a> 编码过程</h3>
<p>对于每个通道的每个块的编码过程：</p>
<ol>
<li>决定块要使用的预测器</li>
<li>决定块的初始 idelta</li>
<li>输出块的头</li>
<li>编码并输出数据</li>
</ol>
<p>块头写入：</p>
<ol>
<li>对每一个通道，输出预测器的选择</li>
<li>对每一个通道，输出初始 idelta (量化比例)</li>
<li>对每一个通道，输出第一个采样的 16bit PCM 值</li>
<li>对每一个通道，输出第二个采样的 16bit PCM 值</li>
</ol>
<p>然后剩下的块就可以进行编码。<strong>注意第一个编码的值是块的第三个采样，因为前两个已经包含在头中了。</strong></p>
<p>当块中有许多采样需要进行编码，将采取下列步骤：</p>
<ol>
<li>从前两个采样中预测下一个样本：<br>
<img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231123215918.webp" alt="image.png"></li>
</ol>
<blockquote>
<p>用预测系数计算会导致运算量增长，而除以 256 只需要移位，无浮点数除法</p>
</blockquote>
<ol start="2">
<li>产生 4bit 有符号 error delta 以及避免上/下溢：$$ierrordelta=\frac{sample(n)-Ipredsamp}{idelta}$$ 并将 ierrordelta 的范围修剪至[-8,7]</li>
<li>于是输出 nibble ierrordelta=<code>putnibble(ierrordelta)</code></li>
<li>把「预测错误」加到预测的下一个样本，并避免上/下溢：$$Inewsamp=Ipredsample+(idelta*ierrordelta)$$ 将其缩紧至 16bit（short）</li>
<li>调整用于计算「预测错误」的量化步长：$$idelta=\frac{idelta*adaptiontable[ierrordelta]}{fixed_point_adaption_base}$$ 如果 idelta 过小，将其设为最小的合法值</li>
<li>更新先前样本的记录：$$isamp2 = isamp1; isamp1 = Inewsample$$<br>
<img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102131901.webp" alt="image.png"><br>
步骤 5 的目的是自适应量化步长。<br>
步骤 4.6 是为了保持和解码端一致，真正预测时是通过编码解码后的信号。此时和解码端保持一致，使误差不会太大。</li>
</ol>

<div class="callout" data-callout="example">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-list"><line x1="8" x2="21" y1="6" y2="6"></line><line x1="8" x2="21" y1="12" y2="12"></line><line x1="8" x2="21" y1="18" y2="18"></line><line x1="3" x2="3.01" y1="6" y2="6"></line><line x1="3" x2="3.01" y1="12" y2="12"></line><line x1="3" x2="3.01" y1="18" y2="18"></line></svg>
</div>
<div class="callout-title-inner">习题助记</div>
</div>
<div class="callout-content"><p>1.What is audio CD rate?<br>
44.1KHZ × 2 × 16bit/s = 1.411 Mbit<br>
2.What are audio coding goals?<br>
delity，rate，complexity，delay<br>
3.List the components of a chunk.<br>
header，data<br>
4.What kind of quantization errors are there in audio coding?<br>
overlode，round-off<br>
5.What is the average number of bits per sample in a Huffman code?</p>
</div></div><h1 id="图片和视频编码基础"><a class="markdownIt-Anchor" href="#图片和视频编码基础"></a> 图片和视频编码基础</h1>
<p>🔺人类视觉系统对低频图像更敏感。</p>
<blockquote>
<p>图形学中的高低频：图像的低频代表着轮廓信息，高频代表着细节信息，相位代表位置信息。</p>
</blockquote>
<p>特定自然视频片段中与视频处理和压缩相关的特征：</p>
<ul>
<li>空间特征：纹理变化、物体对象的数目和形状、颜色</li>
<li>时间特征：物体运动、光线变化、摄像机/视角变化</li>
</ul>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102195839.webp" alt="image.png"></p>
<p>帧率：</p>
<ul>
<li>每秒小于 10 帧：用于超低比特流视频通信</li>
<li>10~20 帧：典型低比特率视频通信</li>
<li><strong>25~30 帧：电视图像标准</strong></li>
<li>50~60 帧：平滑（高数据率）</li>
</ul>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 23：色彩空间</div>
</div>
<div class="callout-content"><p></p>
</div></div><p>色彩空间：</p>
<ul>
<li>单色图：仅需一个数字表示某一个空间采样的亮度</li>
<li>彩色图：至少需要三个数字才能准确表示某一个像素的颜色</li>
</ul>
<p>代表亮度和色彩的方法称为色彩空间：</p>
<ul>
<li>RGB 色彩空间：捕获和显示图像的恰当方法。RGB 色彩空间中三种颜色同样重要，通常分辨率也相同。彩色阴极射线管（CRT）和液晶显示器（LCD）应用 RGB。</li>
<li>YCbCy 色彩空间（YUV 色彩模型）</li>
</ul>
<p><strong>图像的视觉质量受采样点数量的影响。</strong></p>
<h2 id="ycbcr"><a class="markdownIt-Anchor" href="#ycbcr"></a> YCbCr</h2>
<p>🔺<span style="color:#ff0000">人类视觉系统对<b>亮度</b>更敏感（和颜色相比）</span></p>
<blockquote>
<p>人眼的视杆细胞（感知亮度）比视锥细胞（感知色彩）数量多。</p>
</blockquote>
<h3 id="色彩空间"><a class="markdownIt-Anchor" href="#色彩空间"></a> 色彩空间</h3>
<p>在 RGB 颜色空间中，这三种颜色同等重要，因此通常都以相同的分辨率存储。</p>
<p>YCbCr 区分亮度和色度，亮度具有更高的分辨率。</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231106221610.webp" alt="image.png" width="500px"></p>
<p>Y：亮度（luma），RGB 的加权平均，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><msub><mi>k</mi><mi>r</mi></msub><mi>R</mi><mo>+</mo><msub><mi>k</mi><mi>g</mi></msub><mi>G</mi><mo>+</mo><msub><mi>k</mi><mi>b</mi></msub><mi>B</mi><mo separator="true">,</mo><mtext>&nbsp;</mtext><msub><mi>k</mi><mi>g</mi></msub><mtext>&nbsp;</mtext><mo>=</mo><mtext>&nbsp;</mtext><mn>1</mn><mo>−</mo><msub><mi>k</mi><mi>b</mi></msub><mo>−</mo><msub><mi>k</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">Y=k_rR+k_gG+k_bB,&nbsp;k_g&nbsp;=&nbsp;1-k_b-k_r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">&nbsp;</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord">&nbsp;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">&nbsp;</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p>
<p>Cb：彩度蓝</p>
<p>Cr：彩度红</p>
<p>每一个色度是 R、G、B、Y 之间的差异</p>
<p>为了降低存储和传输需求，可以将 RGB 图像转换为 YCbCr 图像</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102195927.webp" alt="image.png"></p>
<p>ITU-R 建议的系数定义：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>b</mi></msub><mo>=</mo><mn>0.114</mn><mo separator="true">,</mo><msub><mi>k</mi><mi>r</mi></msub><mo>=</mo><mn>0.299</mn></mrow><annotation encoding="application/x-tex">k_b=0.114, k_r=0.299</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span><span class="mord">1</span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">2</span><span class="mord">9</span><span class="mord">9</span></span></span></span></p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102200018.webp" alt="image.png"></p>
<h3 id="采样格式"><a class="markdownIt-Anchor" href="#采样格式"></a> 采样格式</h3>
<p>为了利用人眼对亮度和色度的不同敏感性，将视频信号转换为亮度/色彩空间时，可以对色度进行空间上的次采样或低通滤波</p>
<h4 id="444-采样"><a class="markdownIt-Anchor" href="#444-采样"></a> 4:4:4 采样</h4>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102200027.webp" alt="image.png" width="205px"></p>
<p>Y，Cb 和 Cr 有着相同的分辨率。因此每一个分量存在于任何位置的像素上</p>
<h4 id="422-采样"><a class="markdownIt-Anchor" href="#422-采样"></a> 4:2:2 采样</h4>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102200042.webp" alt="image.png" width="187px"></p>
<p>色度组件的垂直分辨率与亮度相同，但水平分辨率只有亮度的一半。</p>
<p>用于高质量彩色录制。</p>
<h4 id="420-采样"><a class="markdownIt-Anchor" href="#420-采样"></a> 4:2:0 采样</h4>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102200051.webp" alt="image.png"></p>
<p>Cb 和 Cr 的水平和垂直分辨率都是 Y 的一半。</p>
<p>广泛用于消费类应用，如视频会议、DVD。</p>
<p><strong>需要的采样数（比特）是 4:4:4 视频（或 RGB 视频）的一半</strong>。</p>
<blockquote>
<p>为什么不叫做 4:1:1 采样？<br>
因为在历史上 4:1:1 采样已被用于指代这种采样：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102200109.webp" alt="image.png" width="275px"></p>
</blockquote>
<p>例子：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102200139.webp" alt="image.png" width="375px"></p>
<h2 id="视频帧格式"><a class="markdownIt-Anchor" href="#视频帧格式"></a> 视频帧格式</h2>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 24：视频帧格式</div>
</div>
<div class="callout-content"><p></p>
</div></div><p>在进行压缩和传输之前，捕获的视频会被捕获或转换为一组“中间格式”之一。</p>
<p>常见的中间格式（CIF）是一组流行格式的基础。</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102200202.webp" alt="image.png" width="375px"></p>
<h2 id="质量评估"><a class="markdownIt-Anchor" href="#质量评估"></a> 质量评估</h2>
<h3 id="主观测量itu-r-500"><a class="markdownIt-Anchor" href="#主观测量itu-r-500"></a> 主观测量——ITU-R 500</h3>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102200215.webp" alt="image.png"></p>
<p>通常采用的手段：双刺激连续质量量表（Double Stimulus Continuous Quality Scale）</p>
<p>花费昂贵，耗时长</p>
<h3 id="客观质量测量"><a class="markdownIt-Anchor" href="#客观质量测量"></a> 客观质量测量</h3>
<blockquote>
<p>峰值信噪比 ( PSNR ) 用于表示信号的最大可能功率与影响其表示的保真度的破坏噪声的功率之间的比率。虽然较高的 PSNR 通常表明重建质量较高，但在某些情况下可能并非如此，必须非常小心该指标的有效性范围。只有当它用于比较来自相同编解码器和相同内容的结果时，它才是最终有效的。一般来说，在估计图像质量，尤其是人类感知的视频质量时，与其他质量指标相比，PSNR 表现不佳。</p>
</blockquote>
<p>运用最广泛的是<strong>峰值信噪比（Peak Signal to Noise Ratio, PSNR）</strong></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mrow><mi>P</mi><mi>S</mi><mi>N</mi><mi>R</mi></mrow><mrow><mi>d</mi><mi>B</mi></mrow></msub><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>10</mn><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>10</mn></msub><mfrac><mrow><mo stretchy="false">(</mo><msup><mn>2</mn><mi>n</mi></msup><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><mrow><mi>M</mi><mi>S</mi><mi>E</mi></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>S</mi><mi>N</mi><mi>R</mi><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>10</mn><mi>log</mi><mo>⁡</mo><mfrac><msubsup><mi>x</mi><mrow><mi>i</mi><mi>n</mi></mrow><mn>2</mn></msubsup><msup><mi>q</mi><mn>2</mn></msup></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
{PSNR}_{dB} =&amp; 10 \log_{10}{\frac{(2^n-1)^2}{MSE}} \\
SNR=&amp;10 \log{\frac{x_{in}^2}{q^2}}
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.148656000000001em;vertical-align:-2.3243280000000004em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.8243280000000004em;"><span style="top:-4.824328em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span><span style="top:-2.34722em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.3243280000000004em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.8243280000000004em;"><span style="top:-4.824328em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"><span class="mord"></span><span class="mord">1</span><span class="mord">0</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.491108em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span style="top:-2.34722em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"><span class="mord"></span><span class="mord">1</span><span class="mord">0</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.491108em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.3243280000000004em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>MSE：原始图像和受损图像或视频帧之间的均方误差</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102200250.webp" alt="image.png" width="475px"></p>
<h2 id="图像视频处理准则"><a class="markdownIt-Anchor" href="#图像视频处理准则"></a> 图像视频处理准则</h2>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 25：图像视频处理准则：四种类型冗余度</div>
</div>
<div class="callout-content"><p></p>
</div></div><p>目标是减少信号中存在的冗余（🔺视频编码的四种冗余度）：</p>
<ul>
<li>时间冗余度（Temporal redundancy）：两帧相像</li>
<li>空间冗余度（Spatial redundancy）：两点相像</li>
<li>统计冗余度（Perceptual redundancy）</li>
<li>感知冗余度（Statistical redundancy）</li>
</ul>
<h2 id="jpeg-图像压缩"><a class="markdownIt-Anchor" href="#jpeg-图像压缩"></a> JPEG 图像压缩</h2>
<p>基本流程：</p>
<ul>
<li>在 JPEG 压缩中，图像被划分为 8×8 像素的块，然后对每个块进行 2-D 离散余弦转换（DCT）。</li>
<li>DCT 将像素块中的大多数信号压缩为小的 DCT 系数部分。</li>
<li>量化这些 DCT 系数将使得它们大部分转化为 0。</li>
<li>这些被量化的系数以之字形进行扫描，再进行游程编码和哈夫曼编码。</li>
</ul>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102200322.webp" alt="image.png"></p>
<h2 id="帧内帧间预测"><a class="markdownIt-Anchor" href="#帧内帧间预测"></a> 帧内帧间预测</h2>
<p>每一帧可以都被编码为分开的图像，例如对每一帧独立应用类似 JPEG 的编码。</p>
<p>视频压缩通过利用时间冗余或帧间相似性达到比图片更好的压缩效果。</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102200334.webp" alt="image.png"></p>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 26：视频编码中，编码帧的三种基本类型</div>
</div>
<div class="callout-content"><p></p>
</div></div><p>🔺编码帧的三种基本类型：</p>
<ul>
<li>帧内编码帧（I - 帧）：独立于于所有其他帧进行编码</li>
<li>预测编码帧（P - 帧）：基于先前编码的帧进行编码</li>
<li>双向预测帧（B - 帧）：基于先前帧和未来帧进行编码</li>
</ul>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102200349.webp" alt="image.png"></p>
<h2 id="运动估计与补偿"><a class="markdownIt-Anchor" href="#运动估计与补偿"></a> 运动估计与补偿</h2>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 27：运动估计和补偿</div>
</div>
<div class="callout-content"><p></p>
</div></div><p>为了最大限度利用相邻帧的可预测性，在运动补偿过程中估算两帧之间的移动并形成正确预测是非常重要的。</p>
<p>估计帧与帧之间运动的过程称为运动估计；基于先前编码的参考帧预测给定帧，同时补偿两帧之间的相对运动的过程称为运动补偿预测 (MC-prediction)。</p>
<h3 id="基于块的的运动估计补偿"><a class="markdownIt-Anchor" href="#基于块的的运动估计补偿"></a> 基于块的的运动估计补偿</h3>
<p>对于当前帧 M×N 样本的每个块：</p>
<ol>
<li>在参考帧中搜索一个区域，以找到一个“匹配”的 M×N 样本区域</li>
<li>被选中的候选区域称为当前块的预测块，并将其与当前块相减，得到残差</li>
<li>将残差块编译传输，当前块和候选位置区域之间的偏移（运动向量）也将被传输</li>
</ol>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102200446.webp" alt="image.png"></p>
<h3 id="运动补偿块的大小"><a class="markdownIt-Anchor" href="#运动补偿块的大小"></a> 运动补偿块的大小</h3>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102200456.webp" alt="image.png"></p>
<h3 id="子像素运动补偿"><a class="markdownIt-Anchor" href="#子像素运动补偿"></a> 子像素运动补偿</h3>
<p>一个更好的运动补偿预测可以由参考帧中的差值样本位置构建。</p>
<p>分像素运动估计补偿引入查找分样本差值位置和整样本位置，选择最匹配的位置，并使用该位置的整数或子样本值进行运动补偿预测。</p>
<p>过程：</p>
<ol>
<li>在整样本网格（圆圈标记）中找到最佳匹配</li>
<li>搜索紧挨着最佳匹配（方块标记）的半样本位置。</li>
<li>如果需要，则搜索最佳半样本位置（三角形标记）旁边的四分之一样本位置</li>
</ol>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102200508.webp" alt="image.png"></p>
<p>预测越精确，残差越小，motion vector 数据量增加。</p>
<p>随着插补步骤的增加，性能增益趋于减小：</p>
<ul>
<li>与整样本运动补偿相比，半样本插值具有显著的增益。</li>
<li>四分之一样本插值有一定适度改进。</li>
<li>8 个样本插值改进更小，以此类推。</li>
</ul>
<p>与更复杂的运动补偿方案相关的压缩效率权衡：<strong>更精确的运动补偿需要更多的比特来编码向量域，但编码残差比特数更少；反之亦然。</strong></p>
<h2 id="图像模型"><a class="markdownIt-Anchor" href="#图像模型"></a> 图像模型</h2>
<ol>
<li>转换：压缩数据并去相关</li>
<li>量化：降低传输数据的精确度</li>
<li>重新排序：组织数据以合并重要值</li>
<li>预测图像编码</li>
</ol>
<h3 id="预测图像编码"><a class="markdownIt-Anchor" href="#预测图像编码"></a> 预测图像编码</h3>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102200520.webp" alt="image.png"></p>
<p>空间预测，以 DPCM 为例：</p>
<ol>
<li>编码预测：prediction P(X) = (2A+B+C)/4</li>
<li>残差计算：R(X) = X-P(X) ，然后编码并传输 R(X)</li>
<li>解码器解码残差并形成预测：P(X) = (2A+B+C)/4</li>
<li>重建像素：X = R(X) + P(X)</li>
</ol>
<h3 id="转换编码"><a class="markdownIt-Anchor" href="#转换编码"></a> 转换编码</h3>
<p>转换后的数据应当去相关且被压缩：在转换后的数据中，大多数的信息应当被集中于少量的值中。</p>
<p>转换应当可逆。</p>
<p>转换应当容易计算：低内存需求、可使用有限精度算法实现、算数操作数低</p>
<p>目前有许多转换：KLT，SVD，DCT</p>
<p>在 N×N 样本块中，DCT 始终受欢迎，且图像一直在块单元中被处理。</p>
<p>运动补偿残差往往会受到块边缘的伪影（blockiness）的影响。</p>
<p>对整个图像或帧做的基于图像的转换操作有：</p>
<ul>
<li>图像传输（离散小波变换 DWT）胜过静态图像压缩的块传输（JPEG2000）</li>
<li>DWT 需要更高的内存需求（尤其是大图像），因为是以整个图像作为一个单元处理图像的</li>
<li><strong>DWT 并不“适合”基于块的运动补偿</strong></li>
</ul>
<h4 id="2d-dct"><a class="markdownIt-Anchor" href="#2d-dct"></a> 2D-DCT</h4>
<p>正向离散余弦转换：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><mi>A</mi><mi>X</mi><msup><mi>A</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">Y=AXA^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></p>
<p>逆 DCT（IDCT）：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><msup><mi>A</mi><mi>T</mi></msup><mi>Y</mi><mi>A</mi></mrow><annotation encoding="application/x-tex">X=A^TYA</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mord mathnormal">A</span></span></span></span></p>
<p>X 为 N×N 样本块，Y 为系数矩阵，A 为 N×N 传输矩阵</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102200620.webp" alt="image.png"></p>
<p>例子：N=4，有 A：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102200637.webp" alt="image.png"></p>
<h4 id="dct-系数的特征"><a class="markdownIt-Anchor" href="#dct-系数的特征"></a> DCT 系数的特征</h4>
<p>FDCT 输出是一组 N×N 的系数，表示 DCT 域中的图像块数据。</p>
<p>DCT 自身保存所有 N×N 图像块中的信息。</p>
<p>人眼对低频 DCT 参数更加敏感。</p>
<p>DCT 有助于将感知上重要的信息与感知上不重要的信息分离开来。</p>
<p><strong>用更高的精度编码低频的 DCT 信息，但使用更少或不使用比特来编码高频系数，从而丢弃在感知上不太重要的信息。</strong></p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102200648.webp" alt="image.png"></p>
<p>在计算 IDCT 之前添加更多的系数，会逐渐提高原始区块的重建精度，到包含五个系数时，重建的区块与原始区块的匹配程度相当接近。</p>
<p>可以从 16 个 DCT 系数的子集中重建块的近似副本。</p>
<h4 id="dct-计算复杂性"><a class="markdownIt-Anchor" href="#dct-计算复杂性"></a> DCT 计算复杂性</h4>
<p>在典型的 DSP 上，单个 8×8 DCT 或 IDCT 需要几百个指令周期。</p>
<p>以 CIF (352×288) 分辨率和 30 fps 帧率运行的解码器可能需要高达 71,280 IDCT /秒。</p>
<p>IDCT 计算可占用高达 30% 的视频解码器编译周期。</p>
<p>由于 DCT 和 IDCT 在小图像块上操作，因此内存需求相当小，与图像和视频压缩应用程序中的帧缓冲区和其他数据的大小相比，通常可以忽略不计。</p>
<p>DCT 和 IDCT 函数的<strong>高计算需求和小内存需求</strong>使它们成为使用专用硬件加速器实现的理想候选者。</p>
<h3 id="量化-2"><a class="markdownIt-Anchor" href="#量化-2"></a> 量化</h3>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>F</mi><mi>Q</mi><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>r</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>d</mi><mrow><mo fence="true">(</mo><mfrac><mi>X</mi><mrow><mi>Q</mi><mi>P</mi></mrow></mfrac><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>Y</mi><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>F</mi><mi>Q</mi><mo>⋅</mo><mi>Q</mi><mi>P</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
FQ = &amp;round\left( \frac{X}{QP} \right) \\
Y=&amp;FQ\cdot QP
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.20003em;vertical-align:-1.850015em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.350015em;"><span style="top:-4.350015000000001em;"><span class="pstrut" style="height:3.45em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal">Q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span><span style="top:-2.2599850000000004em;"><span class="pstrut" style="height:3.45em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.850015em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.350015em;"><span style="top:-4.350015000000001em;"><span class="pstrut" style="height:3.45em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">o</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span><span style="top:-2.2599850000000004em;"><span class="pstrut" style="height:3.45em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal">Q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">Q</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.850015em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>QP 表示量化步长。</p>
<p>量化用于<strong>丢弃感知上不重要的信息</strong>。</p>
<p>量化后，使用统计方法对剩余信息进行编码，从而使用尽可能少的比特。</p>
<p>量化和去量化对内存的要求通常可以忽略不计。</p>
<h3 id="游程编码rlc"><a class="markdownIt-Anchor" href="#游程编码rlc"></a> 游程编码（RLC）</h3>
<p>量化后，绝大多数高频 DCT 系数为零。</p>
<p>游程编码：</p>
<ul>
<li>将连续的 0 值系数成组（一个游程）</li>
<li>编码 0 的个数（长度），不编码单独 0 系数</li>
</ul>
<p><strong>为了使连续零值系数的平均值尽可能高</strong>，我们以对角之字形的方式扫描 DCT 系数矩阵。</p>
<p>游程编码（RLC，Run-length coding）之后通常是可变长度编码（VLC）。</p>
<h3 id="重新排序"><a class="markdownIt-Anchor" href="#重新排序"></a> 重新排序</h3>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102201034.webp" alt="image.png" width="278px"></p>
<p><strong>重排序是将非零系数组合在一起，实现有效地表示零系数</strong></p>
<h3 id="可变长度编码vlc"><a class="markdownIt-Anchor" href="#可变长度编码vlc"></a> 可变长度编码（VLC）</h3>
<p>一对（游程，量化 DCT 系数）的每个可能值称为一个符号。</p>
<p>常见的符号被分配较短的码字，而不常见的符号被分配较长的码字。</p>
<p>VLC 的一个缺点是编码图像中间的比特误差会阻止解码器正确重建剩余的比特流。</p>
<p>通过在整个编码比特流中散布“重新同步标记”，解码器能够在发生错误时搜索下一个重新同步标记以进行同步。</p>
<h2 id="视频编码结构"><a class="markdownIt-Anchor" href="#视频编码结构"></a> 视频编码结构</h2>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102201058.webp" alt="image.png"></p>
<h2 id="通用视频编码模型"><a class="markdownIt-Anchor" href="#通用视频编码模型"></a> 通用视频编码模型</h2>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102201109.webp" alt="image.png"></p>
<h2 id="编码数据流"><a class="markdownIt-Anchor" href="#编码数据流"></a> 编码数据流</h2>
<p>编码器的两个主要的数据流路径：从左到右（编码）、从右到左（重建）。</p>
<p>编码流：</p>
<ol>
<li>输入视频帧 Fn 用于编码，并以宏块为单位进行处理</li>
<li>Fn 和参考帧（如前编码帧 F’n-1）对比。运动估计函数在 F’n-1 中 16×16 的区域，查找出一个 Fn 中当前宏块的一个匹配。当前宏块位置和被选中的参考区域的偏移为一个移动向量（MV，motion vector）</li>
<li>基于被选中的 MV，生成运动补偿预测 P（被运动估计器选择的 16×16 区域）</li>
<li>当前宏块中减去 P 产生残差或 difference 宏块 D。</li>
</ol>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102201156.webp" alt="image.png"></p>
<p>数据重建流：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102201207.webp" alt="image.png"></p>
<h2 id="解码数据流"><a class="markdownIt-Anchor" href="#解码数据流"></a> 解码数据流</h2>
<p>解码数据流：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102201222.webp" alt="image.png"></p>

<div class="callout" data-callout="example">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-list"><line x1="8" x2="21" y1="6" y2="6"></line><line x1="8" x2="21" y1="12" y2="12"></line><line x1="8" x2="21" y1="18" y2="18"></line><line x1="3" x2="3.01" y1="6" y2="6"></line><line x1="3" x2="3.01" y1="12" y2="12"></line><line x1="3" x2="3.01" y1="18" y2="18"></line></svg>
</div>
<div class="callout-title-inner">习题助记</div>
</div>
<div class="callout-content"><p></p>
<ol>
<li>Write down the full name of ADPCM in English<br>
Adaptive Differential Pulse Code Modulation</li>
<li>List the four types of redundancy used in video coding<br>
时间、空间、感知、统计</li>
<li>What is the sample resolution of CIF<br>
352×288</li>
<li>Write down the formula of PSNR</li>
<li>ln video coding , there are three basic types of coded frames, what are they?<br>
I P B</li>
<li>What is the purpose of DCT?<br>
去相关，使数据更紧凑</li>
<li>What is the purpose of Zigzag Scan or reordering?<br>
是将非零系数组合在一起并有效地表示零系数</li>
<li>What is the purpose of quantization?<br>
量化用于丢弃感知上无关紧要的信息</li>
<li>In motion estimation and compensation, what kind of redundancy is used in video coding?<br>
temporal 时间冗余</li>
<li>In 010 editor template, the following variable is defined at the beginning: char type[4];<br>
The variable type is mapped to&nbsp;0&nbsp;bytes&nbsp;3&nbsp;to in the file.</li>
</ol>
</div></div><h2 id="本小节参考链接"><a class="markdownIt-Anchor" href="#本小节参考链接"></a> 本小节参考链接</h2>
<ul>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.csdn.net/Doctor__Chen/article/details/124781119">质量评估指标：PSNR（Peak signal-to-noise ratio 峰值信噪比）_psnr指标_花生树什么树的博客-CSDN博客</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.zhihu.com/question/22085329/answer/774074211">傅里叶变换、拉普拉斯变换、Z 变换的联系是什么？为什么要进行这些变换？ - 知乎 (zhihu.com)</a></li>
</ul>
<h1 id="jpeg-图像编码"><a class="markdownIt-Anchor" href="#jpeg-图像编码"></a> JPEG 图像编码</h1>
<p><strong>Baseline 方法是迄今为止实现最广泛的 JPEG 方法。</strong></p>
<h2 id="基于-dct-的编码解码过程"><a class="markdownIt-Anchor" href="#基于-dct-的编码解码过程"></a> 基于 DCT 的编码/解码过程</h2>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102201904.webp" alt="image.png"></p>
<p>编码过程：</p>
<ol>
<li>输入的组件样本为 8×8 块</li>
<li>每个块被前向 DCT（FDCT）转换为一组 64 个值，作为 DCT 系数。<br>
a. 第一个值称为 DC 系数<br>
b. 其他 63 个值为 AC 系数</li>
<li>然后使用量化表中 64 个对应值中的一个对 64 个系数中的每个系数进行量化</li>
<li>然后将量化系数传递给熵编码过程，以进一步压缩</li>
</ol>
<p>解码过程：</p>
<ol>
<li>熵解码器解码之字形的量化 DCT 系数</li>
<li>解量化后，通过反向 DCT（IDCT）将 DCT 系数转化为 8*8 样本块</li>
</ol>
<h2 id="前向-dctfdct"><a class="markdownIt-Anchor" href="#前向-dctfdct"></a> 前向 DCT（FDCT）</h2>
<p>在编码器的输入中，原图像采样以 8×8 块成组，从无符号整数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><msup><mn>2</mn><mi>P</mi></msup><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,2^P-1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> 的范围转换为有符号整数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mo>−</mo><msup><mn>2</mn><mrow><mi>P</mi><mo>−</mo><mn>1</mn></mrow></msup><mo separator="true">,</mo><msup><mn>2</mn><mrow><mi>P</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[-2^{P-1},2^{P-1}-1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>，然后输入到 FDCT 中：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231123215755.webp" alt="image.png"></p>
<p>其中，</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left right" columnspacing="0em 1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>C</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>C</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>1</mn><mi mathvariant="normal">/</mi><msqrt><mn>2</mn></msqrt><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>w</mi><mi>h</mi><mi>e</mi><mi>n</mi><mtext>&nbsp;</mtext><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>C</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>C</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>1</mn><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>o</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>r</mi><mtext>&nbsp;</mtext><mi>c</mi><mi>o</mi><mi>n</mi><mi>d</mi><mi>i</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>s</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
C(u),C(v)=&amp;1/\sqrt{ 2 }, &amp;when~u,v=0\\
C(u),C(v)=&amp;1,&amp;other~conditions
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.1160950000000005em;vertical-align:-1.3080475000000003em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8080475000000003em;"><span style="top:-3.8519525000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span><span style="top:-2.3519525em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3080475000000003em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8080475000000003em;"><span style="top:-3.8519525000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">1</span><span class="mord">/</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.956095em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">2</span></span></span><span style="top:-2.916095em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.08390500000000001em;"><span></span></span></span></span></span><span class="mpunct">,</span></span></span><span style="top:-2.3519525em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">1</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3080475000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8080475000000003em;"><span style="top:-3.8519525000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">h</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span><span style="top:-2.3519525em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">o</span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord mathnormal">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3080475000000003em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="反向-dctidct"><a class="markdownIt-Anchor" href="#反向-dctidct"></a> 反向 DCT（IDCT）</h2>
<p>解码器的输出中，IDCT 输出 8×8 采样块以形成重构图片：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231123215702.webp" alt="image.png"></p>
<p>其中，</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left right" columnspacing="0em 1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>C</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>C</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>1</mn><mi mathvariant="normal">/</mi><msqrt><mn>2</mn></msqrt><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>w</mi><mi>h</mi><mi>e</mi><mi>n</mi><mtext>&nbsp;</mtext><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>C</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>C</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>1</mn><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>o</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>r</mi><mtext>&nbsp;</mtext><mi>c</mi><mi>o</mi><mi>n</mi><mi>d</mi><mi>i</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>s</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
C(u),C(v)=&amp;1/\sqrt{ 2 }, &amp;when~ u,v=0\\
C(u),C(v)=&amp;1,&amp;other ~conditions
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.1160950000000005em;vertical-align:-1.3080475000000003em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8080475000000003em;"><span style="top:-3.8519525000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span><span style="top:-2.3519525em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3080475000000003em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8080475000000003em;"><span style="top:-3.8519525000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">1</span><span class="mord">/</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.956095em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">2</span></span></span><span style="top:-2.916095em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.08390500000000001em;"><span></span></span></span></span></span><span class="mpunct">,</span></span></span><span style="top:-2.3519525em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">1</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3080475000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8080475000000003em;"><span style="top:-3.8519525000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">h</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span><span style="top:-2.3519525em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">o</span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord mathnormal">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3080475000000003em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="块样本和-dct-系数的关系"><a class="markdownIt-Anchor" href="#块样本和-dct-系数的关系"></a> 块样本和 DCT 系数的关系</h2>
<ul>
<li>对一个块进行前向 DCT 计算后，64 个 DCT 系数结果被均匀量化器量化</li>
<li>每一个系数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mrow><mi>v</mi><mi>u</mi></mrow></msub></mrow><annotation encoding="application/x-tex">S_{vu}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mord mathnormal mtight">u</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 的量化器步长为对应量化表中的元素 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><mrow><mi>v</mi><mi>u</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Q_{vu}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mord mathnormal mtight">u</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br>
<img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102202014.webp" alt="image.png"></li>
</ul>
<h2 id="dc-编码"><a class="markdownIt-Anchor" href="#dc-编码"></a> DC 编码</h2>
<p>相邻的 8×8 块之间的 DC 系数通常有着强烈的关联性。量化的 DC 系数被编码为与前块的 DC 项的差值。这种特殊处理是值得的，因为 DC 系数包含了总图像能量的很大一部分。</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102202041.webp" alt="image.png"></p>
<h2 id="之字形扫描"><a class="markdownIt-Anchor" href="#之字形扫描"></a> 之字形扫描</h2>
<p>所有的量化系数将以之字形顺序进行组织，将低频系数（一般为非 0）放置在高频系数前，以便于进行熵编码。</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102202052.webp" alt="image.png"></p>
<h2 id="压缩与图像质量"><a class="markdownIt-Anchor" href="#压缩与图像质量"></a> 压缩与图像质量</h2>
<p>对于较复杂场景的彩色图像，所有基于 DCT 的操作模式通常会产生以下级别的图像质量：</p>
<ul>
<li>0.25-0.5 比特/像素：中等至良好质量</li>
<li>0.5-0.75 比特/像素：良好至优秀质量</li>
<li>0.75-1.5 比特/像素：杰出质量，满足大多数的应用</li>
<li>1.5-2.0 比特/像素：和原图相差无几，满足有高质量需求的应用</li>
</ul>
<p>根据源特性和场景内容的不同，质量和压缩会有很大的不同。</p>
<h2 id="具有多个组件的源图像"><a class="markdownIt-Anchor" href="#具有多个组件的源图像"></a> 具有多个组件的源图像</h2>
<p>源图像可能包含 1~255 个图像组件。每一个组件包含样本的矩形数组。</p>
<p>样本被定义为一个 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><msup><mn>2</mn><mrow><mi>P</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0, 2^{P-1}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> 范围的无符号整数。</p>
<p>图像中的所有样本必须有着相同的精度 P，对于基于 DCT 的编解码器，P 可以是 8 或 12。</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102202132.webp" alt="image.png"></p>
<h2 id="多组件交织"><a class="markdownIt-Anchor" href="#多组件交织"></a> 多组件交织</h2>
<p>许多应用程序需要将显示/打印多组件图像的过程与解压过程并行。</p>
<p>这只有在组件在压缩数据流中交织在一起时才可行。</p>
<p>编码交错：如果编码器从 a 压缩一个数据单元，从 B 压缩一个数据单元，从 C 压缩一个数据单元，然后返回到 a…</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102202143.webp" alt="image.png"></p>
<h2 id="不同维度的组件交织顺序"><a class="markdownIt-Anchor" href="#不同维度的组件交织顺序"></a> 不同维度的组件交织顺序</h2>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102202151.webp" alt="image.png"></p>
<p>上例中，B、C 在水平方向上与 A 相比少了一半样本。在这个例子中，A 的两个数据单元和 B、C 的各一个单元进行交织。</p>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 28：JPEG 编码与解码过程：最小编码单元、操作模式、DC 熵编码、AC 熵编码、游程、SIZE、EOB</div>
</div>
<div class="callout-content"><p></p>
</div></div><h2 id="最小编码单元-mcu"><a class="markdownIt-Anchor" href="#最小编码单元-mcu"></a> 最小编码单元 MCU</h2>
<p>在基于 DCT 的编解码器中，<strong>数据单元</strong>是一个 8x8 的样本块。</p>
<p><span style="color:#ff0000">最小编码单元 MCU</span>：最小的交错<strong>数据单元</strong>组。对于非交错数据，MCU 是一个数据单元。对于交错数据，MCU 是由扫描中组件的采样因子定义的数据单元序列。交错数据是 MCU 的有序序列，MCU 中包含的数据单元数由交错的元件数及其相对采样因子决定。</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102202208.webp" alt="image.png"></p>
<p>当两个或更多的组件进行交织时，每一个组件 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">C_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 被 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>V</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">V_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 个数据单元划分为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">H_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 的矩形区域。<strong>最大的组件交织数为 4，且每个 MCU 的数据单元最大值为 10</strong>：$$\sum_{\text{所有参与交织的}~i}{H_i\times V_i}\le 10$$（注：置于 10 这个数字是规定的，没有理由）</p>
<h2 id="操作模式"><a class="markdownIt-Anchor" href="#操作模式"></a> 操作模式</h2>
<p>🔺有四种不同的操作模式，在这些模式下定义了各种编码过程：</p>
<ul>
<li>基于 DCT 的顺序模式（从上到下，一块一块编码）</li>
<li>基于 DCT 的渐进模式（从轮廓到细节）</li>
<li>无损模式</li>
<li>层次模式</li>
</ul>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102202314.webp" alt="image.png"></p>
<h3 id="顺序模式与渐进模式"><a class="markdownIt-Anchor" href="#顺序模式与渐进模式"></a> 顺序模式与渐进模式</h3>
<p>在顺序模式中，每一个图片组件在单个扫描中编码。</p>
<p>在渐进模式中，每一个图片组件在多次扫描中编码。第一次扫描中编码粗糙，但可识别的图像版本可以快速传输，且通过后续的扫描进行改进，直到达到由量化表确定的图像质量水平。</p>
<p><span style="color:#ff0000">有两种互补的方法可以对量化 DCT 系数块进行部分编码</span>：</p>
<ol>
<li>在给定的扫描中，只有之字形序列特定的系数带需要进行编码</li>
<li>在给定的扫描中，无需将当前频带内的系数编码为完全（量化）精度。
<ol>
<li>最重要的 N 个比特可以在第一次扫描中编码</li>
<li>在随后的扫描中，次重要的比特再进行编码</li>
<li>这个过程叫做「连续逼近」</li>
</ol>
</li>
</ol>
<p>这两种程序可以单独使用，也可以灵活地混合使用。</p>
<p>量化 DCT 系数的传递：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102202328.webp" alt="image.png"></p>
<p>光谱选择与逐次逼近：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102202337.webp" alt="image.png"></p>
<h3 id="层次模式"><a class="markdownIt-Anchor" href="#层次模式"></a> 层次模式</h3>
<p>层次模式以多种分辨率的方式为图片提供金字塔型的编码。每一种的分辨率与其相邻的编码在水平或垂直维度或两者上相差两倍：</p>
<ol>
<li>对原始图像在每个维度上按所需的 2 的倍数进行滤波和下采样。</li>
<li>使用顺序 DCT、渐进式 DCT 或无损编码器之一对这个减小尺寸的图像进行编码。</li>
<li>解码此缩小尺寸的图像，然后使用接收器必须使用的相同插值滤波器对它进行水平和/或垂直 2 插值和上采样。</li>
<li>使用此上采样图像作为该分辨率下的原始图像的预测，并使用前面介绍的顺序 DCT，逐行 DCT 或无损编码器之一对差异图像进行编码。</li>
<li>重复第 3 步和第 4 步，直到图像的全分辨率被编码</li>
</ol>
<h2 id="基线顺序熵编码"><a class="markdownIt-Anchor" href="#基线顺序熵编码"></a> 基线顺序熵编码</h2>
<p>在基线顺序编码器中，FDCT、量化、DC 差分以及之字形排序步骤之后，是熵编码。</p>
<p>在熵编码之前，通常只有很少的非零系数和很多零值系数。熵编码的任务是更有效地编码这些系数。</p>
<p>基线顺序熵编码有两个步骤：</p>
<ol>
<li>将量化 DCT 系数转换为中间符号序列（游程编码）</li>
<li>为符号分配可变长度代码（哈夫曼编码）</li>
</ol>
<h3 id="ac-系数"><a class="markdownIt-Anchor" href="#ac-系数"></a> AC 系数</h3>
<p>每一个非零的 AC 系数这样编码：</p>
<ul>
<li><code>RUN-LENGTH</code>：之字形扫描序列中，被表示的非零 AC 系数前，连续数字 0 的长度。
<ul>
<li><code>RUN-LENGTH</code> 代表 <span style="color:#ff0000">0~15</span>，Symbol-1 中 <code>(15, 0)</code> 代表 <code>RUN-LENGTH</code>=16。</li>
<li><code>(0,0)</code> 代表 <code>EOB</code>（块结束），可以将其视为“转义”符号。</li>
</ul>
</li>
<li><code>SIZE</code>：编码 <code>AMPLITUDE</code> 所用的比特数</li>
</ul>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102202410.webp" alt="image.png"></p>

<div class="callout" data-callout="example">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-list"><line x1="8" x2="21" y1="6" y2="6"></line><line x1="8" x2="21" y1="12" y2="12"></line><line x1="8" x2="21" y1="18" y2="18"></line><line x1="3" x2="3.01" y1="6" y2="6"></line><line x1="3" x2="3.01" y1="12" y2="12"></line><line x1="3" x2="3.01" y1="18" y2="18"></line></svg>
</div>
<div class="callout-title-inner">更多例子</div>
</div>
<div class="callout-content"><p>0005&nbsp;→&nbsp;(3,3)(5)<br>
000003&nbsp;→&nbsp;(5,2)(3)<br>
00,-12&nbsp;→ &nbsp;(2,4)(-12)<br>
0…(16 个 0)…0 1 → (15,0)(0,1)(1)<br>
0…(17 个 0)…0 1 → (15,0)(1,1)(1)<br>
0…(18 个 0)…0 -3 → (15,0)(2,2)(-3)<br>
00000 3 0…0&nbsp;→ (5,2)(3)(0,0)<br>
0013&nbsp;→ &nbsp;(2,1)(1) (0,2)(3)</p>
</div></div><h3 id="amplitude-和-size-的范围"><a class="markdownIt-Anchor" href="#amplitude-和-size-的范围"></a> AMPLITUDE 和 SIZE 的范围</h3>
<p>量化 AC 系数的取值范围决定了 AMPLITUDE 和 SIZE 信息必须表示的值的范围。对 8×8 FDCT 方程的数值分析表明，如果 64 点 (8×8 块) 输入信号包含 N 位整数，则输出数字的非小数部分 (DCT 系数) 最多可以增长 3 位。这也是量化 DCT 系数的最大可能大小。</p>
<p>基线顺序在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mo>−</mo><msup><mn>2</mn><mn>7</mn></msup><mo separator="true">,</mo><msup><mn>2</mn><mn>7</mn></msup><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[-2^7,2^7-1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> 范围内有 8 位整数源样本，因此量化的 AC 系数幅度由 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mo>−</mo><msup><mn>2</mn><mn>10</mn></msup><mo separator="true">,</mo><msup><mn>2</mn><mn>10</mn></msup><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[-2^{10},2^{10}-1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> 范围内的整数覆盖。</p>
<p>带符号整数编码使用长度为 1 到 10 位的 symbol-2 AMPLITUDE 码，因此 SIZE 也代表 1 到 10 的值。RUNLENGTH 表示从 0 到 15 的值。</p>
<h3 id="dc-系数"><a class="markdownIt-Anchor" href="#dc-系数"></a> DC 系数</h3>
<p>8×8 样本块的差分 DC 系数的中间表示结构类似：</p>
<ul>
<li>Symbol-1 只表示 SIZE 信息</li>
<li>Symbol-2 表示振幅信息</li>
</ul>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102202435.webp" alt="image.png"></p>
<p>因为 DC 系数是差分编码的，所以它覆盖的整数值 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mo>−</mo><msup><mn>2</mn><mn>11</mn></msup><mo separator="true">,</mo><msup><mn>2</mn><mn>11</mn></msup><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[-2^{11},2^{11}-1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> 是 AC 系数的两倍，因此必须为 DC 系数增加一个附加的电平。</p>
<p>因此，DC 系数大小的 symbol–1 表示从 0 到 11 的值。</p>
<blockquote>
<p><strong>差分编码</strong>（differential encoding）指的是对数字数据流，除第一个元素外，将其中各元素都表示为各该元素与其前一元素的差的编码。差分编码的简单例子是储存序列式资料之间的差异（而不是储存资料本身）：不存“2, 4, 6, 9, 7”，而是存“2, 2, 2, 3, -2”。</p>
</blockquote>
<h3 id="可变长度熵编码"><a class="markdownIt-Anchor" href="#可变长度熵编码"></a> 可变长度熵编码</h3>
<p>对于 DC 和 AC 系数，每个 symbol-1 均使用来自 Huffman 表集中的可变长度代码（VLC）进行编码。 每个 symbol-2 均使用“可变长度整数”（VLI）码进行编码。</p>
<p>VLCs 和 VLIs 是具有可变长度的代码，但 VLI 不是霍夫曼代码。一个重要的区别是，VLC（ Huffman code）的长度直到解码才知道，而 VLI 的长度存储在其前一个 VLC 中。</p>
<p>Huffman 码必须在外部指定为 JPEG 编码器的输入。</p>
<p>请注意，Huffman 表在数据流中的表示形式是一种间接规范，解码器在解压缩之前必须以此间接规范来构造表（解码时需要重新构建 Huffman 树进行解码）。 JPEG 标准包括一组 Huffman 表的示例，但这不是强制性的。</p>
<h3 id="基线编码例子"><a class="markdownIt-Anchor" href="#基线编码例子"></a> 基线编码例子</h3>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102202510.webp" alt="image.png"></p>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 29：JPEG 交换格式（JIF）：图像、帧、扫描和标记</div>
</div>
<div class="callout-content"><p></p>
</div></div><h2 id="图像-帧和扫描的关系"><a class="markdownIt-Anchor" href="#图像-帧和扫描的关系"></a> 图像、帧和扫描的关系</h2>
<ul>
<li>压缩的图像数据只包含一张图片。</li>
<li><strong>在渐进模式和顺序模式编码过程中，一张图片只包含一帧。</strong></li>
<li><strong>在层次模式中，一张图片可以包含多帧。</strong></li>
<li>一帧可以包含一个或多个扫描。</li>
<li>顺序模式下，一个扫描包含一个完整的、单个/多个图像组件的编码。</li>
<li><span style="color:#ff0000">在层次模式中：当一张图像的三个组件非交织时，一帧包含三个扫描；如果三个组件交织一起，那么一帧包含一趟扫描。</span></li>
<li>一帧也可以包含两趟扫描：一趟是非交织的组件、另一趟为两组件交织。</li>
</ul>
<h2 id="标记"><a class="markdownIt-Anchor" href="#标记"></a> 标记</h2>
<p><strong>标记用于标识压缩数据格式的各种结构部分。</strong></p>
<p>所有的标记赋予两个字节编码：0xFF+ 不等于 0 或 0xFF 的字节。</p>
<p>标记段包含一个标记以及相关参数的序列。标记段的第一个参数是两字节长的参数，它指定了标记段的字节数（除去两字节标记后的参数长度）</p>
<p>被 SOF 和 SOS 标记码标识出的标记段被视为头（headers）：分别为帧报头和扫描报头。</p>
<p>SOI（0xFFD8）：压缩图片开始标记</p>
<p>EOI（0xFFD9）：压缩图片的结束标记</p>
<h3 id="高级语法"><a class="markdownIt-Anchor" href="#高级语法"></a> 高级语法</h3>
<p>基于顺序 DCT、渐进式 DCT 和无损操作模式的语法：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102202539.webp" alt="image.png"></p>
<h4 id="帧头语义"><a class="markdownIt-Anchor" href="#帧头语义"></a> 帧头语义</h4>
<p>帧报头应该出现在帧的开始。该报头指定源图像特征、帧中的组件和每个组件的采样因子，并指定从中检索要与每个组件一起使用的量化表的目标。</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102202601.webp" alt="image.png"></p>
<table>
<thead>
<tr>
<th>标记结构</th>
<th>长度（字节）</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>0xFFC0</td>
<td>2</td>
<td>SOF marker</td>
</tr>
<tr>
<td>Lf</td>
<td>2</td>
<td>Frame header length, not including the first two bytes 0xFF, 0xC0</td>
</tr>
<tr>
<td>P</td>
<td>1</td>
<td>Sampling precision, equals 0x08 in a baseline system</td>
</tr>
<tr>
<td>Y</td>
<td>2</td>
<td>Image height</td>
</tr>
<tr>
<td>X</td>
<td>2</td>
<td>Image width</td>
</tr>
<tr>
<td>Nf</td>
<td>1</td>
<td>Number of components in a frame. 1 (grey scale) or 3 (color)</td>
</tr>
<tr>
<td>C1</td>
<td>1</td>
<td>Component 1</td>
</tr>
<tr>
<td>(H1,V1)</td>
<td>1</td>
<td>Horizontal and vertical sampling factor</td>
</tr>
<tr>
<td>Tq1</td>
<td>1</td>
<td>Quantization table</td>
</tr>
<tr>
<td>C2</td>
<td>1</td>
<td>Component 2</td>
</tr>
<tr>
<td>(H2,V2)</td>
<td>1</td>
<td>Horizontal and vertical sampling factor</td>
</tr>
<tr>
<td>Tq2</td>
<td>1</td>
<td>Quantization table</td>
</tr>
<tr>
<td>⋯</td>
<td>⋯</td>
<td>⋯</td>
</tr>
</tbody>
</table>
<h4 id="扫描头语义"><a class="markdownIt-Anchor" href="#扫描头语义"></a> 扫描头语义</h4>
<p>扫描头应在扫描开始时出现。这个报头指定扫描中包含哪些组件，指定从中检索要与每个组件一起使用的熵表的地址。</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102202705.webp" alt="image.png"></p>
<table>
<thead>
<tr>
<th>标记</th>
<th>长度（字节）</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>0xFFDA</td>
<td>2</td>
<td>SOS marker</td>
</tr>
<tr>
<td>Ls</td>
<td>2</td>
<td>Scan header length, not including the first two bytes 0xFF, 0xDA</td>
</tr>
<tr>
<td>Ns</td>
<td>1</td>
<td>Number of components in a scan, in a baseline system, Ns=Nf (Number of components in a frame)</td>
</tr>
<tr>
<td>Cs1</td>
<td>1</td>
<td>Component number in a scan</td>
</tr>
<tr>
<td>(Td1,Ta1)</td>
<td>1</td>
<td>Tdn: the four most significant bits, used to select DC entropy coding table <br>Tan: the four least significant bits, used to select AC entropy coding table</td>
</tr>
<tr>
<td>⋯</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Ss</td>
<td>1</td>
<td>Default values are [00] [3F] [00] in a baseline system</td>
</tr>
<tr>
<td>Se</td>
<td>1</td>
<td>Default values are [00] [3F] [00] in a baseline system</td>
</tr>
<tr>
<td>(Ah,Al)</td>
<td>1</td>
<td>Default values are [00] [3F] [00] in a baseline system</td>
</tr>
</tbody>
</table>
<h4 id="dqt-标记段语义"><a class="markdownIt-Anchor" href="#dqt-标记段语义"></a> DQT 标记段语义</h4>
<p>定义量化表 (DQT) 标记段，用于定义一个或多个量化表。</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102202826.webp" alt="image.png"></p>
<table>
<thead>
<tr>
<th>标记</th>
<th>长度（字节）</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>0XFFDB</td>
<td>2</td>
<td>DQT marker</td>
</tr>
<tr>
<td>Lq</td>
<td>2</td>
<td>Quantization table length， not including 0XFF， 0XDB</td>
</tr>
<tr>
<td>(Pq,Tq)</td>
<td>1</td>
<td>Quantization table element precision <br>Pq=0, 8 bits for Q0~Qn, Pq=1, 16 bits for Qt; <br>Tq: Quantization table destination identifier</td>
</tr>
<tr>
<td>Q0</td>
<td>1 or 2</td>
<td>Quantization table element‐Specifies the kth element out of 64 elements</td>
</tr>
<tr>
<td>Q1</td>
<td>1 or 2</td>
<td>Quantization table element‐Specifies the kth element out of 64 elements</td>
</tr>
<tr>
<td>Qn</td>
<td>1 or 2</td>
<td>Quantization table element‐Specifies the kth element out of 64 elements</td>
</tr>
</tbody>
</table>
<h4 id="哈夫曼表规范语法"><a class="markdownIt-Anchor" href="#哈夫曼表规范语法"></a> 哈夫曼表规范语法</h4>
<p>哈夫曼表标记 (DHT) 段定义了一个或多个霍夫曼表规范。</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102202912.webp" alt="image.png"></p>
<table>
<thead>
<tr>
<th>标记</th>
<th>长度（字节）</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>0xFFC4</td>
<td>1</td>
<td>DHT marker</td>
</tr>
<tr>
<td>Ls</td>
<td>2</td>
<td>Huffman table definition length, not including 0xFF, 0xC4</td>
</tr>
<tr>
<td>(Tc,Th)</td>
<td>1</td>
<td>TC: Table class – 0 = DC table or lossless table, 1 = AC table. <br>Th:Huffman table destination identifier <br>Th Specifies one of four possible destinations at the decoder into which the Huffman table shall be installed.</td>
</tr>
<tr>
<td>L 1</td>
<td>1</td>
<td>Number of Huffman codes of length i</td>
</tr>
<tr>
<td>⋯</td>
<td>⋯</td>
<td></td>
</tr>
<tr>
<td>L 16</td>
<td>1</td>
<td></td>
</tr>
<tr>
<td>V 1</td>
<td>1</td>
<td>Value associated with each Huffman code, t=L1+L2+…L16</td>
</tr>
<tr>
<td>…</td>
<td>…</td>
<td></td>
</tr>
<tr>
<td>V t</td>
<td>1</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="jpeg-文件"><a class="markdownIt-Anchor" href="#jpeg-文件"></a> JPEG 文件</h2>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 30：JPEG 文件交换格式（JFIF）</div>
</div>
<div class="callout-content"><p></p>
</div></div><p>到目前为止，我们描述的文件格式被称为「JPEG 交换格式 (JIF)」。然而，这种“纯粹”的文件格式很少使用，主要是因为，这个标准的某些缺点:</p>
<ul>
<li>色彩空间定义</li>
<li>组件子采样注册</li>
<li>像素宽高比定义</li>
</ul>
<p>JPEG 文件交换格式（JFIF）解决了 JIF 的局限性。JFIF 文件中的图像数据使用 JPEG 标准中的技术进行压缩，因此 JFIF 有时被称为“JPEG/JFIF”。</p>
<p>JPEG 文件交换格式是一种最小的文件格式，它使 JPEG 比特流能够在各种平台和应用程序之间进行交换。</p>
<p>此简化格式的唯一目的是允许交换 JPEG 压缩图像。</p>
<p>尽管 JPEG 文件交换格式 (JFIF) 的语法支持任何 JPEG 过程，但强烈建议将 JPEG 基线过程用于文件交换，这确保了与所有支持 JPEG 的应用程序的最大兼容性。</p>
<p><strong>JPEG 文件交换格式与标准的 JPEG 交换格式完全兼容。唯一的额外要求是必须在 SOI 标记之后出现 APP0 标记。</strong></p>
<p>JFIF 文件使用 APP0 标记段，并在帧头中限制某些参数，定义如下：</p>
<ul>
<li>长度、标识符、版本、单位、X 密度、Y 密度、X 缩略图、Y 缩略图、(RGB)n</li>
</ul>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102203032.webp" alt="image.png"></p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102203038.webp" alt="image.png"></p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102203043.webp" alt="image.png"></p>
<h2 id="编码过程-2"><a class="markdownIt-Anchor" href="#编码过程-2"></a> 编码过程</h2>
<p>编码图像的流程</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102203054.webp" alt="image.png"></p>
<p>编码帧的流程</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102203101.webp" alt="image.png"></p>
<p>编码扫描的流程</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102203117.webp" alt="image.png"></p>
<p>编码重启间隔的流程</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102203125.webp" alt="image.png"></p>
<p>对最小编码单元进行编码的过程</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102203134.webp" alt="image.png"></p>
<p>使用哈夫曼编码 AC 系数的过程</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102203141.webp" alt="image.png"></p>
<p>非零 AC 系数的顺序编码过程</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102203149.webp" alt="image.png"></p>
<h2 id="解码过程"><a class="markdownIt-Anchor" href="#解码过程"></a> 解码过程</h2>
<p>解码压缩图像数据的过程</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102203157.webp" alt="image.png"></p>
<p>解码一帧的过程</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102203206.webp" alt="image.png"></p>
<p>解码扫描的过程：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102203212.webp" alt="image.png"></p>
<p>解码重启间隙的过程：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102203223.webp" alt="image.png"></p>
<p>解码 MCU 的过程：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231102203230.webp" alt="image.png"></p>

<div class="callout" data-callout="example">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-list"><line x1="8" x2="21" y1="6" y2="6"></line><line x1="8" x2="21" y1="12" y2="12"></line><line x1="8" x2="21" y1="18" y2="18"></line><line x1="3" x2="3.01" y1="6" y2="6"></line><line x1="3" x2="3.01" y1="12" y2="12"></line><line x1="3" x2="3.01" y1="18" y2="18"></line></svg>
</div>
<div class="callout-title-inner">习题助记</div>
</div>
<div class="callout-content"><p></p>
<ol>
<li>What are markers used for in JIF?<br>
标识压缩数据格式中不同的结构部分</li>
<li>Describe the full name of SOI,EOI,SOF,SOS<br>
Start of image marker,End of image marker,Start of Frame marker,Start of Scan marker</li>
<li>What is JPEG file interchange format used for?<br>
定义分辨率颜色等相关参数，为了能在不同应用和平台转换</li>
<li>An image contains ___ frame in the cases of sequential and progressive coding processes.<br>
one frame</li>
</ol>
</div></div><h1 id="视频编码"><a class="markdownIt-Anchor" href="#视频编码"></a> 视频编码</h1>
<h2 id="视频编码标准的制定"><a class="markdownIt-Anchor" href="#视频编码标准的制定"></a> 视频编码标准的制定</h2>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 2：视频压缩标准及应用</div>
</div>
<div class="callout-content"><p></p>
</div></div><h3 id="itu-t-国际电信联盟-电信"><a class="markdownIt-Anchor" href="#itu-t-国际电信联盟-电信"></a> ITU-T 国际电信联盟 - 电信</h3>
<h4 id="h261"><a class="markdownIt-Anchor" href="#h261"></a> H.261</h4>
<ul>
<li>第一个视频压缩标准（1990 年）</li>
<li>专为综合业务数字网络（ISDN）视频会议设计的。</li>
<li>支持 352X288（CIF）和 176X144（QCIF）的分辨率色度分辨率子采样为 4：2：0</li>
<li>由于视频电话需要，在仅需较低的复杂性同时进行实时编码和解码。</li>
<li>由于它专注于对延迟敏感的双向视频，<span style="color:#ff0000">H.261 仅允许 I 和 P 帧，不允许 B 帧</span>。（B 帧需要等待后帧解码，存在时延）</li>
<li><strong>基于整数像素精度</strong>进行运动估计运算和搜索范围为 +/- 15 像素。</li>
<li>将基于 8x8 块的 DCT 应用于残差。然后在所有 AC 系数上进行<strong>固定</strong>的线性量化用<strong>固定</strong>的量化步长线性量化。</li>
<li>首先对量化系数进行游程编码，然后可变长度（霍夫曼）编码。</li>
<li>将简单的 2D FIR 滤波器应用于块边缘减少块效应。</li>
</ul>
<h4 id="h263"><a class="markdownIt-Anchor" href="#h263"></a> H.263</h4>
<ul>
<li>用于公共交换电话网络（PSTN）可视电话</li>
<li>H.263（1996）是在 H.261 之后开发的，专注于更好<strong>更低比特率</strong>的视频质量。</li>
<li>通过普通电话调制解调器以 33.6 Kbps 的速度传输视频，是其重要的目标之一。</li>
<li>目标分辨率为 SQCIF（128x96）至 CIF（352X288）</li>
<li>与 H.261 类似，但运动矢量略有不同。其<strong>允许为½（“半像素”）的倍数</strong>。使用 16x16 宏块中的<strong>四个 8x8 像素块的四个运动矢量</strong>，而不是宏块的单个运动矢量。</li>
<li>PB 帧：P 帧和 B 帧（这是从当前编码的 P 帧和后一个先前编码的 P 帧预测而来的）编码为一个单元。</li>
<li>使用基于内容的算术编码模式代替霍夫曼编码，对于相同的图像质量，比特率略有降低。</li>
<li>H.263 通常在相同的比特率下实现大约 3 dB 的改善，或者在相同的 SNR（质量）下将比特率减少 50％。</li>
</ul>
<h4 id="h264advanced-video-coding"><a class="markdownIt-Anchor" href="#h264advanced-video-coding"></a> H.264：Advanced video coding</h4>
<p>详看 🍂H.264-MPEG4-AVC（高级视频编码） 小节。</p>
<h3 id="iso-国际标准化组织"><a class="markdownIt-Anchor" href="#iso-国际标准化组织"></a> ISO 国际标准化组织</h3>
<p>MPEG 成立于 1988 年，旨在开发在数字存储媒体上移动图片（视频）和关联的音频（光盘）的压缩标准。</p>
<h4 id="mpeg-1"><a class="markdownIt-Anchor" href="#mpeg-1"></a> MPEG-1</h4>
<ul>
<li>ISO 制定的第一个视频压缩算法 (1991)</li>
<li>可在获得与 VHS 品质相似的视频和音频</li>
<li>比特率 1.5Mb/s</li>
<li>与典型的视频电话相比，支持电影内容中较重的运动（heavier motion）需要更多的计算资源</li>
<li>允许更长的延迟，允许 B 帧</li>
<li>使用自适应感知量化。单独的量化比例因子专门应用于每个频点以优化人类的视觉感知。</li>
</ul>
<h4 id="mpeg-2"><a class="markdownIt-Anchor" href="#mpeg-2"></a> MPEG-2</h4>
<ul>
<li>是 MPEG-1 的扩展，支持更高的比特率，更高分辨率和<strong>隔行</strong>扫描图片（用于电视）。（先打奇数行再偶数行）</li>
<li>是为数字电视开发的比特率较高的应用：DTV，HDTV 和 DVD</li>
<li>由许多部分组成，包括视频，音频，系统，兼容性测试。</li>
<li>在 30：1 左右的压缩率下表现良好。 MPEG-2 以 4~8 Mbps 达到的质量对于消费者视频应用程序是可接受的。</li>
</ul>
<h5 id="mpeg-2-profiles-and-levels"><a class="markdownIt-Anchor" href="#mpeg-2-profiles-and-levels"></a> MPEG-2 Profiles and Levels</h5>
<p>这些标准旨在解决大量不同的应用程序需要许多不同的工具或功能的问题。典型的应用程序可能仅使用 MPEG 功能的一小部分。 为了实现更有效的实现，MPEG 将功能的子集适当的组合在一起，并定义了一组配置文件和级别。</p>
<ul>
<li>档次（profile）定义了视频语法和功能的子集。</li>
<li>在档次（profile）中，级别定义了某些参数的最大范围，例如分辨率，帧速率，比特率和缓冲区大小（下限）。</li>
</ul>
<p>两个广泛使用的配置文件/级别是：</p>
<ul>
<li>Main Level at Main Profile (MP@ML)：用于压缩 DVD 上使用的常规电视（例如 NTSC 或 PAL）和标清数字电视（SD DTV）</li>
<li>Main Profile at High Level (MP@HL)：用于压缩高清电视（HDTV）（1080p）</li>
</ul>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231109211917.webp" alt="image.png"></p>
<h4 id="mpeg-4"><a class="markdownIt-Anchor" href="#mpeg-4"></a> MPEG-4</h4>
<p>MPEG-4 与 MPEG-1 和 MPEG-2 完全不同，它的主要目标是提供新功能，而不仅仅是提供更好的压缩。将提供增强的功能：</p>
<ul>
<li>支持基于对象或基于内容的表示。这使得可以对视频场景中的不同视频对象进行单独编码，并且允许对视频中的不同对象进行单独访问和操作。请注意，MPEG-4 没有指定如何识别或分割视频中的对象。但是，如果单个对象已知，MPEG-4 提供了一种压缩这些对象的方法。</li>
<li>支持对合成或计算机生成的视频对象进行压缩，以及在单个视频中集成自然对象和合成对象。此外，MPEG-4 支持通过差错恢复（例如 Internet 和 3G 无线系统）进行防错通信。因此，MPEG-4 同时支持基于对象和基于帧的视频编码。</li>
<li>与场景的交互</li>
</ul>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231109213856.webp" alt="image.png" width="475px"></p>
<p>Demuxer 用于解析和解码视频和音频对象。场景描述信息描述了解码对象如何组成和渲染以形成最终场景。</p>
<p>与 MPEG-2 和 MPEG-4 简单档次相比，H.264 / AVC 在压缩效率方面取得了重大突破，通常可实现约 2 倍的压缩。</p>
<p>为了满足从低质量，低分辨率监视摄像机到高清电视广播和 DVD 的各种应用，MPEG-4 第 2 部分定义了大约 21 个档次（profiles）：Simple, Advanced Simple, Main, Core, Advanced Coding Efficiency, Advanced Real Time Simple 等。最常用的档次是 Advanced Simple 和 Simple（都是 Advanced Simple 的子集）。</p>
<h3 id="当前视频压缩标准"><a class="markdownIt-Anchor" href="#当前视频压缩标准"></a> 当前视频压缩标准</h3>
<table>
<thead>
<tr>
<th>年份</th>
<th>标准</th>
<th>发布机构</th>
<th>🔺常用于</th>
</tr>
</thead>
<tbody>
<tr>
<td>1990</td>
<td>H.261</td>
<td>ITU-T</td>
<td>ISDN 上的视频会议, 可视电话</td>
</tr>
<tr>
<td>1993</td>
<td>MPEG-1 part 2</td>
<td>ISO, IEC</td>
<td>Video-CD 数字存储媒介（CD-ROM）上的视频</td>
</tr>
<tr>
<td>1995</td>
<td>H.262/MPEG-2 Part 2</td>
<td>ISO, IEC, ITU-T</td>
<td>DVD Video, Blu-ray, Digital Video Broadcasting, 数字电视</td>
</tr>
<tr>
<td>1996</td>
<td>H.263</td>
<td>ITU-T</td>
<td>视频会议, PSTN 上的可视电话, Video on Mobile Phones (3GP)</td>
</tr>
<tr>
<td>1999</td>
<td>MPEG-4 Part 2</td>
<td>ISO, IEC</td>
<td>Video on Internet (DivX, Xvid …), 基于对象的编码, 合成内容, 集成</td>
</tr>
<tr>
<td>2003</td>
<td>H.264/MPEG-4 AVC</td>
<td>Sony, Panosonic, Samsung, ISO, IEC, ITU-T</td>
<td>Blu-ray,HD DVD Digital Video Broadcasting, 无线, 因特网, 电影, 视频电话, 视频会议</td>
</tr>
</tbody>
</table>
<h2 id="标准化的范围"><a class="markdownIt-Anchor" href="#标准化的范围"></a> 标准化的范围</h2>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 31：视频编码和解码架构：normative, informative</div>
</div>
<div class="callout-content"><p></p>
</div></div><p>视频压缩系统由一个编码器，压缩比特流和解码器组成。</p>
<p>标准限定的范围有限，是为了在确保互操作性同时尽可能实现差异化：</p>
<ul>
<li><span style="color:#ff0000">标准指定比特流语法和解码过程</span></li>
<li>标准不限定编码过程或具体解码器的实现。</li>
</ul>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231109202142.webp" alt="image.png"></p>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 32：MPEG 编码结构、MPEG 语法</div>
</div>
<div class="callout-content"><p></p>
</div></div><h2 id="mpeg-编码结构"><a class="markdownIt-Anchor" href="#mpeg-编码结构"></a> MPEG 编码结构</h2>
<p>MPEG 以单元层次结构编码视频，这些单元称为<strong>序列、图像组 (GOPs)、图像、切片、宏块和 DCT 块</strong>：</p>
<ul>
<li>对 16x16 像素的宏块执行 MC 预测（运动补偿预测）</li>
<li>这些宏块组成一个切片</li>
<li>一帧中的所有切片均包含一张图片，连续的图片形成一个 GOP。</li>
<li>所有 GOP 形成一个序列。</li>
</ul>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231109203121.webp" alt="image.png"></p>
<h3 id="gop"><a class="markdownIt-Anchor" href="#gop"></a> GOP</h3>
<p>视频帧被分组为编码单元，称为图像组 (GOPs)。</p>
<p>GOPs 具有重新初始化编码中使用的时间预测的属性。</p>
<p><strong>GOP 的第一帧总是以帧内模式编码，称为 I 帧</strong></p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231109203351.webp" alt="image.png" width="525px"></p>
<p>用 I 帧通过正向预测或双向预测得到 P 帧或 B 帧。</p>
<p>GOP 长度通常在 9 到 15 帧之间。</p>
<p><strong>每个 B 帧都取决于过去帧和一个将来帧，这意味着将来帧必须是在当前 B 帧可以被解/编码之前被解/编码。</strong></p>
<p><strong>编码后的视频数据以编码顺序放置在数据流中，而不是显示顺序</strong>。</p>
<h3 id="i-p-b-帧编码属性"><a class="markdownIt-Anchor" href="#i-p-b-帧编码属性"></a> I P B 帧编码属性</h3>
<p>I，P 和 B 帧的编码通常需要不同数据量。</p>
<ul>
<li>I 帧需要大量数据，因为它们的编码与其他框架无关。</li>
<li><span style="color:#ff0000">P 和 B 帧通常需要的数据少于 I 帧（时间预测）</span>。</li>
<li>B 帧的编码数据通常少于 P 帧，因为：
<ul>
<li>同时使用前后参考帧，可以形成更好的预测。</li>
<li>以较低的质量编码 B 帧通常不会带来负面影响，B 帧的编码质量较低不会影响序列中的其他帧。</li>
</ul>
</li>
</ul>
<h3 id="宏块"><a class="markdownIt-Anchor" href="#宏块"></a> 宏块</h3>
<p>MPEG 使用 16x16 像素 MC 预测来减少时间视频中固有的冗余。</p>
<p>在 I 帧中，必须以帧内模式对每个宏块进行编码。</p>
<p>在 P 帧中，每个宏块都可以使用前向编码预测或帧内模式。</p>
<p>在 B 帧中，每个宏块都可以前向编码，后向或双向预测或帧内模式。</p>
<p>为每个前向和后向预测指定一个 MV（motion vector）宏块，同时为每个双向指定两个 MV 预测宏块。</p>
<h3 id="dct-块"><a class="markdownIt-Anchor" href="#dct-块"></a> DCT 块</h3>
<p>每个宏块（intra or inter）被划分为 8x8 像素块。</p>
<p>为每个块计算 2D-DCT。 DCT 系数被单独量化。</p>
<p>量化系数经过 zigzag 扫描，游程长度进行编码，结果对（游程长度，幅度组成的一对）经过霍夫曼编码并输出至比特流。</p>
<p>还有一些块间和宏块间处理。</p>
<h3 id="slices"><a class="markdownIt-Anchor" href="#slices"></a> Slices</h3>
<p>MPEG 编码要求每个宏块都属于一个切片，所有切片都构成整个图片。</p>
<p><span style="color:#ff0000">切片是一系列任意数量的连续宏块：</span></p>
<ul>
<li><span style="color:#ff0000">每个切片至少应包含一个宏块。</span></li>
<li><span style="color:#ff0000">切片不得重叠。</span></li>
<li><span style="color:#ff0000">切片的位置可能因图片而异。</span></li>
</ul>
<p>这提供了一种用于预测宏块中某些参数的结构，同时保持一定程度的错误弹性。</p>
<p>在 I 帧中，DCT 系数的 DC 值在一个<strong>片（Slice）内</strong>从块到块被差分编码。（JPEG 是整幅图做差分编码）</p>
<p>在 P 和 B 帧中，运动矢量在片内从宏块到宏块进行差分编码。</p>
<p>如果位流中发生错误，则切片中的剩余数据将丢失。 但是，解码器可以通过搜索下一个切片起始码，重新同步位流并继续解码过程来恢复。</p>
<h3 id="mpeg-syntax"><a class="markdownIt-Anchor" href="#mpeg-syntax"></a> MPEG Syntax</h3>
<p><strong>序列头</strong>指定图片的高度/宽度，以及样本宽高比，帧速率，比特率和缓冲区大小序列。 如果未使用默认的量化器，则还包括量化矩阵。</p>
<p><strong>GOP 头</strong>指定时间代码并指示 GOP 是否打开或关闭。</p>
<p><strong>图像头</strong>指定<strong>时间参考参数</strong>，图片类型（I，P 或 B）以及缓冲区充满度。 如果是使用时域预测，它还描述了运动矢量精度（完整或半像素）和运动矢量范围。</p>
<p><strong>切片头</strong>指定了切片开始的宏块行，以及 DCT 系数的初始量化器比例因子。</p>
<p><strong>宏块头</strong>包含一个标志，<strong>指示是内部还是帧间编码</strong>。</p>
<p>对于帧间编码，它包含编码的运动矢量，这个运动矢量会基于相对于先前的运动矢量进行差分编码。</p>
<p>可以在宏块级别上调整量化器比例因子。1bit 用于指定是否调整因子。</p>
<p>序列、GOP、图片、切片的标头以这些代码开头：</p>
<ul>
<li>例如，通过简单地检查编码数据流而无需解析或解码数据，就能找到第二个 GOP 中第二张图片的第二切片编码的数据</li>
<li>允许对压缩比特流的随机访问</li>
<li>提高容错能力</li>
</ul>

<div class="callout" data-callout="example">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-list"><line x1="8" x2="21" y1="6" y2="6"></line><line x1="8" x2="21" y1="12" y2="12"></line><line x1="8" x2="21" y1="18" y2="18"></line><line x1="3" x2="3.01" y1="6" y2="6"></line><line x1="3" x2="3.01" y1="12" y2="12"></line><line x1="3" x2="3.01" y1="18" y2="18"></line></svg>
</div>
<div class="callout-title-inner">习题助记</div>
</div>
<div class="callout-content"><p>MPEG-1 is used in <strong>VCD</strong> ，MPEG-2 is used in <strong>DVD</strong>.<br>
MP3 is a lossy compression method.<br>
H.261、H.263 主要用于可视电话<br>
The bit stream synatax is specified in MPEG video coding standard.<br>
The encoding process is <strong>NOT</strong> specified in MPEG coding standard.<br>
MPEG-1 allows B frames.<br>
P frames require <strong>LESS</strong> data than I frames because of temporal prediction.<br>
In video coding the position of slices may change from picture to picture.<br>
In video coding <strong>the Picture header</strong> specifiles the temporal reference parameter</p>
</div></div><h1 id="h264-mpeg4-avc高级视频编码"><a class="markdownIt-Anchor" href="#h264-mpeg4-avc高级视频编码"></a> 🍂H.264-MPEG4-AVC（高级视频编码）</h1>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 33：H.264 编码结构、基线档次、主档次、向量块大小、新特性、视频编码层级和网络抽象层</div>
</div>
<div class="callout-content"><p></p>
</div></div><p>在过去十年中，视频编码领域最重要的发展之一是由 ITU 和 ISO/IEC 的联合视频团队（Joint Video Team，JVT）定义的 H.264/MPEG-4 AVC 标准。ITU 从 1997 年开始使用新的编码工具开展了 H.26L（for long term）的工作。结果令人印象深刻，因此 ISO/IEC 决定与 ITU 合作，采用一个共同的标准，成立了联合视频团队。ITU 于 2003 年 5 月批准了新的 H.264 标准。ISO 于 2003 年 10 月批准了该标准，命名为 MPEG-4 第 10 部分，即高级视频编码（AVC）。</p>
<p>块框图和特性：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231110224654.webp" alt="image.png"></p>
<p>H.264/AVC 在压缩效率方面取得了重大突破，通常相对于 MPEG-2 和 MPEG-4 简单档次实现了大约 2 倍的压缩比。</p>
<p>在 H.264 标准化时，它支持三种档次（profiles）：基线档次、主要档次和扩展档次。</p>
<ul>
<li>后来，一项名为保真度范围扩展（FRExt）的修正引入了四个额外的配置，称为高级档次。</li>
<li>最初，基本档次和主档次引起了最大的关注。</li>
</ul>
<p>基本档次需要较少的计算和系统内存，并且针对低延迟进行了优化：</p>
<ul>
<li><span style="color:#ff0000">基本档次不包括 B 帧（由于固有时延）</span>或 <strong>CABAC（由于计算复杂性</strong>）。</li>
<li>基本档次非常适合视频电话应用以及其他需要成本效益的实时编码应用。</li>
</ul>
<p>主档次旨在为广播和内容存储应用提供尽可能高的视频质量和最低的比特率。</p>
<p>标准编解码器中的关键压缩特性：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231110231714.webp" alt="image.png"></p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231110231651.webp" alt="image.png"></p>
<p>应用趋势：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231110232210.webp" alt="image.png"></p>
<h2 id="h264avc-的目标和应用"><a class="markdownIt-Anchor" href="#h264avc-的目标和应用"></a> H.264/AVC 的目标和应用</h2>
<p>视频编码专家组（VCEG），ITU-T SG16</p>
<ul>
<li>H.26L 项目（1998 年初），最初的重点是视频会议和电话通信。</li>
<li>目标是将编码效率提高一倍，超过任何其他现有的视频编码标准。<br>
应用领域：</li>
<li>有线、卫星、地面数字视频广播</li>
<li>媒体存储、DVD、蓝光 DVD 等</li>
<li>互联网流媒体、视频电话在 3G/4G 网络上</li>
<li>视频会议</li>
<li>数字视频监控、数字电影等</li>
</ul>
<h2 id="与其他标准的关系"><a class="markdownIt-Anchor" href="#与其他标准的关系"></a> 与其他标准的关系</h2>
<p>在 ITU-T 和 MPEG 中都将批准相同的设计。</p>
<p>在 ITU-T 中，这将是一个新的独立标准：</p>
<ul>
<li>ITU-T 推荐标准 H.264。</li>
<li>ITU-T 系统（H.32x）将进行修改以支持它。<br>
在 MPEG 中，这将是 MPEG-4 套件中的一个新的“部分”：</li>
<li>与之前的 MPEG-4 视觉编解码器设计分开。</li>
<li>新的第 10 部分称为“高级视频编码”（类似于 MPEG-2 中的“AAC”位置，作为独立的编解码器）。<br>
与之前的标准不兼容（包括之前的 MPEG-4 视觉规范 - 核心技术不同）。<br>
MPEG-4 系统/文件格式正在进行修改以支持它。<br>
IETF 正在研究 RTP 有效载荷的封装。</li>
</ul>
<h2 id="新功能和共同元素"><a class="markdownIt-Anchor" href="#新功能和共同元素"></a> 新功能和共同元素</h2>
<p>视频编码层基于混合视频编码（hybrid video coding），与其他标准在理念上类似，但存在重要的区别。</p>
<p>新的关键功能包括：</p>
<ul>
<li>增强的运动补偿</li>
<li>用于变换编码的小块</li>
<li>改进的去块滤波器</li>
<li>增强的熵编码</li>
</ul>
<p>与之前的标准相比，H.264/AVC 具有以下共同元素：</p>
<ul>
<li>16x16 宏块</li>
<li>块运动位移</li>
<li>块变换</li>
<li>标量量化</li>
<li>I、P 和 B 帧类型<br>
相对于之前的标准，在相同感知质量下，H.264/AVC 可以实现约 50% 的比特率节省。</li>
</ul>
<h2 id="档次"><a class="markdownIt-Anchor" href="#档次"></a> 档次</h2>
<p>受限基准档次（Constrained Baseline Profile，CBP）：</p>
<ul>
<li>主要用于视频会议和移动应用等低成本应用，于 2009 年开发。</li>
<li>对应于基准档次、主档次和高级档次之间共同支持的功能子集。</li>
</ul>
<p>基准档次（Baseline Profile，BP）：</p>
<ul>
<li>主要用于需要额外数据丢失鲁棒性的低成本应用，如视频会议和移动应用。</li>
<li>包括所有受限基准档次支持的功能，以及用于提高鲁棒性的额外功能。</li>
<li>所有受限基准档次的比特流也被视为基准档次的比特流，因为这两个档次共享相同的档次标识码值。</li>
</ul>
<p>主档次（Main Profile，MP）：</p>
<ul>
<li>用于使用 MPEG-4 格式的标准定义数字电视广播，符合 DVB 标准定义。</li>
</ul>
<p>扩展档次（Extended Profile，XP）：</p>
<ul>
<li>用于流媒体视频档次。</li>
<li>具有相对较高的压缩能力和一些额外的技巧，以提高对数据丢失和服务器流切换的鲁棒性。</li>
</ul>
<p>高级档次（High Profile，HiP）：</p>
<ul>
<li>于 2004 年开发，用于广播和光盘存储应用，特别适用于高清电视应用（例如，已被蓝光光盘存储格式和 DVB 高清电视广播服务采用）。</li>
</ul>
<p>高 10 档次（High 10 Profile，Hi10P）：</p>
<ul>
<li>在高级档次的基础上增加了对每个样本解码图像精度高达 10 位的支持。</li>
</ul>
<p>高 4:2:2 档次（High 4:2:2 Profile，Hi422P）：</p>
<ul>
<li>针对使用隔行视频的专业应用。</li>
<li>在高 10 档次的基础上增加了对 4:2:2 色度子采样格式的支持，同时使用高达 10 位的解码图像精度。</li>
</ul>
<p>高 4:4:4 预测档次（High 4:4:4 Predictive Profile，Hi444PP）：</p>
<ul>
<li>在高 4:2:2 档次的基础上增加了对 4:4:4 色度采样的支持，每个样本的解码图像精度高达 14 位。</li>
<li>此外，还支持高效的无损区域编码和将每个图像编码为三个独立的色彩平面。</li>
</ul>
<h3 id="基准档次"><a class="markdownIt-Anchor" href="#基准档次"></a> 基准档次</h3>
<p>特点包括：</p>
<ul>
<li><span style="color:#ff0000"> I 和 P 帧类型（不包括 B 帧，因为时延较大）</span></li>
<li>循环内去块滤波器</li>
<li>1/4 像素级的运动补偿</li>
<li>基于树状结构的运动分割，最小块大小为 4x4</li>
<li>基于 VLC 的熵编码</li>
</ul>
<p>一些增强的错误容忍特性包括：</p>
<ul>
<li>灵活的宏块排序/任意切片排序</li>
<li>冗余切片</li>
<li>主要用于视频会议和无线应用</li>
</ul>
<h3 id="主档次"><a class="markdownIt-Anchor" href="#主档次"></a> 主档次</h3>
<p>主档次的特点包括：</p>
<ul>
<li>所有基准档次的特点，除了增强的错误容忍特性</li>
<li><span style="color:#ff0000">B 帧类型</span></li>
<li><span style="color:#ff0000">CABAC（上下文自适应二进制算术编码）</span></li>
<li>宏块级别的帧/场切换</li>
<li>对 B 帧和 P 帧预测进行自适应加权</li>
<li>支持隔行图像扫描</li>
</ul>
<p>主档次主要用于广播应用。</p>
<h2 id="基本宏块编码结构"><a class="markdownIt-Anchor" href="#基本宏块编码结构"></a> 基本宏块编码结构</h2>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231110233820.webp" alt="image.png"></p>
<h2 id="运动补偿"><a class="markdownIt-Anchor" href="#运动补偿"></a> 运动补偿</h2>
<p>运动补偿的特点包括：</p>
<ul>
<li>不同的块大小和形状用于运动补偿</li>
<li>1/4 像素精度
<ul>
<li>6 点滤波器用于 1/2 像素精度</li>
<li>简化滤波器用于 1/4 像素精度</li>
</ul>
</li>
<li>多个参考帧</li>
<li>时间反转运动和广义 B 帧</li>
<li>B 帧预测加权</li>
</ul>
<h2 id="h264avc-编码数据格式"><a class="markdownIt-Anchor" href="#h264avc-编码数据格式"></a> H.264/AVC 编码数据格式</h2>
<p>H.264 区分视频编码层（VCL）和网络抽象层（NAL）。</p>
<p>编码过程的输出是 VCL 数据（表示编码视频数据的一系列比特），在传输或存储之前将其映射到 NAL 单元。</p>
<p>分别指定 VCL 和 NAL 的目的是区分编码特定的功能（在 VCL 中）和传输特定的功能。</p>
<p>每个 NAL 单元包含原始字节序列负载（RBSP），即对应于编码视频数据的一组数据和头部信息。</p>
<p>编码的视频序列由一系列 NAL 单元表示，可以通过基于数据包的网络、比特流传输链路或存储在文件中进行传输。</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231110233942.webp" alt="image.png"></p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231110234417.webp" alt="image.png" width="375px"></p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231110234420.webp" alt="image.png" width="300px"></p>
<p>NAL 单元的第一个字节是一个头部，包含有关该包类型的信息。</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ubyte forbidden_bit: <span class="number">1</span>; <span class="comment">// set to 0</span></span><br><span class="line">ubyte nal_ref_idc:<span class="number">2</span>; <span class="comment">// the level of priority</span></span><br><span class="line">ubyte nal_unit_type:<span class="number">5</span>; <span class="comment">// NAL type</span></span><br></pre></td></tr></tbody></table></figure>
<table>
<thead>
<tr>
<th>Type</th>
<th>Defintion</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Undefined</td>
</tr>
<tr>
<td>1</td>
<td>Slice layer without partitioning non <span style="color:#ff0000">IDR（instaneous decoding refresh 立即编码刷新）</span></td>
</tr>
<tr>
<td>2</td>
<td>Slice data partition A layer <span style="color:#ff0000">（Partition A：片头信息，片里面宏块头信息，最重要）</span></td>
</tr>
<tr>
<td>3</td>
<td>Slice data partition B layer <span style="color:#ff0000">（Partition B：帧内编码的数据）</span></td>
</tr>
<tr>
<td>4</td>
<td>Slice data partition C layer <span style="color:#ff0000">（Partition C：帧间编码的数据）</span></td>
</tr>
<tr>
<td>5</td>
<td>Slice layer without partitioning IDR</td>
</tr>
<tr>
<td>6</td>
<td>Additional information (SEI) 时间信息</td>
</tr>
<tr>
<td>7</td>
<td>Sequence parameter set 序列参数集（序列编号、帧数、参考帧数目、图像大小、场模式）</td>
</tr>
<tr>
<td>8</td>
<td>Picture parameter set 图像参数集（图像编号、熵编码方式、条带数目、初始量化步长）</td>
</tr>
<tr>
<td>9</td>
<td>Access unit delimiter</td>
</tr>
<tr>
<td>10</td>
<td>End of sequence</td>
</tr>
<tr>
<td>11</td>
<td>End of stream</td>
</tr>
<tr>
<td>12</td>
<td>Filler data</td>
</tr>
<tr>
<td>13…23</td>
<td>Reserved</td>
</tr>
<tr>
<td>24…31</td>
<td>Undefined</td>
</tr>
</tbody>
</table>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231110235130.webp" alt="image.png"></p>
<h2 id="参考图片"><a class="markdownIt-Anchor" href="#参考图片"></a> 参考图片</h2>
<p>H.264 编码器可以使用一到两个先前编码的图片作为参考，用于对每个帧间编码的宏块或宏块分区进行运动补偿预测。</p>
<p>这使得编码器可以从比先前编码的图片更广泛的图片集中搜索当前宏块分区的最佳匹配。</p>
<p>编码器和解码器各自维护一个或两个参考图片列表，其中包含先前已编码和解码的图片（出现在当前图片之前和/或之后的显示顺序中）。</p>
<ul>
<li>P 帧中的帧间编码的宏块和宏块分区是从单个列表（列表 0）中的图片进行预测的。</li>
<li>B 帧中的帧间编码的宏块和宏块分区可以从两个列表（列表 0 和列表 1）中的图片进行预测。</li>
</ul>
<h2 id="slices-2"><a class="markdownIt-Anchor" href="#slices-2"></a> Slices</h2>
<p>一个视频图像被编码为一个或多个切片，每个切片包含从 1 个宏块到图像中的总宏块数的整数个宏块（每个图像一个切片）。</p>
<p>切片中的宏块数不需要在图像内是恒定的。编码切片之间的相互依赖性很小，这有助于限制错误的传播。</p>
<p>符合基准配置的比特流包含编码的 I 和/或 P 切片：</p>
<ul>
<li>I 切片只包含帧内编码的宏块（从同一切片中先前编码的样本进行预测）；</li>
<li>P 切片可以包含帧间编码的宏块（从先前编码的图片中的样本进行预测）、帧内编码的宏块或跳过的宏块。<br>
编码图像可以由不同类型的切片组成：</li>
<li>基准档次的编码图像可以包含 I 和 P 切片的混合；</li>
<li>主档次或扩展档次的图像可以包含 I、P 和 B 切片的混合。<br>
切片数据包括切片头、一系列编码的宏块和/或跳过的宏块的指示。<br>
切片头定义了切片类型和切片所属的编码图像，并可能包含与参考图片管理相关的指令。</li>
</ul>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 34：帧内预测、运动向量预测、帧间预测</div>
</div>
<div class="callout-content"><p></p>
</div></div>
<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 35：H.264 的 DCT 变换</div>
</div>
<div class="callout-content"><p></p>
</div></div>
<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 36：熵编码：指数格罗姆编码和 CAVLC</div>
</div>
<div class="callout-content"><p></p>
</div></div><h2 id="cavlc"><a class="markdownIt-Anchor" href="#cavlc"></a> CAVLC</h2>
<p>这是用于编码变换系数的残差和之字形有序块的方法。</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231111134717.webp" alt="image.png"></p>
<p>CAVLC（Context-Adaptive Variable Length Coding）旨在利用量化的 4×4 块的几个特点：</p>
<ul>
<li>在预测、变换和量化之后，块通常是稀疏的（主要包含零）。</li>
<li>在之字形扫描后，最高的非零系数通常是 +/-1 的序列。</li>
<li>相邻块中的非零系数的数量是相关的。</li>
<li>非零系数的级别（幅度）在之字形扫描开始时往往较高，并且随着频率增高而降低。</li>
</ul>
<p>对一块变换系数进行 CAVLC 编码的过程如下：</p>
<ol>
<li>编码系数的数量和尾部的 1。</li>
<li>编码每个尾部 1 的符号。</li>
<li>编码剩余非零系数的级别。</li>
<li>编码最后一个系数之前的零的总数。</li>
<li>编码每个零的连续出现次数。</li>
<li>编码系数的数量和尾部的 1<br>
第一步是编码非零系数的总数（NumCoef）和尾部的 1（T1s）。<br>
NumCoef 的取值范围可以是从 0（4x4 块中没有系数）到 16（16 个非零系数）。<br>
T1s 的取值范围可以是从 0 到 3。<br>
如果尾部的 +/- 1 的个数超过 3 个，只有最后 3 个被视为“特殊情况”，其他的被编码为普通系数。</li>
</ol>
<p>例如：4x4 块</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231111135021.webp" alt="image.png"></p>
<p>The Num-Coef = 7, and T1s = 3</p>
<p>用于编码 Num_Coeff 和 T1 的四个表格分别是 Num-VLC0、Num-VLC1、Num-VLC2 和 FLC。</p>
<p>Num-VLC0：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231111135118.webp" alt="image.png"></p>
<p>表格的选择取决于先前编码块中，上方和左方的非零系数的数量 NU 和 NL。</p>
<p>参数 N 的计算如下：</p>
<ul>
<li>如果块 U 和 L 都可用（即在同一个编码片中），N = (NU + NL) / 2。</li>
<li>如果只有块 U 可用，N = NU。</li>
<li>如果只有块 L 可用，N = NL。</li>
<li>如果两者都不可用，N = 0。</li>
</ul>
<p>表格的选择基于以下方式中的 N 值：</p>
<table>
<thead>
<tr>
<th>N</th>
<th>Selected Table</th>
</tr>
</thead>
<tbody>
<tr>
<td>0,1</td>
<td>Num-VLC0</td>
</tr>
<tr>
<td>2,3</td>
<td>Num-VLC1</td>
</tr>
<tr>
<td>4,5,6,7</td>
<td>Num-VLC2</td>
</tr>
<tr>
<td>8 or above</td>
<td>FLC</td>
</tr>
</tbody>
</table>
<p>FLC 的形式如下：xxxxyy（即 6 位）</p>
<p>其中 xxxx 和 yy 分别表示 Num_Coeff 和 T1。</p>
<ol start="2">
<li>
<p>对每个 T1 编码其尾随 1 的符号<br>
对于每个 T1，一个比特位编码其符号（0 表示正，1 表示负）。<br>
这些符号按照逆序编码，从最高频率的 T1 开始。</p>
</li>
<li>
<p>对剩余的非零系数编码其级别（符号和大小）<br>
 块中每个剩余的非零系数的级别（符号和大小）按照逆序进行编码。<br>
 选择用于编码每个级别的 VLC 表根据每个连续编码级别的大小进行自适应调整（上下文自适应）。<br>
 有 7 个可供选择的 VLC 表，从 Level_VLC0 到 Level_VLC6。<br>
 Level_VLC0 偏向较低的大小，Level_VLC1 偏向稍高的大小，依此类推。<br>
 初始化表格为 Level_VLC0（除非非零系数超过 10 个且尾随 1 少于 3 个，在这种情况下从 Level_VLC1 开始）。<br>
 编码最高频率的非零系数。<br>
 如果该系数的大小大于预定义的阈值，则切换到下一个 VLC 表。</p>
</li>
</ol>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231111135814.webp" alt="image.png"></p>
<p> 级别的选择与最近编码的系数的大小相匹配。阈值列在表中；</p>
<p> 第一个阈值为零，这意味着在编码第一个系数级别之后，表总是递增。</p>
<ol start="4">
<li>编码最后一个系数之前的零的总数。</li>
</ol>
<p>以下是用于编码最后一个系数之前的零的总数（TotZeros）的表格。</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231111135924.webp" alt="image.png"></p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231111135948.webp" alt="image.png"></p>
<ol start="5">
<li>编码每个零的连续出现次数<br>
在每个非零系数之前的零的数量（run_before）按照逆序进行编码。对于每个非零系数，除了以下两种情况外，都会编码一个 run_before 参数：<br>
(a) 如果没有更多的零需要编码；<br>
(b) 对于最后（最低频率）的非零系数，不需要编码 run_before。</li>
</ol>
<p>每个零的连续出现次数的 VLC 表的选择取决于：</p>
<p>(a) 尚未编码的零的数量（ZerosLeft）；</p>
<p>(b) run_before。</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231111140035.webp" alt="image.png"></p>
<p>例子：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231111140120.webp" alt="image.png"></p>
<p>考虑以下 4×4 帧间残差块</p>
<p>块的 Zigzag 重新排序如下所示：</p>
<p>0,3,0,1,-1,-1,0,1,0,0,0,0,0,0,0,0</p>
<p>因此，NumCoeff=5，TotZero=3，T1s=3</p>
<p>假设 N=1</p>
<p>编码：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231111140327.webp" alt="image.png"></p>
<p>解码：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231111140403.webp" alt="image.png"></p>
<h1 id="心理声学模型"><a class="markdownIt-Anchor" href="#心理声学模型"></a> 心理声学模型</h1>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 19：心理声学模型：频域掩蔽、时域掩蔽、听觉阈值、SMR、关键带宽、巴克刻度、感知熵</div>
</div>
<div class="callout-content"><p></p>
</div></div><h2 id="声压等级-sound-pressure-levels"><a class="markdownIt-Anchor" href="#声压等级-sound-pressure-levels"></a> 声压等级 Sound Pressure Levels</h2>
<p>声音以压力波的形式到达人耳。声压 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span></span></span></span> 在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><msup><mn>0</mn><mo>−</mo></msup><mn>5</mn><mo separator="true">,</mo><mn>1</mn><msup><mn>0</mn><mn>2</mn></msup><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[10^-5,10^2]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span></span></span></span></span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>Pa 范围之间变化。</p>
<p>声压等级 SPL，单位 dB：</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>S</mi><mi>P</mi><mi>L</mi><mo>=</mo><mn>10</mn><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>10</mn></msub><msup><mrow><mo fence="true">(</mo><mfrac><mi>p</mi><msub><mi>p</mi><mn>0</mn></msub></mfrac><mo fence="true">)</mo></mrow><mn>2</mn></msup><mo separator="true">,</mo><msub><mi>p</mi><mn>0</mn></msub><mo>=</mo><mn>20</mn><mi>μ</mi><mi>P</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">SPL= 10 \log_{10}{\left( \frac{p}{p_{0}} \right)^2}, p_{0}=20\mu Pa
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.604038em;vertical-align:-0.95003em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.6540080000000001em;"><span style="top:-3.9029000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord mathnormal">μ</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">a</span></span></span></span></span></p>
<p>p0 为音频在 2kHz 左右的听觉阈值处的声压。</p>
<p>声音也可以被声音强度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span> 来描述，表示声波单位面积的功率，与 p 的平方成正比。</p>
<p>声压等级 SPL 也可以被定义为：</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>S</mi><mi>P</mi><mi>L</mi><mo>=</mo><mn>10</mn><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>10</mn></msub><mrow><mo fence="true">(</mo><mfrac><mi>I</mi><msub><mi>I</mi><mn>0</mn></msub></mfrac><mo fence="true">)</mo></mrow><mo separator="true">,</mo><msub><mi>I</mi><mn>0</mn></msub><mo>=</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>12</mn></mrow></msup><mi>W</mi><mi mathvariant="normal">/</mi><msup><mi>m</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">SPL= 10 \log_{10}{\left( \frac{I}{I_{0}} \right)}, I_{0}=10^{-12}W/m^2
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord">/</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">I_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">p_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 对应。</p>
<h2 id="响度-loudness"><a class="markdownIt-Anchor" href="#响度-loudness"></a> 响度 Loudness</h2>
<p>响度等级定义为，在正面入射平面场下，被感知到的与所检测的声音一样响亮的 1 kHz 声音的级别。</p>
<p><span style="color:#ff0000">响度取决于强度、持续时间、时间和频谱结构。</span></p>
<p>单位为 phon，描述了自变量为频率的函数中一条等响曲线。下图每条曲线指的是同样的响度。</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231105213848.webp" alt="image.png"></p>
<p>在高音量水平下，以 phon 为单位测量的响度与以 dB 为单位测量的声强之间的差异减小。</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231105214437.webp" alt="image.png"></p>
<h2 id="掩蔽现象"><a class="markdownIt-Anchor" href="#掩蔽现象"></a> 掩蔽现象</h2>
<h3 id="同时掩蔽频域掩蔽"><a class="markdownIt-Anchor" href="#同时掩蔽频域掩蔽"></a> 同时掩蔽（频域掩蔽）</h3>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231105214640.webp" alt="image.png" width="450px"></p>
<blockquote>
<p>频域掩蔽是指在掩蔽声与被掩蔽声同时存在时产生的掩蔽效应，又称为同时掩蔽。在这种情况下，掩蔽声在掩蔽效应发生期间持续影响着被掩蔽声，形成一种强烈的掩蔽效应。通常情况下，频域中的一个强音会掩盖附近较弱的声音，而距离强音较近的弱音往往更容易被掩蔽；相反地，距离较远的弱音不太容易受到掩蔽效应的影响。图 3 解释了频域掩蔽现象，可以看到一个强信号掩蔽了两个接近其频率的弱信号，低于掩蔽域值的弱信号将无法听见，这导致听觉的安静阈值在掩蔽作用下提高。一般来说，低频声音更容易掩蔽高频声音。</p>
</blockquote>
<h3 id="非同时掩蔽时域掩蔽"><a class="markdownIt-Anchor" href="#非同时掩蔽时域掩蔽"></a> 非同时掩蔽（时域掩蔽）</h3>
<blockquote>
<p>时域掩蔽效应是在时域中相邻的声音之间互相的掩蔽效应，或被称为非同时掩蔽。时域掩蔽又分为超前掩蔽（pre-masking 或 backward masking）和滞后掩蔽（post-masking 或 forward masking）</p>
</blockquote>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231105214835.webp" alt="image.png" width="500px"></p>
<p>虚线之间是掩蔽声音实际的存在时间。</p>
<blockquote>
<p>声音信号大多数时候是非稳态的瞬时信号，声压级随着时间变化很快，即强音后面跟着弱音，弱音后面又可能跟着强音。比较强的声音往往会掩蔽随后到来的较弱音。时域掩蔽又分为前掩蔽和后掩蔽。若掩蔽声音出现之前的一段时间内发生掩蔽效应，则称为前掩蔽；否则称为后掩蔽。前掩蔽效应要大于后掩蔽效应，前掩蔽发生作用的时间大于后掩蔽的时间。产生时域掩蔽的主要原因是人的大脑处理信息需要花费一定的时间，时域掩蔽也随着时间的推移很快衰减，是一种弱掩蔽效应。</p>
</blockquote>
<h3 id="窄带噪声掩蔽"><a class="markdownIt-Anchor" href="#窄带噪声掩蔽"></a> 窄带噪声掩蔽</h3>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231105214923.webp" alt="image.png" width="450px"></p>
<p>信号掩蔽比（signal to mask ratio, SMR）。</p>
<blockquote>
<p>注意：信噪比是 SNR（Signal-to-noise ratio）</p>
</blockquote>
<blockquote>
<p>窄带噪声通常是指带宽等于或者小于听觉临界频带的噪声。在图 1 中，以不同中心频率的窄带噪声作为掩蔽声时的听阈曲线，窄带噪声的中心频率分别为 0.25KHz，1KHz，4KHz，带宽分别为 0.1KHz、0.16KHz 和 0.7KHz，图上部水平虚线为掩蔽噪声声强级 60dB，中部实线表示刚好可听到的纯音声级，下部的虚线是听觉安静域值。从图中可以看出，被掩蔽纯音的频率偏离掩蔽噪声中心频率越大，掩蔽效应下降越快；因为是平滑以后的数据，故而不呈锯齿状。信号分量和掩蔽域值之间的声级差，称信号掩蔽比 (signal to mask ratio, SMR)，SMR 越大，掩蔽效果越小。上图中，0.25KHz，1KHz，4KHz 的最小 SMR 分别为 2、3 和 5dB，最小 SMR 是设计音频编码器很重要的参数。</p>
</blockquote>
<p>下图表示不同级别的掩蔽音调下，1kHz 窄带噪声掩蔽器的掩蔽阈值。</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231105215907.webp" alt="image.png"></p>
<h3 id="纯音掩蔽"><a class="markdownIt-Anchor" href="#纯音掩蔽"></a> 纯音掩蔽</h3>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231105220158.webp" alt="image.png"></p>
<blockquote>
<p>从图中可以看出，当被掩蔽音声级较低时，掩蔽域值向低频扩展（斜率较小）；而在声级较高时则相反。当掩蔽音声级为 90dB 时，掩蔽曲线峰值为 75dB，信号掩蔽比为 15dB。与噪声相比，纯音在掩蔽方面具有较大的信号掩蔽比（SMR），这意味着噪声比纯音具有更好的掩蔽效果。纯音的掩蔽效应基本符合以下几个规律：低频纯音容易掩蔽高频纯音，而高频纯音相对较难掩蔽低频纯音；频率相近的纯音容易互相掩蔽；当增加掩蔽声的声压级时，掩蔽阈值会提高，同时被掩蔽的频率范围也会扩展。</p>
</blockquote>
<h3 id="临界带宽"><a class="markdownIt-Anchor" href="#临界带宽"></a> 临界带宽</h3>
<blockquote>
<p>临界带宽指临界频带的带宽，即恰能产生变化的频率通带（频段）的宽度值。如响度测试中指恰能使声音响度产生变化的带宽值：当声音由一定频带组成时，它的响度变化呈现出下图所示的规律：带宽从很窄到越来越宽的过程中，声音整体响度开始时保持不变；当到达一个特定的带宽后，声音整体响度会随着带宽的变宽而变得更响。<br>
<img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231106201541.webp" alt="image.png" width="275px"></p>
</blockquote>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231106200607.webp" alt="image.png"></p>
<p>Threshold of a narrow band noise centered between two sinusoidal maskers at a level of 50dB as a function of the frequency separation between the two sinusoidals.</p>
<h3 id="掩蔽-masking"><a class="markdownIt-Anchor" href="#掩蔽-masking"></a> 掩蔽 Masking</h3>
<p><strong>掩蔽曲线的水平在接近遮蔽音调频率的地方最高</strong>。</p>
<p>当测试信号频率超过临界带宽远离遮蔽音调频率时，掩蔽曲线迅速下降。</p>
<p><strong>掩蔽频率曲线的形状取决于掩蔽音调的频率和水平</strong>。</p>
<p>掩蔽曲线在很大程度上取决于掩蔽音调是音调还是噪声样式。</p>
<h2 id="音频编码的心理声学模型"><a class="markdownIt-Anchor" href="#音频编码的心理声学模型"></a> 音频编码的心理声学模型</h2>
<h3 id="巴克刻度-bark-scale"><a class="markdownIt-Anchor" href="#巴克刻度-bark-scale"></a> 巴克刻度 Bark Scale</h3>
<blockquote>
<p>巴克刻度是一种心理声学的尺度。</p>
<p>临界频带指的是由于耳蜗构造产生的听觉滤波器的频率带宽。听觉系统中，耳蜗起着频谱分析的作用，基底膜上特定位置点是对某一特征频率（Characteristic Frequency, CF）的响应最大，当声波偏离 CF 时，该点的响应减少，因此基底膜上每一点可等效成具有特定中心频率（CF）的带通滤波器，整个听觉系统可等效成一系列具有连续 CF 的、相互交叠的带通滤波器，称为“听觉滤波器”。临界频带就是听觉系统带通滤波功能的反映，听觉滤波器的带宽即为临界带宽。</p>
<p>概括地说，临界频带是声音频率带，在临界频带中第一个单音感知度会被第二单音的听觉掩蔽所干扰。根据相关的心理声学的研究，由于人耳的特殊结构，在同一个临界频带内信号容易发生掩蔽效应，即：主要信号容易被能量大并且频率接近的掩蔽信号所掩蔽。因此我们可以认为 Bark 域越近的信号越容易产生掩蔽效应。</p>
<p>声学研究中，人们使用听觉滤波器来模拟不同的临界频带。后来研究者发现人耳结构大致会对 24 个频率点产生共振，根据这个结论 Eberhard Zwicker 在 1961 年针对人耳特殊结构提出：信号在频带上也呈现出 24 个临界频带，分别从 1 到 24。这就是 Bark 域。</p>
<p>通常将人耳可听范围内的 20Hz～16kHz 分成 24 个临界频带，用临界频带级来表示临界频带的宽度，单位为巴克（Bark）：Bark=一个临界频带的宽度。当频率 f＜500Hz 时，1 Bark=f/100，临界带宽几乎恒定为 100Hz；当频率 f＞500Hz 时，1 Bark=4log(f/100)，&nbsp;临界带宽随中心频率的升高而增加，约为中心频率的 20%。<br>
<img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231106202935.webp" alt="image.png" width="500px"></p>
</blockquote>
<p>每个临界带宽（频率）对应于耳朵中基底膜上的固定距离。我们可以定义基底距离测量中的长度单位为一个临界带宽。</p>
<h3 id="掩蔽传播模型"><a class="markdownIt-Anchor" href="#掩蔽传播模型"></a> 掩蔽传播模型</h3>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231106202329.webp" alt="image.png"></p>
<p>Excitation patterns for narrow-band noise signals centered at different frequencies and at a level of 60 dB.</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231106203058.webp" alt="image.png"></p>
<p>Excitation patterns for narrow-band noise signals centered at 1kHz and at different levels.</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231106203147.webp" alt="image.png"></p>
<p>The curve in the diagram be expressed as a function of the Bark scale difference between the maskee and masker frequency.</p>
<h3 id="掩蔽曲线"><a class="markdownIt-Anchor" href="#掩蔽曲线"></a> 掩蔽曲线</h3>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231106203258.webp" alt="image.png" width="475px"></p>
<h3 id="mp3-的心理声学模型"><a class="markdownIt-Anchor" href="#mp3-的心理声学模型"></a> MP3 的心理声学模型</h3>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231106203341.webp" alt="image.png" width="379px"></p>
<h3 id="感知熵"><a class="markdownIt-Anchor" href="#感知熵"></a> 感知熵</h3>
<p>感知熵（Perceptual entropy）PE：在不引入任何感知差异的情况下，对信号进行编码所需的每个频率样本的平均比特数。</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231126174641.webp" alt="image.png"></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mi>b</mi></msub></mrow><annotation encoding="application/x-tex">n_b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是分区带 b 中的频率线数量，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><msub><mi>y</mi><mi>b</mi></msub></mrow><annotation encoding="application/x-tex">energy_b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是分区 b 中的信号能量，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>h</mi><mi>r</mi><mi>e</mi><mi>s</mi><mi>h</mi><mi>o</mi><mi>l</mi><msub><mi>d</mi><mi>b</mi></msub></mrow><annotation encoding="application/x-tex">threshold_b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">e</span><span class="mord mathnormal">s</span><span class="mord mathnormal">h</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是掩蔽阈值。</p>
<p>PE 可以用于确定 MDCT 或 attack 的块类型（PE&gt;1800 比特表示短窗口）</p>
<h3 id="block-switching-state-diagram"><a class="markdownIt-Anchor" href="#block-switching-state-diagram"></a> Block Switching State Diagram</h3>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231106203917.webp" alt="image.png" width="479px"></p>
<h2 id="本章参考的外部资源"><a class="markdownIt-Anchor" href="#本章参考的外部资源"></a> 本章参考的外部资源</h2>
<ul>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://zhuanlan.zhihu.com/p/647121839">心理声学声掩蔽效应及应用 - 知乎 (zhihu.com)</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cDovL3d3dy5oZWFjYWQuY24vTmV3c0RldGFpbC8zMjQwMjYwLmh0bWw=">听力学小课堂 | 名词释义（15）：临界带宽、临界频带-苏州海卡缔听力技术有限公司 (heacad.cn)</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.csdn.net/qq_34218078/article/details/125145458">声学感知刻度(mel scale、Bark scale、ERB)与声学特征提取(MFCC、BFCC、GFCC)_hz2erb_凌逆战的博客-CSDN博客</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.bilibili.com/video/BV1D5411S71K/?spm_id_from=333.999.0.0&amp;vd_source=e03d48176855fc5349b27aef691f9cdb">mp3是如何骗过你耳朵的？【差评君】_哔哩哔哩_bilibili</a></li>
</ul>
<h1 id="时频映射"><a class="markdownIt-Anchor" href="#时频映射"></a> 🍂时频映射</h1>
<p>音频编码框图：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231110202133.webp" alt="image.png"></p>
<p>T/F mapping: FFT, PQMF, MDCT</p>
<p>傅里叶变换</p>
<ul>
<li>
<p>1822 年，傅里叶指出实时信号可以表示为具有不同频率的信号的总和。</p>
</li>
<li>
<p>傅里叶变换定义如下：<br>
<img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231110202311.webp" alt="image.png"></p>
</li>
<li>
<p>傅里叶逆变换等于：<br>
<img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231110202315.webp" alt="image.png"></p>
</li>
</ul>
<p>傅里叶级数</p>
<ul>
<li>
<p>对信号在有限时间间隔上的傅里叶变换可以用来在时域中重构原始信号。</p>
</li>
<li>
<p>实际上，我们不需要完整的傅里叶变换数据来完全在时域中重构信号。</p>
</li>
<li>
<p>我们只需要在离散频率点 f=k/T（其中 k 是整数）处的 X(f) 值。</p>
</li>
<li>
<p>我们通过将窗口信号替换为在时间间隔从 -T/2 到 T/2 内相等的信号，但在该间隔之外周期性地重复，来进行数据压缩。<br>
对于生成的周期信号，我们可以定义傅里叶级数：<br>
<img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231110202643.webp" alt="image.png"></p>
</li>
<li>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">X[k]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span></span></span></span> 只是时间限定信号在离散频率集合 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>=</mo><mi>k</mi><mi mathvariant="normal">/</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">f=k/T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span> 处的傅里叶变换。</p>
</li>
<li>
<p>我们可以使用以下公式重构 x(t)：<img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231110202703.webp" alt="image.png"><br>
采样定理</p>
</li>
<li>
<p>假设一个信号在频率范围从 -Fmax 到 Fmax 内具有频率内容。</p>
</li>
<li>
<p>如果我们选择某个频率间隔 Fs≥2Fmax，并周期性地延续信号的频谱范围超出从 -Fs/2 到 Fs/2 的范围。</p>
</li>
<li>
<p>从傅里叶级数的定义可以想象，这个频率周期函数只有离散时间分量 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">x[n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span>（如果我们定义 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>=</mo><mn>1</mn><mi mathvariant="normal">/</mi><msub><mi>F</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">T=1/F_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，则有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo><mo>=</mo><mi>x</mi><mo stretchy="false">(</mo><mi>n</mi><mi>T</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x[n]=x(nT)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose">)</span></span></span></span>）。</p>
</li>
</ul>
<p>在时域中对信号进行窗函数处理</p>
<ul>
<li>假设我们开始处理一个带限信号，并以采样频率 Fs≥2Fmax 对信号进行采样。</li>
<li>假设我们想要使用有限的样本块进行计算，以便在等待信号完成之前开始进行计算。</li>
<li>实现这个目标的一种方法是将原始的非有限信号 x(t) 与矩形窗函数相乘。</li>
</ul>
<p>矩形窗函数</p>
<ul>
<li>矩形窗函数 WR(t) 在 t=0 到 t=T 之间等于 1，在其他地方等于零。</li>
<li>我们可能想知道这个时限信号是否仍然足够带限。</li>
<li>时限信号的傅里叶变换等于原始信号的傅里叶变换与 WR(t) 的傅里叶变换 WR(f) 的卷积。</li>
<li>WR(f) 的傅里叶变换随着频率的增加下降得非常缓慢，这意味着时限信号的傅里叶变换很可能不再足够带限。</li>
<li>如果我们使用这个窗函数，会发生混叠现象。</li>
</ul>
<p>正弦窗函数</p>
<ul>
<li>矩形窗函数的问题在于窗口边缘处的截断非常尖锐。</li>
<li>尖锐的变化会导致高频成分。</li>
<li>在时域中，更好的窗函数选择是在边缘处缓慢衰减，以避免尖锐的不连续性。</li>
<li>正弦窗函数为 ws(t) = sin(πt/T)，0≤t≤T。当应用于离散时间信号的 N 个样本时，窗函数变为 ws[n] = sin(π(n+1/2)/N)，其中 n=0，…，N-1。</li>
<li>从频谱中可以看出，主瓣比矩形窗函数更宽，但频率幅度下降得更快。</li>
</ul>
<p>汉宁窗函数</p>
<ul>
<li>汉宁窗函数在边缘处没有正弦窗函数那样的突变。</li>
<li>汉宁窗函数为 wH(t) = 1/2(1-cos(2πt/T))，0≤t≤T。</li>
<li>当应用于离散时间信号的 N 个样本时，窗函数变为 wH[n] = 1/2(1-cos[2π(n+1/2)/N])，其中 n=0，…，N-1。</li>
<li>从频谱中可以看出，汉宁窗函数的衰减速度更快（有助于避免混叠），但其主瓣的宽度更大（对于准确的频率识别不利）。</li>
<li>在窗函数设计中，我们面临权衡：低旁瓣能量（与杂散频率成分相关）和主瓣的宽度（窗函数的频率分辨率）。</li>
</ul>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 17：FFT 和复杂度</div>
</div>
<div class="callout-content"><p></p>
</div></div><p>快速傅里叶变换（FFT）</p>
<ul>
<li>直接计算 DFT 需要 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>N</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">N^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span> 次复数乘法和加法运算。</li>
<li>令人惊讶的是，FFT 允许我们在大约 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>×</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mi>N</mi></mrow><annotation encoding="application/x-tex">N×log_2N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> 次复数乘法/加法运算中完成完全相同的计算。</li>
<li>以 N=1024 为例，FFT 只需要 DFT 所需计算时间的 1%。</li>
<li>这个算法最早由高斯在 1880 年提出，后来由库利和图基在 1965 年重新发现。</li>
</ul>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 15：傅里叶变换、傅里叶级数、离散时间傅里叶变换、离散傅里叶变换</div>
</div>
<div class="callout-content"><p></p>
</div></div><table>
<thead>
<tr>
<th></th>
<th>时域</th>
<th>频域</th>
</tr>
</thead>
<tbody>
<tr>
<td>傅里叶变换</td>
<td>连续、无限</td>
<td>连续、无限</td>
</tr>
<tr>
<td>傅里叶级数</td>
<td>有限信号周期延拓，连续</td>
<td>离散</td>
</tr>
<tr>
<td>离散时间傅里叶变换</td>
<td>离散</td>
<td>有限频谱的周期延拓</td>
</tr>
<tr>
<td><span style="color:#ff0000">离散傅里叶变换</span></td>
<td>离散，有限</td>
<td>离散，有限</td>
</tr>
</tbody>
</table>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 16：Windowing</div>
</div>
<div class="callout-content"><p></p>
</div></div><table>
<thead>
<tr>
<th></th>
<th>去混叠</th>
<th>频率选择性</th>
</tr>
</thead>
<tbody>
<tr>
<td>矩形窗</td>
<td>最差</td>
<td><span style="color:#ff0000">最好</span></td>
</tr>
<tr>
<td>正弦窗</td>
<td>中等</td>
<td>中等</td>
</tr>
<tr>
<td>汉宁窗</td>
<td>最好</td>
<td>最差</td>
</tr>
</tbody>
</table>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 18：MDCT：重叠相加技术、长窗、短窗</div>
</div>
<div class="callout-content"><p></p>
</div></div><p>MDCT</p>
<p>重叠相加技术</p>
<ul>
<li>PQMF 通常被视为时频银行（Time Frequency banks）。相应的编码称为子带编码。</li>
<li>如果在音频编码过程中，将时域的数据样本映射到频域的数据样本，例如使用 FFT，这种音频编码方法称为变换编码。</li>
<li>我们已经知道，在进行 DFT 之前，音频信号会进行窗函数处理以避免混叠效应，在解码器中，我们需要知道如何恢复原始信号。</li>
<li>除了应用逆离散傅里叶变换之外，我们还需要将窗函数的影响从数据中去除。</li>
<li>第一种方法是将逆 DFT 的输出除以窗函数系数。</li>
<li>问题在于量化/反量化会在信号中引入小的误差。</li>
<li>这些误差可能是听不到的，但是将逆 DFT 的输出除以窗函数可能会放大数据块边缘附近的误差，因为窗函数在该区域被设计为平滑地趋近于零。</li>
</ul>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231110204338.webp" alt="image.png" width="450px"></p>
<p>在编码器中，块输入信号是重叠的。在解码器中，我们重叠并相加输出信号。</p>
<p>窗函数的设计使得在没有量化的情况下可以恢复原始信号。</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231110204716.webp" alt="image.png"></p>
<p>重叠量 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>−</mo><mi>M</mi><mo>≤</mo><mi>N</mi><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">N-M ≤ N/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord">/</span><span class="mord">2</span></span></span></span></p>
<p>在编码器中，每个连续的数据块从前一个数据块的起始位置后的 M 个样本开始，并包括 M 个新的数据样本。</p>
<p>在解码器中：</p>
<ul>
<li>我们将逆变换和窗函数处理后的数据的前 M 个样本传输到输出缓冲区。</li>
<li>将剩余的 N-M 个样本存储到存储缓冲区中。</li>
<li>我们将前一个数据块存储缓冲区中的 N-M 个样本与当前数据块输出缓冲区的前 N-M 个样本相加。</li>
<li>然后，我们将输出缓冲区的 M 个样本发送到解码器的输出流中。</li>
</ul>
<p>我们选择在解码器中进行窗函数处理的原因是：</p>
<ul>
<li>使逆变换块边缘附近的量化噪声较小；</li>
<li>分析和合成阶段可以对称地进行。</li>
</ul>
<p>对于分析和合成窗函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mi>a</mi><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">wa[n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mi>s</mi><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">ws[n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">s</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span>，有以下要求：</p>
<ul>
<li>在没有重叠的任何块区域中，<img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231110204931.webp" alt="image.png"></li>
<li>在重叠区域中，<img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231110204934.webp" alt="image.png"><br>
该条件将一个块的窗函数的右侧与下一个块的窗函数的左侧相关联。i 是块的索引。</li>
</ul>
<p>窗的选择：</p>
<p>如果分析和合成窗函数是相同的，我们有：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231110205027.webp" alt="image.png"></p>
<p>一个满足这个条件的简单窗函数是：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231110205032.webp" alt="image.png"></p>
<p>正弦窗口可能无法为特定应用提供频率分辨率与泄漏之间的权衡。实际上，我们可以通过一种归一化过程来修改任何窗口函数，以满足重叠相加条件。</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231110205646.webp" alt="image.png"></p>
<p>如果 w’(p) 具有控制其形状的参数，我们可以调整这些参数以调节归一化窗口以适应特定应用。归一化过程可以使用 Kaiser-Bessel 窗口作为核窗口，并在相邻块之间具有 50% 的重叠来进行，从而创建所谓的“Kaiser-Bessel 衍生”窗口。</p>
<p>音频编码中的窗口考虑因素：</p>
<ul>
<li>在音频编码中，我们希望：
<ul>
<li>最大化频率分离。</li>
<li>最小化音频阻塞效应的影响。</li>
</ul>
</li>
<li>所选的窗口长度和形状与这两个属性有关。</li>
<li>给定输入数据到滤波器组的块大小，窗口形状的选择决定了滤波器组的频谱分离程度：
<ul>
<li>正弦窗口比α=4 的 KBD 窗口具有更好的近端选择性（主瓣更窄）。</li>
<li>正弦窗口的侧瓣能量的抑制程度较差。<br>
根据输入音频信号的特性，正弦窗口或α=4 的 KBD 窗口可能为信号表示提供更好的频率分辨率：</li>
</ul>
</li>
<li>对于高度音调的信号，近端选择性比频率表示中的最终抑制更重要。</li>
<li>如果信号的频率分量之间存在较大的分离，更高的最终抑制可以更好地利用信号分量的掩蔽效应。</li>
</ul>
<p>改进离散余弦变换（MDCT）：</p>
<ul>
<li>为了减少窗口化引起的阻塞效应，我们希望窗口边缘的过渡到零尽可能平缓。</li>
<li>这意味着当我们设置大的重叠区域时，阻塞效应最小。</li>
<li>然而，我们需要对每 M 个新的时间样本输入编码器的样本进行 N 个样本的变换数据的编码、传输/存储。</li>
<li>在从冗余和无关信息去除中获得任何编码增益之前，我们将数据速率增加了 N/M 倍。</li>
<li>为了解决这个问题，开发了 MDCT。</li>
<li>MDCT 是一种替代 DFT 的变换，允许块之间有 50% 的重叠，而不增加数据速率。<br>
<img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231110205908.webp" alt="image.png"></li>
</ul>
<h1 id="mp3-的编码与解码"><a class="markdownIt-Anchor" href="#mp3-的编码与解码"></a> MP3 的编码与解码</h1>
<p>Normative：必须的，必要的</p>
<p>Informative：不必的</p>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 22：MP3 的编解码器过程</div>
</div>
<div class="callout-content"><p></p>
</div></div><h2 id="mp3-编码器informative-elements"><a class="markdownIt-Anchor" href="#mp3-编码器informative-elements"></a> MP3 编码器（Informative Elements）</h2>
<p>编码器概览：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231109220436.webp" alt="image.png"></p>
<h3 id="时频映射-2"><a class="markdownIt-Anchor" href="#时频映射-2"></a> 时频映射</h3>
<p>PQMF：在一个帧中，对 1152 个 PCM 音频样本进行滤波，使得每个子带包含 36 个子带样本。</p>
<p>窗函数：在进行 MDCT 之前，对子带样本应用了四种不同的窗函数。</p>
<p>MDCT：使用两种不同的 MDCT 块长度，一种是长块，包含 36 个样本，另一种是短块，包含 12 个样本。<strong>短块适合变化较快的信号，长块适合平稳信号。</strong></p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231109220745.webp" alt="image.png"></p>
<h3 id="块模式"><a class="markdownIt-Anchor" href="#块模式"></a> 块模式</h3>
<ul>
<li>注意，短块长度是长块长度的 1/3。在短块模式下，三个短块替代一个长块，这样无论块类型如何，音频样本帧的 MDCT 样本数量保持不变。</li>
<li>对于给定的音频样本帧，MDCT 可以全部具有相同的块长度（长块或短块），或者采用混合块模式。</li>
<li>在混合块模式下，MDCT 对于两个较低频率子带使用长窗口，对于 30 个较高频率子带使用短窗口。这种模式在不牺牲较高频率的时间分辨率的情况下，为较低频率提供更好的频率分辨率。</li>
</ul>
<p>应用于 1152 个 PCM 样本的信号处理：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231109221035.webp" alt="image.png"></p>
<h3 id="去混叠"><a class="markdownIt-Anchor" href="#去混叠"></a> 去混叠</h3>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231109221050.webp" alt="image.png"></p>
<p>在量化之前，应用了一种抗混叠处理来消除在分析 PQMF 中引入的混叠，以减少传输的信息量。</p>
<p>这种减少是通过一系列蝶形计算来实现的。</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231109221249.webp" alt="image.png"></p>
<h3 id="非均匀量化"><a class="markdownIt-Anchor" href="#非均匀量化"></a> 非均匀量化</h3>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231109221321.webp" alt="image.png"></p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231109221324.webp" alt="image.png"></p>
<p><span style="color:#ff0000">global_gain：全局量化步长。控制比特率。</span></p>
<p>scale_factor：子带因子控制噪声。</p>
<p>在量化之前，将 MDCT 系数提升到 3/4 的幂，以在量化器值的范围内提供更一致的信噪比。</p>
<p>scale_factor 用于调整量化噪声，以适应掩蔽阈值的不同频率轮廓。</p>
<h3 id="哈夫曼编码-2"><a class="markdownIt-Anchor" href="#哈夫曼编码-2"></a> 哈夫曼编码</h3>
<p>有序的频率线被分为三个不同的区域，分别称为“rzero”、“count1”和“big_value”区域。</p>
<ul>
<li>连零区域：从较高的频率开始，编码器将连续的全零值识别为一个区域，即“rzero”区域。“rzero”区域必须包含偶数个零值。</li>
<li>数 1 区域：4 个一起编码。由一系列仅包含 -1、0 或 1 的值组成。这个区域的两个霍夫曼表每次编码 4 个值，因此值的数量必须是 4 的倍数。</li>
<li>big_value 区：2 个一起编码。涵盖了所有剩余的值，称为“big_values”区域。这些值与 30 个霍夫曼表一起进行编码。这个区域进一步分为三个子区域，每个子区域都有自己特定的霍夫曼表。</li>
</ul>
<h3 id="比特分配两层嵌套循环"><a class="markdownIt-Anchor" href="#比特分配两层嵌套循环"></a> 比特分配（两层嵌套循环）</h3>
<p>外层循环：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231109221944.webp" alt="image.png"></p>
<p>内层循环：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231109221959.webp" alt="image.png"></p>
<p>Quantizer_change is the change of global_gain.</p>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 20：MP3：比特流格式、MP3 采样频率、stereo/joint channel/dual channel/single channel、哈夫曼编码域，比特池</div>
</div>
<div class="callout-content"><p></p>
</div></div><h3 id="比特流格式"><a class="markdownIt-Anchor" href="#比特流格式"></a> 比特流格式</h3>
<p>为了生成符合 MP3 标准的比特流，霍夫曼编码的频率线、辅助信息和帧头被组合成比特流。</p>
<p>比特流被分割成帧，每帧表示 1152 个音频样本。</p>
<p>帧头描述了编码音频所使用的比特率和采样频率。</p>
<p>辅助信息告知使用的块类型、霍夫曼表、subband gain 和子带比例因子。</p>
<h3 id="比特池"><a class="markdownIt-Anchor" href="#比特池"></a> 比特池</h3>
<p>使用“比特储备池”方法来满足编码器对编码比特的时变需求。</p>
<p>编码器只能从过去的帧中借用比特，而不能从未来的帧中借用比特。</p>
<p>MPEG/Audio Layer 3 比特流使用一个 9 位指针，称为 main_data_begin，来表示当前处理帧的主数据的起始点。</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231109222321.webp" alt="image.png"></p>
<h3 id="stereo-encoding"><a class="markdownIt-Anchor" href="#stereo-encoding"></a> Stereo Encoding</h3>
<p>联合立体声</p>
<p>中侧立体声</p>
<p>强度立体声</p>
<h2 id="mp3-解码器normative-elements"><a class="markdownIt-Anchor" href="#mp3-解码器normative-elements"></a> MP3 解码器（Normative Elements）</h2>
<p>MPEG 音频第三层解码概述：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231109222737.webp" alt="image.png"></p>
<p>解码器主要由三个部分组成：“比特流解码”，“逆量化”和“频率到时间映射”。</p>
<ul>
<li>输入的编码比特流通过第一部分进行同步，并提取每帧的量化频率线和其他信息。</li>
<li>接下来，量化的频率线进行反量化。</li>
<li>最后，应用逆 MDCT 和合成 PQMF 来获得以 PCM 格式输出的信号。</li>
</ul>
<p>MP3 解码器的框图：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231109222925.webp" alt="image.png"></p>
<p>比特流解码框图：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231109222954.webp" alt="image.png"></p>
<h3 id="辅助信息解码的过程"><a class="markdownIt-Anchor" href="#辅助信息解码的过程"></a> 辅助信息解码的过程</h3>
<ul>
<li>帧中的辅助信息包含解码主数据所需的必要信息。</li>
<li>它包含有关在 Huffman 解码过程中使用哪些霍夫曼表以及比例因子的信息。</li>
<li>它还包含主数据开始的位置信息。</li>
</ul>
<h3 id="哈夫曼信息解码"><a class="markdownIt-Anchor" href="#哈夫曼信息解码"></a> 哈夫曼信息解码</h3>
<ul>
<li>Huffman 信息解码块的任务是设置 Huffman 解码块所需的所有参数。</li>
<li>第一个任务是从辅助信息中收集有关 Huffman 编码比特的数据。这包括在比特流中找到 Huffman 编码的比特，并确定每个频谱区域分区所使用的 Huffman 表。</li>
<li>此外，该块必须确保生成所有频率线，而不管 Huffman 编码比特中描述了多少频率线。当出现少于 576 个频率线时，Huffman 信息解码块必须执行零填充以填补数据的不足。</li>
</ul>
<p>哈夫曼解码：</p>
<ul>
<li>由于 Huffman 编码是一种可变长度编码方法，没有尝试将 Huffman 编码比特中的各个码字分开，因此，如果不从已知为码字起始点的 Huffman 编码比特开始解码，无法识别 Huffman 编码比特中间的单个码字。</li>
<li>如果在一串 Huffman 编码比特中发生错误，剩余的编码比特无法正确解码。<strong>我们可以直接找下一帧的同步字，那么这一帧就去掉。</strong></li>
</ul>
<p>子带因子解码：<img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231109223350.webp" alt="image.png"></p>
<h3 id="反量化dequantization或去缩放descaling"><a class="markdownIt-Anchor" href="#反量化dequantization或去缩放descaling"></a> 反量化（Dequantization）或去缩放（Descaling）</h3>
<p>目的是重构编码器中由 MDCT 块生成的频率线的感知相同的数据。</p>
<p>长窗口的计算公式为：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231109223456.webp" alt="image.png"></p>
<p>短窗口的计算公式为：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231109223500.webp" alt="image.png"></p>
<p>反量化：</p>
<ul>
<li><span style="color:#ff0000">全局步长（global_gain）定义了在一个 granule 内用于一个声道的量化步长</span>。</li>
<li>编码器中的比例因子（scalefactors）使用步长为 2 或 sqrt(2) 进行量化，可以通过 scalefac_scale 标志的值来识别，如果 scalefac_scale=0，则 scalefac_multiplier=0.5，否则 scalefac_multiplier=1。</li>
<li>pretab 和 preflag 变量仅在长窗口的情况下使用。一个表格为 pretab 变量的每个比例因子带指定了一个单独的值。</li>
<li>对于短窗口，通过 subblock_gain 指定了一个 gain factor。</li>
</ul>
<h3 id="重新排序reordering"><a class="markdownIt-Anchor" href="#重新排序reordering"></a> 重新排序（Reordering）</h3>
<p>通过解量化生成的频率线并不总是以相同的方式排序。</p>
<p>在长窗口的 MDCT 块中，它会首先按子带，然后按频率生成排序的频率线。</p>
<p>为了增加频率线的 Huffman 编码效率，在短窗口中，频率线首先按子带排序，然后按频率排序，最后按窗口排序。</p>
<h3 id="立体声处理"><a class="markdownIt-Anchor" href="#立体声处理"></a> 立体声处理</h3>
<p>在解量化之后，重构的值在进入合成滤波器组之前进行中侧处理（MS）。</p>
<p>在中侧立体声（MS）模式下，传输的是归一化的中侧（middle/side）通道值 Mi/Si，而不是左右（left/right）通道值 Li/Ri。因此，可以使用这些 Mi/Si 值来重构 Li/Ri。</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231109224345.webp" alt="image.png"></p>
<h3 id="去混叠-2"><a class="markdownIt-Anchor" href="#去混叠-2"></a> 去混叠</h3>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231109224359.webp" alt="image.png"></p>
<h3 id="反向-mdct"><a class="markdownIt-Anchor" href="#反向-mdct"></a> 反向 MDCT</h3>
<p>从去混叠块中处理的频率线通过 IMDCT 块进行处理。IMDCT 的表达式如下所示：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231109224424.webp" alt="image.png"></p>
<p>Xk 表示频率线，对于短块 n=12，对于长块 n=36。</p>
<p>根据 block_type 值，xi 与之前定义的窗口之一相乘：</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231109224428.webp" alt="image.png"></p>
<h3 id="imdct-的重叠相加"><a class="markdownIt-Anchor" href="#imdct-的重叠相加"></a> IMDCT 的重叠相加</h3>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231109224656.webp" alt="image.png"></p>
<h3 id="合成多相滤波器组"><a class="markdownIt-Anchor" href="#合成多相滤波器组"></a> 合成多相滤波器组</h3>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231109224713.webp" alt="image.png"></p>
<h2 id="编码语法normative-elements"><a class="markdownIt-Anchor" href="#编码语法normative-elements"></a> 编码语法（Normative Elements）</h2>
<h3 id="位流格式"><a class="markdownIt-Anchor" href="#位流格式"></a> 位流格式</h3>
<p>一个 MP3 位流被组织成音频帧，其中包括五个部分：头部、CRC、辅助信息、主数据和附加数据。</p>
<p>单声道的辅助信息块长度为 136 位，双声道的辅助信息块长度为 256 位。</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231110132621.webp" alt="image.png"></p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 音频帧</span></span><br><span class="line">frame()</span><br><span class="line">{</span><br><span class="line">	header()</span><br><span class="line">	error_check()</span><br><span class="line">	audio_data() <span class="comment">// 音频数据</span></span><br><span class="line">	ancillary_data()</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h3 id="header"><a class="markdownIt-Anchor" href="#header"></a> Header</h3>
<p>一开始的 32 位（4 字节）是头部信息。</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231110132753.webp" alt="image.png"></p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">header()</span><br><span class="line">{</span><br><span class="line">	syncword           <span class="number">12</span> bits bslbf <span class="comment">// 12个1</span></span><br><span class="line">	ID                 <span class="number">1</span>  bit  bslbf <span class="comment">// 表明算法的ID。1表示MPEG音频，0做保留</span></span><br><span class="line">	layer              <span class="number">2</span>  bits bslbf <span class="comment">// 表明使用的层级。</span></span><br><span class="line">									 <span class="comment">// 11：Layer I；   10 Layer II</span></span><br><span class="line">									 <span class="comment">// 01：Layer III； 00 保留</span></span><br><span class="line">	protection_bit     <span class="number">1</span>  bit  bslbf <span class="comment">// 指示是否在音频比特流中增加了冗余，以方便错误检测。</span></span><br><span class="line">									 <span class="comment">// 1：没有冗余，0：增加了冗余</span></span><br><span class="line">	bitrate_index      <span class="number">4</span>  bits bslbf <span class="comment">// 指示比特率。全0表示'free format'，</span></span><br><span class="line">									 <span class="comment">// 可以使用不出现在列表中的固定比特率</span></span><br><span class="line">	sampling_frequency <span class="number">2</span>  bits bslbf <span class="comment">// 抽样频率</span></span><br><span class="line">	padding_bit        <span class="number">1</span>  bit  bslbf <span class="comment">// 1：帧包含额外的槽以调整平均比特率到采样频率，否则为0。</span></span><br><span class="line">									 <span class="comment">// padding只在44.1kHz采样频率下才有必要使用。</span></span><br><span class="line">	private_bit        <span class="number">1</span>  bit  bslbf <span class="comment">// 私用比特。未来ISO将不再使用。</span></span><br><span class="line">	mode               <span class="number">2</span>  bits bslbf </span><br><span class="line">	mode_extension     <span class="number">2</span>  bits bslbf <span class="comment">// 用于联合立体声模式中（mode='01'）</span></span><br><span class="line">									<span class="comment">// 指名应用哪种联合立体声编码方法类型。</span></span><br><span class="line">									<span class="comment">//该算法中隐含了应用强度立体声模式和ms_stereo模式的频率范围</span></span><br><span class="line">	copyright          <span class="number">1</span>  bit  bslbf <span class="comment">// 0:编码的比特流没有版权，1：存在版权保护</span></span><br><span class="line">	original/home      <span class="number">1</span>  bit  bslbf <span class="comment">// 0：比特流为副本，1：比特流为原始版本</span></span><br><span class="line">	emphasis           <span class="number">2</span>  bits bslbf <span class="comment">// 加重的信息。表明解加重需要使用的类型。</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<table>
<thead>
<tr>
<th>bit_rate_index</th>
<th>bit rate</th>
</tr>
</thead>
<tbody>
<tr>
<td>‘0000’</td>
<td>free</td>
</tr>
<tr>
<td>‘0001’</td>
<td>32 kbit/s</td>
</tr>
<tr>
<td>‘0010’</td>
<td>40 kbit/s</td>
</tr>
<tr>
<td>‘0011’</td>
<td>48 kbit/s</td>
</tr>
<tr>
<td>‘0100’</td>
<td>56 kbit/s</td>
</tr>
<tr>
<td>‘0101’</td>
<td>64 kbit/s</td>
</tr>
<tr>
<td>‘0110’</td>
<td>80 kbit/s</td>
</tr>
<tr>
<td>‘0111’</td>
<td>96 kbit/s</td>
</tr>
<tr>
<td>‘1000’</td>
<td>112 kbit/s</td>
</tr>
<tr>
<td>‘1001’</td>
<td>128 kbit/s</td>
</tr>
<tr>
<td>‘1010’</td>
<td>160 kbit/s</td>
</tr>
<tr>
<td>‘1011’</td>
<td>192 kbit/s</td>
</tr>
<tr>
<td>‘1100’</td>
<td>224 kbit/s</td>
</tr>
<tr>
<td>‘1101’</td>
<td>256 kbit/s</td>
</tr>
<tr>
<td>‘1110’</td>
<td>320 kbit/s</td>
</tr>
<tr>
<td>‘1111’</td>
<td>forbidden</td>
</tr>
</tbody>
</table>
<p>sampling_frequency 抽样频率：</p>
<table>
<thead>
<tr>
<th></th>
<th>MPEG-1</th>
<th>MPEG-2</th>
</tr>
</thead>
<tbody>
<tr>
<td>‘00’</td>
<td>44.1kHz</td>
<td>22.05kHz</td>
</tr>
<tr>
<td>‘01’</td>
<td>48 kHz</td>
<td>24kHz</td>
</tr>
<tr>
<td>‘10’</td>
<td>32 kHz</td>
<td>16kHz</td>
</tr>
<tr>
<td>‘11’</td>
<td>reserved</td>
<td>reserved</td>
</tr>
</tbody>
</table>
<p>mode：</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>‘00’</td>
<td>stereo 立体声</td>
</tr>
<tr>
<td>‘01’</td>
<td>joint_stereo 联合立体声 (intensity_stereo 增强立体声 and/or ms_stereo)  ms-&gt;mid-size</td>
</tr>
<tr>
<td>‘10’</td>
<td>dual_channel</td>
</tr>
<tr>
<td>‘11’</td>
<td>single_channel 单通道</td>
</tr>
</tbody>
</table>
<p>mode_extension：</p>
<table>
<thead>
<tr>
<th></th>
<th>intensity_stereo</th>
<th>ms_stereo</th>
</tr>
</thead>
<tbody>
<tr>
<td>‘00’</td>
<td>off</td>
<td>off</td>
</tr>
<tr>
<td>‘01’</td>
<td>on</td>
<td>off</td>
</tr>
<tr>
<td>‘10’</td>
<td>off</td>
<td>on</td>
</tr>
<tr>
<td>‘11’</td>
<td>on</td>
<td>on</td>
</tr>
</tbody>
</table>
<p>emphasis：</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>‘00’</td>
<td>no emphasis</td>
</tr>
<tr>
<td>‘01’</td>
<td>50/15 microsec. emphasis</td>
</tr>
<tr>
<td>‘10’</td>
<td>reserved</td>
</tr>
<tr>
<td>‘11’</td>
<td>CCITT J.17</td>
</tr>
</tbody>
</table>
<h3 id="errorcheck"><a class="markdownIt-Anchor" href="#errorcheck"></a> ErrorCheck</h3>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">error_check()</span><br><span class="line">{</span><br><span class="line">	<span class="keyword">if</span> (protection_bit==<span class="number">0</span>) <span class="comment">// 在Header中</span></span><br><span class="line">		crc_check <span class="number">16</span> bits rpchof</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h3 id="audio-data"><a class="markdownIt-Anchor" href="#audio-data"></a> Audio Data</h3>
<p>每一个音频帧包含来自 1 到 2 个音频 granules 的压缩数据。</p>
<p>每一个 granule 由 18*32 子带样本组成</p>
<p>帧中的音频数据以下面的方式进行分配：</p>
<ul>
<li>main_data_begin pointer</li>
<li>side info for both granules (scfsi)</li>
<li>side info granule 1</li>
<li>side info granule 2</li>
<li>scalefactors and Huffman code data granule 1</li>
<li>scalefactors and Huffman code data granule 2</li>
</ul>
<h4 id="边信息"><a class="markdownIt-Anchor" href="#边信息"></a> 边信息</h4>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">audio_data(){</span><br><span class="line">	main_data_begin  <span class="number">9</span> bits uimsbf <span class="comment">// main-data-begin 的值用于确定帧的主数据的第一个比特的位置。它将该位置指定为相对于音频同步字节的负偏移量（以字节为单位）</span></span><br><span class="line">	<span class="keyword">if</span> (mode == single_channel)	{</span><br><span class="line">		private_bits <span class="number">5</span> bits bslbf <span class="comment">// 用于私有用途的位。这些位在ISO的未来不会被使用。</span></span><br><span class="line">		<span class="comment">// scfsi_band 控制着尺度因子组（scfsi_bands）的尺度因子选择信息的使用。</span></span><br><span class="line">		<span class="keyword">for</span> (scfsi_band=<span class="number">0</span>; scfsi_band&lt;<span class="number">4</span>; scfsi_band++)</span><br><span class="line">			scfsi[scfsi_band] <span class="number">1</span> bits bslbf <span class="comment">// 尺度因子选择信息。</span></span><br><span class="line">										   <span class="comment">// scfsi 控制着对于每个粒度是否传输尺度因子： </span></span><br><span class="line">										   <span class="comment">// '0' 对于每个粒度都传输尺度因子。 </span></span><br><span class="line">										   <span class="comment">// '1' 对于粒度0传输的尺度因子也适用于粒度1。</span></span><br><span class="line">		<span class="keyword">for</span> (gr=<span class="number">0</span>; gr&lt;<span class="number">2</span>; gr++) 	{</span><br><span class="line">			part2_3_length[gr] <span class="number">12</span> bits uimsbf</span><br><span class="line">			<span class="comment">// 该值包含用于尺度因子和Huffman编码数据的主数据比特数。</span></span><br><span class="line">			<span class="comment">// 由于边信息的长度始终相同，可以使用该值来计算每个粒度的主要信息的起始位置</span></span><br><span class="line">			<span class="comment">// 以及辅助信息的位置（如果使用）。</span></span><br><span class="line">			<span class="comment">// part2_length - 该值包含用于尺度因子的主数据比特数。</span></span><br><span class="line">			big_values[gr] <span class="number">9</span> bits uimsbf <span class="comment">// 每个粒度的频谱值使用不同的Huffman编码表进行编码。</span></span><br><span class="line">							<span class="comment">// 完整的频率范围被分成几个区域，然后使用不同的Huffman表进行编码。</span></span><br><span class="line">			global_gain[gr] <span class="number">8</span> bits uimsbf <span class="comment">// 全局量化步长</span></span><br><span class="line">			scalefac_compress[gr] <span class="number">4</span> bits bslbf <span class="comment">// 选择用于比例因子传输的位数。</span></span><br><span class="line">			blocksplit_flag[gr] <span class="number">1</span> bit bslbf <span class="comment">// 表示该块使用非正常（类型0）的窗口。</span></span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">if</span> (blocksplit_flag[gr]){</span><br><span class="line">		block_type[gr] <span class="number">2</span> bits bslbf <span class="comment">// 指示实际粒度的窗口类型。</span></span><br><span class="line">		switch_point[gr] <span class="number">1</span> bits uimsbf <span class="comment">// 表示短/长变换的分割点。</span></span><br><span class="line">		<span class="keyword">for</span> (region=<span class="number">0</span>; region&lt;<span class="number">2</span>; region++)</span><br><span class="line">			table_select[region][gr] <span class="number">5</span> bits bslbf <span class="comment">// 指定用于压缩特定量化MDCT区域的Huffman编码表。</span></span><br><span class="line">		<span class="keyword">for</span> (window=<span class="number">0</span>; window&lt;<span class="number">3</span>; window++)</span><br><span class="line">			subblock_gain[window][gr] <span class="number">3</span> bits uimsbf <span class="comment">// 表示一个子块相对于全局增益的增益偏移量。仅在块类型2（短窗口）中使用。</span></span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">else</span>{</span><br><span class="line">		<span class="keyword">for</span> (region=<span class="number">0</span>; region&lt;<span class="number">3</span>; region++)</span><br><span class="line">			table_select[region][gr] <span class="number">5</span> bits bslbf</span><br><span class="line">			<span class="comment">// region_address1[gr]，region_address2[gr]</span></span><br><span class="line">			<span class="comment">// 对频谱进行进一步分区，以增强Huffman编码器的性能。</span></span><br><span class="line">			<span class="comment">// 这是对big_values区域的细分。这个细分的目的是获得更好的错误鲁棒性（tea：这一点表示怀疑）和更好的编码效率。使用三个区域。</span></span><br><span class="line">			<span class="comment">// 每个区域根据最大量化值和局部信号统计使用不同的Huffman编码表进行编码。</span></span><br><span class="line">			region_address1[gr] <span class="number">4</span> bits bslbf</span><br><span class="line">			region_address2[gr] <span class="number">3</span> bits bslbf</span><br><span class="line">		}</span><br><span class="line">		preflag[gr] <span class="number">1</span> bit bslbf <span class="comment">// 这是对量化值进行额外高频放大的快捷方式。</span></span><br><span class="line">		scalefac_scale[gr] <span class="number">1</span> bit bslbf <span class="comment">// 比例因子按对数方式进行量化，步长为2，取决于scalefac_scale的值。</span></span><br><span class="line">		<span class="comment">// scalefac_scale = 0，步长为sqrt(2) </span></span><br><span class="line">		<span class="comment">// scalefac_scale = 1，步长为2</span></span><br><span class="line">		count1table_select[gr] <span class="number">1</span> bit bslbf <span class="comment">// 此标志选择两个可能的Huffman编码表之一，用于幅度不超过1的量化值四元组的区域。</span></span><br><span class="line">	}</span><br></pre></td></tr></tbody></table></figure>
<table>
<thead>
<tr>
<th>scfsi_band</th>
<th>scalefactor bands</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0,1,2,3,4,5,</td>
</tr>
<tr>
<td>1</td>
<td>6,7,8,9,10,</td>
</tr>
<tr>
<td>2</td>
<td>11 … 15</td>
</tr>
<tr>
<td>3</td>
<td>16 … 20</td>
</tr>
</tbody>
</table>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231110194611.webp" alt="image.png"></p>
<p>在长窗口的情况下，slen1 是用于比例因子带 0-10 的比例因子的长度。slen2 是用于比例因子带 11-21 的比例因子的长度。</p>
<table>
<thead>
<tr>
<th>scalefac_compress</th>
<th>slen1</th>
<th>slen2</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>0</td>
<td>2</td>
</tr>
<tr>
<td>3</td>
<td>0</td>
<td>3</td>
</tr>
<tr>
<td>4</td>
<td>3</td>
<td>0</td>
</tr>
<tr>
<td>5</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>6</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>7</td>
<td>1</td>
<td>3</td>
</tr>
<tr>
<td>8</td>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td>9</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>10</td>
<td>2</td>
<td>3</td>
</tr>
<tr>
<td>11</td>
<td>3</td>
<td>1</td>
</tr>
<tr>
<td>12</td>
<td>3</td>
<td>2</td>
</tr>
<tr>
<td>13</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>14</td>
<td>4</td>
<td>2</td>
</tr>
<tr>
<td>15</td>
<td>4</td>
<td>3</td>
</tr>
</tbody>
</table>
<h4 id="main-data"><a class="markdownIt-Anchor" href="#main-data"></a> Main Data</h4>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (gr=<span class="number">0</span>; gr&lt;<span class="number">2</span>; gr++)</span><br><span class="line">	<span class="keyword">if</span> (blocksplit_flag[gr] == <span class="number">1</span> &amp;&amp; block_type[gr] == <span class="number">2</span>){</span><br><span class="line">		<span class="keyword">for</span> (cb=<span class="number">0</span>; cb&lt;switch_point_l[gr]; cb++)</span><br><span class="line">		<span class="keyword">if</span> (scfsi[cb]==<span class="number">0</span>) || (gr==<span class="number">0</span>)</span><br><span class="line">			scalefac[cb][gr] <span class="number">0.</span><span class="number">.4</span> bits uimsbf</span><br><span class="line">		<span class="title function_">for</span> <span class="params">(cb=switch_point_s[gr]; cb&lt;cblimit_short; cb++)</span></span><br><span class="line">			<span class="title function_">for</span> <span class="params">(window=<span class="number">0</span>; window&lt;<span class="number">3</span>; window++)</span></span><br><span class="line">			<span class="title function_">if</span> <span class="params">(scfsi[cb]==<span class="number">0</span>)</span> || <span class="params">(gr==<span class="number">0</span>)</span></span><br><span class="line">				scalefac[cb][window][gr] 0..4 bits uimsbf</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="title function_">for</span> <span class="params">(cb=<span class="number">0</span>; cb&lt;cblimit; cb++)</span></span><br><span class="line">			<span class="title function_">if</span> <span class="params">(scfsi[cb]==<span class="number">0</span>)</span> || <span class="params">(gr==<span class="number">0</span>)</span></span><br><span class="line">				scalefac[cb][gr] 0..4 bits uimsbf</span><br><span class="line">				<span class="title function_">Huffmancodebits</span> <span class="params">(part2_3_length-part2_length)</span> bits bslbf</span><br><span class="line">				<span class="title function_">while</span> <span class="params">(position != main_data_end)</span>{</span><br><span class="line">					ancillary_bit <span class="number">1</span> bit bslbf</span><br><span class="line">				}</span><br><span class="line">			}</span><br></pre></td></tr></tbody></table></figure>
<p><code>scalefac[cb][gr]</code> - 比例因子用于给量化噪声上色。如果量化噪声被正确形状的颜色掩盖，它将完全被掩盖。</p>
<p>编码器和解码器使用比例因子来获取数值块的除法因子。这些块延伸到多个频率线上。这些块被称为比例因子带，被选择得尽可能接近临界带。</p>
<p>比例因子压缩表显示，比例因子 0…10 的范围为 0 到 15（最大长度为 4 位），比例因子 11…21 的范围为 0 到 7（最大长度为 3 位）。</p>
<p>将频谱细分为比例因子带对于每个块长度和采样频率是固定的，并存储在编码器和解码器的表中。</p>
<p><code>Huffman_code_bits</code> - 伪函数</p>
<ul>
<li>所有绝对值小于等于 15 的量化值直接使用 Huffman 编码进行编码。总是对值 (x,y) 进行编码。</li>
<li>如果发现幅度大于 15 的量化值，则使用 ESC 码来标记这些值。</li>
<li>如果一对值中的一个或两个值不为零，则在 Huffman 编码字后附加一个或两个符号位。</li>
</ul>
<p><code>hcod[|x|][|y|]</code> 是值 x、y 的 Huffman 编码表条目。</p>
<p><code>hlen[|x|][|y|]</code> 是值 x、y 的 Huffman 长度表条目。</p>
<p><code>max_table_entry</code> 是最大的表条目索引。这是一个系统常量（15，单个表中的最大条目数为 256）。</p>
<p><code>signx</code> 是第一个值的符号（如果为正，则为 0；如果为负，则为 1）。</p>
<p><code>signy</code> 是第二个值的符号（如果为正，则为 0；如果为负，则为 1）。</p>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 21：MP3 huffman code: <span style="color:#ff0000">linebits</span></div>
</div>
<div class="callout-content"><p></p>
</div></div><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">coded_word</span> {</span></span><br><span class="line">	codeword      <span class="comment">// hcod[|x|][|y|], length is hlen[|x|][|y|]</span></span><br><span class="line">	linbitsx      <span class="comment">// 如果(x=15)，则构成一个ESC码。在这种情况下，该字段的长度为linbits，否则为零。该字段中包含的无符号整数加上15，以确定编码数据的绝对值。</span></span><br><span class="line">	signx         <span class="comment">// sign of x (transmitted only if x not equal 0)</span></span><br><span class="line">	linbitsy      <span class="comment">// See linbitsx.</span></span><br><span class="line">	signy         <span class="comment">// sign of y (transmitted only if y not equal 0)</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>只有在实际标记了大于或等于 15 的值时，才会使用 ESCaped 代码 linbitsx 或 linbitsy。</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231110200755.webp" alt="image.png"></p>
<p>Huffman 编码</p>
<p>对于频谱的高端部分，使用两个特殊的 Huffman 表对值的四元组进行编码。</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">quad_word</span> {</span></span><br><span class="line">	codeword <span class="comment">// hcod[|v|][|w|][|x|][|y|]，hlen[|v|][|w|][|x|][|y|]</span></span><br><span class="line">	signv    <span class="comment">//（仅当v不等于0时）</span></span><br><span class="line">	signw    <span class="comment">//（仅当w不等于0时）</span></span><br><span class="line">	signx    <span class="comment">//（仅当x不等于0时）</span></span><br><span class="line">	signy    <span class="comment">//（仅当y不等于0时）</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>在频谱的高端部分，只需计算零对的数量。由于当其他值已解码时，这个值是隐含已知的，因此不需要传输。</p>
<p>Huffman 编码数据的排序方式：</p>
<ul>
<li>如果 block_type 为 0、1 或 3，则根据频率递增的顺序对 Huffman 编码数据进行排序。</li>
<li>如果 block_type 为 2（短块），则 Huffman 编码数据的排序如下：
<ul>
<li>首先给出连续的比例因子带的 Huffman 编码数据，从比例因子带 0 开始，以比例因子带 11 结束。</li>
<li>在每个比例因子带内，按照时间窗口的顺序给出数据，从窗口 0 开始，以窗口 2 结束。每个窗口内的数据值按照频率递增的顺序排列。</li>
</ul>
</li>
</ul>
<p>Characteristic of 32 Huffman tables:</p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231110201127.webp" alt="image.png"></p>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231110201152.webp" alt="image.png"></p>
<p>TIP: 考试的时候以长块为准。</p>
<p><code>cb_limit</code> - 长块（block_type != 2）的比例因子带数量。对于所有模式和所有采样频率的 Layer III，这是一个常数，为 21。</p>
<p><code>cb_limit_short</code> - 短块（block_type=2）的比例因子带数量。对于所有模式和所有采样频率的 Layer III，这是一个常数，为 12。</p>
<p><code>window</code> - 在 block_type=2 的情况下，实际时间槽的数量。window 的取值为 0、1、2。</p>
<h1 id="88-010-编辑器之模板的使用"><a class="markdownIt-Anchor" href="#88-010-编辑器之模板的使用"></a> 88、010 编辑器之模板的使用</h1>
<h2 id="什么是-010-编辑器"><a class="markdownIt-Anchor" href="#什么是-010-编辑器"></a> 什么是 010 编辑器</h2>
<p>010 编辑器是一个专业的文本/HEX 编辑器，它可以快速并易于编辑电脑上的任何文件内容。</p>
<ul>
<li>查看并编辑任何硬盘上的二进制文件，以及文本文件（Unicode 文件、C/C++ 源文件等）</li>
<li>独家的二进制模板技术能让你理解任何二进制文件</li>
<li>通过强大的工具（查找、替换等功能）分析并编辑文本以及二进制数据</li>
<li>使用硬盘、软盘等查找并修复问题</li>
</ul>
<h2 id="二进制模板"><a class="markdownIt-Anchor" href="#二进制模板"></a> 二进制模板</h2>
<p>010 编辑器可以将二进制文件已易于使用的方式将其结构呈现在你的面前。二进制模板可以将二进制文件解析为指定的结构。</p>
<p>模板有着和 C/C++ 相似的结构，但它们是以一个程序运行的。当模板中的变量声明后，变量将映射到当前文件的对应字节集合。</p>
<p><span style="color:#ff0000">例子：</span></p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">FILE</span> {</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">HEADER</span> {</span></span><br><span class="line">        <span class="type">char</span> type[<span class="number">4</span>];   <span class="comment">// 映射文件的0~3字节（注意，从0开始数）</span></span><br><span class="line">        <span class="type">int</span> version;    <span class="comment">// 映射文件的4~7字节</span></span><br><span class="line">        <span class="type">int</span> numRecords; <span class="comment">// 映射文件的8~11字节</span></span><br><span class="line">    } header;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">RECORD</span> {</span></span><br><span class="line">        <span class="type">int</span> employeeId;</span><br><span class="line">        <span class="type">char</span> name[<span class="number">40</span>];</span><br><span class="line">        <span class="type">float</span> salary;</span><br><span class="line">    } record[header.numRecords];</span><br><span class="line">} file;</span><br></pre></td></tr></tbody></table></figure>
<p>当访问一个变量时，其值从文件中读出；当对一个变量进行赋值时，其值将写回文件。</p>
<p>这些模板的 <code>structures</code> 和常规的 C 不同，因为它包含了控制语句，如 if，for，while。</p>
<p>模板的执行顺序为从文件顶端到底部。</p>
<h2 id="写一个二进制模板"><a class="markdownIt-Anchor" href="#写一个二进制模板"></a> 写一个二进制模板</h2>
<h3 id="模板基础"><a class="markdownIt-Anchor" href="#模板基础"></a> 模板基础</h3>
<p>模板可以使二进制文件更容易理解和编辑。每一个模板是以 <code>.bt</code> 为后缀的文本文件，可以被 010 编辑器编辑。</p>
<h3 id="数字"><a class="markdownIt-Anchor" href="#数字"></a> 数字</h3>
<p>Decimal - 456</p>
<p>Hexadecimal - 0xff, 25h, 0EFh</p>
<p>Octal - 013 (任何数字前加 0)</p>
<p>Binary - 0b011</p>
<p>无符号值：数字后加 <code>u</code>，例如 12u</p>
<p>8 字节的 int64：数字后加 <code>L</code>，例如 1L</p>
<p>浮点数中对于一个指数会包含 e，例如 1e10</p>
<p>浮点数默认为 8 字节 double 型，除非数字后加了 f（4 字节 float，例子：2.0f）</p>
<h3 id="数据类型"><a class="markdownIt-Anchor" href="#数据类型"></a> 数据类型</h3>
<p>8-Bit Signed Integer - char, byte, CHAR, BYTE</p>
<p>8-Bit Unsigned Integer - uchar, ubyte, UCHAR, UBYTE</p>
<p>16-Bit Signed Integer - short, int16, SHORT, INT16</p>
<p>16-Bit Unsigned Integer - ushort, uint16, USHORT, UINT16, WORD</p>
<p>32-Bit Signed Integer - int, int32, long, INT, INT32, LONG</p>
<p>32-Bit Unsigned Integer - uint, uint32, ulong, UINT, UINT32, ULONG, DWORD</p>
<p>64-Bit Signed Integer - int64, quad, QUAD, INT64, __int64</p>
<p>64-Bit Unsigned Integer - uint64, uquad, UQUAD, UINT64, QWORD, __uint64</p>
<p>32-Bit Floating Point Number - float, FLOAT</p>
<p>64-Bit Floating Point Number - double, DOUBLE</p>
<p>模板中可以使用数字类型，但数字在被运算前，必须转换为 int 或 float</p>
<h3 id="类型定义-typedef"><a class="markdownIt-Anchor" href="#类型定义-typedef"></a> 类型定义 typedef</h3>
<p>其他类型可以通过 <code>typedef</code> 关键字创建。</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建类型语法：</span></span><br><span class="line"><span class="keyword">typedef</span> &lt;data_type&gt; &lt;new_type_name&gt;</span><br><span class="line"><span class="comment">// 例子：创建新类型myInt，表示无符号整数</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">int</span> myInt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 运用于数组：</span></span><br><span class="line"><span class="keyword">typedef</span> &lt;data_type&gt; &lt;new_type_name&gt; [ &lt;array_size&gt; ]</span><br><span class="line"><span class="comment">// array_size必须为常量，typedef不能用于创建多维数组，但可以在structs中使用。</span></span><br><span class="line"><span class="comment">// 例子：生成新的字符串类型数组</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">char</span> myString[<span class="number">15</span>];</span><br><span class="line">myString s = <span class="string">"Test"</span>;</span><br></pre></td></tr></tbody></table></figure>
<h3 id="声明模板变量"><a class="markdownIt-Anchor" href="#声明模板变量"></a> 声明模板变量</h3>
<p>声明变量的方法类似于 C 语言但有一个重要的区别：模板中已声明的变量映射到文件中的一组字节。</p>
<p>可以通过定义 structs 或 unions 的方法将模板变量组织起来。</p>
<h3 id="特殊属性"><a class="markdownIt-Anchor" href="#特殊属性"></a> 特殊属性</h3>
<p>变量后后面可以使用 <code>&lt;&gt;</code> 将一个或多个的特殊属性括住。</p>
<p>支持以下属性：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;</span><br><span class="line">    format  = hex|decimal|octal|binary,</span><br><span class="line">    fgcolor = &lt;color&gt;,</span><br><span class="line">    bgcolor = &lt;color&gt;,</span><br><span class="line">    comment = <span class="string">"&lt;string&gt;"</span>,</span><br><span class="line">    open    = <span class="literal">true</span>|<span class="literal">false</span>|suppress,</span><br><span class="line">    hidden  = <span class="literal">true</span>|<span class="literal">false</span>,</span><br><span class="line">    read    = &lt;function_name&gt;</span><br><span class="line">&gt;</span><br></pre></td></tr></tbody></table></figure>
<h3 id="局部变量"><a class="markdownIt-Anchor" href="#局部变量"></a> 局部变量</h3>
<p>在有些情况中，一些变量不需要映射到文件中的值或者显示在「模板结果」中（可以右击「模板结果」开启局部变量的查看）。我们可以使用关键字 <code>local</code> 声明变量。例子：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">local <span class="type">int</span> i, total = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> recordCounts[<span class="number">5</span>];</span><br><span class="line"><span class="keyword">for</span>( i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++ )</span><br><span class="line">    total += recordCounts[i];</span><br><span class="line"><span class="type">double</span> records[ total ];</span><br></pre></td></tr></tbody></table></figure>
<h3 id="字符串"><a class="markdownIt-Anchor" href="#字符串"></a> 字符串</h3>
<p>通常二进制文件中定义了 Null 结尾的字符串。010 编辑器可以通过特殊的语法进行阅读：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 以下两种方法将读取字符串，直到遇到「0」字节</span></span><br><span class="line"><span class="type">char</span> str[];</span><br><span class="line"><span class="built_in">string</span> str;</span><br><span class="line"><span class="comment">// Unicode 字符串可以使用以下两种方法阅读：</span></span><br><span class="line"><span class="type">wchar_t</span> str[];</span><br><span class="line"><span class="built_in">wstring</span> str;</span><br></pre></td></tr></tbody></table></figure>
<p>字符串中可以使用=、+、+=以及比较运算符，例子：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">local <span class="type">char</span> str[<span class="number">15</span>] = <span class="string">"First"</span>;</span><br><span class="line">local <span class="built_in">string</span> s = <span class="string">"Second"</span>;</span><br><span class="line">local <span class="built_in">string</span> r1 = str + s;</span><br><span class="line">local <span class="built_in">string</span> r2 = str;</span><br><span class="line">r2 += s;</span><br><span class="line"><span class="keyword">return</span> (r1 == r2);</span><br></pre></td></tr></tbody></table></figure>
<h3 id="颜色"><a class="markdownIt-Anchor" href="#颜色"></a> 颜色</h3>
<p>解析文件时，使用模板可以将不同颜色应用到不同的变量上，有两种方式：</p>
<ul>
<li>方式一：对单个变量设置颜色<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 语法：在变量后添加以下标签</span></span><br><span class="line">&lt;fgcolor=???&gt; <span class="comment">// 设置前景色</span></span><br><span class="line">&lt;bgcolor=???&gt; <span class="comment">// 设置背景色</span></span><br><span class="line"><span class="comment">// 例子：</span></span><br><span class="line"><span class="type">int</span> id &lt;fgcolor=cBlack, bgcolor=<span class="number">0x0000FF</span>&gt;;</span><br></pre></td></tr></tbody></table></figure>
</li>
<li>方式二：使用 <code>SetForeColor</code>，<code>SetBackColor</code>，<code>SetColor</code> 函数设置默认颜色。<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在这些函数后定义变量</span></span><br><span class="line">SetForeColor( cRed );</span><br><span class="line"><span class="type">int</span> first; <span class="comment">// will be colored red</span></span><br><span class="line"><span class="type">int</span> second; <span class="comment">// will be colored red</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 关闭涂色的方法</span></span><br><span class="line">SetForeColor( cNone );</span><br><span class="line"><span class="type">int</span> third; <span class="comment">// will not be colored</span></span><br></pre></td></tr></tbody></table></figure>
</li>
</ul>
<h3 id="顺序"><a class="markdownIt-Anchor" href="#顺序"></a> 顺序</h3>
<p>当每一个模板变量都声明后，「当前文件的位置」将向前移动。可以通过使用函数 FTell 获取「当前文件位置」。</p>
<p>通过使用 FSeek 或 FSkip 函数，「当前位置」可以在整个文件中移动。这项技术允许我们不按顺序解析文件。</p>
<p>可以使用 ReadByte, ReadShort, ReadInt 等函数实现不定义变量而读取文件。</p>

<div class="callout" data-callout="hint">
<div class="callout-title">
<div class="callout-title-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>
</div>
<div class="callout-title-inner">考点 14：010 编辑器：Array、Struct</div>
</div>
<div class="callout-content"><p></p>
</div></div><h3 id="结构-struct"><a class="markdownIt-Anchor" href="#结构-struct"></a> 结构 struct</h3>
<p>关键字 <code>struct</code> 可以定义一个数据结构。可以使用 C/C++ 语法进行定义。例子：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 生成新类型myStruct，但不声明任何变量</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">myStruct</span> {</span></span><br><span class="line">    <span class="type">int</span> a;</span><br><span class="line">    <span class="type">int</span> b;</span><br><span class="line">    <span class="type">int</span> c;</span><br><span class="line">};</span><br><span class="line"><span class="comment">// 声明一个结构</span></span><br><span class="line">myStruct s;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义结构并声明两个实例</span></span><br><span class="line"><span class="comment">// 其中，s1覆盖文件的前12个字节，s2覆盖接下来的12个字节</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">myStruct</span> {</span></span><br><span class="line">    <span class="type">int</span> a; <span class="comment">// 4字节</span></span><br><span class="line">    <span class="type">int</span> b;</span><br><span class="line">    <span class="type">int</span> c;</span><br><span class="line">} s1, s2;</span><br></pre></td></tr></tbody></table></figure>
<p>使用控制语句（<code>if</code>，<code>for</code>，<code>while</code>）的结构。例子：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 实例s只生成两个变量：a、b或a、c</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">myIfStruct</span> {</span></span><br><span class="line">    <span class="type">int</span> a;</span><br><span class="line">    <span class="keyword">if</span>( a &gt; <span class="number">5</span> )</span><br><span class="line">        <span class="type">int</span> b;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="type">int</span> c;</span><br><span class="line">} s;</span><br></pre></td></tr></tbody></table></figure>
<p>结构可以嵌套，也可以声明数组。例子：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> {</span></span><br><span class="line">    <span class="type">int</span> width;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">COLOR</span> {</span></span><br><span class="line">        uchar r, g, b;</span><br><span class="line">    } colors[width];</span><br><span class="line">} line1;</span><br></pre></td></tr></tbody></table></figure>
<p>使用 typedef 定义 struct 的别名：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> {</span></span><br><span class="line">    ushort id;</span><br><span class="line">    <span class="type">int</span> size;</span><br><span class="line">} myData;</span><br></pre></td></tr></tbody></table></figure>
<h3 id="联合-union"><a class="markdownIt-Anchor" href="#联合-union"></a> 联合 union</h3>
<p>union 中，所有变量从相同的位置开始。union 的大小为其中最大变量的大小。</p>
<p>可以使用和 struct 相同的语法进行声明。例子：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 以下Union大小为8字节</span></span><br><span class="line"><span class="class"><span class="keyword">union</span> <span class="title">myUnion</span> {</span></span><br><span class="line">    ushort s;</span><br><span class="line">    <span class="type">double</span> d; <span class="comment">// 8字节</span></span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">} u;</span><br></pre></td></tr></tbody></table></figure>
<h3 id="带参数的-struct-和-union"><a class="markdownIt-Anchor" href="#带参数的-struct-和-union"></a> 带参数的 struct 和 union</h3>
<p>struct 或 union 关键字后可以接参数列表。参数列表的定义和函数相似。例子：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title function_">VarSizeStruct</span> <span class="params">(<span class="type">int</span> arraySize)</span></span><br><span class="line">{</span><br><span class="line">    <span class="type">int</span> <span class="built_in">array</span>[arraySize];</span><br><span class="line">};</span><br><span class="line"><span class="comment">// 声明实例。传递参数到结构体中</span></span><br><span class="line">VarSizeStruct <span class="title function_">s1</span><span class="params">(<span class="number">5</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 可以使用typedef声明</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="title function_">struct</span> <span class="params">(<span class="type">int</span> arraySize)</span></span><br><span class="line">{</span><br><span class="line">    <span class="type">int</span> <span class="built_in">array</span>[arraySize];</span><br><span class="line">} VarSizeStruct;</span><br></pre></td></tr></tbody></table></figure>
<h3 id="数组-array"><a class="markdownIt-Anchor" href="#数组-array"></a> 数组 Array</h3>
<p>数组变量定义的语法：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;data type&gt; &lt;variable name&gt; [ &lt;expression&gt; ] <span class="comment">// 例子：int myArray[15];</span></span><br></pre></td></tr></tbody></table></figure>
<p>一些例子：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 与ANSI C不同的是，数组的大小可以为任意表达式（包括变量、函数或操作符）</span></span><br><span class="line"><span class="type">int</span> myArray[ FileSize() - myInt * <span class="number">0x10</span> + (<span class="number">17</span> &lt;&lt; <span class="number">5</span>) ];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用中括号获取单个元素</span></span><br><span class="line">myArray[i] = value;</span><br></pre></td></tr></tbody></table></figure>
<p>当数组的大小定义为 0 时将有警告提示（不是异常）并且不声明任何变量。</p>
<p>010 编辑器允许数组以特殊的方式构建。当定义模板变量时，可以定义多个名称相同的变量。010 编辑器将这些相同变量看作数组，称之为 Duplicate Array。例子：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> x; <span class="type">int</span> x; <span class="type">int</span> x;</span><br><span class="line"><span class="comment">// 可以这样读取：</span></span><br><span class="line">x[<span class="number">0</span>]; <span class="comment">// 读取第一个x的值</span></span><br></pre></td></tr></tbody></table></figure>
<p>可以使用 for 或 while 定义 Duplicate arrays：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">local <span class="type">int</span> i;</span><br><span class="line"><span class="keyword">for</span>( i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++ )</span><br><span class="line">    <span class="type">int</span> x;</span><br></pre></td></tr></tbody></table></figure>
<h3 id="表达式"><a class="markdownIt-Anchor" href="#表达式"></a> 表达式</h3>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231101183949.webp" alt="image.png"></p>
<p>可以使用任何的赋值运算符：+=, -=, *=, /=, &amp;=, ^=, %=, |=, &lt;&lt;=, &gt;&gt;=</p>
<p>可以使用小括号组合表达式。</p>
<h3 id="布尔运算符"><a class="markdownIt-Anchor" href="#布尔运算符"></a> 布尔运算符</h3>
<p>&amp;&amp;（AND)</p>
<p>||(OR)</p>
<p>!(NOT- 单操作符)</p>
<p>可以使用小括号指定操作顺序。</p>
<h3 id="控制语句"><a class="markdownIt-Anchor" href="#控制语句"></a> 控制语句</h3>
<p>可以使用 break、continue、return</p>
<h4 id="if-语句"><a class="markdownIt-Anchor" href="#if-语句"></a> if 语句</h4>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>( x &lt; <span class="number">5</span> )</span><br><span class="line">    x = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( y &gt; x )</span><br><span class="line">    max = y;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">{</span><br><span class="line">    max = x;</span><br><span class="line">    y = <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id="for-语句"><a class="markdownIt-Anchor" href="#for-语句"></a> for 语句</h4>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>( i = <span class="number">0</span>, x = <span class="number">0</span>; i &lt; <span class="number">15</span>; i++ )</span><br><span class="line">{</span><br><span class="line">    x += i;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id="while-语句"><a class="markdownIt-Anchor" href="#while-语句"></a> while 语句</h4>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>( myVar &lt; <span class="number">15</span> )</span><br><span class="line">{</span><br><span class="line">    x *= myVar;</span><br><span class="line">    myVar += <span class="number">2</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">{</span><br><span class="line">    x *= myVar;</span><br><span class="line">    myVar += <span class="number">2</span>;</span><br><span class="line">}<span class="keyword">while</span>( myVar &lt; <span class="number">23</span> );</span><br></pre></td></tr></tbody></table></figure>
<h4 id="switch-语句"><a class="markdownIt-Anchor" href="#switch-语句"></a> switch 语句</h4>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span>( &lt;variable&gt; )</span><br><span class="line">{</span><br><span class="line">    <span class="keyword">case</span> &lt;expression&gt;: &lt;statement&gt;; [<span class="keyword">break</span>;]</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">default</span> : &lt;statement&gt;;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h3 id="比特域"><a class="markdownIt-Anchor" href="#比特域"></a> 比特域</h3>
<p>比特域允许细分结构为多组比特。这一过程允许将多个变量打包成一个块的内存。</p>
<p>定义比特域的语法：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">type_name &lt;variable_name&gt; : number_of_bits;</span><br><span class="line"><span class="comment">// type_name 可以是char, short, int, int64 (unsigned or signed) 或其他的等效类型</span></span><br></pre></td></tr></tbody></table></figure>
<p>如果变量名省略，那么对应这个变量的比特数也将省略。例子：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 打包alpha和beta为一个32比特的值中，但忽略中间的12bit</span></span><br><span class="line"><span class="type">int</span> alpha : <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span>      : <span class="number">12</span>;</span><br><span class="line"><span class="type">int</span> beta : <span class="number">15</span>;</span><br></pre></td></tr></tbody></table></figure>
<h4 id="比特域模式"><a class="markdownIt-Anchor" href="#比特域模式"></a> 比特域模式</h4>
<p>010 编辑器有两个特殊的比特域模式，定义了比特如何打包到变量中：</p>
<ul>
<li>padded bitfields（默认）。比特打包为变量的方式取决于当前的字节顺序（大小端）。默认为，小端文件从右到左打包，大端文件从左往右打包。</li>
<li>unpadded bitfields</li>
</ul>
<h5 id="padded-bitfields"><a class="markdownIt-Anchor" href="#padded-bitfields"></a> Padded bitfields</h5>
<p>例子：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ushort a : <span class="number">4</span>;</span><br><span class="line">ushort b : <span class="number">7</span>;</span><br><span class="line">ushort c : <span class="number">5</span>;</span><br><span class="line"><span class="comment">// 小端模式下，结构存储为：cccccbbb bbbbaaaa</span></span><br><span class="line"><span class="comment">// 大端模式下，结构存储为：aaaabbbb bbbccccc</span></span><br></pre></td></tr></tbody></table></figure>
<p>当需要的时候，程序会增加填充。例如某些特定的比特域将跨越变量的边界，这将会添加填充使得比特域从下一个变量开始。例如：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 第一个变量</span></span><br><span class="line"><span class="type">int</span> apple : <span class="number">10</span>;</span><br><span class="line"><span class="type">int</span> orange : <span class="number">20</span>;</span><br><span class="line"><span class="comment">// 第二个变量</span></span><br><span class="line"><span class="type">int</span> banana : <span class="number">10</span>;</span><br><span class="line"><span class="type">int</span> peach : <span class="number">12</span>;</span><br><span class="line"><span class="comment">// 此处填充10个比特</span></span><br><span class="line"><span class="comment">// 第三个变量</span></span><br><span class="line"><span class="type">short</span> grape : <span class="number">4</span>; <span class="comment">// 字节类型改变为short</span></span><br></pre></td></tr></tbody></table></figure>
<h5 id="unpadded-bitfields"><a class="markdownIt-Anchor" href="#unpadded-bitfields"></a> Unpadded Bitfields</h5>
<p>将文件视为一个长长的比特流，不管是变量类型改变时还是比特不能被打包为单个变量时，都不存在任何的填充比特。</p>
<p>进入此模式的方法：调用 <code>BitfieldDisablePadding</code> 函数（调用 <code>BitfieldEnablePadding</code> 以返回 padding 模式）</p>
<p>在 unpadded Bitfield 模式中，每一个定义的变量从比特流中读取比特。例如：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">BitfieldDisablePadding();</span><br><span class="line"><span class="type">short</span> a : <span class="number">10</span>; <span class="comment">// 从文件中读取10个比特</span></span><br><span class="line"><span class="type">int</span>   b : <span class="number">20</span>; <span class="comment">// 读取接下来的20个比特</span></span><br><span class="line"><span class="type">short</span> c : <span class="number">10</span>;</span><br><span class="line"><span class="comment">// 如果比特域被定义为从右到左读取（小端数据的默认方式，或使用了BitfieldRightToLeft函数）</span></span><br><span class="line"><span class="comment">// 变量将以此方式存储比特：aaaaaaaa bbbbbbaa bbbbbbbb ccbbbbbb cccccccc</span></span><br></pre></td></tr></tbody></table></figure>
<h3 id="函数"><a class="markdownIt-Anchor" href="#函数"></a> 函数</h3>
<p>010 编辑器中内置有大量的函数。支持许多标准 C 函数，并以首字母大写以区分它们。</p>
<h4 id="调用"><a class="markdownIt-Anchor" href="#调用"></a> 调用</h4>
<p>使用典型 C 语言语法进行函数调用：<code>&lt;function name&gt; ( &lt;argument_list&gt; )</code>，例子：<code>Strlen(str);</code></p>
<h4 id="定义"><a class="markdownIt-Anchor" href="#定义"></a> 定义</h4>
<p>常规 C 语法：<code>&lt;return type&gt; &lt;function name&gt; ( &lt;argument_list&gt; ) {&lt;statements&gt; }</code></p>
<p>return type 可以为 void 或其他支持的数据类型。</p>
<h4 id="函数的参数"><a class="markdownIt-Anchor" href="#函数的参数"></a> 函数的参数</h4>
<p>函数通常使用值传递，在变量名称前加上 <code>&amp;</code> 可以使用引用传递。</p>
<p>在参数名称后加上 <code>[]</code> 表明其为数组类型，数组类型会尽量为引用传递，否则为值传递。</p>
<h4 id="接口函数"><a class="markdownIt-Anchor" href="#接口函数"></a> 接口函数</h4>
<h4 id="int-printfconst-char-formatargument"><a class="markdownIt-Anchor" href="#int-printfconst-char-formatargument"></a> <code>int Printf(const char format[][,argument,...])</code></h4>
<p><img src="/image/loading.gif" data-lazy-src="https://cdn.gallery.uuanqin.top/img/20231101184106.webp" alt="image.png"></p>
<p>支持宽度、精度、对齐的调整。如 <code>%5.2lf</code> 或 <code>%-15s</code>。<code>\n</code> 表示换行。</p>
<h4 id="void-warningconst-char-format-argument"><a class="markdownIt-Anchor" href="#void-warningconst-char-format-argument"></a> <code>void Warning(const char format[] [,argument,...])</code></h4>
<p>和 <code>Printf</code> 函数相似，但结果字符串显示在状态栏中，并以橘色高亮显示。通常用于显示模板中的错误。</p>
<h4 id="io-函数"><a class="markdownIt-Anchor" href="#io-函数"></a> I/O 函数</h4>
<h4 id="void-bigendian"><a class="markdownIt-Anchor" href="#void-bigendian"></a> <code>void BigEndian()</code></h4>
<p>表明所有从文件中读写的子序列使用大端顺序。用于指定变量的字节顺序。</p>
<h4 id="void-littleendian"><a class="markdownIt-Anchor" href="#void-littleendian"></a> <code>void LittleEndian()</code></h4>
<p>小端。</p>
<h5 id="读取函数"><a class="markdownIt-Anchor" href="#读取函数"></a> 读取函数</h5>
<p>char ReadByte( int64 pos )</p>
<p>double ReadDouble( int64 pos )</p>
<p>float ReadFloat( int64 pos )</p>
<p>int ReadInt( int64 pos )</p>
<p>int64 ReadInt64( int64 pos )</p>
<p>int64 ReadQuad( int64 pos )</p>
<p>short ReadShort( int64 pos )</p>
<p>uchar ReadUByte( int64 pos )</p>
<p>uint ReadUInt( int64 pos )</p>
<p>uint64 ReadUInt64( int64 pos )</p>
<p>uint64 ReadUQuad( int64 pos )</p>
<p>ushort ReadUShort( int64 pos )</p>
<p>返回从地址 pos 读取文件的内容。用于不声明任何变量从文件中读取数据。</p>
<h4 id="int-feof"><a class="markdownIt-Anchor" href="#int-feof"></a> <code>int FEof()</code></h4>
<p>如果当前读取位置为文件末尾，则返回 true。</p>
<h4 id="int64-filesize"><a class="markdownIt-Anchor" href="#int64-filesize"></a> <code>int64 FileSize()</code></h4>
<p>返回当前文件的比特数。</p>
<h4 id="int-fseekint64-pos"><a class="markdownIt-Anchor" href="#int-fseekint64-pos"></a> <code>int FSeek(int64 pos)</code></h4>
<p>设置当前读取位置为 pos 指向的地址。如果地址超出范围返回 -1，成功则返回 0。</p>
<h4 id="int-fskipint64-offset"><a class="markdownIt-Anchor" href="#int-fskipint64-offset"></a> <code>int FSkip(int64 offset)</code></h4>
<p>将当前读取位置向前移动 offset 字节。offset 可以为负，即将读取位置向后移动。如果地址超出范围返回 -1，成功则返回 0。</p>
<h4 id="int64-ftell"><a class="markdownIt-Anchor" href="#int64-ftell"></a> <code>int64 FTell()</code></h4>
<p>返回当前文件的读取位置。</p>
<h5 id="数学函数"><a class="markdownIt-Anchor" href="#数学函数"></a> 数学函数</h5>
<p><code>double Abs(double x)</code></p>
<p><code>double Ceil(double x)</code></p>
<p><code>double Cos(double a)</code> <code>double Sin(double a)</code> <code>double Tan(double a)</code> The angle is given in degrees.</p>
<p><code>double Exp(double x)</code></p>
<p><code>double Floor(double x)</code></p>
<p><code>double Log(double x)</code> 计算 x 的自然对数，ln(x)</p>
<p><code>double Max(double a, double b)</code> <code>double Min(double a, double b)</code></p>
<p><code>double Pow(double x, double y)</code></p>
<p><code>int Random(int maximum)</code> 返回 0 到 maximum-1 的随机整数</p>
<p><code>double Sqrt(double x )</code> 计算数字 x 的正平方根</p>
<p><code>data_type SwapBytes(data_type x)</code> 交换变量的比特并返回结果，可以指定任何的数据类型 (byte, short, int, int64, float, double)</p>
<h3 id="模板限制"><a class="markdownIt-Anchor" href="#模板限制"></a> 模板限制</h3>
<ul>
<li>不允许使用指针</li>
<li>不支持 goto 语句</li>
<li>不支持多维数组（包括字符串数组）的定义。写模板时，struct 和数组的合并可以模拟多维数组。例如：<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">{</span></span><br><span class="line">    <span class="type">float</span> row[<span class="number">4</span>];</span><br><span class="line">} MATRIX[<span class="number">4</span>];</span><br><span class="line">MATRIX m;</span><br></pre></td></tr></tbody></table></figure>
</li>
</ul>
<h1 id="名词解释"><a class="markdownIt-Anchor" href="#名词解释"></a> 名词解释</h1>
<blockquote>
<p>名词解释是考试内容之一。</p>
</blockquote>
<p>JPEG：Joint Photographic Experts Group 联合图像专家组</p>
<p>MPEG：Moving picture Experts Group 运动图像专家组</p>
<p>TIFF：Tagged Image File Format 标记图像文件格式</p>
<p>AIFF：Audio Interchange File Format 音频交换文件格式</p>
<p>RIFF：Resource Interchange File Format 资源交换档案标准</p>
<p>ISO：International Organization for Standardization</p>
<p>ITU：International Telecommunication Union 国际电信联盟</p>
<p>ITU-T：International Telecommunications Union-Telecommunications</p>
<p>IEC：International Electrotechnical Commission 国际电工委员会</p>
<blockquote>
<p>有另译：International Engineering committee</p>
</blockquote>
<p>PCM：Pulse Code Modulation 脉冲编码调制</p>
<p>DPCM：Differential Pulse-code Modulation 差分脉冲编码调制</p>
<p>ADPCM：Adaptive Differential Pulse Code Modulation 自适应差分脉冲编码调制</p>
<p>AAC：Advanced Audio Coding</p>
<p>AVI：Audio Video Interleave</p>
<p>CODEC：enCOder / DECoder pair，解编码器</p>
<p>DCT：Discrete Cosine Transform</p>
<p>MDCT：modified discrete cosine transform</p>
<p><span style="color:#ff0000">IDR：立即编码刷新</span></p>
<h1 id="本课知识点"><a class="markdownIt-Anchor" href="#本课知识点"></a> 本课知识点</h1>
<p>所有知识点如下：</p>
<ol>
<li>Audio, image and video format, container</li>
<li>Video compression standards and applications</li>
<li>AVI container</li>
<li>Window Bitmap file structure</li>
<li>WAVE format</li>
<li>Explain the meaning of FOURCC tags “ 00db” , “ 01dc” , “01wb” ,“vids” , and “auds” in AVI container.</li>
<li>What is CD data rate?</li>
<li>List the components of a chunk.</li>
<li>Potential coding errors</li>
<li>Lossy compression and lossless compression</li>
<li>Uniform and quantization and nonuniform quantization</li>
<li>entropy and Huffman coding</li>
<li>MS-ADPCM</li>
<li>010 editor: Array, struct</li>
<li>Fourier transform, Fourier series, Discrete time Fourier transform, Discrete Fourier transform</li>
<li>Windowing</li>
<li>FFT and complexity</li>
<li>MDCT: overlap and add technique, long window, short window</li>
<li>Psychoacoustics: Frequency masking, temporal masking, threshold in quiet, signal to masker ratio, critical bandwidth, bark scale, perceptual entropy</li>
<li>MP3: bitstream format, MP3 sampling frequency, stereo/joint channel/dual channel/single channel, Huffman coding region, bit reservoir</li>
<li>MP3 huffman code: linebits</li>
<li>MP3 encoder and decoder process</li>
<li>Color space</li>
<li>Video frame format</li>
<li>Image and video coding principles: four types of redundancy</li>
<li>Three basic types of code frame in video coding</li>
<li>Motion estimation and compensation</li>
<li>JPEG encoding and decoding process: Minimum code Unit, modes of operation, DC entropy coding, AC entropy coding, run-length, size, EOB</li>
<li>JPEG interchange format: image, frame, scan, marker,</li>
<li>JPEG file interchange format</li>
<li>Video encoding and decoding architecture: normative, informative</li>
<li>MPEG coding structure, MPEG syntax</li>
<li>H.264 encoding structure, baseline profile, main profile, vector block size, new features, video coding layer and network abstraction layer</li>
<li>Inter frame prediction, motion vector prediction, Intra-frame prediction</li>
<li>DCT transform in H.264</li>
<li>entropy coding: Exp-Golomb coding and CAVLC</li>
</ol>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://blog.uuanqin.top">wuanqin</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://blog.uuanqin.top/p/6c1cb5ed/">https://blog.uuanqin.top/p/6c1cb5ed/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="/pages/cc.html" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://blog.uuanqin.top" target="_blank">半方池水半方田</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/pages/tags/%E5%B5%8C%E5%85%A5%E5%BC%8F/">嵌入式</a><a class="post-meta__tags" href="/pages/tags/%E7%AC%94%E8%AE%B0/">笔记</a><a class="post-meta__tags" href="/pages/tags/%E5%A4%9A%E5%AA%92%E4%BD%93/">多媒体</a><a class="post-meta__tags" href="/pages/tags/MP3/">MP3</a><a class="post-meta__tags" href="/pages/tags/AVC/">AVC</a><a class="post-meta__tags" href="/pages/tags/010%E7%BC%96%E8%BE%91%E5%99%A8/">010编辑器</a><a class="post-meta__tags" href="/pages/tags/JPEG/">JPEG</a><a class="post-meta__tags" href="/pages/tags/WAV/">WAV</a><a class="post-meta__tags" href="/pages/tags/AVI/">AVI</a><a class="post-meta__tags" href="/pages/tags/BMP/">BMP</a><a class="post-meta__tags" href="/pages/tags/DCT/">DCT</a><a class="post-meta__tags" href="/pages/tags/USTC/">USTC</a></div><div class="post-share"><div class="social-share" data-image="https://cdn.gallery.uuanqin.top/img/jshkcover.webp" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://lib.baomitu.com/social-share.js/1.0.16/css/share.min.css" media="print" onload="this.media='all'"><script src="https://lib.baomitu.com/social-share.js/1.0.16/js/social-share.min.js" defer=""></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>赞助</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/image/wx.png" target="_blank"><img class="post-qr-code-img" src="/image/wx.png" alt="微信"></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/image/zfb.png" target="_blank"><img class="post-qr-code-img" src="/image/zfb.png" alt="支付宝"></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/p/cce6330b/" title="本地文件夹的多端同步"><img class="cover" src="https://cdn.gallery.uuanqin.top/img/synccoverasf.webp" onerror="onerror=null;src='/image/404img.png'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">本地文件夹的多端同步</div></div><div class="info-2"><div class="info-item-1">实现Xmind思维导图的三端同步。</div></div></div></a><a class="pagination-related" href="/p/6f54b93a/" title="Linux 服务器 HTTPS 的配置"><img class="cover" src="https://cdn.gallery.uuanqin.top/img/SSL_certificate-1cover.webp" onerror="onerror=null;src='/image/404img.png'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">Linux 服务器 HTTPS 的配置</div></div><div class="info-2"><div class="info-item-1">SSL证书的不同部署方式以及CDN配置HTTPS。</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/p/d49e934e/" title="那一年的暑假剪影"><img class="cover" src="https://cdn.gallery.uuanqin.top/img/20231016002154.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-07</div><div class="info-item-2">那一年的暑假剪影</div></div><div class="info-2"><div class="info-item-1">暑假留校备战考研的一段时光剪影</div></div></div></a></div></div><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/image/avatar.webp" onerror="this.onerror=null;this.src='/image/loading.gif'" alt="avatar"></div><div class="author-info-name">wuanqin</div><div class="author-info-description">只能懂一点点</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">142</div></a><a href="/pages/tags/"><div class="headline">标签</div><div class="length-num">317</div></a><a href="/pages/categories/"><div class="headline">分类</div><div class="length-num">20</div></a></div><a id="card-info-btn" href="/pages/building.html"><i class="fa-solid fa-address-card"></i><span>用户认证页/调试页</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/uuanqin" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fa-brands fa-github"></i></a><a class="social-icon" href="mailto:uuanqin@uuanqin.top" target="_blank" title="Email"><i class="fa-solid fa-at"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fa-solid fa-rss"></i></a><a class="social-icon" href="https://steamcommunity.com/id/uuanqin/" rel="external nofollow noreferrer" target="_blank" title="Steam"><i class="fa-brands fa-steam"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">⚠️账单保卫行动：小破站正抵御坏人的攻击！部分省市用户近期将无法访问本站。
</div></div><div class="card-widget seamless-card"><div class="item-headline"><i></i><span></span></div><div class="item-content"><div style="height: 250px">
<iframe src="/DO_NOT_render/cosmoscope/cosmoscope_trim.html" frameborder="no" style="width: 100%; height: 100%"></iframe>
</div>
</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%94%E8%AE%B0%E8%AF%B4%E6%98%8E"><span class="toc-number">1.</span> <span class="toc-text"> 笔记说明</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AF%BC%E8%AE%BA%E6%A0%BC%E5%BC%8F%E6%A6%82%E8%A7%88"><span class="toc-number">2.</span> <span class="toc-text"> 导论（格式概览）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%8E%8B%E7%BC%A9"><span class="toc-number">2.1.</span> <span class="toc-text"> 🔺 数据压缩</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E5%AD%97%E5%AE%B9%E5%99%A8%E6%A0%BC%E5%BC%8F-digital-container-format"><span class="toc-number">2.2.</span> <span class="toc-text"> 数字容器格式 Digital Container Format</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9F%B3%E9%A2%91%E6%A0%BC%E5%BC%8F"><span class="toc-number">2.3.</span> <span class="toc-text"> 音频格式 🎵</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BE%E5%83%8F%E6%A0%BC%E5%BC%8F"><span class="toc-number">2.4.</span> <span class="toc-text"> 图像格式 🖼</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%86%E9%A2%91%E6%A0%BC%E5%BC%8F"><span class="toc-number">2.5.</span> <span class="toc-text"> 视频格式 🎞</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#bmp-wav-avi-%E6%A0%BC%E5%BC%8F"><span class="toc-number">3.</span> <span class="toc-text"> BMP、WAV、AVI 格式</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#windows-bitmap"><span class="toc-number">3.1.</span> <span class="toc-text"> Windows Bitmap🖼</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84"><span class="toc-number">3.1.1.</span> <span class="toc-text"> 文件结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%8D%E5%9B%BE%E7%A7%8D%E7%B1%BB"><span class="toc-number">3.1.2.</span> <span class="toc-text"> 位图种类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%81%B0%E5%BA%A6%E4%BD%8D%E5%9B%BE"><span class="toc-number">3.1.2.1.</span> <span class="toc-text"> 灰度位图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#24-bit-%E5%BD%A9%E8%89%B2%E4%BD%8D%E5%9B%BE"><span class="toc-number">3.1.2.2.</span> <span class="toc-text"> 24-Bit 彩色位图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-bit-%E5%BD%A9%E8%89%B2%E4%BD%8D%E5%9B%BE"><span class="toc-number">3.1.2.3.</span> <span class="toc-text"> 8-Bit 彩色位图</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#wav-%E6%A0%BC%E5%BC%8F"><span class="toc-number">3.2.</span> <span class="toc-text"> WAV 格式 🎵</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E6%88%90"><span class="toc-number">3.2.1.</span> <span class="toc-text"> 组成</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BF%85%E5%90%ABfmt-%E5%9D%97"><span class="toc-number">3.2.1.1.</span> <span class="toc-text"> 【必含】fmt 块</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#waveformatextensible-%E6%89%A9%E5%B1%95%E7%9A%84-wave-%E6%A0%BC%E5%BC%8F%E5%9D%97"><span class="toc-number">3.2.1.1.1.</span> <span class="toc-text"> WAVEFORMATEXTENSIBLE 扩展的 WAVE 格式块</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BF%85%E5%90%ABdata-%E5%9D%97"><span class="toc-number">3.2.1.2.</span> <span class="toc-text"> 【必含】data 块</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B6%E4%BB%96"><span class="toc-number">3.2.1.3.</span> <span class="toc-text"> 其他</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#avi-%E6%A0%BC%E5%BC%8F"><span class="toc-number">3.3.</span> <span class="toc-text"> AVI 格式 🎵🎞</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%9F%B3%E9%A2%91%E7%BC%96%E7%A0%81%E5%9F%BA%E7%A1%80"><span class="toc-number">4.</span> <span class="toc-text"> 音频编码基础</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#pcm%E6%9C%80%E7%AE%80%E5%8D%95%E7%9A%84%E7%BC%96%E7%A0%81%E5%99%A8"><span class="toc-number">4.1.</span> <span class="toc-text"> PCM——最简单的编码器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cdcompact-disc-%E6%BF%80%E5%85%89%E5%94%B1%E7%89%87"><span class="toc-number">4.2.</span> <span class="toc-text"> CD：Compact Disc 激光唱片</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BD%9C%E5%9C%A8%E7%9A%84%E7%BC%96%E7%A0%81%E9%94%99%E8%AF%AF"><span class="toc-number">4.3.</span> <span class="toc-text"> 潜在的编码错误</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9B%B4%E5%A4%8D%E6%9D%82%E7%9A%84%E7%BC%96%E7%A0%81%E5%99%A8"><span class="toc-number">4.4.</span> <span class="toc-text"> 更复杂的编码器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%89%E6%8D%9F%E5%8E%8B%E7%BC%A9"><span class="toc-number">4.5.</span> <span class="toc-text"> 有损压缩</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8F%E5%8C%96"><span class="toc-number">4.5.1.</span> <span class="toc-text"> 量化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9D%87%E5%8C%80%E9%87%8F%E5%8C%96-uniform-quantization"><span class="toc-number">4.5.1.1.</span> <span class="toc-text"> 均匀量化 Uniform Quantization</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%9E%E5%9D%87%E5%8C%80%E9%87%8F%E5%8C%96-nonuniform-quantization"><span class="toc-number">4.5.1.2.</span> <span class="toc-text"> 非均匀量化 Nonuniform Quantization</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A0%E6%8D%9F%E5%8E%8B%E7%BC%A9%E7%86%B5%E7%BC%96%E7%A0%81"><span class="toc-number">4.6.</span> <span class="toc-text"> 无损压缩：熵编码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%93%88%E5%A4%AB%E6%9B%BC%E7%BC%96%E7%A0%81"><span class="toc-number">4.6.1.</span> <span class="toc-text"> 哈夫曼编码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#wave-ms-adpcm"><span class="toc-number">4.7.</span> <span class="toc-text"> WAVE MS-ADPCM</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#waveformat"><span class="toc-number">4.7.1.</span> <span class="toc-text"> WAVEFORMAT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E7%A0%81%E8%BF%87%E7%A8%8B"><span class="toc-number">4.7.2.</span> <span class="toc-text"> 编码过程</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%BE%E7%89%87%E5%92%8C%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E5%9F%BA%E7%A1%80"><span class="toc-number">5.</span> <span class="toc-text"> 图片和视频编码基础</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ycbcr"><span class="toc-number">5.1.</span> <span class="toc-text"> YCbCr</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%89%B2%E5%BD%A9%E7%A9%BA%E9%97%B4"><span class="toc-number">5.1.1.</span> <span class="toc-text"> 色彩空间</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%87%E6%A0%B7%E6%A0%BC%E5%BC%8F"><span class="toc-number">5.1.2.</span> <span class="toc-text"> 采样格式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#444-%E9%87%87%E6%A0%B7"><span class="toc-number">5.1.2.1.</span> <span class="toc-text"> 4:4:4 采样</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#422-%E9%87%87%E6%A0%B7"><span class="toc-number">5.1.2.2.</span> <span class="toc-text"> 4:2:2 采样</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#420-%E9%87%87%E6%A0%B7"><span class="toc-number">5.1.2.3.</span> <span class="toc-text"> 4:2:0 采样</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%86%E9%A2%91%E5%B8%A7%E6%A0%BC%E5%BC%8F"><span class="toc-number">5.2.</span> <span class="toc-text"> 视频帧格式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B4%A8%E9%87%8F%E8%AF%84%E4%BC%B0"><span class="toc-number">5.3.</span> <span class="toc-text"> 质量评估</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E8%A7%82%E6%B5%8B%E9%87%8Fitu-r-500"><span class="toc-number">5.3.1.</span> <span class="toc-text"> 主观测量——ITU-R 500</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%A2%E8%A7%82%E8%B4%A8%E9%87%8F%E6%B5%8B%E9%87%8F"><span class="toc-number">5.3.2.</span> <span class="toc-text"> 客观质量测量</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BE%E5%83%8F%E8%A7%86%E9%A2%91%E5%A4%84%E7%90%86%E5%87%86%E5%88%99"><span class="toc-number">5.4.</span> <span class="toc-text"> 图像视频处理准则</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jpeg-%E5%9B%BE%E5%83%8F%E5%8E%8B%E7%BC%A9"><span class="toc-number">5.5.</span> <span class="toc-text"> JPEG 图像压缩</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%A7%E5%86%85%E5%B8%A7%E9%97%B4%E9%A2%84%E6%B5%8B"><span class="toc-number">5.6.</span> <span class="toc-text"> 帧内帧间预测</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%90%E5%8A%A8%E4%BC%B0%E8%AE%A1%E4%B8%8E%E8%A1%A5%E5%81%BF"><span class="toc-number">5.7.</span> <span class="toc-text"> 运动估计与补偿</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E5%9D%97%E7%9A%84%E7%9A%84%E8%BF%90%E5%8A%A8%E4%BC%B0%E8%AE%A1%E8%A1%A5%E5%81%BF"><span class="toc-number">5.7.1.</span> <span class="toc-text"> 基于块的的运动估计补偿</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%90%E5%8A%A8%E8%A1%A5%E5%81%BF%E5%9D%97%E7%9A%84%E5%A4%A7%E5%B0%8F"><span class="toc-number">5.7.2.</span> <span class="toc-text"> 运动补偿块的大小</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%90%E5%83%8F%E7%B4%A0%E8%BF%90%E5%8A%A8%E8%A1%A5%E5%81%BF"><span class="toc-number">5.7.3.</span> <span class="toc-text"> 子像素运动补偿</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BE%E5%83%8F%E6%A8%A1%E5%9E%8B"><span class="toc-number">5.8.</span> <span class="toc-text"> 图像模型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%84%E6%B5%8B%E5%9B%BE%E5%83%8F%E7%BC%96%E7%A0%81"><span class="toc-number">5.8.1.</span> <span class="toc-text"> 预测图像编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%AC%E6%8D%A2%E7%BC%96%E7%A0%81"><span class="toc-number">5.8.2.</span> <span class="toc-text"> 转换编码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2d-dct"><span class="toc-number">5.8.2.1.</span> <span class="toc-text"> 2D-DCT</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#dct-%E7%B3%BB%E6%95%B0%E7%9A%84%E7%89%B9%E5%BE%81"><span class="toc-number">5.8.2.2.</span> <span class="toc-text"> DCT 系数的特征</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#dct-%E8%AE%A1%E7%AE%97%E5%A4%8D%E6%9D%82%E6%80%A7"><span class="toc-number">5.8.2.3.</span> <span class="toc-text"> DCT 计算复杂性</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8F%E5%8C%96-2"><span class="toc-number">5.8.3.</span> <span class="toc-text"> 量化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%B8%E7%A8%8B%E7%BC%96%E7%A0%81rlc"><span class="toc-number">5.8.4.</span> <span class="toc-text"> 游程编码（RLC）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E6%96%B0%E6%8E%92%E5%BA%8F"><span class="toc-number">5.8.5.</span> <span class="toc-text"> 重新排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AF%E5%8F%98%E9%95%BF%E5%BA%A6%E7%BC%96%E7%A0%81vlc"><span class="toc-number">5.8.6.</span> <span class="toc-text"> 可变长度编码（VLC）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E7%BB%93%E6%9E%84"><span class="toc-number">5.9.</span> <span class="toc-text"> 视频编码结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%9A%E7%94%A8%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E6%A8%A1%E5%9E%8B"><span class="toc-number">5.10.</span> <span class="toc-text"> 通用视频编码模型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E7%A0%81%E6%95%B0%E6%8D%AE%E6%B5%81"><span class="toc-number">5.11.</span> <span class="toc-text"> 编码数据流</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E7%A0%81%E6%95%B0%E6%8D%AE%E6%B5%81"><span class="toc-number">5.12.</span> <span class="toc-text"> 解码数据流</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%AC%E5%B0%8F%E8%8A%82%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5"><span class="toc-number">5.13.</span> <span class="toc-text"> 本小节参考链接</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#jpeg-%E5%9B%BE%E5%83%8F%E7%BC%96%E7%A0%81"><span class="toc-number">6.</span> <span class="toc-text"> JPEG 图像编码</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E-dct-%E7%9A%84%E7%BC%96%E7%A0%81%E8%A7%A3%E7%A0%81%E8%BF%87%E7%A8%8B"><span class="toc-number">6.1.</span> <span class="toc-text"> 基于 DCT 的编码/解码过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E5%90%91-dctfdct"><span class="toc-number">6.2.</span> <span class="toc-text"> 前向 DCT（FDCT）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E5%90%91-dctidct"><span class="toc-number">6.3.</span> <span class="toc-text"> 反向 DCT（IDCT）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9D%97%E6%A0%B7%E6%9C%AC%E5%92%8C-dct-%E7%B3%BB%E6%95%B0%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-number">6.4.</span> <span class="toc-text"> 块样本和 DCT 系数的关系</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dc-%E7%BC%96%E7%A0%81"><span class="toc-number">6.5.</span> <span class="toc-text"> DC 编码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%8B%E5%AD%97%E5%BD%A2%E6%89%AB%E6%8F%8F"><span class="toc-number">6.6.</span> <span class="toc-text"> 之字形扫描</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%8B%E7%BC%A9%E4%B8%8E%E5%9B%BE%E5%83%8F%E8%B4%A8%E9%87%8F"><span class="toc-number">6.7.</span> <span class="toc-text"> 压缩与图像质量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B7%E6%9C%89%E5%A4%9A%E4%B8%AA%E7%BB%84%E4%BB%B6%E7%9A%84%E6%BA%90%E5%9B%BE%E5%83%8F"><span class="toc-number">6.8.</span> <span class="toc-text"> 具有多个组件的源图像</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E7%BB%84%E4%BB%B6%E4%BA%A4%E7%BB%87"><span class="toc-number">6.9.</span> <span class="toc-text"> 多组件交织</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8D%E5%90%8C%E7%BB%B4%E5%BA%A6%E7%9A%84%E7%BB%84%E4%BB%B6%E4%BA%A4%E7%BB%87%E9%A1%BA%E5%BA%8F"><span class="toc-number">6.10.</span> <span class="toc-text"> 不同维度的组件交织顺序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E5%B0%8F%E7%BC%96%E7%A0%81%E5%8D%95%E5%85%83-mcu"><span class="toc-number">6.11.</span> <span class="toc-text"> 最小编码单元 MCU</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E6%A8%A1%E5%BC%8F"><span class="toc-number">6.12.</span> <span class="toc-text"> 操作模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%BA%E5%BA%8F%E6%A8%A1%E5%BC%8F%E4%B8%8E%E6%B8%90%E8%BF%9B%E6%A8%A1%E5%BC%8F"><span class="toc-number">6.12.1.</span> <span class="toc-text"> 顺序模式与渐进模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B1%82%E6%AC%A1%E6%A8%A1%E5%BC%8F"><span class="toc-number">6.12.2.</span> <span class="toc-text"> 层次模式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E7%BA%BF%E9%A1%BA%E5%BA%8F%E7%86%B5%E7%BC%96%E7%A0%81"><span class="toc-number">6.13.</span> <span class="toc-text"> 基线顺序熵编码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ac-%E7%B3%BB%E6%95%B0"><span class="toc-number">6.13.1.</span> <span class="toc-text"> AC 系数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#amplitude-%E5%92%8C-size-%E7%9A%84%E8%8C%83%E5%9B%B4"><span class="toc-number">6.13.2.</span> <span class="toc-text"> AMPLITUDE 和 SIZE 的范围</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dc-%E7%B3%BB%E6%95%B0"><span class="toc-number">6.13.3.</span> <span class="toc-text"> DC 系数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AF%E5%8F%98%E9%95%BF%E5%BA%A6%E7%86%B5%E7%BC%96%E7%A0%81"><span class="toc-number">6.13.4.</span> <span class="toc-text"> 可变长度熵编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E7%BA%BF%E7%BC%96%E7%A0%81%E4%BE%8B%E5%AD%90"><span class="toc-number">6.13.5.</span> <span class="toc-text"> 基线编码例子</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BE%E5%83%8F-%E5%B8%A7%E5%92%8C%E6%89%AB%E6%8F%8F%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-number">6.14.</span> <span class="toc-text"> 图像、帧和扫描的关系</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%87%E8%AE%B0"><span class="toc-number">6.15.</span> <span class="toc-text"> 标记</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95"><span class="toc-number">6.15.1.</span> <span class="toc-text"> 高级语法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%A7%E5%A4%B4%E8%AF%AD%E4%B9%89"><span class="toc-number">6.15.1.1.</span> <span class="toc-text"> 帧头语义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%AB%E6%8F%8F%E5%A4%B4%E8%AF%AD%E4%B9%89"><span class="toc-number">6.15.1.2.</span> <span class="toc-text"> 扫描头语义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#dqt-%E6%A0%87%E8%AE%B0%E6%AE%B5%E8%AF%AD%E4%B9%89"><span class="toc-number">6.15.1.3.</span> <span class="toc-text"> DQT 标记段语义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%93%88%E5%A4%AB%E6%9B%BC%E8%A1%A8%E8%A7%84%E8%8C%83%E8%AF%AD%E6%B3%95"><span class="toc-number">6.15.1.4.</span> <span class="toc-text"> 哈夫曼表规范语法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jpeg-%E6%96%87%E4%BB%B6"><span class="toc-number">6.16.</span> <span class="toc-text"> JPEG 文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E7%A0%81%E8%BF%87%E7%A8%8B-2"><span class="toc-number">6.17.</span> <span class="toc-text"> 编码过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E7%A0%81%E8%BF%87%E7%A8%8B"><span class="toc-number">6.18.</span> <span class="toc-text"> 解码过程</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81"><span class="toc-number">7.</span> <span class="toc-text"> 视频编码</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E6%A0%87%E5%87%86%E7%9A%84%E5%88%B6%E5%AE%9A"><span class="toc-number">7.1.</span> <span class="toc-text"> 视频编码标准的制定</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#itu-t-%E5%9B%BD%E9%99%85%E7%94%B5%E4%BF%A1%E8%81%94%E7%9B%9F-%E7%94%B5%E4%BF%A1"><span class="toc-number">7.1.1.</span> <span class="toc-text"> ITU-T 国际电信联盟 - 电信</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#h261"><span class="toc-number">7.1.1.1.</span> <span class="toc-text"> H.261</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#h263"><span class="toc-number">7.1.1.2.</span> <span class="toc-text"> H.263</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#h264advanced-video-coding"><span class="toc-number">7.1.1.3.</span> <span class="toc-text"> H.264：Advanced video coding</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#iso-%E5%9B%BD%E9%99%85%E6%A0%87%E5%87%86%E5%8C%96%E7%BB%84%E7%BB%87"><span class="toc-number">7.1.2.</span> <span class="toc-text"> ISO 国际标准化组织</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#mpeg-1"><span class="toc-number">7.1.2.1.</span> <span class="toc-text"> MPEG-1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#mpeg-2"><span class="toc-number">7.1.2.2.</span> <span class="toc-text"> MPEG-2</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#mpeg-2-profiles-and-levels"><span class="toc-number">7.1.2.2.1.</span> <span class="toc-text"> MPEG-2 Profiles and Levels</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#mpeg-4"><span class="toc-number">7.1.2.3.</span> <span class="toc-text"> MPEG-4</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BD%93%E5%89%8D%E8%A7%86%E9%A2%91%E5%8E%8B%E7%BC%A9%E6%A0%87%E5%87%86"><span class="toc-number">7.1.3.</span> <span class="toc-text"> 当前视频压缩标准</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%87%E5%87%86%E5%8C%96%E7%9A%84%E8%8C%83%E5%9B%B4"><span class="toc-number">7.2.</span> <span class="toc-text"> 标准化的范围</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mpeg-%E7%BC%96%E7%A0%81%E7%BB%93%E6%9E%84"><span class="toc-number">7.3.</span> <span class="toc-text"> MPEG 编码结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#gop"><span class="toc-number">7.3.1.</span> <span class="toc-text"> GOP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#i-p-b-%E5%B8%A7%E7%BC%96%E7%A0%81%E5%B1%9E%E6%80%A7"><span class="toc-number">7.3.2.</span> <span class="toc-text"> I P B 帧编码属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%8F%E5%9D%97"><span class="toc-number">7.3.3.</span> <span class="toc-text"> 宏块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dct-%E5%9D%97"><span class="toc-number">7.3.4.</span> <span class="toc-text"> DCT 块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#slices"><span class="toc-number">7.3.5.</span> <span class="toc-text"> Slices</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mpeg-syntax"><span class="toc-number">7.3.6.</span> <span class="toc-text"> MPEG Syntax</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#h264-mpeg4-avc%E9%AB%98%E7%BA%A7%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81"><span class="toc-number">8.</span> <span class="toc-text"> 🍂H.264-MPEG4-AVC（高级视频编码）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#h264avc-%E7%9A%84%E7%9B%AE%E6%A0%87%E5%92%8C%E5%BA%94%E7%94%A8"><span class="toc-number">8.1.</span> <span class="toc-text"> H.264/AVC 的目标和应用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8E%E5%85%B6%E4%BB%96%E6%A0%87%E5%87%86%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-number">8.2.</span> <span class="toc-text"> 与其他标准的关系</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B0%E5%8A%9F%E8%83%BD%E5%92%8C%E5%85%B1%E5%90%8C%E5%85%83%E7%B4%A0"><span class="toc-number">8.3.</span> <span class="toc-text"> 新功能和共同元素</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A1%A3%E6%AC%A1"><span class="toc-number">8.4.</span> <span class="toc-text"> 档次</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E5%87%86%E6%A1%A3%E6%AC%A1"><span class="toc-number">8.4.1.</span> <span class="toc-text"> 基准档次</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E6%A1%A3%E6%AC%A1"><span class="toc-number">8.4.2.</span> <span class="toc-text"> 主档次</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E5%AE%8F%E5%9D%97%E7%BC%96%E7%A0%81%E7%BB%93%E6%9E%84"><span class="toc-number">8.5.</span> <span class="toc-text"> 基本宏块编码结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%90%E5%8A%A8%E8%A1%A5%E5%81%BF"><span class="toc-number">8.6.</span> <span class="toc-text"> 运动补偿</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#h264avc-%E7%BC%96%E7%A0%81%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F"><span class="toc-number">8.7.</span> <span class="toc-text"> H.264/AVC 编码数据格式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E5%9B%BE%E7%89%87"><span class="toc-number">8.8.</span> <span class="toc-text"> 参考图片</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#slices-2"><span class="toc-number">8.9.</span> <span class="toc-text"> Slices</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cavlc"><span class="toc-number">8.10.</span> <span class="toc-text"> CAVLC</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BF%83%E7%90%86%E5%A3%B0%E5%AD%A6%E6%A8%A1%E5%9E%8B"><span class="toc-number">9.</span> <span class="toc-text"> 心理声学模型</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A3%B0%E5%8E%8B%E7%AD%89%E7%BA%A7-sound-pressure-levels"><span class="toc-number">9.1.</span> <span class="toc-text"> 声压等级 Sound Pressure Levels</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%93%8D%E5%BA%A6-loudness"><span class="toc-number">9.2.</span> <span class="toc-text"> 响度 Loudness</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A9%E8%94%BD%E7%8E%B0%E8%B1%A1"><span class="toc-number">9.3.</span> <span class="toc-text"> 掩蔽现象</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8C%E6%97%B6%E6%8E%A9%E8%94%BD%E9%A2%91%E5%9F%9F%E6%8E%A9%E8%94%BD"><span class="toc-number">9.3.1.</span> <span class="toc-text"> 同时掩蔽（频域掩蔽）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%9E%E5%90%8C%E6%97%B6%E6%8E%A9%E8%94%BD%E6%97%B6%E5%9F%9F%E6%8E%A9%E8%94%BD"><span class="toc-number">9.3.2.</span> <span class="toc-text"> 非同时掩蔽（时域掩蔽）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AA%84%E5%B8%A6%E5%99%AA%E5%A3%B0%E6%8E%A9%E8%94%BD"><span class="toc-number">9.3.3.</span> <span class="toc-text"> 窄带噪声掩蔽</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%AF%E9%9F%B3%E6%8E%A9%E8%94%BD"><span class="toc-number">9.3.4.</span> <span class="toc-text"> 纯音掩蔽</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%B4%E7%95%8C%E5%B8%A6%E5%AE%BD"><span class="toc-number">9.3.5.</span> <span class="toc-text"> 临界带宽</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A9%E8%94%BD-masking"><span class="toc-number">9.3.6.</span> <span class="toc-text"> 掩蔽 Masking</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9F%B3%E9%A2%91%E7%BC%96%E7%A0%81%E7%9A%84%E5%BF%83%E7%90%86%E5%A3%B0%E5%AD%A6%E6%A8%A1%E5%9E%8B"><span class="toc-number">9.4.</span> <span class="toc-text"> 音频编码的心理声学模型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%B4%E5%85%8B%E5%88%BB%E5%BA%A6-bark-scale"><span class="toc-number">9.4.1.</span> <span class="toc-text"> 巴克刻度 Bark Scale</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A9%E8%94%BD%E4%BC%A0%E6%92%AD%E6%A8%A1%E5%9E%8B"><span class="toc-number">9.4.2.</span> <span class="toc-text"> 掩蔽传播模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A9%E8%94%BD%E6%9B%B2%E7%BA%BF"><span class="toc-number">9.4.3.</span> <span class="toc-text"> 掩蔽曲线</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mp3-%E7%9A%84%E5%BF%83%E7%90%86%E5%A3%B0%E5%AD%A6%E6%A8%A1%E5%9E%8B"><span class="toc-number">9.4.4.</span> <span class="toc-text"> MP3 的心理声学模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%84%9F%E7%9F%A5%E7%86%B5"><span class="toc-number">9.4.5.</span> <span class="toc-text"> 感知熵</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#block-switching-state-diagram"><span class="toc-number">9.4.6.</span> <span class="toc-text"> Block Switching State Diagram</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%AC%E7%AB%A0%E5%8F%82%E8%80%83%E7%9A%84%E5%A4%96%E9%83%A8%E8%B5%84%E6%BA%90"><span class="toc-number">9.5.</span> <span class="toc-text"> 本章参考的外部资源</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%97%B6%E9%A2%91%E6%98%A0%E5%B0%84"><span class="toc-number">10.</span> <span class="toc-text"> 🍂时频映射</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#mp3-%E7%9A%84%E7%BC%96%E7%A0%81%E4%B8%8E%E8%A7%A3%E7%A0%81"><span class="toc-number">11.</span> <span class="toc-text"> MP3 的编码与解码</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#mp3-%E7%BC%96%E7%A0%81%E5%99%A8informative-elements"><span class="toc-number">11.1.</span> <span class="toc-text"> MP3 编码器（Informative Elements）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%B6%E9%A2%91%E6%98%A0%E5%B0%84-2"><span class="toc-number">11.1.1.</span> <span class="toc-text"> 时频映射</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9D%97%E6%A8%A1%E5%BC%8F"><span class="toc-number">11.1.2.</span> <span class="toc-text"> 块模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%BB%E6%B7%B7%E5%8F%A0"><span class="toc-number">11.1.3.</span> <span class="toc-text"> 去混叠</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%9E%E5%9D%87%E5%8C%80%E9%87%8F%E5%8C%96"><span class="toc-number">11.1.4.</span> <span class="toc-text"> 非均匀量化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%93%88%E5%A4%AB%E6%9B%BC%E7%BC%96%E7%A0%81-2"><span class="toc-number">11.1.5.</span> <span class="toc-text"> 哈夫曼编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AF%94%E7%89%B9%E5%88%86%E9%85%8D%E4%B8%A4%E5%B1%82%E5%B5%8C%E5%A5%97%E5%BE%AA%E7%8E%AF"><span class="toc-number">11.1.6.</span> <span class="toc-text"> 比特分配（两层嵌套循环）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AF%94%E7%89%B9%E6%B5%81%E6%A0%BC%E5%BC%8F"><span class="toc-number">11.1.7.</span> <span class="toc-text"> 比特流格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AF%94%E7%89%B9%E6%B1%A0"><span class="toc-number">11.1.8.</span> <span class="toc-text"> 比特池</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#stereo-encoding"><span class="toc-number">11.1.9.</span> <span class="toc-text"> Stereo Encoding</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mp3-%E8%A7%A3%E7%A0%81%E5%99%A8normative-elements"><span class="toc-number">11.2.</span> <span class="toc-text"> MP3 解码器（Normative Elements）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BE%85%E5%8A%A9%E4%BF%A1%E6%81%AF%E8%A7%A3%E7%A0%81%E7%9A%84%E8%BF%87%E7%A8%8B"><span class="toc-number">11.2.1.</span> <span class="toc-text"> 辅助信息解码的过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%93%88%E5%A4%AB%E6%9B%BC%E4%BF%A1%E6%81%AF%E8%A7%A3%E7%A0%81"><span class="toc-number">11.2.2.</span> <span class="toc-text"> 哈夫曼信息解码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E9%87%8F%E5%8C%96dequantization%E6%88%96%E5%8E%BB%E7%BC%A9%E6%94%BEdescaling"><span class="toc-number">11.2.3.</span> <span class="toc-text"> 反量化（Dequantization）或去缩放（Descaling）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E6%96%B0%E6%8E%92%E5%BA%8Freordering"><span class="toc-number">11.2.4.</span> <span class="toc-text"> 重新排序（Reordering）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AB%8B%E4%BD%93%E5%A3%B0%E5%A4%84%E7%90%86"><span class="toc-number">11.2.5.</span> <span class="toc-text"> 立体声处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%BB%E6%B7%B7%E5%8F%A0-2"><span class="toc-number">11.2.6.</span> <span class="toc-text"> 去混叠</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%90%91-mdct"><span class="toc-number">11.2.7.</span> <span class="toc-text"> 反向 MDCT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#imdct-%E7%9A%84%E9%87%8D%E5%8F%A0%E7%9B%B8%E5%8A%A0"><span class="toc-number">11.2.8.</span> <span class="toc-text"> IMDCT 的重叠相加</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%88%E6%88%90%E5%A4%9A%E7%9B%B8%E6%BB%A4%E6%B3%A2%E5%99%A8%E7%BB%84"><span class="toc-number">11.2.9.</span> <span class="toc-text"> 合成多相滤波器组</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E7%A0%81%E8%AF%AD%E6%B3%95normative-elements"><span class="toc-number">11.3.</span> <span class="toc-text"> 编码语法（Normative Elements）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%8D%E6%B5%81%E6%A0%BC%E5%BC%8F"><span class="toc-number">11.3.1.</span> <span class="toc-text"> 位流格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#header"><span class="toc-number">11.3.2.</span> <span class="toc-text"> Header</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#errorcheck"><span class="toc-number">11.3.3.</span> <span class="toc-text"> ErrorCheck</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#audio-data"><span class="toc-number">11.3.4.</span> <span class="toc-text"> Audio Data</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BE%B9%E4%BF%A1%E6%81%AF"><span class="toc-number">11.3.4.1.</span> <span class="toc-text"> 边信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#main-data"><span class="toc-number">11.3.4.2.</span> <span class="toc-text"> Main Data</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#88-010-%E7%BC%96%E8%BE%91%E5%99%A8%E4%B9%8B%E6%A8%A1%E6%9D%BF%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">12.</span> <span class="toc-text"> 88、010 编辑器之模板的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF-010-%E7%BC%96%E8%BE%91%E5%99%A8"><span class="toc-number">12.1.</span> <span class="toc-text"> 什么是 010 编辑器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%A8%A1%E6%9D%BF"><span class="toc-number">12.2.</span> <span class="toc-text"> 二进制模板</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%99%E4%B8%80%E4%B8%AA%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%A8%A1%E6%9D%BF"><span class="toc-number">12.3.</span> <span class="toc-text"> 写一个二进制模板</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF%E5%9F%BA%E7%A1%80"><span class="toc-number">12.3.1.</span> <span class="toc-text"> 模板基础</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E5%AD%97"><span class="toc-number">12.3.2.</span> <span class="toc-text"> 数字</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">12.3.3.</span> <span class="toc-text"> 数据类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E5%AE%9A%E4%B9%89-typedef"><span class="toc-number">12.3.4.</span> <span class="toc-text"> 类型定义 typedef</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A3%B0%E6%98%8E%E6%A8%A1%E6%9D%BF%E5%8F%98%E9%87%8F"><span class="toc-number">12.3.5.</span> <span class="toc-text"> 声明模板变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E6%AE%8A%E5%B1%9E%E6%80%A7"><span class="toc-number">12.3.6.</span> <span class="toc-text"> 特殊属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F"><span class="toc-number">12.3.7.</span> <span class="toc-text"> 局部变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">12.3.8.</span> <span class="toc-text"> 字符串</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%9C%E8%89%B2"><span class="toc-number">12.3.9.</span> <span class="toc-text"> 颜色</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%BA%E5%BA%8F"><span class="toc-number">12.3.10.</span> <span class="toc-text"> 顺序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E6%9E%84-struct"><span class="toc-number">12.3.11.</span> <span class="toc-text"> 结构 struct</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%94%E5%90%88-union"><span class="toc-number">12.3.12.</span> <span class="toc-text"> 联合 union</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%A6%E5%8F%82%E6%95%B0%E7%9A%84-struct-%E5%92%8C-union"><span class="toc-number">12.3.13.</span> <span class="toc-text"> 带参数的 struct 和 union</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E7%BB%84-array"><span class="toc-number">12.3.14.</span> <span class="toc-text"> 数组 Array</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">12.3.15.</span> <span class="toc-text"> 表达式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%83%E5%B0%94%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">12.3.16.</span> <span class="toc-text"> 布尔运算符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E8%AF%AD%E5%8F%A5"><span class="toc-number">12.3.17.</span> <span class="toc-text"> 控制语句</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#if-%E8%AF%AD%E5%8F%A5"><span class="toc-number">12.3.17.1.</span> <span class="toc-text"> if 语句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#for-%E8%AF%AD%E5%8F%A5"><span class="toc-number">12.3.17.2.</span> <span class="toc-text"> for 语句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#while-%E8%AF%AD%E5%8F%A5"><span class="toc-number">12.3.17.3.</span> <span class="toc-text"> while 语句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#switch-%E8%AF%AD%E5%8F%A5"><span class="toc-number">12.3.17.4.</span> <span class="toc-text"> switch 语句</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AF%94%E7%89%B9%E5%9F%9F"><span class="toc-number">12.3.18.</span> <span class="toc-text"> 比特域</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AF%94%E7%89%B9%E5%9F%9F%E6%A8%A1%E5%BC%8F"><span class="toc-number">12.3.18.1.</span> <span class="toc-text"> 比特域模式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#padded-bitfields"><span class="toc-number">12.3.18.1.1.</span> <span class="toc-text"> Padded bitfields</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#unpadded-bitfields"><span class="toc-number">12.3.18.1.2.</span> <span class="toc-text"> Unpadded Bitfields</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0"><span class="toc-number">12.3.19.</span> <span class="toc-text"> 函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B0%83%E7%94%A8"><span class="toc-number">12.3.19.1.</span> <span class="toc-text"> 调用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89"><span class="toc-number">12.3.19.2.</span> <span class="toc-text"> 定义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E7%9A%84%E5%8F%82%E6%95%B0"><span class="toc-number">12.3.19.3.</span> <span class="toc-text"> 函数的参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3%E5%87%BD%E6%95%B0"><span class="toc-number">12.3.19.4.</span> <span class="toc-text"> 接口函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#int-printfconst-char-formatargument"><span class="toc-number">12.3.19.5.</span> <span class="toc-text"> int Printf(const char format[][,argument,...])</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#void-warningconst-char-format-argument"><span class="toc-number">12.3.19.6.</span> <span class="toc-text"> void Warning(const char format[] [,argument,...])</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#io-%E5%87%BD%E6%95%B0"><span class="toc-number">12.3.19.7.</span> <span class="toc-text"> I/O 函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#void-bigendian"><span class="toc-number">12.3.19.8.</span> <span class="toc-text"> void BigEndian()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#void-littleendian"><span class="toc-number">12.3.19.9.</span> <span class="toc-text"> void LittleEndian()</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E5%87%BD%E6%95%B0"><span class="toc-number">12.3.19.9.1.</span> <span class="toc-text"> 读取函数</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#int-feof"><span class="toc-number">12.3.19.10.</span> <span class="toc-text"> int FEof()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#int64-filesize"><span class="toc-number">12.3.19.11.</span> <span class="toc-text"> int64 FileSize()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#int-fseekint64-pos"><span class="toc-number">12.3.19.12.</span> <span class="toc-text"> int FSeek(int64 pos)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#int-fskipint64-offset"><span class="toc-number">12.3.19.13.</span> <span class="toc-text"> int FSkip(int64 offset)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#int64-ftell"><span class="toc-number">12.3.19.14.</span> <span class="toc-text"> int64 FTell()</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E5%AD%A6%E5%87%BD%E6%95%B0"><span class="toc-number">12.3.19.14.1.</span> <span class="toc-text"> 数学函数</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF%E9%99%90%E5%88%B6"><span class="toc-number">12.3.20.</span> <span class="toc-text"> 模板限制</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%90%8D%E8%AF%8D%E8%A7%A3%E9%87%8A"><span class="toc-number">13.</span> <span class="toc-text"> 名词解释</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9C%AC%E8%AF%BE%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="toc-number">14.</span> <span class="toc-text"> 本课知识点</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/p/7d2de43e/" title="我吃柠檬！网站被镜像自己后知后觉"><img src="https://cdn.gallery.uuanqin.top/img/202412010504201.webp" onerror="this.onerror=null;this.src='/image/404img.png'" alt="我吃柠檬！网站被镜像自己后知后觉"></a><div class="content"><a class="title" href="/p/7d2de43e/" title="我吃柠檬！网站被镜像自己后知后觉">我吃柠檬！网站被镜像自己后知后觉</a><time datetime="2024-11-30T21:11:26.459Z" title="更新于 2024-12-01 05:11:26">2024-12-01</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="footer_custom_text"><div class="footer-svg-div">
  <svg class="footer-wave-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 100" preserveAspectRatio="none">
  <path class="footer-wave-path" d="M851.8,100c125,0,288.3-45,348.2-64V0H0v44c3.7-1,7.3-1.9,11-2.9C80.7,22,151.7,10.8,223.5,6.3C276.7,2.9,330,4,383,9.8 c52.2,5.7,103.3,16.2,153.4,32.8C623.9,71.3,726.8,100,851.8,100z"></path>
  </svg>    
</div>
<div class="footer-content-div">
<div class="footer-content">
    <div class="footer-content-column">
        <div class="footer-logo">
            <a class="footer-logo-link" href="#">
                <span class="hidden-link-text">LOGO</span>
                <img src="/image/footer/qlogo_white_no_words.png" style="height:40%; width:40%">
            </a>
        </div>
        <div class="footer-menu">
            <h2 class="footer-menu-name">开始</h2>
            <ul id="menu-get-started" class="footer-menu-list">
                <li class="menu-item menu-item-type-post_type menu-item-object-product">
                    <a href="/pages/about.html">关于本站</a>
                </li>
            </ul>
        </div>
    </div>
    <div class="footer-content-column">
        <div class="footer-menu">
            <h2 class="footer-menu-name">快速链接</h2>
            <ul id="menu-company" class="footer-menu-list">
                <li class="menu-item menu-item-type-post_type menu-item-object-product">
                    <a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io/zh-cn/">Hexo</a>&nbsp;⨯&nbsp;<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a>
                </li>
                <li class="menu-item menu-item-type-taxonomy menu-item-object-category">
                    <a href="/archives/">时间轴</a>&nbsp;|&nbsp;<a href="/DO_NOT_render/cosmoscope/cosmoscope_trim.html">关系图</a>&nbsp;|&nbsp;<a href="/pages/categories/">分类</a>
                </li>
                <li class="menu-item menu-item-type-post_type menu-item-object-product">
                    <a href="/p/91b7dad/">同款页脚</a>
                </li>
                <li class="menu-item menu-item-type-post_type menu-item-object-product">
                    <a href="https://www.foreverblog.cn/" rel="noopener external nofollow noreferrer" target="_blank"> <img class="img-foreverblog" src="/image/footer/forever_logo_en_default_white.png" alt="" style="width:auto;height:21px;margin-top:6px"> </a>
                </li>
            </ul>
        </div>

    </div>

    <div class="footer-content-column">
        <div class="footer-menu">
            <h2 class="footer-menu-name">法律声明</h2>
            <ul id="menu-legal" class="footer-menu-list">
                <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-privacy-policy menu-item-170434">
                    <a href="/pages/privacy.html">隐私政策</a>
                </li>
            </ul>
        </div>
        <div class="footer-call-to-action">
            <h2 class="footer-call-to-action-title">联系本站</h2>
            <ul id="menu-legal" class="footer-menu-list">
                <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-privacy-policy menu-item-170434">
                    <a href="/DO_NOT_render/wechatOA/index.html">微信公众号</a>
                </li>

                <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-privacy-policy menu-item-170434">
                    <a class="footer-call-to-action-link" href="mailto:uuanqin@uuanqin.top" target="_self">
                        uuan<span style="display:none">@</span>qi<!-- >@ -->n@<span style="display:none">@</span>uu<!-- >@. -->an<span style="display:none">@</span>qin.top
                    </a>
                </li>

            </ul>
        </div>

    </div>
    <div class="footer-content-column">
        <ul id="menu-get-started" class="footer-menu-list">
            <li class="menu-item menu-item-type-post_type menu-item-object-product">
                <a href="/pages/ai_policy.html"><img class="img-not-ai" src="/image/footer/Written-By-Human-Not-By-AI-Badge-white.svg" alt="Written by Human, Not by AI"></a>
            </li>
            <li class="menu-item menu-item-type-post_type menu-item-object-product">
                <a href="/pages/cc.html"><img src="/image/footer/by-nc-sa.svg" alt="署名-非商业性使用-相同方式共享 4.0 国际"></a>
            </li>

            <li class="menu-item menu-item-type-post_type menu-item-object-product">
                ©2022-2024 By wuanqin
            </li>
        </ul>
    </div>

    <div class="footer-social-links"> <svg class="footer-social-amoeba-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 236 54">
        <path class="footer-social-amoeba-path" d="M223.06,43.32c-.77-7.2,1.87-28.47-20-32.53C187.78,8,180.41,18,178.32,20.7s-5.63,10.1-4.07,16.7-.13,15.23-4.06,15.91-8.75-2.9-6.89-7S167.41,36,167.15,33a18.93,18.93,0,0,0-2.64-8.53c-3.44-5.5-8-11.19-19.12-11.19a21.64,21.64,0,0,0-18.31,9.18c-2.08,2.7-5.66,9.6-4.07,16.69s.64,14.32-6.11,13.9S108.35,46.5,112,36.54s-1.89-21.24-4-23.94S96.34,0,85.23,0,57.46,8.84,56.49,24.56s6.92,20.79,7,24.59c.07,2.75-6.43,4.16-12.92,2.38s-4-10.75-3.46-12.38c1.85-6.6-2-14-4.08-16.69a21.62,21.62,0,0,0-18.3-9.18C13.62,13.28,9.06,19,5.62,24.47A18.81,18.81,0,0,0,3,33a21.85,21.85,0,0,0,1.58,9.08,16.58,16.58,0,0,1,1.06,5A6.75,6.75,0,0,1,0,54H236C235.47,54,223.83,50.52,223.06,43.32Z"></path>
    </svg>
        <a class="footer-social-link github" href="https://github.com/uuanqin" rel="external nofollow noreferrer" target="_blank">
            <span class="hidden-link-text">Github</span>
            <svg class="footer-social-icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
                <path class="footer-social-icon-path" d="M 16 4 C 9.371094 4 4 9.371094 4 16 C 4 21.300781 7.4375 25.800781 12.207031 27.386719 C 12.808594 27.496094 13.027344 27.128906 13.027344 26.808594 C 13.027344 26.523438 13.015625 25.769531 13.011719 24.769531 C 9.671875 25.492188 8.96875 23.160156 8.96875 23.160156 C 8.421875 21.773438 7.636719 21.402344 7.636719 21.402344 C 6.546875 20.660156 7.71875 20.675781 7.71875 20.675781 C 8.921875 20.761719 9.554688 21.910156 9.554688 21.910156 C 10.625 23.746094 12.363281 23.214844 13.046875 22.910156 C 13.15625 22.132813 13.46875 21.605469 13.808594 21.304688 C 11.144531 21.003906 8.34375 19.972656 8.34375 15.375 C 8.34375 14.0625 8.8125 12.992188 9.578125 12.152344 C 9.457031 11.851563 9.042969 10.628906 9.695313 8.976563 C 9.695313 8.976563 10.703125 8.65625 12.996094 10.207031 C 13.953125 9.941406 14.980469 9.808594 16 9.804688 C 17.019531 9.808594 18.046875 9.941406 19.003906 10.207031 C 21.296875 8.65625 22.300781 8.976563 22.300781 8.976563 C 22.957031 10.628906 22.546875 11.851563 22.421875 12.152344 C 23.191406 12.992188 23.652344 14.0625 23.652344 15.375 C 23.652344 19.984375 20.847656 20.996094 18.175781 21.296875 C 18.605469 21.664063 18.988281 22.398438 18.988281 23.515625 C 18.988281 25.121094 18.976563 26.414063 18.976563 26.808594 C 18.976563 27.128906 19.191406 27.503906 19.800781 27.386719 C 24.566406 25.796875 28 21.300781 28 16 C 28 9.371094 22.628906 4 16 4 Z "></path>
            </svg>
        </a>
        <a class="footer-social-link email" href="mailto:uuanqin@uuanqin.top" target="_blank">
            <span class="hidden-link-text">Email</span>
            <svg class="footer-social-icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                <!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. -->
                <path class="footer-social-icon-path" d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4 0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4c0-26.5-21.5-48-48-48H48zM0 176V384c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V176L294.4 339.2c-22.8 17.1-54 17.1-76.8 0L0 176z"></path>
            </svg>
        </a>
        <a class="footer-social-link fish" href="/404.html" target="_blank">
            <span class="hidden-link-text">爱发电</span>
            <svg class="footer-social-icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
                <!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. -->
                <path class="footer-social-icon-path" d="M180.5 141.5C219.7 108.5 272.6 80 336 80s116.3 28.5 155.5 61.5c39.1 33 66.9 72.4 81 99.8c4.7 9.2 4.7 20.1 0 29.3c-14.1 27.4-41.9 66.8-81 99.8C452.3 403.5 399.4 432 336 432s-116.3-28.5-155.5-61.5c-16.2-13.7-30.5-28.5-42.7-43.1L48.1 379.6c-12.5 7.3-28.4 5.3-38.7-4.9S-3 348.7 4.2 336.1L50 256 4.2 175.9c-7.2-12.6-5-28.4 5.3-38.6s26.1-12.2 38.7-4.9l89.7 52.3c12.2-14.6 26.5-29.4 42.7-43.1zM448 256a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"></path>
            </svg>
        </a>
        <a class="footer-social-link rss" href="/atom.xml" target="_blank">
            <span class="hidden-link-text">RSS</span>
            <svg class="footer-social-icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                <!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. -->
                <path class="footer-social-icon-path" d="M0 64C0 46.3 14.3 32 32 32c229.8 0 416 186.2 416 416c0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96C14.3 96 0 81.7 0 64zM0 416a64 64 0 1 1 128 0A64 64 0 1 1 0 416zM32 160c159.1 0 288 128.9 288 288c0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224c-17.7 0-32-14.3-32-32s14.3-32 32-32z"></path>
            </svg>
        </a>

    </div>
</div>
</div>
<div class="footer-copyright">
    <div class="footer-copyright-wrapper">
        <p class="footer-copyright-text">
            <a target="_blank" href="https://beian.miit.gov.cn/" rel="noopener external nofollow noreferrer noopener"><img class="icp-icon" src="/image/footer/icp.ico"><span>津ICP备2022002156号-1</span></a>
            &nbsp;|&nbsp;<a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=12011202000621" rel="noopener external nofollow noreferrer noopener"><img class="icp-icon" src="/image/footer/beian_logo.png"><span>津公网安备 12011202000621号</span></a>
            &nbsp;|&nbsp;&nbsp;
            <span>互联网不良信息举报:&nbsp;
              uuan<span style="display:none">@</span>qi<!-- >@ -->n@<span style="display:none">@</span>uu<!-- >@. -->an<span style="display:none">@</span>qin.top
            </span>
        </p>
    </div>
</div>
</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/fancyapps-ui/5.0.17/fancybox/fancybox.umd.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/instant.page/5.1.0/instantpage.min.js" type="module"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/vanilla-lazyload/17.3.1/lazyload.iife.min.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/node-snackbar/0.1.16/snackbar.js"></script><div class="js-pjax"><script>(async () => {
  const showKatex = () => {
    document.querySelectorAll('#article-container .katex').forEach(el => el.classList.add('katex-show'))
  }

  if (!window.katex_js_css) {
    window.katex_js_css = true
    await btf.getCSS('https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/KaTeX/0.16.9/katex.min.js')
    if (true) {
      await btf.getScript('https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/KaTeX/0.16.9/contrib/copy-tex.min.js')
    }
  }

  showKatex()
})()</script><script>(() => {
  let initFn = window.walineFn || null

  const initWaline = (Fn) => {
    const waline = Fn(Object.assign({
      el: '#waline-wrap',
      serverURL: 'https://pl.uuanqin.top',
      pageview: true,
      dark: 'html[data-theme="dark"]',
      path: window.location.pathname,
      comment: true,
    }, {"locale":{"nick":"昵称","mail":"邮箱","link":"网站","placeholder":"都看到这了，不妨将你的真知灼见狠狠的塞满我......","requiredMeta":[],"sofa":"评论区空空如也~喵呜呜呜","anonymous":"匿名访客","login":"登录(可选)"},"search":false,"emoji":["https://github.elemecdn.com/@waline/emojis@1.2.0/tieba/","https://github.elemecdn.com/@waline/emojis@1.2.0/bilibili/","https://github.elemecdn.com/@waline/emojis@1.2.0/qq/","https://github.elemecdn.com/@waline/emojis@1.2.0/weibo/"],"reaction":["/image/comment/reaction1.gif","/image/comment/reaction2.gif","/image/comment/reaction3.gif","/image/comment/reaction4.gif","/image/comment/reaction5.gif","/image/comment/reaction6.gif"]}))

    const destroyWaline = () => {
      waline.destroy()
    }

    btf.addGlobalFn('pjaxSendOnce', destroyWaline, 'destroyWaline')
  }

  const loadWaline = () => {
    if (initFn) initWaline(initFn)
    else {
      btf.getCSS('/css/mywaline.css')
        .then(() => import('https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/waline/3.3.0/waline.js'))
        .then(({ init }) => {
          initFn = init || Waline.init
          initWaline(initFn)
          window.walineFn = initFn
        })
    }
  }

  if ('Waline' === 'Waline' || !false) {
    if (false) btf.loadComment(document.getElementById('waline-wrap'),loadWaline)
    else setTimeout(loadWaline, 0)
  } else {
    window.loadOtherComment = loadWaline
  }
})()</script></div><script src="/js/chuckle-post-ai.min.js"></script><script data-pjax="" defer="">
  new ChucklePostAI({
    el: '#post>#article-container',
    key: 'Zm8snUerkRZvD7Ek4Jil',
    rec_method: 'all',
    interface: {
        name: "AI量子速读",
        introduce: "我是你的文章AI助手，点击下方的按钮，让我为你生成本文简介或推荐相关文章。",
        button: ["介绍自己", "相关文章推荐", "生成文章简介", "矩阵穿梭"],
    },
    title_el: '.post-title',
    whitelist: ['/p/'],
    summary_directly: false,
    total_length: 250,
    ratio_string: "5:3:2",
    summary_toggle: false,
  })
</script>
<script src="/js/gray_page.js"></script><script src="/js/bi-links.js"></script><script src="/js/links-art-card.js"></script><script src="/js/genuine_website_verification2.js"></script><script async="" data-pjax="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/algoliasearch/4.12.1/algoliasearch-lite.umd.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/instantsearch.js/4.39.0/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script></div></div><!-- hexo injector body_end start --> <script data-pjax="">if(document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    var parent = document.getElementById('recent-posts');
    var child = '<div class="recent-post-item" style="width:100%;height: auto"><div id="catalog_magnet"><div class="magnet_item"><a class="magnet_link" href="/pages/categories/博客相关/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🎨 博客相关 (34)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="/pages/categories/核心协同/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🔷 核心协同板块 (18)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="/pages/categories/百味人生/有感而发/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🏄‍♂️ 热爱生活 (11)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="/pages/categories/嵌入式/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🧩 嵌入式开发 (16)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="/pages/categories/Java/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🧑‍💻 桩桩猫学 Java (9)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="/pages/categories/数学与算法/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🪢 数学与算法 (11)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><a class="magnet_link_more"  href="/pages/categories/" style="flex:1;text-align: center;margin-bottom: 10px;">查看更多...</a></div></div>';
    console.log('已挂载magnet')
    parent.insertAdjacentHTML("afterbegin",child)}
     </script><style>#catalog_magnet{flex-wrap: wrap;display: flex;width:100%;justify-content:space-between;padding: 10px 10px 0 10px;align-content: flex-start;}.magnet_item{flex-basis: calc(33.333333333333336% - 5px);background: #f2f2f2;margin-bottom: 10px;border-radius: 8px;transition: all 0.2s ease-in-out;}.magnet_item:hover{background: #669900}.magnet_link_more{color:#555}.magnet_link{color:black}.magnet_link:hover{color:white}@media screen and (max-width: 600px) {.magnet_item {flex-basis: 100%;}}.magnet_link_context{display:flex;padding: 10px;font-size:16px;transition: all 0.2s ease-in-out;}.magnet_link_context:hover{padding: 10px 20px;}</style>
    <style></style> <script data-pjax="">if(document.getElementById('recent-posts') && location.pathname =='/'){
    
    var parent = document.getElementById('recent-posts');
    var child = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms"><div class="blog-slider__img"><img src="https://cdn.gallery.uuanqin.top/img/hexoobsidian-Grammar.webp" alt="https://cdn.gallery.uuanqin.top/img/hexoobsidian-Grammar.webp"/></div><div class="blog-slider__content"><span class="blog-slider__code">2023-08-01</span><a class="blog-slider__title" href="p/d4bc55f2/">Hexo 博客适配 Obsidian 新语法</a><div class="blog-slider__text">你可能在寻找这篇文章</div><a class="blog-slider__button" href="p/d4bc55f2/">详情</a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms"><div class="blog-slider__img"><img src="https://cdn.gallery.uuanqin.top/img/202408042352584.webp" alt="https://cdn.gallery.uuanqin.top/img/202408042352584.webp"/></div><div class="blog-slider__content"><span class="blog-slider__code">2024-08-04</span><a class="blog-slider__title" href="p/e1ee5eca/">Hexo 博客与 Waline 评论区实现外链跳转中间页</a><div class="blog-slider__text">文章推荐</div><a class="blog-slider__button" href="p/e1ee5eca/">详情</a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms"><div class="blog-slider__img"><img src="https://cdn.gallery.uuanqin.top/img/202411272314587.webp" alt="https://cdn.gallery.uuanqin.top/img/202411272314587.webp"/></div><div class="blog-slider__content"><span class="blog-slider__code">2024-11-27</span><a class="blog-slider__title" href="p/8aa53d93/">自定义 Hexo 中的超链接样式</a><div class="blog-slider__text">最近更新完善</div><a class="blog-slider__button" href="p/8aa53d93/">详情</a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
    console.log('已挂载swiper')
    parent.insertAdjacentHTML("afterbegin",child)}
     </script>
<!--<script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-swiper/swiper/swiper.min.js"></script>-->
<!--<script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-swiper@0.18/swiper/swiperindex.js"></script>-->
<!--<script data-pjax src="https://cdn.gallery.uuanqin.top/js/swiperindex.js"></script>-->
<script data-pjax="" src="https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/Swiper/4.1.6/js/swiper.min.js"></script>
<script data-pjax="" src="/js/swiperindex.js"></script>
<style></style><!-- hexo injector body_end end --></body></html>