{"data":{"title":"çº¿æ®µæ ‘æ¨¡æ¿çš„ç†è§£å’Œä½¿ç”¨","slug":"ç®—æ³•ä¸æ•°æ®ç»“æ„/çº¿æ®µæ ‘æ¨¡æ¿çš„ç†è§£å’Œä½¿ç”¨","description":"æƒ³å¥½äº†å†ç”¨ï¼Œä¸ç„¶æµªè´¹æ—¶é—´ã€‚","date":"2025-01-01T19:08:58.000Z","updated":"2025-08-27T14:50:54.772Z","language":"zh-CN","comments":true,"url":"p/10ab676/","cover":"https://cdn.gallery.uuanqin.top/img/202508270057686.webp","images":[],"content":"<h1 id=\"çº¿æ®µæ ‘ç®€è¿°\"><a class=\"markdownIt-Anchor\" href=\"#çº¿æ®µæ ‘ç®€è¿°\"></a> çº¿æ®µæ ‘ç®€è¿°</h1>\n<p>çº¿æ®µæ ‘æ˜¯ç”¨æ¥ç»´æŠ¤ åŒºé—´ä¿¡æ¯ çš„æ•°æ®ç»“æ„ã€‚<strong>çº¿æ®µæ ‘çš„æ¯ä¸ªèŠ‚ç‚¹ä»£è¡¨ä¸€ä¸ªåŒºé—´</strong>ã€‚</p>\n<p>çº¿æ®µæ ‘å¯ä»¥åœ¨ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>log</mi><mo>â¡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(\\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span> çš„æ—¶é—´å¤æ‚åº¦å†…å®ç°å•ç‚¹ä¿®æ”¹ã€åŒºé—´ä¿®æ”¹ã€åŒºé—´æŸ¥è¯¢ï¼ˆåŒºé—´æ±‚å’Œï¼Œæ±‚åŒºé—´æœ€å¤§å€¼ï¼Œæ±‚åŒºé—´æœ€å°å€¼ï¼‰ç­‰æ“ä½œã€‚</p>\n<h1 id=\"çº¿æ®µæ ‘çš„æ¨¡æ¿\"><a class=\"markdownIt-Anchor\" href=\"#çº¿æ®µæ ‘çš„æ¨¡æ¿\"></a> çº¿æ®µæ ‘çš„æ¨¡æ¿</h1>\n\n<div class=\"callout\" data-callout=\"example\">\n<div class=\"callout-title\">\n<div class=\"callout-title-icon\">\n<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"lucide lucide-list\"><line x1=\"8\" x2=\"21\" y1=\"6\" y2=\"6\"/><line x1=\"8\" x2=\"21\" y1=\"12\" y2=\"12\"/><line x1=\"8\" x2=\"21\" y1=\"18\" y2=\"18\"/><line x1=\"3\" x2=\"3.01\" y1=\"6\" y2=\"6\"/><line x1=\"3\" x2=\"3.01\" y1=\"12\" y2=\"12\"/><line x1=\"3\" x2=\"3.01\" y1=\"18\" y2=\"18\"/></svg>\n</div>\n<div class=\"callout-title-inner\">æ¨¡æ¿é¢˜ï¼šæ±‚ç»™å®šåŒºé—´çš„åŒºé—´å’Œï¼ˆå¤šæ¬¡è¯¢é—®ï¼‰</div>\n</div>\n<div class=\"callout-content\"><p></p>\n</div></div><p>çº¿æ®µæ ‘ä¸­ï¼ŒåŒºé—´çš„èŒƒå›´ç»™å®šä¹‹åï¼Œæ ‘çš„ç»“ç‚¹å°±å›ºå®šäº†ã€‚</p>\n<h2 id=\"ä½¿ç”¨é“¾è¡¨è¡¨ç¤ºçº¿æ®µæ ‘\"><a class=\"markdownIt-Anchor\" href=\"#ä½¿ç”¨é“¾è¡¨è¡¨ç¤ºçº¿æ®µæ ‘\"></a> ä½¿ç”¨é“¾è¡¨è¡¨ç¤ºçº¿æ®µæ ‘</h2>\n<p>é¢„å…ˆå®šä¹‰ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Node</span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> val,add;</span><br><span class=\"line\">\tNode left,right;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"type\">Node</span> <span class=\"variable\">root</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Node</span>(); <span class=\"comment\">// é¢„å…ˆå®šä¹‰å¥½æ ‘æ ¹</span></span><br><span class=\"line\"><span class=\"type\">int</span> <span class=\"variable\">N</span> <span class=\"operator\">=</span> <span class=\"number\">1000000000</span>;     <span class=\"comment\">// é¢˜ç›®ä¸­å¯èƒ½å‡ºç°çš„èŒƒå›´</span></span><br></pre></td></tr></table></figure>\n<p>çº¿æ®µæ ‘çš„æ„å»ºæ¨¡æ¿å†™æ³•ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">buildTree</span><span class=\"params\">(Node node, <span class=\"type\">int</span> start, <span class=\"type\">int</span> end)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// åˆ°è¾¾å¶å­èŠ‚ç‚¹</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (start == end) &#123;</span><br><span class=\"line\">        node.val = arr[start];</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(node.left==<span class=\"literal\">null</span>)node.left=<span class=\"keyword\">new</span> <span class=\"title class_\">Node</span>();</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(node.right==<span class=\"literal\">null</span>)node.right=<span class=\"keyword\">new</span> <span class=\"title class_\">Node</span>();</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">mid</span> <span class=\"operator\">=</span> (start + end) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    buildTree(node.left, start, mid);</span><br><span class=\"line\">    buildTree(node.right, mid + <span class=\"number\">1</span>, end);</span><br><span class=\"line\">    <span class=\"comment\">// å‘ä¸Šæ›´æ–°</span></span><br><span class=\"line\">    pushUp(node);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// å‘ä¸Šæ›´æ–°</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">pushUp</span><span class=\"params\">(Node node)</span> &#123;</span><br><span class=\"line\">    node.val = node.left.val + node.right.val;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>çº¿æ®µæ ‘åŠ¨æ€å¼€ç‚¹æ¨¡æ¿å†™æ³•ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// åŠ¨æ€å¼€ç‚¹</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">SegmentTreeDynamic</span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">// ç»“ç‚¹è¡¨ç¤º</span></span><br><span class=\"line\">    <span class=\"keyword\">class</span> <span class=\"title class_\">Node</span> &#123;</span><br><span class=\"line\">        Node left, right; <span class=\"comment\">// å·¦å³æŒ‡é’ˆ</span></span><br><span class=\"line\">        <span class=\"type\">int</span> val; <span class=\"comment\">// ç»“ç‚¹çš„å€¼ï¼Œæ„æ€ä¸ºæ­¤èŠ‚ç‚¹é”è¡¨ç¤ºåŒºé—´çš„åŒºé—´å’Œ</span></span><br><span class=\"line\">        <span class=\"type\">int</span> add; <span class=\"comment\">// æ‡’æƒ°æ ‡è®°ï¼Œæ„æ€æ˜¯æ­¤èŠ‚ç‚¹çš„å­ç»“ç‚¹çš„æ¯ä¸ªå…ƒç´ çš„å€¼éƒ½è¦åŠ ä¸Š add</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> <span class=\"variable\">N</span> <span class=\"operator\">=</span> (<span class=\"type\">int</span>) <span class=\"number\">1e9</span>; <span class=\"comment\">// åŒºé—´èŒƒå›´ï¼Œä¸€èˆ¬ç”±é¢˜ç›®ç»™å‡º</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">Node</span> <span class=\"variable\">root</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Node</span>(); <span class=\"comment\">// æ ¹ç»“ç‚¹</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// åŒºé—´æ›´æ–°</span></span><br><span class=\"line\">\t<span class=\"comment\">// å°†[start,end]å½“å‰ç»“ç‚¹çš„æ‰€æœ‰å…ƒç´ åŠ ä¸Š val</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">update</span><span class=\"params\">(Node node, <span class=\"type\">int</span> start, <span class=\"type\">int</span> end, <span class=\"type\">int</span> l, <span class=\"type\">int</span> r, <span class=\"type\">int</span> val)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// å½“å‰ç»“ç‚¹å·²ç»æ»¡è¶³æ›´æ–°èŒƒå›´</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (l &lt;= start &amp;&amp; end &lt;= r) &#123;</span><br><span class=\"line\">            node.val += (end - start + <span class=\"number\">1</span>) * val;</span><br><span class=\"line\">            node.add += val;</span><br><span class=\"line\">            <span class=\"comment\">// å­èŠ‚ç‚¹å°±ä¸å†é€’å½’ï¼Œå®ç°äº†ã€Œæ‡’æƒ°ã€</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> ;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">mid</span> <span class=\"operator\">=</span> (start + end) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">        pushDown(node, mid - start + <span class=\"number\">1</span>, end - mid); <span class=\"comment\">// æ¸…ç©ºå½“å‰ç»“ç‚¹æ‡’æƒ°æ ‡è®°</span></span><br><span class=\"line\">        <span class=\"comment\">// è¡¨æ˜æŸ¥è¯¢åŒºé—´å’Œå·¦å­åŒºé—´æœ‰äº¤é›†</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (l &lt;= mid) update(node.left, start, mid, l, r, val);</span><br><span class=\"line\">        <span class=\"comment\">// è¡¨æ˜æŸ¥è¯¢åŒºé—´å’Œå³å­åŒºé—´æœ‰äº¤é›†</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (mid + <span class=\"number\">1</span> &lt;= r) update(node.right, mid + <span class=\"number\">1</span>, end, l, r, val);</span><br><span class=\"line\">        pushUp(node); <span class=\"comment\">// æ›´æ–°å½“å‰ç»“ç‚¹çš„åŒºé—´å€¼</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">query</span><span class=\"params\">(Node node, <span class=\"type\">int</span> start, <span class=\"type\">int</span> end, <span class=\"type\">int</span> l, <span class=\"type\">int</span> r)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (l &lt;= start &amp;&amp; end &lt;= r) <span class=\"keyword\">return</span> node.val;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">mid</span> <span class=\"operator\">=</span> (start + end) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">ans</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        pushDown(node, mid - start + <span class=\"number\">1</span>, end - mid);</span><br><span class=\"line\">        <span class=\"comment\">// è¡¨æ˜æŸ¥è¯¢åŒºé—´å’Œå·¦å­åŒºé—´æœ‰äº¤é›†</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (l &lt;= mid) ans += query(node.left, start, mid, l, r); </span><br><span class=\"line\">        <span class=\"comment\">// è¡¨æ˜æŸ¥è¯¢åŒºé—´å’Œå³å­åŒºé—´æœ‰äº¤é›†</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (mid + <span class=\"number\">1</span> &lt;= r) ans += query(node.right, mid + <span class=\"number\">1</span>, end, l, r);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">pushUp</span><span class=\"params\">(Node node)</span> &#123;</span><br><span class=\"line\">        node.val = node.left.val + node.right.val;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// ç»“ç‚¹ä¸‹æ¨</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">pushDown</span><span class=\"params\">(Node node, <span class=\"type\">int</span> leftNum, <span class=\"type\">int</span> rightNum)</span> &#123;</span><br><span class=\"line\">\t    <span class=\"comment\">// å­èŠ‚ç‚¹å»ºç«‹æ£€æŸ¥</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (node.left == <span class=\"literal\">null</span>) node.left = <span class=\"keyword\">new</span> <span class=\"title class_\">Node</span>();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (node.right == <span class=\"literal\">null</span>) node.right = <span class=\"keyword\">new</span> <span class=\"title class_\">Node</span>();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (node.add == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> ; <span class=\"comment\">// æ²¡æœ‰æ‡’æƒ°æ ‡è®°ï¼Œæ— éœ€å¤„ç†</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\">// å¤„ç†æ‡’æƒ°æ ‡è®°</span></span><br><span class=\"line\">        node.left.val += node.add * leftNum;</span><br><span class=\"line\">        node.right.val += node.add * rightNum;</span><br><span class=\"line\">        node.left.add += node.add;  <span class=\"comment\">// ç´¯ç§¯æ‡’æƒ°æ ‡è®°</span></span><br><span class=\"line\">        node.right.add += node.add;</span><br><span class=\"line\">        node.add = <span class=\"number\">0</span>;               <span class=\"comment\">// æ¸…ç©ºæ‡’æƒ°æ ‡è®°ï¼Œè¡¨ç¤ºå¤„ç†å®Œæ¯•</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ä»ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºï¼Œä¸ç®¡æ˜¯ <code>update</code>ï¼Œè¿˜æ˜¯ <code>query</code>ï¼Œåœ¨è¿›è¡Œä¸‹å±‚é€’å½’æ—¶éƒ½æ˜¯ä½¿ç”¨ <code>[start, mid]</code> å’Œ <code>[mid + 1, end]</code>ã€‚å®ƒè¡¨ç¤ºæ•°çš„å½“å‰ç»“ç‚¹è¡¨ç¤ºçš„åŒºé—´èŒƒå›´ã€‚</p>\n<p>é€’å½’æ—¶ï¼Œä¸ç®¡æ˜¯ <code>update</code>ï¼Œè¿˜æ˜¯ <code>query</code>ï¼Œ<code>[l,r]</code> è¡¨ç¤ºæŸ¥è¯¢åŒºé—´ï¼Œå‚æ•°ä¼ é€’æ—¶æ˜¯ä¸å˜çš„ã€‚ä¸è¦è‡ªè¡Œåˆ†å‰²åŒºé—´ï¼Œå¦‚ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// é”™è¯¯å†™æ³•</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> (l &lt;= mid) update(node.left, start, mid, l, mid, val);</span><br><span class=\"line\"><span class=\"keyword\">if</span> (mid + <span class=\"number\">1</span> &lt;= r) update(node.right, mid + <span class=\"number\">1</span>, end, mid+<span class=\"number\">1</span>, r, val);</span><br><span class=\"line\"><span class=\"comment\">// æ›´æ­£å†™æ³•ï¼ˆæŒ‰ç…§è‡ªè¡Œåˆ†å‰²çš„æ€è·¯ï¼‰</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> (l &lt;= mid) update(node.left,start,mid,l,r&gt;=mid?mid:r,val);</span><br><span class=\"line\"><span class=\"keyword\">if</span> (mid + <span class=\"number\">1</span> &lt;= r) update(node.right,mid+<span class=\"number\">1</span>,end,l&lt;=mid+<span class=\"number\">1</span>?mid+<span class=\"number\">1</span>:l,r,val);</span><br></pre></td></tr></table></figure>\n<p>ä¸Šé¢çš„åšæ³•æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºä½ å¯èƒ½ä¼šæŠŠæŸ¥è¯¢çš„åŒºé—´æ‰©å¤§äº†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸Šé¢çš„ä»£ç æ²¡æœ‰è€ƒè™‘åˆ° <code>r&lt;mid</code> æˆ– <code>l&gt;mid+1</code> çš„æƒ…å†µã€‚</p>\n<p>é€’å½’æ—¶çš„ç»ˆæ­¢æ¡ä»¶ä¸­ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰æ£€æŸ¥ <code>start &lt;= end</code>ï¼Œå³ä¸è€ƒè™‘ <code>start &gt; end</code> çš„æƒ…å†µï¼Œé‚£ä¹ˆ <code>update</code>ï¼Œè¿˜æ˜¯ <code>query</code> åœ¨é€’å½’è¿‡ç¨‹ä¸­ä¼ å…¥çš„å‚æ•°ä¼šå‡ºç° <code>start &gt; end</code> å—ï¼Ÿç­”æ¡ˆæ˜¯ä¸ä¼šçš„ã€‚æ¨å¯¼ <sup class=\"footnote-ref\"><a href=\"#fn1\" id=\"fnref1\">[1]</a></sup> å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>å› ä¸ºæœ¬å±‚ä¼ å…¥ <code>start &gt; end</code> åªæœ‰åœ¨ä¸Šä¸€å±‚æœ‰ <code>start==end</code> å¹¶è®¡ç®— <code>mid=(start+end)/2;</code> æ—¶ï¼Œå¯¹å³å­åŒºé—´é€’å½’æ—¶æ‰å¯èƒ½å‡ºç°ã€‚</li>\n<li>ç„¶è€Œå¦‚æœä¸Šä¸€å±‚ä¼ å…¥çš„å‚æ•° <code>start==end</code>ï¼Œé‚£ä¹ˆå¿…æœ‰ <code>l &lt;= start &amp;&amp; end &lt;= r</code>ï¼Œå®ƒåªä¼šåœ¨ç¬¬ä¸€ä¸ªæ¡ä»¶åˆ¤æ–­è¯­å¥ï¼ˆè¾¹ç•Œæ¡ä»¶ï¼‰ä¸­è·³å‡ºé€’å½’ï¼Œä¸ä¼šè¿›è¡Œåç»­çš„ <code>mid</code> è®¡ç®—ï¼Œæ›´æ— ä¸‹ä¸€å±‚çš„é€’å½’ã€‚</li>\n<li>å› æ­¤ä¸ä¼šå‡ºç°ä¼ è¿‡æ¥çš„å‚æ•° <code>start &gt; end</code>ã€‚</li>\n</ul>\n<p>å¯¹äºç»ˆæ­¢æ¡ä»¶çš„é£æ ¼ï¼Œè¿˜æœ‰ä»¥ä¸‹è¿™ç§ï¼Œä¸¤è€…æ˜¯ç­‰ä»·çš„ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">update</span><span class=\"params\">(Node node, <span class=\"type\">int</span> start,<span class=\"type\">int</span> end,<span class=\"type\">int</span> l,<span class=\"type\">int</span> r,<span class=\"type\">int</span> val)</span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(r&lt;start || l&gt; end)<span class=\"keyword\">return</span>; <span class=\"comment\">// æŸ¥è¯¢åŒºé—´ä¸å½“å‰åŒºé—´æ— äº¤é›†</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(l&lt;= start &amp;&amp; end &lt;= r)&#123;</span><br><span class=\"line\">\t\tnode.val += val * ( end-start+<span class=\"number\">1</span>);</span><br><span class=\"line\">\t\tnode.add += val;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> ;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"type\">int</span> <span class=\"variable\">mid</span> <span class=\"operator\">=</span> (start+end)/<span class=\"number\">2</span>;</span><br><span class=\"line\">\tpushDown(node,mid-start+<span class=\"number\">1</span>,end-mid);</span><br><span class=\"line\">\tupdate(node.left,start,mid,l,r,val);   <span class=\"comment\">// ç§»é™¤äº†å‰é¢çš„åˆ¤æ–­æ¡ä»¶</span></span><br><span class=\"line\">\tupdate(node.right,mid+<span class=\"number\">1</span>,end,l,r,val);  <span class=\"comment\">// ç§»é™¤äº†å‰é¢çš„åˆ¤æ–­æ¡ä»¶</span></span><br><span class=\"line\">\tpushUp(node);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>åœ¨ä¸åŒçš„é¢˜ç›®ä¸­ï¼Œ<code>val</code> å’Œ <code>add</code> å¯ä»¥æ‰®æ¼”ä¸åŒçš„è§’è‰²ï¼Œæ¯”å¦‚åŒºé—´å’Œæˆ–è€…åŒºé—´æœ€å€¼ã€‚è¿™æ—¶å€™å°±éœ€è¦æ ¹æ®é¢˜ç›®è¦æ±‚ä¿®æ”¹ <code>val</code> å’Œ <code>add</code> çš„è®¡ç®—ä»£ç ã€‚</p>\n<h2 id=\"ä½¿ç”¨æ•°ç»„è¡¨ç¤ºçº¿æ®µæ ‘\"><a class=\"markdownIt-Anchor\" href=\"#ä½¿ç”¨æ•°ç»„è¡¨ç¤ºçº¿æ®µæ ‘\"></a> ä½¿ç”¨æ•°ç»„è¡¨ç¤ºçº¿æ®µæ ‘</h2>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/202501070206417.webp\" alt=\"image.png\" width=\"350px\" /></p>\n\n<div class=\"callout\" data-callout=\"node\">\n<div class=\"callout-title\">\n<div class=\"callout-title-icon\">\n<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"lucide lucide-pencil\"><path d=\"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z\"/><path d=\"m15 5 4 4\"/></svg>\n</div>\n<div class=\"callout-title-inner\">å †å¼å­˜å‚¨</div>\n</div>\n<div class=\"callout-content\"><p>æˆ‘ä»¬çŸ¥é“ï¼Œï¼ˆäºŒå‰ï¼‰å †çš„é€»è¾‘ç»“æ„æ˜¯æ ‘å½¢çš„ï¼Œä½†å…¶å­˜å‚¨ç»“æ„æ˜¯æ•°ç»„ã€‚æ ‘æ ¹ç¼–å·ä¸º 1ã€‚å‡è®¾æŸç»“ç‚¹çš„ç¼–å·ä¸º <code>p</code>ï¼Œåˆ™å…¶å·¦å­©å­çš„ç¼–å·ä¸º <code>2p</code>ï¼Œå³å­©å­ç¼–å·ä¸º <code>2p+1</code>ã€‚</p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/202501070213296.webp\" alt=\"image.png\" width=\"250px\" /></p>\n<p>ä»£ç å†™æ³•ï¼šçˆ¶ç»“ç‚¹ç¼–å· pï¼Œå·¦å­èŠ‚ç‚¹ç¼–å· <code>p&lt;&lt;1</code>ï¼Œå³å­èŠ‚ç‚¹ç¼–å· <code>p&lt;&lt;1|1</code>ã€‚æ³¨æ„ï¼Œä¸å»ºè®®ä½¿ç”¨ç§»ä½è¿ç®—é…åˆåŠ å·ä½¿ç”¨ï¼Œå› ä¸ºåŠ å·ä¼˜å…ˆçº§æ›´é«˜ï¼Œå› æ­¤éœ€è¦å¼•å…¥é¢å¤–çš„æ‹¬å·ã€‚</p>\n</div></div>\n<details class=\"callout\" data-callout=\"note\" data-callout-fold=\"-\">\n<summary class=\"callout-title\">\n<div class=\"callout-title-icon\">\n<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"lucide lucide-pencil\"><path d=\"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z\"/><path d=\"m15 5 4 4\"/></svg>\n</div>\n<div class=\"callout-title-inner\">ä¼˜å…ˆçº§çš„è®°å¿†å£è¯€ï¼š<strong>å•ç®—ç§»å…³ä¸ï¼Œå¼‚æˆ–é€»æ¡èµ‹</strong></div>\n<div class=\"callout-fold\"></div>\n</summary>\n<div class=\"callout-content\"><p>æ‹¬å·çº§åˆ«æœ€é«˜ï¼Œé€—å·çº§åˆ«æœ€ä½ï¼Œå•ç›® &gt; ç®—æœ¯ &gt; ä½ç§» &gt; å…³ç³» &gt; é€»è¾‘ &gt; ä¸‰ç›® &gt; èµ‹å€¼ã€‚</p>\n</div></details><p>å°±æ˜¯æŠŠåŸå…ˆåœ¨é“¾å¼ç»“æ„ä¸­ <code>Node</code> çš„å±æ€§å€¼å˜ä¸ºæ•°ç»„å³å¯ã€‚æ³¨æ„å–çš„æ•°ç»„å¤§å°è‡³å°‘ä¸º <code>4N</code>ï¼Œå¦‚æœé¢˜ç›®ä¸­æ‰€éœ€çš„ <code>N</code> è¿‡å¤§å¯èƒ½ä¼šå¯¼è‡´å†…å­˜è¶…é™ã€‚</p>\n\n<details class=\"callout\" data-callout=\"note\" data-callout-fold=\"-\">\n<summary class=\"callout-title\">\n<div class=\"callout-title-icon\">\n<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"lucide lucide-pencil\"><path d=\"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z\"/><path d=\"m15 5 4 4\"/></svg>\n</div>\n<div class=\"callout-title-inner\">å…³äºä½¿ç”¨å †å¼å­˜å‚¨æ—¶æ•°ç»„å¤§å°è®¾ç½®æˆ <code>4N</code> çš„åŸå› </div>\n<div class=\"callout-fold\"></div>\n</summary>\n<div class=\"callout-content\"><p>å…³äºçº¿æ®µæ ‘çš„ç©ºé—´ï¼šå¦‚æœé‡‡ç”¨å †å¼å­˜å‚¨ï¼Œè‹¥æœ‰ n ä¸ªå¶å­ç»“ç‚¹ï¼Œåˆ™ d æ•°ç»„çš„èŒƒå›´æœ€å¤§ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mrow><mrow><mo fence=\"true\">âŒˆ</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo fence=\"true\">âŒ‰</mo></mrow><mo>+</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">2^{\\left\\lceil\\log{n}\\right\\rceil+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8879999999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"minner mtight\"><span class=\"mopen mtight delimcenter\" style=\"top:0em;\"><span class=\"mtight\">âŒˆ</span></span><span class=\"mop mtight\"><span class=\"mtight\">l</span><span class=\"mtight\">o</span><span class=\"mtight\" style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace mtight\" style=\"margin-right:0.19516666666666668em;\"></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span><span class=\"mclose mtight delimcenter\" style=\"top:0em;\"><span class=\"mtight\">âŒ‰</span></span></span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span>ã€‚</p>\n<p>åˆ†æï¼šå®¹æ˜“çŸ¥é“çº¿æ®µæ ‘çš„æ·±åº¦æ˜¯ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo fence=\"true\">âŒˆ</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo fence=\"true\">âŒ‰</mo></mrow><annotation encoding=\"application/x-tex\">\\left\\lceil\\log{n}\\right\\rceil</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">âŒˆ</span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span></span><span class=\"mclose delimcenter\" style=\"top:0em;\">âŒ‰</span></span></span></span></span> çš„ï¼Œåˆ™åœ¨å †å¼å‚¨å­˜æƒ…å†µä¸‹å¶å­èŠ‚ç‚¹ï¼ˆåŒ…æ‹¬æ— ç”¨çš„å¶å­èŠ‚ç‚¹ï¼‰æ•°é‡ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mrow><mo fence=\"true\">âŒˆ</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo fence=\"true\">âŒ‰</mo></mrow></msup></mrow><annotation encoding=\"application/x-tex\">2^{\\left\\lceil\\log{n}\\right\\rceil}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8879999999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"minner mtight\"><span class=\"mopen mtight delimcenter\" style=\"top:0em;\"><span class=\"mtight\">âŒˆ</span></span><span class=\"mop mtight\"><span class=\"mtight\">l</span><span class=\"mtight\">o</span><span class=\"mtight\" style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace mtight\" style=\"margin-right:0.19516666666666668em;\"></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span><span class=\"mclose mtight delimcenter\" style=\"top:0em;\"><span class=\"mtight\">âŒ‰</span></span></span></span></span></span></span></span></span></span></span></span></span></span> ä¸ªï¼Œåˆç”±äºå…¶ä¸ºä¸€æ£µå®Œå…¨äºŒå‰æ ‘ï¼Œåˆ™å…¶æ€»èŠ‚ç‚¹ä¸ªæ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mrow><mrow><mo fence=\"true\">âŒˆ</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo fence=\"true\">âŒ‰</mo></mrow><mo>+</mo><mn>1</mn></mrow></msup><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">2^{\\left\\lceil\\log{n}\\right\\rceil+1}-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9713299999999999em;vertical-align:-0.08333em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"minner mtight\"><span class=\"mopen mtight delimcenter\" style=\"top:0em;\"><span class=\"mtight\">âŒˆ</span></span><span class=\"mop mtight\"><span class=\"mtight\">l</span><span class=\"mtight\">o</span><span class=\"mtight\" style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace mtight\" style=\"margin-right:0.19516666666666668em;\"></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span><span class=\"mclose mtight delimcenter\" style=\"top:0em;\"><span class=\"mtight\">âŒ‰</span></span></span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span>ã€‚å½“ç„¶å¦‚æœä½ æ‡’å¾—è®¡ç®—çš„è¯å¯ä»¥ç›´æ¥æŠŠæ•°ç»„é•¿åº¦è®¾ä¸º 4nï¼Œå› ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mrow><msup><mn>2</mn><mrow><mrow><mo fence=\"true\">âŒˆ</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo fence=\"true\">âŒ‰</mo></mrow><mo>+</mo><mn>1</mn></mrow></msup><mo>âˆ’</mo><mn>1</mn></mrow><mi>n</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{2^{\\left\\lceil\\log{n}\\right\\rceil+1}-1}{n}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.4157em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0707em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9667142857142857em;\"><span style=\"top:-2.966714285714285em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5357142857142856em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"minner mtight\"><span class=\"mopen mtight delimcenter\" style=\"top:0em;\"><span class=\"mtight\">âŒˆ</span></span><span class=\"mop mtight\"><span class=\"mtight\">l</span><span class=\"mtight\">o</span><span class=\"mtight\" style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace mtight\" style=\"margin-right:0.24533333333333335em;\"></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span><span class=\"mclose mtight delimcenter\" style=\"top:0em;\"><span class=\"mtight\">âŒ‰</span></span></span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span> çš„æœ€å¤§å€¼åœ¨ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><msup><mn>2</mn><mi>x</mi></msup><mo>+</mo><mn>1</mn><mo stretchy=\"false\">(</mo><mi>x</mi><mo>âˆˆ</mo><msub><mi>N</mi><mo lspace=\"0em\" rspace=\"0em\">+</mo></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">n=2^{x}+1(x\\in N_{+})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.747722em;vertical-align:-0.08333em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.25833100000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">+</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> æ—¶å–åˆ°ï¼Œæ­¤æ—¶èŠ‚ç‚¹æ•°ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mrow><mrow><mo fence=\"true\">âŒˆ</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo fence=\"true\">âŒ‰</mo></mrow><mo>+</mo><mn>1</mn></mrow></msup><mo>âˆ’</mo><mn>1</mn><mo>=</mo><msup><mn>2</mn><mrow><mi>x</mi><mo>+</mo><mn>2</mn></mrow></msup><mo>âˆ’</mo><mn>1</mn><mo>=</mo><mn>4</mn><mi>n</mi><mo>âˆ’</mo><mn>5</mn></mrow><annotation encoding=\"application/x-tex\">2^{\\left\\lceil\\log{n}\\right\\rceil+1}-1=2^{x+2}-1=4n-5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9713299999999999em;vertical-align:-0.08333em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"minner mtight\"><span class=\"mopen mtight delimcenter\" style=\"top:0em;\"><span class=\"mtight\">âŒˆ</span></span><span class=\"mop mtight\"><span class=\"mtight\">l</span><span class=\"mtight\">o</span><span class=\"mtight\" style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace mtight\" style=\"margin-right:0.19516666666666668em;\"></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span><span class=\"mclose mtight delimcenter\" style=\"top:0em;\"><span class=\"mtight\">âŒ‰</span></span></span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.897438em;vertical-align:-0.08333em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.72777em;vertical-align:-0.08333em;\"></span><span class=\"mord\">4</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">5</span></span></span></span>ã€‚</p>\n<p>è€Œå †å¼å­˜å‚¨å­˜åœ¨æ— ç”¨çš„å¶å­èŠ‚ç‚¹ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨å†…å­˜æ± ç®¡ç†çº¿æ®µæ ‘èŠ‚ç‚¹ï¼Œæ¯å½“éœ€è¦æ–°å»ºèŠ‚ç‚¹æ—¶ä»æ± ä¸­è·å–ã€‚è‡ªåº•å‘ä¸Šè€ƒè™‘ï¼Œå¿…æœ‰æ¯ä¸¤ä¸ªåº•å±‚èŠ‚ç‚¹åˆå¹¶ä¸ºä¸€ä¸ªä¸Šå±‚èŠ‚ç‚¹ï¼Œå› æ­¤å¯ä»¥ç±»ä¼¼å“ˆå¤«æ›¼æ ‘åœ°è¯æ˜ï¼Œå¦‚æœæœ‰ n ä¸ªå¶å­èŠ‚ç‚¹ï¼Œè¿™æ ·çš„çº¿æ®µæ ‘æ€»å…±æœ‰ 2n-1 ä¸ªèŠ‚ç‚¹ã€‚å…¶ç©ºé—´æ•ˆç‡ä¼˜äºå †å¼å­˜å‚¨ï¼Œå¹¶ä¸”æ˜¯å¯èƒ½çš„æœ€ä¼˜æƒ…å†µã€‚</p>\n</div></details><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">int</span> N;</span><br><span class=\"line\"><span class=\"type\">int</span>[] vals ,adds; <span class=\"comment\">// å¤§å°ä¸º 4 N</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">build</span><span class=\"params\">(<span class=\"type\">int</span> nodeId,<span class=\"type\">int</span> start,<span class=\"type\">int</span> end)</span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(start==end)&#123;</span><br><span class=\"line\">\t\tvals[nodeId]=nums[start];</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"type\">int</span> mid= (start+end)/<span class=\"number\">2</span>;</span><br><span class=\"line\">\tbuild(nodeId&lt;&lt;<span class=\"number\">1</span>,start,mid);</span><br><span class=\"line\">\tbuild(nodeId&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>,mid+<span class=\"number\">1</span>,end);</span><br><span class=\"line\">\tpushUp(nodeId);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">update</span><span class=\"params\">(<span class=\"type\">int</span> nodeId, <span class=\"type\">int</span> start,<span class=\"type\">int</span> end,<span class=\"type\">int</span> l,<span class=\"type\">int</span> r,<span class=\"type\">int</span> val)</span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(l&lt;= start &amp;&amp; end &lt;= r)&#123;</span><br><span class=\"line\">\t\tvals[nodeId] += val * ( end-start+<span class=\"number\">1</span>);</span><br><span class=\"line\">\t\tadds[nodeId] += val;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> ;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"type\">int</span> <span class=\"variable\">mid</span> <span class=\"operator\">=</span> (start+end)/<span class=\"number\">2</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\tpushDown(nodeId,mid-start+<span class=\"number\">1</span>,end-mid);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(l&lt;=mid)update(nodeId&lt;&lt;<span class=\"number\">1</span>,start,mid,l,r,val);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(mid+<span class=\"number\">1</span>&lt;=r)update(nodeId&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>,mid+<span class=\"number\">1</span>,end,l,r,val);</span><br><span class=\"line\">\tpushUp(nodeId);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">pushUp</span><span class=\"params\">(<span class=\"type\">int</span> nodeId)</span>&#123;</span><br><span class=\"line\">\tvals[nodeId] = vals[nodeId&lt;&lt;<span class=\"number\">1</span>]+ vals[nodeId&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">pushDown</span><span class=\"params\">(<span class=\"type\">int</span> nodeId,<span class=\"type\">int</span> leftNum,<span class=\"type\">int</span> rightNum)</span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(adds[nodeId]==<span class=\"number\">0</span>)<span class=\"keyword\">return</span>;</span><br><span class=\"line\">\tvals[nodeId&lt;&lt;<span class=\"number\">1</span>]+=adds[nodeId]*leftNum;</span><br><span class=\"line\">\tvals[nodeId&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+=adds[nodeId]*rightNum;</span><br><span class=\"line\">\tadds[nodeId&lt;&lt;<span class=\"number\">1</span>]+=adds[nodeId];</span><br><span class=\"line\">\tadds[nodeId&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>]+=adds[nodeId];</span><br><span class=\"line\">\tadds[nodeId]=<span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">query</span><span class=\"params\">(<span class=\"type\">int</span> nodeId,<span class=\"type\">int</span> start , <span class=\"type\">int</span> end,<span class=\"type\">int</span> l,<span class=\"type\">int</span> r)</span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(l&lt;=start&amp;&amp;end&lt;=r)&#123; </span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> vals[nodeId];</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"type\">int</span> <span class=\"variable\">mid</span> <span class=\"operator\">=</span> (start+end)/<span class=\"number\">2</span>;</span><br><span class=\"line\">\t<span class=\"type\">int</span> ans=<span class=\"number\">0</span>;</span><br><span class=\"line\">\tpushDown(nodeId,mid-start+<span class=\"number\">1</span>,end-mid);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(l&lt;=mid)ans+=query(nodeId&lt;&lt;<span class=\"number\">1</span>,start,mid,l,r);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(mid+<span class=\"number\">1</span>&lt;=r)ans+=query(nodeId&lt;&lt;<span class=\"number\">1</span>|<span class=\"number\">1</span>,mid+<span class=\"number\">1</span>,end,l,r);</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>ç›¸å…³é¢˜ç›®ï¼šğŸŸ¨ <a href=\"https://leetcode.cn/problems/range-sum-query-mutable/\">307. åŒºåŸŸå’Œæ£€ç´¢ - æ•°ç»„å¯ä¿®æ”¹ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></p>\n</blockquote>\n<h1 id=\"ä»€ä¹ˆæƒ…å†µä¸‹ç”¨åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘\"><a class=\"markdownIt-Anchor\" href=\"#ä»€ä¹ˆæƒ…å†µä¸‹ç”¨åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘\"></a> ä»€ä¹ˆæƒ…å†µä¸‹ç”¨åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘ï¼Ÿ</h1>\n<p>å¦‚æœåªæ˜¯éœ€è¦ä¸€æ¬¡æ„å»ºå¹¶æ±‚å‡ºç»“æœï¼Œå°±ä½¿ç”¨ä¸€æ¬¡å½’å¹¶çš„æ€è·¯è§£å†³ï¼ˆå†™ <code>build</code> å‡½æ•°å³å¯ï¼‰ã€‚</p>\n<p>å¦‚æœæ˜¯å¤šæ¬¡æ›´æ–°ä¸æŸ¥è¯¢æ··åˆäº¤æ›¿ï¼ˆåœ¨ LeetCode ä¸­è¿™ç§é¢˜ç›®ä¸€èˆ¬æ˜¯å«ä½ è¡¥å……å®Œæ•´ä¸€ä¸ªç±»ï¼‰ï¼Œé‚£å°±ä½¿ç”¨åŠ¨æ€å¼€ç‚¹å’Œæ‡’æƒ°æ ‡è®°æ¨¡æ¿ï¼Œå†™ä¸€ä¸ªå®Œæ•´çš„çº¿æ®µæ ‘ã€‚</p>\n<p>æ ¹æ®é¢˜ç›®å®é™…æƒ…å†µï¼Œä¸¤ä¸ªæ¨¡æ¿æŒ‰éœ€é»˜å†™ã€‚æ¯”å¦‚åœ¨è¿™äº›é¢˜ç›®ä¸­ï¼š</p>\n<ul>\n<li>åªéœ€è¦é»˜å†™åŠ¨æ€å¼€ç‚¹æ¨¡æ¿\n<ul>\n<li>ğŸŸ¨ <a href=\"https://leetcode.cn/problems/my-calendar-i/description/\">729. æˆ‘çš„æ—¥ç¨‹å®‰æ’è¡¨ I - åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></li>\n<li>ğŸŸ¨ <a href=\"https://leetcode.cn/problems/my-calendar-ii/\">731. æˆ‘çš„æ—¥ç¨‹å®‰æ’è¡¨ II - åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></li>\n<li>ğŸŸ¥ <a href=\"https://leetcode.cn/problems/my-calendar-iii/\">732. æˆ‘çš„æ—¥ç¨‹å®‰æ’è¡¨ III - åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></li>\n</ul>\n</li>\n<li>éœ€è¦ä»å¤´åˆ°å°¾æ„å»ºä¸€æ£µå®Œæ•´çš„çº¿æ®µæ ‘\n<ul>\n<li>ğŸŸ¨ <a href=\"https://leetcode.cn/problems/maximum-subarray/description/\">53. æœ€å¤§å­æ•°ç»„å’Œ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a>ã€‚é¢˜è§£å¯å‚è€ƒ <a class=\"uuanqin-bilink\" target=\"_blank\" href=\"/p/19c8c246/\"><span class=\"bilink-pop-up\">ç«™å†…æ–‡ç« </span>æœ¬æ–‡</a> ä¸­çº¿æ®µæ ‘çš„è§£æ³•ã€‚</li>\n</ul>\n</li>\n<li>éœ€è¦ä»å¤´åˆ°å°¾æ„å»ºä¸€æ£µå®Œæ•´çš„çº¿æ®µæ ‘ï¼Œå†åŠ¨æ€æ›´æ–°\n<ul>\n<li>ğŸŸ¨ <a href=\"https://leetcode.cn/problems/range-sum-query-mutable/description/\">307. åŒºåŸŸå’Œæ£€ç´¢ - æ•°ç»„å¯ä¿®æ”¹ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></li>\n</ul>\n</li>\n</ul>\n<h1 id=\"æœ¬æ–‡å‚è€ƒ\"><a class=\"markdownIt-Anchor\" href=\"#æœ¬æ–‡å‚è€ƒ\"></a> æœ¬æ–‡å‚è€ƒ</h1>\n<ul>\n<li>â­ä¸»è¦å‚è€ƒ/æ¨èé˜…è¯»ï¼š<a href=\"https://lfool.github.io/LFool-Notes/algorithm/%E7%BA%BF%E6%AE%B5%E6%A0%91%E8%AF%A6%E8%A7%A3.html\">çº¿æ®µæ ‘è¯¦è§£ - Lfool</a></li>\n<li>æˆ‘çš„ 408 ç¬”è®°</li>\n<li><a href=\"https://oiwiki.org/ds/seg/\">çº¿æ®µæ ‘ - OI Wiki</a></li>\n<li><a href=\"https://blog.csdn.net/feifuzeng/article/details/108862001\">Javaè¿ç®—ç¬¦åŠè¿ç®—ç¬¦çš„ä¼˜å…ˆçº§_javaè¿ç®—ç¬¦ä¼˜å…ˆçº§-CSDNåšå®¢</a></li>\n</ul>\n<hr class=\"footnotes-sep\" />\n<section class=\"footnotes\">\n<ol class=\"footnotes-list\">\n<li id=\"fn1\" class=\"footnote-item\"><p>å°è¯•å°†ä¸Šé¢çš„è¯æŠ½è±¡ä¸ºå‘½é¢˜å¹¶ç”¨å½¢å¼è¯­è¨€è¯æ˜ï¼Ÿä¸€ç‚¹ç‚¹å‚è€ƒï¼š<a class=\"uuanqin-bilink\" target=\"_blank\" href=\"/p/cd939534/\"><span class=\"bilink-pop-up\">ç«™å†…æ–‡ç« </span>ä½ çœŸçš„å¼„æ‡‚å‡è¨€åˆ¤æ–­ï¼ˆæ¡ä»¶å‘½é¢˜ï¼‰äº†å—ï¼Ÿ</a>ã€‚ <a href=\"#fnref1\" class=\"footnote-backref\">â†©ï¸</a></p>\n</li>\n</ol>\n</section>\n","raw":"---\ntitle: çº¿æ®µæ ‘æ¨¡æ¿çš„ç†è§£å’Œä½¿ç”¨\ntags:\n  - Java\n  - çº¿æ®µæ ‘\n  - é€’å½’\ncover: 'https://cdn.gallery.uuanqin.top/img/202508270057686.webp'\ndescription: æƒ³å¥½äº†å†ç”¨ï¼Œä¸ç„¶æµªè´¹æ—¶é—´ã€‚\ncategories:\n  - ç®—æ³•ä¸æ•°æ®ç»“æ„\nabbrlink: 10ab676\ndate: 2025-01-02 03:08:58\ntop_img:\nkatex: true\n---\n\n# çº¿æ®µæ ‘ç®€è¿°\n\nçº¿æ®µæ ‘æ˜¯ç”¨æ¥ç»´æŠ¤ åŒºé—´ä¿¡æ¯ çš„æ•°æ®ç»“æ„ã€‚**çº¿æ®µæ ‘çš„æ¯ä¸ªèŠ‚ç‚¹ä»£è¡¨ä¸€ä¸ªåŒºé—´**ã€‚\n\nçº¿æ®µæ ‘å¯ä»¥åœ¨ $O(\\log N)$ çš„æ—¶é—´å¤æ‚åº¦å†…å®ç°å•ç‚¹ä¿®æ”¹ã€åŒºé—´ä¿®æ”¹ã€åŒºé—´æŸ¥è¯¢ï¼ˆåŒºé—´æ±‚å’Œï¼Œæ±‚åŒºé—´æœ€å¤§å€¼ï¼Œæ±‚åŒºé—´æœ€å°å€¼ï¼‰ç­‰æ“ä½œã€‚\n\n# çº¿æ®µæ ‘çš„æ¨¡æ¿\n\n> [!example] æ¨¡æ¿é¢˜ï¼šæ±‚ç»™å®šåŒºé—´çš„åŒºé—´å’Œï¼ˆå¤šæ¬¡è¯¢é—®ï¼‰\n\nçº¿æ®µæ ‘ä¸­ï¼ŒåŒºé—´çš„èŒƒå›´ç»™å®šä¹‹åï¼Œæ ‘çš„ç»“ç‚¹å°±å›ºå®šäº†ã€‚\n\n## ä½¿ç”¨é“¾è¡¨è¡¨ç¤ºçº¿æ®µæ ‘\n\né¢„å…ˆå®šä¹‰ï¼š\n\n```java\nclass Node{\n\tint val,add;\n\tNode left,right;\n}\nNode root = new Node(); // é¢„å…ˆå®šä¹‰å¥½æ ‘æ ¹\nint N = 1000000000;     // é¢˜ç›®ä¸­å¯èƒ½å‡ºç°çš„èŒƒå›´\n```\n\nçº¿æ®µæ ‘çš„æ„å»ºæ¨¡æ¿å†™æ³•ï¼š\n\n```java\npublic void buildTree(Node node, int start, int end) {\n    // åˆ°è¾¾å¶å­èŠ‚ç‚¹\n    if (start == end) {\n        node.val = arr[start];\n        return ;\n    }\n    if(node.left==null)node.left=new Node();\n    if(node.right==null)node.right=new Node();\n    int mid = (start + end) >> 1;\n    buildTree(node.left, start, mid);\n    buildTree(node.right, mid + 1, end);\n    // å‘ä¸Šæ›´æ–°\n    pushUp(node);\n}\n// å‘ä¸Šæ›´æ–°\nprivate void pushUp(Node node) {\n    node.val = node.left.val + node.right.val;\n}\n```\n\nçº¿æ®µæ ‘åŠ¨æ€å¼€ç‚¹æ¨¡æ¿å†™æ³•ï¼š\n\n```java\n// åŠ¨æ€å¼€ç‚¹\npublic class SegmentTreeDynamic {\n\t// ç»“ç‚¹è¡¨ç¤º\n    class Node {\n        Node left, right; // å·¦å³æŒ‡é’ˆ\n        int val; // ç»“ç‚¹çš„å€¼ï¼Œæ„æ€ä¸ºæ­¤èŠ‚ç‚¹é”è¡¨ç¤ºåŒºé—´çš„åŒºé—´å’Œ\n        int add; // æ‡’æƒ°æ ‡è®°ï¼Œæ„æ€æ˜¯æ­¤èŠ‚ç‚¹çš„å­ç»“ç‚¹çš„æ¯ä¸ªå…ƒç´ çš„å€¼éƒ½è¦åŠ ä¸Š add\n    }\n    private int N = (int) 1e9; // åŒºé—´èŒƒå›´ï¼Œä¸€èˆ¬ç”±é¢˜ç›®ç»™å‡º\n    private Node root = new Node(); // æ ¹ç»“ç‚¹\n\n\t// åŒºé—´æ›´æ–°\n\t// å°†[start,end]å½“å‰ç»“ç‚¹çš„æ‰€æœ‰å…ƒç´ åŠ ä¸Š val\n    public void update(Node node, int start, int end, int l, int r, int val) {\n        // å½“å‰ç»“ç‚¹å·²ç»æ»¡è¶³æ›´æ–°èŒƒå›´\n        if (l <= start && end <= r) {\n            node.val += (end - start + 1) * val;\n            node.add += val;\n            // å­èŠ‚ç‚¹å°±ä¸å†é€’å½’ï¼Œå®ç°äº†ã€Œæ‡’æƒ°ã€\n            return ;\n        }\n        int mid = (start + end) >> 1;\n        pushDown(node, mid - start + 1, end - mid); // æ¸…ç©ºå½“å‰ç»“ç‚¹æ‡’æƒ°æ ‡è®°\n        // è¡¨æ˜æŸ¥è¯¢åŒºé—´å’Œå·¦å­åŒºé—´æœ‰äº¤é›†\n        if (l <= mid) update(node.left, start, mid, l, r, val);\n        // è¡¨æ˜æŸ¥è¯¢åŒºé—´å’Œå³å­åŒºé—´æœ‰äº¤é›†\n        if (mid + 1 <= r) update(node.right, mid + 1, end, l, r, val);\n        pushUp(node); // æ›´æ–°å½“å‰ç»“ç‚¹çš„åŒºé—´å€¼\n    }\n    public int query(Node node, int start, int end, int l, int r) {\n        if (l <= start && end <= r) return node.val;\n        int mid = (start + end) >> 1;\n        int ans = 0;\n        pushDown(node, mid - start + 1, end - mid);\n        // è¡¨æ˜æŸ¥è¯¢åŒºé—´å’Œå·¦å­åŒºé—´æœ‰äº¤é›†\n        if (l <= mid) ans += query(node.left, start, mid, l, r); \n        // è¡¨æ˜æŸ¥è¯¢åŒºé—´å’Œå³å­åŒºé—´æœ‰äº¤é›†\n        if (mid + 1 <= r) ans += query(node.right, mid + 1, end, l, r);\n        return ans;\n    }\n    private void pushUp(Node node) {\n        node.val = node.left.val + node.right.val;\n    }\n\n\t// ç»“ç‚¹ä¸‹æ¨\n    private void pushDown(Node node, int leftNum, int rightNum) {\n\t    // å­èŠ‚ç‚¹å»ºç«‹æ£€æŸ¥\n        if (node.left == null) node.left = new Node();\n        if (node.right == null) node.right = new Node();\n        if (node.add == 0) return ; // æ²¡æœ‰æ‡’æƒ°æ ‡è®°ï¼Œæ— éœ€å¤„ç†\n\n\t\t// å¤„ç†æ‡’æƒ°æ ‡è®°\n        node.left.val += node.add * leftNum;\n        node.right.val += node.add * rightNum;\n        node.left.add += node.add;  // ç´¯ç§¯æ‡’æƒ°æ ‡è®°\n        node.right.add += node.add;\n        node.add = 0;               // æ¸…ç©ºæ‡’æƒ°æ ‡è®°ï¼Œè¡¨ç¤ºå¤„ç†å®Œæ¯•\n    }\n}\n```\n\nä»ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºï¼Œä¸ç®¡æ˜¯ `update`ï¼Œè¿˜æ˜¯ `query`ï¼Œåœ¨è¿›è¡Œä¸‹å±‚é€’å½’æ—¶éƒ½æ˜¯ä½¿ç”¨ `[start, mid]` å’Œ `[mid + 1, end]`ã€‚å®ƒè¡¨ç¤ºæ•°çš„å½“å‰ç»“ç‚¹è¡¨ç¤ºçš„åŒºé—´èŒƒå›´ã€‚\n\né€’å½’æ—¶ï¼Œä¸ç®¡æ˜¯ `update`ï¼Œè¿˜æ˜¯ `query`ï¼Œ`[l,r]` è¡¨ç¤ºæŸ¥è¯¢åŒºé—´ï¼Œå‚æ•°ä¼ é€’æ—¶æ˜¯ä¸å˜çš„ã€‚ä¸è¦è‡ªè¡Œåˆ†å‰²åŒºé—´ï¼Œå¦‚ï¼š\n\n```java\n// é”™è¯¯å†™æ³•\nif (l <= mid) update(node.left, start, mid, l, mid, val);\nif (mid + 1 <= r) update(node.right, mid + 1, end, mid+1, r, val);\n// æ›´æ­£å†™æ³•ï¼ˆæŒ‰ç…§è‡ªè¡Œåˆ†å‰²çš„æ€è·¯ï¼‰\nif (l <= mid) update(node.left,start,mid,l,r>=mid?mid:r,val);\nif (mid + 1 <= r) update(node.right,mid+1,end,l<=mid+1?mid+1:l,r,val);\n```\n\nä¸Šé¢çš„åšæ³•æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºä½ å¯èƒ½ä¼šæŠŠæŸ¥è¯¢çš„åŒºé—´æ‰©å¤§äº†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸Šé¢çš„ä»£ç æ²¡æœ‰è€ƒè™‘åˆ° `r<mid` æˆ– `l>mid+1` çš„æƒ…å†µã€‚\n\né€’å½’æ—¶çš„ç»ˆæ­¢æ¡ä»¶ä¸­ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰æ£€æŸ¥ `start <= end`ï¼Œå³ä¸è€ƒè™‘ `start > end` çš„æƒ…å†µï¼Œé‚£ä¹ˆ `update`ï¼Œè¿˜æ˜¯ `query` åœ¨é€’å½’è¿‡ç¨‹ä¸­ä¼ å…¥çš„å‚æ•°ä¼šå‡ºç° `start > end` å—ï¼Ÿç­”æ¡ˆæ˜¯ä¸ä¼šçš„ã€‚æ¨å¯¼ [^ls] å¦‚ä¸‹ï¼š\n\n- å› ä¸ºæœ¬å±‚ä¼ å…¥ `start > end` åªæœ‰åœ¨ä¸Šä¸€å±‚æœ‰ `start==end` å¹¶è®¡ç®— `mid=(start+end)/2;` æ—¶ï¼Œå¯¹å³å­åŒºé—´é€’å½’æ—¶æ‰å¯èƒ½å‡ºç°ã€‚\n- ç„¶è€Œå¦‚æœä¸Šä¸€å±‚ä¼ å…¥çš„å‚æ•° `start==end`ï¼Œé‚£ä¹ˆå¿…æœ‰ `l <= start && end <= r`ï¼Œå®ƒåªä¼šåœ¨ç¬¬ä¸€ä¸ªæ¡ä»¶åˆ¤æ–­è¯­å¥ï¼ˆè¾¹ç•Œæ¡ä»¶ï¼‰ä¸­è·³å‡ºé€’å½’ï¼Œä¸ä¼šè¿›è¡Œåç»­çš„ `mid` è®¡ç®—ï¼Œæ›´æ— ä¸‹ä¸€å±‚çš„é€’å½’ã€‚\n- å› æ­¤ä¸ä¼šå‡ºç°ä¼ è¿‡æ¥çš„å‚æ•° `start > end`ã€‚\n\n[^ls]: å°è¯•å°†ä¸Šé¢çš„è¯æŠ½è±¡ä¸ºå‘½é¢˜å¹¶ç”¨å½¢å¼è¯­è¨€è¯æ˜ï¼Ÿä¸€ç‚¹ç‚¹å‚è€ƒï¼š[[ä½ çœŸçš„å¼„æ‡‚å‡è¨€åˆ¤æ–­ï¼ˆæ¡ä»¶å‘½é¢˜ï¼‰äº†å—ï¼Ÿ]]ã€‚\n\nå¯¹äºç»ˆæ­¢æ¡ä»¶çš„é£æ ¼ï¼Œè¿˜æœ‰ä»¥ä¸‹è¿™ç§ï¼Œä¸¤è€…æ˜¯ç­‰ä»·çš„ï¼š\n\n```java\npublic void update(Node node, int start,int end,int l,int r,int val){\n\tif(r<start || l> end)return; // æŸ¥è¯¢åŒºé—´ä¸å½“å‰åŒºé—´æ— äº¤é›†\n\tif(l<= start && end <= r){\n\t\tnode.val += val * ( end-start+1);\n\t\tnode.add += val;\n\t\treturn ;\n\t}\n\tint mid = (start+end)/2;\n\tpushDown(node,mid-start+1,end-mid);\n\tupdate(node.left,start,mid,l,r,val);   // ç§»é™¤äº†å‰é¢çš„åˆ¤æ–­æ¡ä»¶\n\tupdate(node.right,mid+1,end,l,r,val);  // ç§»é™¤äº†å‰é¢çš„åˆ¤æ–­æ¡ä»¶\n\tpushUp(node);\n}\n```\n\nåœ¨ä¸åŒçš„é¢˜ç›®ä¸­ï¼Œ`val` å’Œ `add` å¯ä»¥æ‰®æ¼”ä¸åŒçš„è§’è‰²ï¼Œæ¯”å¦‚åŒºé—´å’Œæˆ–è€…åŒºé—´æœ€å€¼ã€‚è¿™æ—¶å€™å°±éœ€è¦æ ¹æ®é¢˜ç›®è¦æ±‚ä¿®æ”¹ `val` å’Œ `add` çš„è®¡ç®—ä»£ç ã€‚\n\n## ä½¿ç”¨æ•°ç»„è¡¨ç¤ºçº¿æ®µæ ‘\n\n![image.png|350](https://cdn.gallery.uuanqin.top/img/202501070206417.webp)\n\n> [!node] å †å¼å­˜å‚¨\n> æˆ‘ä»¬çŸ¥é“ï¼Œï¼ˆäºŒå‰ï¼‰å †çš„é€»è¾‘ç»“æ„æ˜¯æ ‘å½¢çš„ï¼Œä½†å…¶å­˜å‚¨ç»“æ„æ˜¯æ•°ç»„ã€‚æ ‘æ ¹ç¼–å·ä¸º 1ã€‚å‡è®¾æŸç»“ç‚¹çš„ç¼–å·ä¸º `p`ï¼Œåˆ™å…¶å·¦å­©å­çš„ç¼–å·ä¸º `2p`ï¼Œå³å­©å­ç¼–å·ä¸º `2p+1`ã€‚\n>\n> ![image.png|250](https://cdn.gallery.uuanqin.top/img/202501070213296.webp)\n>\n>\n> ä»£ç å†™æ³•ï¼šçˆ¶ç»“ç‚¹ç¼–å· pï¼Œå·¦å­èŠ‚ç‚¹ç¼–å· `p<<1`ï¼Œå³å­èŠ‚ç‚¹ç¼–å· `p<<1|1`ã€‚æ³¨æ„ï¼Œä¸å»ºè®®ä½¿ç”¨ç§»ä½è¿ç®—é…åˆåŠ å·ä½¿ç”¨ï¼Œå› ä¸ºåŠ å·ä¼˜å…ˆçº§æ›´é«˜ï¼Œå› æ­¤éœ€è¦å¼•å…¥é¢å¤–çš„æ‹¬å·ã€‚\n\n> [!note]- ä¼˜å…ˆçº§çš„è®°å¿†å£è¯€ï¼š**å•ç®—ç§»å…³ä¸ï¼Œå¼‚æˆ–é€»æ¡èµ‹**\n> æ‹¬å·çº§åˆ«æœ€é«˜ï¼Œé€—å·çº§åˆ«æœ€ä½ï¼Œå•ç›® > ç®—æœ¯ > ä½ç§» > å…³ç³» > é€»è¾‘ > ä¸‰ç›® > èµ‹å€¼ã€‚\n\nå°±æ˜¯æŠŠåŸå…ˆåœ¨é“¾å¼ç»“æ„ä¸­ `Node` çš„å±æ€§å€¼å˜ä¸ºæ•°ç»„å³å¯ã€‚æ³¨æ„å–çš„æ•°ç»„å¤§å°è‡³å°‘ä¸º `4N`ï¼Œå¦‚æœé¢˜ç›®ä¸­æ‰€éœ€çš„ `N` è¿‡å¤§å¯èƒ½ä¼šå¯¼è‡´å†…å­˜è¶…é™ã€‚\n\n> [!note]- å…³äºä½¿ç”¨å †å¼å­˜å‚¨æ—¶æ•°ç»„å¤§å°è®¾ç½®æˆ `4N` çš„åŸå› \n> å…³äºçº¿æ®µæ ‘çš„ç©ºé—´ï¼šå¦‚æœé‡‡ç”¨å †å¼å­˜å‚¨ï¼Œè‹¥æœ‰ n ä¸ªå¶å­ç»“ç‚¹ï¼Œåˆ™ d æ•°ç»„çš„èŒƒå›´æœ€å¤§ä¸º $2^{\\left\\lceil\\log{n}\\right\\rceil+1}$ã€‚\n>\n> åˆ†æï¼šå®¹æ˜“çŸ¥é“çº¿æ®µæ ‘çš„æ·±åº¦æ˜¯ $\\left\\lceil\\log{n}\\right\\rceil$ çš„ï¼Œåˆ™åœ¨å †å¼å‚¨å­˜æƒ…å†µä¸‹å¶å­èŠ‚ç‚¹ï¼ˆåŒ…æ‹¬æ— ç”¨çš„å¶å­èŠ‚ç‚¹ï¼‰æ•°é‡ä¸º $2^{\\left\\lceil\\log{n}\\right\\rceil}$ ä¸ªï¼Œåˆç”±äºå…¶ä¸ºä¸€æ£µå®Œå…¨äºŒå‰æ ‘ï¼Œåˆ™å…¶æ€»èŠ‚ç‚¹ä¸ªæ•° $2^{\\left\\lceil\\log{n}\\right\\rceil+1}-1$ã€‚å½“ç„¶å¦‚æœä½ æ‡’å¾—è®¡ç®—çš„è¯å¯ä»¥ç›´æ¥æŠŠæ•°ç»„é•¿åº¦è®¾ä¸º 4nï¼Œå› ä¸º $\\frac{2^{\\left\\lceil\\log{n}\\right\\rceil+1}-1}{n}$ çš„æœ€å¤§å€¼åœ¨ $n=2^{x}+1(x\\in N_{+})$ æ—¶å–åˆ°ï¼Œæ­¤æ—¶èŠ‚ç‚¹æ•°ä¸º $2^{\\left\\lceil\\log{n}\\right\\rceil+1}-1=2^{x+2}-1=4n-5$ã€‚\n>\n> è€Œå †å¼å­˜å‚¨å­˜åœ¨æ— ç”¨çš„å¶å­èŠ‚ç‚¹ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨å†…å­˜æ± ç®¡ç†çº¿æ®µæ ‘èŠ‚ç‚¹ï¼Œæ¯å½“éœ€è¦æ–°å»ºèŠ‚ç‚¹æ—¶ä»æ± ä¸­è·å–ã€‚è‡ªåº•å‘ä¸Šè€ƒè™‘ï¼Œå¿…æœ‰æ¯ä¸¤ä¸ªåº•å±‚èŠ‚ç‚¹åˆå¹¶ä¸ºä¸€ä¸ªä¸Šå±‚èŠ‚ç‚¹ï¼Œå› æ­¤å¯ä»¥ç±»ä¼¼å“ˆå¤«æ›¼æ ‘åœ°è¯æ˜ï¼Œå¦‚æœæœ‰ n ä¸ªå¶å­èŠ‚ç‚¹ï¼Œè¿™æ ·çš„çº¿æ®µæ ‘æ€»å…±æœ‰ 2n-1 ä¸ªèŠ‚ç‚¹ã€‚å…¶ç©ºé—´æ•ˆç‡ä¼˜äºå †å¼å­˜å‚¨ï¼Œå¹¶ä¸”æ˜¯å¯èƒ½çš„æœ€ä¼˜æƒ…å†µã€‚\n\n```java\nint N;\nint[] vals ,adds; // å¤§å°ä¸º 4 N\n\npublic void build(int nodeId,int start,int end){\n\tif(start==end){\n\t\tvals[nodeId]=nums[start];\n\t\treturn;\n\t}\n\tint mid= (start+end)/2;\n\tbuild(nodeId<<1,start,mid);\n\tbuild(nodeId<<1|1,mid+1,end);\n\tpushUp(nodeId);\n}\n\npublic void update(int nodeId, int start,int end,int l,int r,int val){\n\tif(l<= start && end <= r){\n\t\tvals[nodeId] += val * ( end-start+1);\n\t\tadds[nodeId] += val;\n\t\treturn ;\n\t}\n\tint mid = (start+end)/2;\n\n\tpushDown(nodeId,mid-start+1,end-mid);\n\tif(l<=mid)update(nodeId<<1,start,mid,l,r,val);\n\tif(mid+1<=r)update(nodeId<<1|1,mid+1,end,l,r,val);\n\tpushUp(nodeId);\n}\n\npublic void pushUp(int nodeId){\n\tvals[nodeId] = vals[nodeId<<1]+ vals[nodeId<<1|1];\n}\n\npublic void pushDown(int nodeId,int leftNum,int rightNum){\n\tif(adds[nodeId]==0)return;\n\tvals[nodeId<<1]+=adds[nodeId]*leftNum;\n\tvals[nodeId<<1|1]+=adds[nodeId]*rightNum;\n\tadds[nodeId<<1]+=adds[nodeId];\n\tadds[nodeId<<1|1]+=adds[nodeId];\n\tadds[nodeId]=0;\n}\n\npublic int query(int nodeId,int start , int end,int l,int r){\n\tif(l<=start&&end<=r){ \n\t\treturn vals[nodeId];\n\t}\n\tint mid = (start+end)/2;\n\tint ans=0;\n\tpushDown(nodeId,mid-start+1,end-mid);\n\tif(l<=mid)ans+=query(nodeId<<1,start,mid,l,r);\n\tif(mid+1<=r)ans+=query(nodeId<<1|1,mid+1,end,l,r);\n\treturn ans;\n}\n```\n\n> ç›¸å…³é¢˜ç›®ï¼šğŸŸ¨ [307. åŒºåŸŸå’Œæ£€ç´¢ - æ•°ç»„å¯ä¿®æ”¹ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/problems/range-sum-query-mutable/)\n\n# ä»€ä¹ˆæƒ…å†µä¸‹ç”¨åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘ï¼Ÿ\n\nå¦‚æœåªæ˜¯éœ€è¦ä¸€æ¬¡æ„å»ºå¹¶æ±‚å‡ºç»“æœï¼Œå°±ä½¿ç”¨ä¸€æ¬¡å½’å¹¶çš„æ€è·¯è§£å†³ï¼ˆå†™ `build` å‡½æ•°å³å¯ï¼‰ã€‚\n\nå¦‚æœæ˜¯å¤šæ¬¡æ›´æ–°ä¸æŸ¥è¯¢æ··åˆäº¤æ›¿ï¼ˆåœ¨ LeetCode ä¸­è¿™ç§é¢˜ç›®ä¸€èˆ¬æ˜¯å«ä½ è¡¥å……å®Œæ•´ä¸€ä¸ªç±»ï¼‰ï¼Œé‚£å°±ä½¿ç”¨åŠ¨æ€å¼€ç‚¹å’Œæ‡’æƒ°æ ‡è®°æ¨¡æ¿ï¼Œå†™ä¸€ä¸ªå®Œæ•´çš„çº¿æ®µæ ‘ã€‚\n\næ ¹æ®é¢˜ç›®å®é™…æƒ…å†µï¼Œä¸¤ä¸ªæ¨¡æ¿æŒ‰éœ€é»˜å†™ã€‚æ¯”å¦‚åœ¨è¿™äº›é¢˜ç›®ä¸­ï¼š\n\n- åªéœ€è¦é»˜å†™åŠ¨æ€å¼€ç‚¹æ¨¡æ¿\n\t- ğŸŸ¨ [729. æˆ‘çš„æ—¥ç¨‹å®‰æ’è¡¨ I - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/problems/my-calendar-i/description/)\n\t- ğŸŸ¨ [731. æˆ‘çš„æ—¥ç¨‹å®‰æ’è¡¨ II - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/problems/my-calendar-ii/)\n\t- ğŸŸ¥ [732. æˆ‘çš„æ—¥ç¨‹å®‰æ’è¡¨ III - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/problems/my-calendar-iii/)\n- éœ€è¦ä»å¤´åˆ°å°¾æ„å»ºä¸€æ£µå®Œæ•´çš„çº¿æ®µæ ‘\n\t- ğŸŸ¨ [53. æœ€å¤§å­æ•°ç»„å’Œ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/problems/maximum-subarray/description/)ã€‚é¢˜è§£å¯å‚è€ƒ [[æœ€å¤§å­æ•°ç»„é—®é¢˜|æœ¬æ–‡]] ä¸­çº¿æ®µæ ‘çš„è§£æ³•ã€‚\n- éœ€è¦ä»å¤´åˆ°å°¾æ„å»ºä¸€æ£µå®Œæ•´çš„çº¿æ®µæ ‘ï¼Œå†åŠ¨æ€æ›´æ–°\n\t- ğŸŸ¨ [307. åŒºåŸŸå’Œæ£€ç´¢ - æ•°ç»„å¯ä¿®æ”¹ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/problems/range-sum-query-mutable/description/)\n\n# æœ¬æ–‡å‚è€ƒ\n\n- â­ä¸»è¦å‚è€ƒ/æ¨èé˜…è¯»ï¼š[çº¿æ®µæ ‘è¯¦è§£ - Lfool](https://lfool.github.io/LFool-Notes/algorithm/%E7%BA%BF%E6%AE%B5%E6%A0%91%E8%AF%A6%E8%A7%A3.html)\n- æˆ‘çš„ 408 ç¬”è®°\n- [çº¿æ®µæ ‘ - OI Wiki](https://oiwiki.org/ds/seg/)\n- [Javaè¿ç®—ç¬¦åŠè¿ç®—ç¬¦çš„ä¼˜å…ˆçº§_javaè¿ç®—ç¬¦ä¼˜å…ˆçº§-CSDNåšå®¢](https://blog.csdn.net/feifuzeng/article/details/108862001)\n","categories":[{"name":"ç®—æ³•ä¸æ•°æ®ç»“æ„","api":"api/categories/ç®—æ³•ä¸æ•°æ®ç»“æ„.json"}],"tags":[{"name":"Java","api":"api/tags/Java.json"},{"name":"çº¿æ®µæ ‘","api":"api/tags/çº¿æ®µæ ‘.json"},{"name":"é€’å½’","api":"api/tags/é€’å½’.json"}]},"api":"api/posts/p/10ab676.json"}