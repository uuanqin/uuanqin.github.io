{"data":{"title":"国内访问 Hexo 博客优化加速（静态资源 CDN 链接替换）","slug":"博客站点维护/Hexo/国内访问 Hexo 博客优化加速（静态资源 CDN 链接替换）","description":"本文介绍 Butterfly 下替换 CDN 链接的解决方案","date":"2023-04-28T09:34:18.000Z","updated":"2024-12-12T17:57:56.747Z","language":"zh-CN","comments":true,"url":"p/7b17333d/","cover":"https://cdn.gallery.uuanqin.top/img/jsdeliver-banned.png","images":[],"content":"<p>假设你刚搭建了个人博客，发现网站的访问速度实在堪忧，怎么办？解决方法无非以下几种方法：</p>\n<ul>\n<li>有经济实力的，考虑提升硬件性能和带宽（购买高级服务器、增大带宽）</li>\n<li>正确使用 CDN 加速源站和图片</li>\n<li>如果你的个人博客网站是动态网站（如 Wordpress），但实在没有必要必须是动态网站时，可尝试改成静态框架 <sup class=\"footnote-ref\"><a href=\"#fn1\" id=\"fnref1\">[1]</a></sup></li>\n</ul>\n<p>如果以上的方法你都尝试过，但博客网站可能遇到页面卡顿、显示不全、功能异常（图标、评论、搜索等各种异常）等情况，比如：</p>\n<ul>\n<li>font awesome 加载迟、卡，拖慢网页加载 <sup class=\"footnote-ref\"><a href=\"#fn2\" id=\"fnref2\">[2]</a></sup>。</li>\n<li>algolia 搜索按钮按不出来</li>\n<li>Waline 评论系统不显示或评论数据无法获取 <sup class=\"footnote-ref\"><a href=\"#fn3\" id=\"fnref3\">[3]</a></sup></li>\n<li>网站加载条等了半天，文章图片一直都是加载中</li>\n</ul>\n<p>本地调试自己的博客网站后，打开浏览器的开发者面板（F12）-&gt; 禁用缓存 -&gt; 点击网络选项卡 -&gt; 刷新页面：</p>\n<p><img src= \"/image/loading.gif\" data-lazy-src=\"https://cdn.gallery.uuanqin.top/img/jsdeliver惹的祸1.png\" alt=\"jsdeliver惹的祸1\" width=\"500px\" /></p>\n<p>你会发现一些 js 文件或 css 文件无法被加载，这些文件大多来源于 jsdelivr 的 CDN 连接（这是因为 Butterfly 主题默认 CDN 源为 jsdelivr）。</p>\n<blockquote>\n<p>不熟悉 CDN 的小伙伴可以将其理解为，jsdelivr 里存放了大量的 js 文件或 css 文件，你的博客网站需要引入这些文件。但是由于国情，jsdelivr 结点的链接状况在国内时好时坏。</p>\n</blockquote>\n<p>这时我们可以考虑把获取这些 js 或 css 文件的链接替换掉，或者把默认的第三方源替换掉。在你的主题配置上进行替换，这里以 Butterfly 主题为例，在主题配置文件下找到：</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">CDN:</span></span><br><span class=\"line\">\t<span class=\"comment\"># The CDN provider of third party scripts (第三方 js 的 cdn 配置)</span></span><br><span class=\"line\">\t<span class=\"comment\"># option: local/jsdelivr/unpkg/cdnjs/custom</span></span><br><span class=\"line\">\t<span class=\"comment\"># when set it to local, you need to install hexo-butterfly-extjs</span></span><br><span class=\"line\">\t<span class=\"attr\">third_party_provider:</span> <span class=\"string\">unpkg</span> <span class=\"comment\"># jsdelivr/unpkg/cdnjs</span></span><br><span class=\"line\">\t<span class=\"attr\">option:</span></span><br><span class=\"line\">\t\t<span class=\"attr\">fontawesome:</span> <span class=\"string\">&lt;替换的cdn&gt;</span></span><br></pre></td></tr></table></figure>\n<p>关于此项配置详看 Butterfly 主题官方文档：<a href=\"https://butterfly.js.org/posts/ceeb73f/#CDN\">Butterfly 安裝文檔(四) 主題配置-2 | Butterfly</a></p>\n<p>以下是博主使用过的国内公共 CDN 静态资源库：</p>\n<ul>\n<li>【✅推荐】字节跳动静态资源公共库 <a href=\"http://cdn.bytedance.com\">cdn.bytedance.com</a></li>\n<li>【✅推荐】南方科技大学 CDN 镜像 <a href=\"http://mirrors.sustech.edu.cn/help/cdnjs.html\">mirrors.sustech.edu.cn/help/cdnjs.html</a> ，是 cdnjs 的镜像站</li>\n<li>【✅推荐】饿了么 <a href=\"http://github.elemecdn.com\">github.elemecdn.com</a> 是 unpkg 的国内镜像站。</li>\n<li><strong>【🚫禁止使用】</strong> <a href=\"http://bootcdn.cn\">bootcdn.cn</a> <code>240904</code> 官网都开始凌乱了，部分文件已挂。据传存在安全隐患 <sup class=\"footnote-ref\"><a href=\"#fn4\" id=\"fnref4\">[4]</a></sup>。</li>\n</ul>\n<p>也可以把文件放在自己的使用了 CDN 的存储桶中，或博客项目资源目录里（注意看好你的钱包）。</p>\n<h1 id=\"本文参考\"><a class=\"markdownIt-Anchor\" href=\"#本文参考\"></a> 本文参考</h1>\n<ul>\n<li><a href=\"https://blog.zhheo.com/p/790087d9.html\">Butterfly CDN 链接更改指南，替换 jsdelivr 提升访问速度 | 张洪 Heo (zhheo.com)</a></li>\n<li><a href=\"https://blog.csdn.net/u013014254/article/details/122045331\">jsdelivr 炸了如何解决|用这些免费 cdn_地域男孩的博客-CSDN 博客</a></li>\n<li><a href=\"https://butterfly.js.org/posts/ceeb73f/#custom-format\">Butterfly 安裝文檔(四) 主題配置-2 | Butterfly</a></li>\n<li><a href=\"https://github.com/jerryc127/hexo-theme-butterfly/issues/1243\">fontawesome 图标问题 · Issue #1243 · jerryc127/hexo-theme-butterfly (github.com)</a></li>\n<li><a href=\"https://blog.zhheo.com/p/790087d9.html\">Butterfly CDN 链接更改指南，替换 jsdelivr 提升访问速度 | 张洪 Heo (zhheo.com)</a></li>\n</ul>\n<p>其他优化博客网站的好文（我没仔细看，似乎有干货）：</p>\n<ul>\n<li><a href=\"https://akilar.top/posts/7c16c4bb/\">Hexo 博客优化蓝图 | Akilar の糖果屋</a></li>\n<li><a href=\"https://blog.mrzefr.cn/posts/hexo-speed/\">MrZeFr 的小窝 - Hello World</a></li>\n</ul>\n<hr class=\"footnotes-sep\" />\n<section class=\"footnotes\">\n<ol class=\"footnotes-list\">\n<li id=\"fn1\" class=\"footnote-item\"><p>详看这篇文章：<a class=\"uuanqin-bilink\" target=\"_blank\" href=\"/p/ad28b4a/\"><span class=\"yukari\">站内文章</span>部署 Hexo 个人博客框架到服务器</a> <a href=\"#fnref1\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn2\" class=\"footnote-item\"><p>fontawesome 可以考虑更换图标库，请看我之前的文章 <a class=\"uuanqin-bilink\" target=\"_blank\" href=\"/p/4872f379/\"><span class=\"yukari\">站内文章</span>【索引】装点你的 Butterfly 博客</a> <a href=\"#fnref2\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn3\" class=\"footnote-item\"><p>处理这个问题前请看我之前的文章：<a class=\"uuanqin-bilink\" target=\"_blank\" href=\"/p/591f2165/\"><span class=\"yukari\">站内文章</span>Hexo Btterfly 引入 Waline 评论系统以及常见问题解决</a> 决]] 访问时却一切正常。这时候我们该考虑是不是 CDN 出现问题了。 <a href=\"#fnref3\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn4\" class=\"footnote-item\"><p>详见 <a href=\"https://sansec.io/research/polyfill-supply-chain-attack\">Polyfill 供应链攻击击中 100K+ 个站点</a> <a href=\"#fnref4\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n</ol>\n</section>\n","raw":"---\ntitle: 国内访问 Hexo 博客优化加速（静态资源 CDN 链接替换）\ntags:\n  - jsdelivr\n  - CDN\n  - Butterfly\n  - Waline\ncover: 'https://cdn.gallery.uuanqin.top/img/jsdeliver-banned.png'\ndescription: 本文介绍 Butterfly 下替换 CDN 链接的解决方案\nabbrlink: 7b17333d\ncategories:\n  - 博客站点维护\n  - Hexo\ndate: 2023-04-28 17:34:18\ntop_img:\n---\n\n假设你刚搭建了个人博客，发现网站的访问速度实在堪忧，怎么办？解决方法无非以下几种方法：\n\n- 有经济实力的，考虑提升硬件性能和带宽（购买高级服务器、增大带宽）\n- 正确使用 CDN 加速源站和图片\n- 如果你的个人博客网站是动态网站（如 Wordpress），但实在没有必要必须是动态网站时，可尝试改成静态框架 [^hexo]\n\n[^hexo]: 详看这篇文章：[[部署 Hexo 个人博客框架到服务器]]\n\n如果以上的方法你都尝试过，但博客网站可能遇到页面卡顿、显示不全、功能异常（图标、评论、搜索等各种异常）等情况，比如：\n\n- font awesome 加载迟、卡，拖慢网页加载 [^hb]。\n- algolia 搜索按钮按不出来\n- Waline 评论系统不显示或评论数据无法获取 [^bw]\n- 网站加载条等了半天，文章图片一直都是加载中\n\n[^hb]: fontawesome 可以考虑更换图标库，请看我之前的文章 [[【索引】装点你的 Butterfly 博客]]\n[^bw]: 处理这个问题前请看我之前的文章：[[Hexo Btterfly 引入 Waline 评论系统以及常见问题解决]] 决]] 访问时却一切正常。这时候我们该考虑是不是 CDN 出现问题了。\n\n本地调试自己的博客网站后，打开浏览器的开发者面板（F12）-> 禁用缓存 -> 点击网络选项卡 -> 刷新页面：\n\n![jsdeliver惹的祸1|500](https://cdn.gallery.uuanqin.top/img/jsdeliver%E6%83%B9%E7%9A%84%E7%A5%B81.png)\n\n你会发现一些 js 文件或 css 文件无法被加载，这些文件大多来源于 jsdelivr 的 CDN 连接（这是因为 Butterfly 主题默认 CDN 源为 jsdelivr）。\n\n> 不熟悉 CDN 的小伙伴可以将其理解为，jsdelivr 里存放了大量的 js 文件或 css 文件，你的博客网站需要引入这些文件。但是由于国情，jsdelivr 结点的链接状况在国内时好时坏。\n\n这时我们可以考虑把获取这些 js 或 css 文件的链接替换掉，或者把默认的第三方源替换掉。在你的主题配置上进行替换，这里以 Butterfly 主题为例，在主题配置文件下找到：\n\n```yaml\nCDN:\n\t# The CDN provider of third party scripts (第三方 js 的 cdn 配置)\n\t# option: local/jsdelivr/unpkg/cdnjs/custom\n\t# when set it to local, you need to install hexo-butterfly-extjs\n\tthird_party_provider: unpkg # jsdelivr/unpkg/cdnjs\n\toption:\n\t\tfontawesome: <替换的cdn>\n```\n\n关于此项配置详看 Butterfly 主题官方文档：[Butterfly 安裝文檔(四) 主題配置-2 | Butterfly](https://butterfly.js.org/posts/ceeb73f/#CDN)\n\n以下是博主使用过的国内公共 CDN 静态资源库：\n\n- 【✅推荐】字节跳动静态资源公共库 cdn.bytedance.com\n- 【✅推荐】南方科技大学 CDN 镜像 mirrors.sustech.edu.cn/help/cdnjs.html ，是 cdnjs 的镜像站\n- 【✅推荐】饿了么 github.elemecdn.com 是 unpkg 的国内镜像站。\n-  **【🚫禁止使用】** bootcdn.cn `240904` 官网都开始凌乱了，部分文件已挂。据传存在安全隐患 [^poly]。\n\n也可以把文件放在自己的使用了 CDN 的存储桶中，或博客项目资源目录里（注意看好你的钱包）。\n\n[^poly]: 详见 [Polyfill 供应链攻击击中 100K+ 个站点](https://sansec.io/research/polyfill-supply-chain-attack)\n\n# 本文参考\n\n- [Butterfly CDN 链接更改指南，替换 jsdelivr 提升访问速度 | 张洪 Heo (zhheo.com)](https://blog.zhheo.com/p/790087d9.html)\n- [jsdelivr 炸了如何解决|用这些免费 cdn\\_地域男孩的博客-CSDN 博客](https://blog.csdn.net/u013014254/article/details/122045331)\n- [Butterfly 安裝文檔(四) 主題配置-2 | Butterfly](https://butterfly.js.org/posts/ceeb73f/#custom-format)\n- [fontawesome 图标问题 · Issue #1243 · jerryc127/hexo-theme-butterfly (github.com)](https://github.com/jerryc127/hexo-theme-butterfly/issues/1243)\n- [Butterfly CDN 链接更改指南，替换 jsdelivr 提升访问速度 | 张洪 Heo (zhheo.com)](https://blog.zhheo.com/p/790087d9.html)\n\n其他优化博客网站的好文（我没仔细看，似乎有干货）：\n\n- [Hexo 博客优化蓝图 | Akilar の糖果屋](https://akilar.top/posts/7c16c4bb/)\n- [MrZeFr 的小窝 - Hello World](https://blog.mrzefr.cn/posts/hexo-speed/)\n","categories":[{"name":"博客站点维护","api":"api/categories/博客站点维护.json"},{"name":"Hexo","api":"api/categories/博客站点维护/Hexo.json"}],"tags":[{"name":"CDN","api":"api/tags/CDN.json"},{"name":"Waline","api":"api/tags/Waline.json"},{"name":"Butterfly","api":"api/tags/Butterfly.json"},{"name":"jsdelivr","api":"api/tags/jsdelivr.json"}]},"api":"api/posts/p/7b17333d.json"}